"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8666],{44929:(t,e,a)=>{function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,e,a){return(e=function(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,e||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}a.d(e,{A:()=>u});function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function n(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function c(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?n(Object(a),!0).forEach((function(e){s(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function s(t,e,a){return(e=function(t){var e=function(t,e){if("object"!=l(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var i=a.call(t,e||"default");if("object"!=l(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==l(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}const o={props:["title","type","src","preview","prefix"],data:function(){return{duplicateModal:!1,loading:!0,listData:[],filteredList:[],duplicateData:{schema:{},name:null,id:null},tableList:window.init.dbSchema.tableList,viewList:window.init.dbSchema.viewList,reportList:window.init.dbSchema.reportList}},created:function(){this.getData()},computed:{lang:function(){var t=this,e=["add","delete_data"];return e.reduce((function(a,i,r){return a[i]=t.$t("puzzle."+e[r]),a}),{})},lang1:function(){var t=this,e=["pleaseEnterSearchValue","yes","no","copy","name","selectTable","table","basicTable","table_list"];return e.reduce((function(a,i,r){return a[i]=t.$t("components."+e[r]),a}),{})}},methods:{getData:function(){var t=this;axios.get(this.$props.src).then((function(e){var a=e.data;t.loading=!1,t.listData=a.data.sort((function(t,e){return e.id-t.id})),t.filteredList=t.listData.map((function(t){return c({},t)}))}))},doDuplicate:function(){var t=this,e="/lambda/puzzle/schema/form";"grid"===this.type&&(e="/lambda/puzzle/schema/grid",this.duplicateData.schema.schema.forEach((function(e){e.table=t.duplicateData.schema.model}))),this.$project&&(e="/lambda/puzzle/project/".concat(this.$project.id,"/form"),"grid"===this.type&&(e="/lambda/puzzle/project/".concat(this.$project.id,"/grid"),this.duplicateData.schema.schema.forEach((function(e){e.table=t.duplicateData.schema.model}))));var a={name:this.duplicateData.name,schema:JSON.stringify(this.duplicateData.schema)};"datasource"===this.type&&(e="/lambda/puzzle/schema/datasource"),axios.post(e,a).then((function(e){e.data.status?(t.$Notice.success({title:"Амжилттай хадгалагдлаа",desc:'"'.concat(t.formName,'" формын мэдээлэл амжилттай хадгалагдлаа.')}),t.duplicateModal=!1,t.duplicateData={schema:{},name:null,id:null},t.getData()):t.$Notice.error({title:"Хадгалах үед алдаа гарлаа!"})}))},duplicate:function(t,e){var a=this,i="/lambda/puzzle/schema/form/".concat(t,"/builder");"grid"==this.type&&(i="/lambda/puzzle/schema/grid/".concat(t)),this.$project&&(i="/lambda/puzzle/project/".concat(this.$project.id,"/form/").concat(t,"/builder"),"grid"==this.type&&(i="/lambda/puzzle/project/".concat(this.$project.id,"/grid/").concat(t))),axios.get(i).then((function(e){var i=e.data;a.duplicateData.name=i.data.hasOwnProperty("name")?i.data.name:i.data.model,a.duplicateData.schema=JSON.parse(i.data.schema),a.duplicateData.id=t,a.duplicateModal=!0})).catch((function(t){console.log(t)}))},deleteListItem:function(t){var e=this;axios.delete(this.$project?"/lambda/puzzle/delete/project/vb_schemas/".concat(this.$project.id,"/").concat(this.type,"/").concat(t):"/lambda/puzzle/delete/vb_schemas/".concat(this.type,"/").concat(t)).then((function(a){e.filteredList=e.filteredList.filter((function(e){return e.id!==t})),e.listData=e.listData.filter((function(e){return e.id!==t})),e.$Message.success("444 Амжилттай устгалаа!")}))},cancel:function(){},filterList:function(t){var e=this,a=t.target.value;if(""!==a){var i=e.listData.filter((function(t){return t.name.toString().toLowerCase().includes(a.toLowerCase())}));e.filteredList=i.map((function(t){return c({},t)}))}else e.filteredList=e.listData.map((function(t){return c({},t)}))}}};const u=(0,a(14486).A)(o,(function(){var t=this,e=t._self._c;return e("section",{staticClass:"page page-list"},[e("div",{staticClass:"page-list-header"},[e("h3",[t._v(t._s(t.title)+" ("+t._s(t.listData.length)+")")]),t._v(" "),e("div",{staticClass:"page-list-header-search"},[e("Input",{staticStyle:{width:"200px"},attrs:{icon:"ios-search",placeholder:t.lang1.pleaseEnterSearchValue},on:{"on-keyup":t.filterList}})],1),t._v(" "),e("div",{staticClass:"page-list-header-control"},[e("router-link",{staticClass:"btn-del",attrs:{to:"".concat(t.prefix?t.prefix:"","/").concat(t.type,"/builder")}},[e("Button",{attrs:{type:"success"}},[e("Icon",{attrs:{type:"md-add"}}),t._v("\n                    "+t._s(t.lang.add)+"\n                ")],1)],1)],1)]),t._v(" "),t.loading?e("div",{staticClass:"loader"},[t._m(0)]):e("Row",{directives:[{name:"slimscroll",rawName:"v-slimscroll",value:{height:"100vh-30",size:7,alwaysVisible:!0,wheelStep:7,color:"#2C3A47"},expression:"{height:'100vh-30',size:7,alwaysVisible: true,wheelStep:7,color:'#2C3A47'}"}],staticClass:"pz-list",attrs:{gutter:16}},t._l(t.filteredList,(function(a){return e("Col",{key:a.index,attrs:{xs:24,sm:12,md:8,lg:6}},[e("div",{staticClass:"pz-list-item"},[e("div",{staticClass:"pz-list-item-body"},[e("h3",[t._v(t._s(a.name))]),t._v(" "),e("small",[t._v(t._s(a.created_at))])]),t._v(" "),e("div",{staticClass:"pz-list-item-control"},["form"==t.type||"grid"==t.type||"datasource"==t.type?e("a",{staticClass:"btn-preview",staticStyle:{"margin-right":"5px","font-size":"10px"},attrs:{href:"javascript:void(0);"}},[t._v("\n                        "+t._s(a.id)+"\n                    ")]):t._e(),t._v(" "),"hidden"!=t.preview?e("router-link",{staticClass:"btn-preview",attrs:{to:"".concat(t.prefix?t.prefix:"","/").concat(t.type,"/preview/").concat(a.id)}},[e("Icon",{attrs:{type:"ios-eye"}})],1):t._e(),t._v(" \n                    "),"form"==t.type||"grid"==t.type||"datasource"==t.type?e("a",{staticClass:"btn-preview",attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.duplicate(a.id,t.type)}}},[e("Icon",{attrs:{type:"md-copy"}})],1):t._e(),t._v(" "),e("span",[e("router-link",{staticClass:"btn-edit",attrs:{to:"".concat(t.prefix?t.prefix:"","/").concat(t.type,"/builder/").concat(a.id)}},[e("Icon",{attrs:{type:"md-create"}})],1),t._v(" "),e("Poptip",{attrs:r(r(r(r({confirm:"",title:t.lang.delete_data},"confirm",""),"width","180"),"ok-text",t.lang1.yes),"cancel-text",t.lang1.no),on:{"on-ok":function(e){return t.deleteListItem(a.id)},"on-cancel":t.cancel}},[e("a",{staticClass:"btn-del",attrs:{href:"javascript:void(0)"}},[e("Icon",{attrs:{type:"ios-trash"}})],1)])],1)],1)])])})),1),t._v(" "),e("Modal",{attrs:{title:t.lang1.copy,"ok-text":t.lang1.copy},on:{"on-ok":t.doDuplicate},model:{value:t.duplicateModal,callback:function(e){t.duplicateModal=e},expression:"duplicateModal"}},[e("label",[t._v(t._s(t.lang1.name))]),t._v(" "),e("Input",{staticStyle:{width:"100%"},attrs:{placeholder:t.lang1.name},model:{value:t.duplicateData.name,callback:function(e){t.$set(t.duplicateData,"name",e)},expression:"duplicateData.name"}}),t._v(" "),"form"===t.type||"grid"===t.type?e("label",[t._v(t._s(t.lang1.table)+" (DB table)")]):t._e(),t._v(" "),"form"===t.type?e("Select",{staticStyle:{width:"100%"},attrs:{placeholder:t.lang1.selectTable,clearable:"",filterable:""},model:{value:t.duplicateData.schema.model,callback:function(e){t.$set(t.duplicateData.schema,"model",e)},expression:"duplicateData.schema.model"}},t._l(t.tableList,(function(a){return e("Option",{key:a.index,attrs:{value:a}},[t._v(t._s(a))])})),1):t._e(),t._v(" "),"grid"===t.type?e("Select",{staticStyle:{width:"100%"},attrs:{placeholder:t.lang1.selectTable,clearable:"",filterable:""},model:{value:t.duplicateData.schema.model,callback:function(e){t.$set(t.duplicateData.schema,"model",e)},expression:"duplicateData.schema.model"}},[e("OptionGroup",{attrs:{label:t.lang.table_list}},t._l(t.tableList,(function(a){return e("Option",{key:a.index,attrs:{value:a}},[t._v(t._s(a))])})),1),t._v(" "),e("OptionGroup",{attrs:{label:t.lang.table_list}},t._l(t.viewList,(function(a){return e("Option",{key:a.index,attrs:{value:a}},[t._v(t._s(a))])})),1)],1):t._e(),t._v(" "),"grid"===t.type?e("label",[t._v(t._s(t.lang1.basicTable)+" (DB table)")]):t._e(),t._v(" "),"grid"===t.type?e("Select",{staticStyle:{width:"100%"},attrs:{placeholder:t.lang1.selectTable,clearable:"",filterable:""},model:{value:t.duplicateData.schema.mainTable,callback:function(e){t.$set(t.duplicateData.schema,"mainTable",e)},expression:"duplicateData.schema.mainTable"}},t._l(t.tableList,(function(a){return e("Option",{key:a.index,attrs:{value:a}},[t._v(t._s(a))])})),1):t._e()],1)],1)}),[function(){var t=this,e=t._self._c;return e("div",{staticClass:"loader-wrapper"},[e("div",{staticClass:"lds-roller"},[e("div"),t._v(" "),e("div"),t._v(" "),e("div"),t._v(" "),e("div"),t._v(" "),e("div"),t._v(" "),e("div"),t._v(" "),e("div"),t._v(" "),e("div")]),t._v(" "),e("h3",[t._v("Түр хүлээнэ үү")])])}],!1,null,null,null).exports},59562:(t,e,a)=>{a.r(e),a.d(e,{default:()=>r});const i={components:{"list-view":a(44929).A},methods:{},computed:{lang:function(){var t=this,e=["_report"];return e.reduce((function(a,i,r){return a[i]=t.$t("puzzle."+e[r]),a}),{})}}};const r=(0,a(14486).A)(i,(function(){var t=this;return(0,t._self._c)("list-view",{attrs:{src:"/lambda/puzzle/schema/report",title:t.lang._report,type:"report",data:t.listData}})}),[],!1,null,null,null).exports}}]);