"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1875],{57495:(t,e,a)=>{a.d(e,{A:()=>l});const i={props:["title","type","src","preview","prefix"],data:()=>({duplicateModal:!1,loading:!0,listData:[],filteredList:[],duplicateData:{schema:{},name:null,id:null},tableList:window.init.dbSchema.tableList,viewList:window.init.dbSchema.viewList,reportList:window.init.dbSchema.reportList}),created(){this.getData()},computed:{lang(){const t=["add","delete_data"];return t.reduce(((e,a,i)=>(e[a]=this.$t("puzzle."+t[i]),e)),{})},lang1(){const t=["pleaseEnterSearchValue","yes","no","copy","name","selectTable","table","basicTable","table_list"];return t.reduce(((e,a,i)=>(e[a]=this.$t("components."+t[i]),e)),{})}},methods:{getData(){axios.get(this.$props.src).then((({data:t})=>{this.loading=!1,this.listData=t.data.sort(((t,e)=>e.id-t.id)),this.filteredList=this.listData.map((t=>({...t})))}))},doDuplicate(){let t="/lambda/puzzle/schema/form";"grid"===this.type&&(t="/lambda/puzzle/schema/grid",this.duplicateData.schema.schema.forEach((t=>{t.table=this.duplicateData.schema.model}))),this.$project&&(t=`/lambda/puzzle/project/${this.$project.id}/form`,"grid"===this.type&&(t=`/lambda/puzzle/project/${this.$project.id}/grid`,this.duplicateData.schema.schema.forEach((t=>{t.table=this.duplicateData.schema.model}))));let e={name:this.duplicateData.name,schema:JSON.stringify(this.duplicateData.schema)};"datasource"===this.type&&(t="/lambda/puzzle/schema/datasource"),axios.post(t,e).then((({data:t})=>{t.status?(this.$Notice.success({title:"Амжилттай хадгалагдлаа",desc:`"${this.formName}" формын мэдээлэл амжилттай хадгалагдлаа.`}),this.duplicateModal=!1,this.duplicateData={schema:{},name:null,id:null},this.getData()):this.$Notice.error({title:"Хадгалах үед алдаа гарлаа!"})}))},duplicate(t,e){let a=`/lambda/puzzle/schema/form/${t}/builder`;"grid"==this.type&&(a=`/lambda/puzzle/schema/grid/${t}`),this.$project&&(a=`/lambda/puzzle/project/${this.$project.id}/form/${t}/builder`,"grid"==this.type&&(a=`/lambda/puzzle/project/${this.$project.id}/grid/${t}`)),axios.get(a).then((({data:e})=>{this.duplicateData.name=e.data.hasOwnProperty("name")?e.data.name:e.data.model,this.duplicateData.schema=JSON.parse(e.data.schema),this.duplicateData.id=t,this.duplicateModal=!0})).catch((t=>{console.log(t)}))},deleteListItem(t){axios.delete(this.$project?`/lambda/puzzle/delete/project/vb_schemas/${this.$project.id}/${this.type}/${t}`:`/lambda/puzzle/delete/vb_schemas/${this.type}/${t}`).then((e=>{this.filteredList=this.filteredList.filter((e=>e.id!==t)),this.listData=this.listData.filter((e=>e.id!==t)),this.$Message.success("444 Амжилттай устгалаа!")}))},cancel(){},filterList(t){let e=this,a=t.target.value;if(""!==a){let t=e.listData.filter((t=>t.name.toString().toLowerCase().includes(a.toLowerCase())));e.filteredList=t.map((t=>({...t})))}else e.filteredList=e.listData.map((t=>({...t})))}}};const l=(0,a(14486).A)(i,(function(){var t=this,e=t._self._c;return e("section",{staticClass:"page page-list"},[e("div",{staticClass:"page-list-header"},[e("h3",[t._v(t._s(t.title)+" ("+t._s(t.listData.length)+")")]),t._v(" "),e("div",{staticClass:"page-list-header-search"},[e("Input",{staticStyle:{width:"200px"},attrs:{icon:"ios-search",placeholder:t.lang1.pleaseEnterSearchValue},on:{"on-keyup":t.filterList}})],1),t._v(" "),e("div",{staticClass:"page-list-header-control"},[e("router-link",{staticClass:"btn-del",attrs:{to:`${t.prefix?t.prefix:""}/${t.type}/builder`}},[e("Button",{attrs:{type:"success"}},[e("Icon",{attrs:{type:"md-add"}}),t._v("\n                    "+t._s(t.lang.add)+"\n                ")],1)],1)],1)]),t._v(" "),t.loading?e("div",{staticClass:"loader"},[t._m(0)]):e("Row",{directives:[{name:"slimscroll",rawName:"v-slimscroll",value:{height:"100vh-30",size:7,alwaysVisible:!0,wheelStep:7,color:"#2C3A47"},expression:"{height:'100vh-30',size:7,alwaysVisible: true,wheelStep:7,color:'#2C3A47'}"}],staticClass:"pz-list",attrs:{gutter:16}},t._l(t.filteredList,(function(a){return e("Col",{key:a.index,attrs:{xs:24,sm:12,md:8,lg:6}},[e("div",{staticClass:"pz-list-item"},[e("div",{staticClass:"pz-list-item-body"},[e("h3",[t._v(t._s(a.name))]),t._v(" "),e("small",[t._v(t._s(a.created_at))])]),t._v(" "),e("div",{staticClass:"pz-list-item-control"},["form"==t.type||"grid"==t.type||"datasource"==t.type?e("a",{staticClass:"btn-preview",staticStyle:{"margin-right":"5px","font-size":"10px"},attrs:{href:"javascript:void(0);"}},[t._v("\n                        "+t._s(a.id)+"\n                    ")]):t._e(),t._v(" "),"hidden"!=t.preview?e("router-link",{staticClass:"btn-preview",attrs:{to:`${t.prefix?t.prefix:""}/${t.type}/preview/${a.id}`}},[e("Icon",{attrs:{type:"ios-eye"}})],1):t._e(),t._v(" \n                    "),"form"==t.type||"grid"==t.type||"datasource"==t.type?e("a",{staticClass:"btn-preview",attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.duplicate(a.id,t.type)}}},[e("Icon",{attrs:{type:"md-copy"}})],1):t._e(),t._v(" "),e("span",[e("router-link",{staticClass:"btn-edit",attrs:{to:`${t.prefix?t.prefix:""}/${t.type}/builder/${a.id}`}},[e("Icon",{attrs:{type:"md-create"}})],1),t._v(" "),e("Poptip",{attrs:{confirm:"",title:t.lang.delete_data,confirm:"",width:"180","ok-text":t.lang1.yes,"cancel-text":t.lang1.no},on:{"on-ok":function(e){return t.deleteListItem(a.id)},"on-cancel":t.cancel}},[e("a",{staticClass:"btn-del",attrs:{href:"javascript:void(0)"}},[e("Icon",{attrs:{type:"ios-trash"}})],1)])],1)],1)])])})),1),t._v(" "),e("Modal",{attrs:{title:t.lang1.copy,"ok-text":t.lang1.copy},on:{"on-ok":t.doDuplicate},model:{value:t.duplicateModal,callback:function(e){t.duplicateModal=e},expression:"duplicateModal"}},[e("label",[t._v(t._s(t.lang1.name))]),t._v(" "),e("Input",{staticStyle:{width:"100%"},attrs:{placeholder:t.lang1.name},model:{value:t.duplicateData.name,callback:function(e){t.$set(t.duplicateData,"name",e)},expression:"duplicateData.name"}}),t._v(" "),"form"===t.type||"grid"===t.type?e("label",[t._v(t._s(t.lang1.table)+" (DB table)")]):t._e(),t._v(" "),"form"===t.type?e("Select",{staticStyle:{width:"100%"},attrs:{placeholder:t.lang1.selectTable,clearable:"",filterable:""},model:{value:t.duplicateData.schema.model,callback:function(e){t.$set(t.duplicateData.schema,"model",e)},expression:"duplicateData.schema.model"}},t._l(t.tableList,(function(a){return e("Option",{key:a.index,attrs:{value:a}},[t._v(t._s(a))])})),1):t._e(),t._v(" "),"grid"===t.type?e("Select",{staticStyle:{width:"100%"},attrs:{placeholder:t.lang1.selectTable,clearable:"",filterable:""},model:{value:t.duplicateData.schema.model,callback:function(e){t.$set(t.duplicateData.schema,"model",e)},expression:"duplicateData.schema.model"}},[e("OptionGroup",{attrs:{label:t.lang.table_list}},t._l(t.tableList,(function(a){return e("Option",{key:a.index,attrs:{value:a}},[t._v(t._s(a))])})),1),t._v(" "),e("OptionGroup",{attrs:{label:t.lang.table_list}},t._l(t.viewList,(function(a){return e("Option",{key:a.index,attrs:{value:a}},[t._v(t._s(a))])})),1)],1):t._e(),t._v(" "),"grid"===t.type?e("label",[t._v(t._s(t.lang1.basicTable)+" (DB table)")]):t._e(),t._v(" "),"grid"===t.type?e("Select",{staticStyle:{width:"100%"},attrs:{placeholder:t.lang1.selectTable,clearable:"",filterable:""},model:{value:t.duplicateData.schema.mainTable,callback:function(e){t.$set(t.duplicateData.schema,"mainTable",e)},expression:"duplicateData.schema.mainTable"}},t._l(t.tableList,(function(a){return e("Option",{key:a.index,attrs:{value:a}},[t._v(t._s(a))])})),1):t._e()],1)],1)}),[function(){var t=this,e=t._self._c;return e("div",{staticClass:"loader-wrapper"},[e("div",{staticClass:"lds-roller"},[e("div"),t._v(" "),e("div"),t._v(" "),e("div"),t._v(" "),e("div"),t._v(" "),e("div"),t._v(" "),e("div"),t._v(" "),e("div"),t._v(" "),e("div")]),t._v(" "),e("h3",[t._v("Түр хүлээнэ үү")])])}],!1,null,null,null).exports},26772:(t,e,a)=>{a.r(e),a.d(e,{default:()=>l});const i={components:{"list-view":a(57495).A},data:()=>({}),methods:{},computed:{lang(){const t=["graphql_management"];return t.reduce(((e,a,i)=>(e[a]=this.$t("project."+t[i]),e)),{})}}};const l=(0,a(14486).A)(i,(function(){var t=this,e=t._self._c;return e("div",[t.$project?e("list-view",{attrs:{src:`/lambda/puzzle/project/${t.$project.id}/graphql`,title:t.lang.graphql_management,type:"graphql",data:t.listData,preview:"hidden"}}):e("list-view",{attrs:{src:"/lambda/puzzle/schema/graphql",title:t.lang.graphql_management,type:"graphql",data:t.listData,preview:"hidden"}})],1)}),[],!1,null,null,null).exports}}]);