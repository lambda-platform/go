var ho=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function n0(S){return S&&S.__esModule&&Object.prototype.hasOwnProperty.call(S,"default")?S.default:S}function Tm(S){if(S.__esModule)return S;var B=S.default;if(typeof B=="function"){var W=function R(){return this instanceof R?Reflect.construct(B,arguments,this.constructor):B.apply(this,arguments)};W.prototype=B.prototype}else W={};return Object.defineProperty(W,"__esModule",{value:!0}),Object.keys(S).forEach(function(R){var P=Object.getOwnPropertyDescriptor(S,R);Object.defineProperty(W,R,P.get?P:{enumerable:!0,get:function(){return S[R]}})}),W}var tp={},Qc="1.13.7",Yg=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},dh=Array.prototype,qc=Object.prototype,Ug=typeof Symbol<"u"?Symbol.prototype:null,Nm=dh.push,Ha=dh.slice,Za=qc.toString,Pm=qc.hasOwnProperty,ep=typeof ArrayBuffer<"u",Em=typeof DataView<"u",Lm=Array.isArray,Hg=Object.keys,Xg=Object.create,Jg=ep&&ArrayBuffer.isView,Dm=isNaN,Bm=isFinite,ip=!{toString:null}.propertyIsEnumerable("toString"),$g=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],zm=Math.pow(2,53)-1;function ln(S,B){return B=B==null?S.length-1:+B,function(){for(var W=Math.max(arguments.length-B,0),R=Array(W),P=0;P<W;P++)R[P]=arguments[P+B];switch(B){case 0:return S.call(this,R);case 1:return S.call(this,arguments[0],R);case 2:return S.call(this,arguments[0],arguments[1],R)}var ht=Array(B+1);for(P=0;P<B;P++)ht[P]=arguments[P];return ht[B]=R,S.apply(this,ht)}}function uo(S){var B=typeof S;return B==="function"||B==="object"&&!!S}function np(S){return S===null}function tu(S){return S===void 0}function eu(S){return S===!0||S===!1||Za.call(S)==="[object Boolean]"}function rp(S){return!!(S&&S.nodeType===1)}function Ki(S){var B="[object "+S+"]";return function(W){return Za.call(W)===B}}const gh=Ki("String"),iu=Ki("Number"),op=Ki("Date"),sp=Ki("RegExp"),ap=Ki("Error"),nu=Ki("Symbol"),ru=Ki("ArrayBuffer");var lp=Ki("Function"),Om=Yg.document&&Yg.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof Om!="function"&&(lp=function(S){return typeof S=="function"||!1});const $i=lp,hp=Ki("Object");var cp=Em&&(!/\[native code\]/.test(String(DataView))||hp(new DataView(new ArrayBuffer(8)))),ou=typeof Map<"u"&&hp(new Map),Rm=Ki("DataView");function jm(S){return S!=null&&$i(S.getInt8)&&ru(S.buffer)}const Fa=cp?jm:Rm,go=Lm||Ki("Array");function po(S,B){return S!=null&&Pm.call(S,B)}var Xc=Ki("Arguments");(function(){Xc(arguments)||(Xc=function(S){return po(S,"callee")})})();const ph=Xc;function up(S){return!nu(S)&&Bm(S)&&!isNaN(parseFloat(S))}function su(S){return iu(S)&&Dm(S)}function au(S){return function(){return S}}function dp(S){return function(B){var W=S(B);return typeof W=="number"&&W>=0&&W<=zm}}function gp(S){return function(B){return B==null?void 0:B[S]}}const ah=gp("byteLength"),Gm=dp(ah);var Vm=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function Zm(S){return Jg?Jg(S)&&!Fa(S):Gm(S)&&Vm.test(Za.call(S))}const lu=ep?Zm:au(!1),vn=gp("length");function Fm(S){for(var B={},W=S.length,R=0;R<W;++R)B[S[R]]=!0;return{contains:function(P){return B[P]===!0},push:function(P){return B[P]=!0,S.push(P)}}}function pp(S,B){B=Fm(B);var W=$g.length,R=S.constructor,P=$i(R)&&R.prototype||qc,ht="constructor";for(po(S,ht)&&!B.contains(ht)&&B.push(ht);W--;)ht=$g[W],ht in S&&S[ht]!==P[ht]&&!B.contains(ht)&&B.push(ht)}function Pi(S){if(!uo(S))return[];if(Hg)return Hg(S);var B=[];for(var W in S)po(S,W)&&B.push(W);return ip&&pp(S,B),B}function fp(S){if(S==null)return!0;var B=vn(S);return typeof B=="number"&&(go(S)||gh(S)||ph(S))?B===0:vn(Pi(S))===0}function hu(S,B){var W=Pi(B),R=W.length;if(S==null)return!R;for(var P=Object(S),ht=0;ht<R;ht++){var wt=W[ht];if(B[wt]!==P[wt]||!(wt in P))return!1}return!0}function Ze(S){if(S instanceof Ze)return S;if(!(this instanceof Ze))return new Ze(S);this._wrapped=S}Ze.VERSION=Qc;Ze.prototype.value=function(){return this._wrapped};Ze.prototype.valueOf=Ze.prototype.toJSON=Ze.prototype.value;Ze.prototype.toString=function(){return String(this._wrapped)};function Kg(S){return new Uint8Array(S.buffer||S,S.byteOffset||0,ah(S))}var Qg="[object DataView]";function Jc(S,B,W,R){if(S===B)return S!==0||1/S===1/B;if(S==null||B==null)return!1;if(S!==S)return B!==B;var P=typeof S;return P!=="function"&&P!=="object"&&typeof B!="object"?!1:mp(S,B,W,R)}function mp(S,B,W,R){S instanceof Ze&&(S=S._wrapped),B instanceof Ze&&(B=B._wrapped);var P=Za.call(S);if(P!==Za.call(B))return!1;if(cp&&P=="[object Object]"&&Fa(S)){if(!Fa(B))return!1;P=Qg}switch(P){case"[object RegExp]":case"[object String]":return""+S==""+B;case"[object Number]":return+S!=+S?+B!=+B:+S==0?1/+S===1/B:+S==+B;case"[object Date]":case"[object Boolean]":return+S==+B;case"[object Symbol]":return Ug.valueOf.call(S)===Ug.valueOf.call(B);case"[object ArrayBuffer]":case Qg:return mp(Kg(S),Kg(B),W,R)}var ht=P==="[object Array]";if(!ht&&lu(S)){var wt=ah(S);if(wt!==ah(B))return!1;if(S.buffer===B.buffer&&S.byteOffset===B.byteOffset)return!0;ht=!0}if(!ht){if(typeof S!="object"||typeof B!="object")return!1;var St=S.constructor,Xt=B.constructor;if(St!==Xt&&!($i(St)&&St instanceof St&&$i(Xt)&&Xt instanceof Xt)&&"constructor"in S&&"constructor"in B)return!1}W=W||[],R=R||[];for(var Wt=W.length;Wt--;)if(W[Wt]===S)return R[Wt]===B;if(W.push(S),R.push(B),ht){if(Wt=S.length,Wt!==B.length)return!1;for(;Wt--;)if(!Jc(S[Wt],B[Wt],W,R))return!1}else{var Oe=Pi(S),Ce;if(Wt=Oe.length,Pi(B).length!==Wt)return!1;for(;Wt--;)if(Ce=Oe[Wt],!(po(B,Ce)&&Jc(S[Ce],B[Ce],W,R)))return!1}return W.pop(),R.pop(),!0}function vp(S,B){return Jc(S,B)}function Ws(S){if(!uo(S))return[];var B=[];for(var W in S)B.push(W);return ip&&pp(S,B),B}function cu(S){var B=vn(S);return function(W){if(W==null)return!1;var R=Ws(W);if(vn(R))return!1;for(var P=0;P<B;P++)if(!$i(W[S[P]]))return!1;return S!==xp||!$i(W[uu])}}var uu="forEach",yp="has",du=["clear","delete"],bp=["get",yp,"set"],_m=du.concat(uu,bp),xp=du.concat(bp),Wm=["add"].concat(du,uu,yp);const wp=ou?cu(_m):Ki("Map"),Ap=ou?cu(xp):Ki("WeakMap"),Cp=ou?cu(Wm):Ki("Set"),Ip=Ki("WeakSet");function Xo(S){for(var B=Pi(S),W=B.length,R=Array(W),P=0;P<W;P++)R[P]=S[B[P]];return R}function Mp(S){for(var B=Pi(S),W=B.length,R=Array(W),P=0;P<W;P++)R[P]=[B[P],S[B[P]]];return R}function gu(S){for(var B={},W=Pi(S),R=0,P=W.length;R<P;R++)B[S[W[R]]]=W[R];return B}function _a(S){var B=[];for(var W in S)$i(S[W])&&B.push(W);return B.sort()}function pu(S,B){return function(W){var R=arguments.length;if(B&&(W=Object(W)),R<2||W==null)return W;for(var P=1;P<R;P++)for(var ht=arguments[P],wt=S(ht),St=wt.length,Xt=0;Xt<St;Xt++){var Wt=wt[Xt];(!B||W[Wt]===void 0)&&(W[Wt]=ht[Wt])}return W}}const fu=pu(Ws),Fs=pu(Pi),mu=pu(Ws,!0);function Ym(){return function(){}}function Sp(S){if(!uo(S))return{};if(Xg)return Xg(S);var B=Ym();B.prototype=S;var W=new B;return B.prototype=null,W}function kp(S,B){var W=Sp(S);return B&&Fs(W,B),W}function Tp(S){return uo(S)?go(S)?S.slice():fu({},S):S}function Np(S,B){return B(S),S}function vu(S){return go(S)?S:[S]}Ze.toPath=vu;function Xa(S){return Ze.toPath(S)}function yu(S,B){for(var W=B.length,R=0;R<W;R++){if(S==null)return;S=S[B[R]]}return W?S:void 0}function bu(S,B,W){var R=yu(S,Xa(B));return tu(R)?W:R}function Pp(S,B){B=Xa(B);for(var W=B.length,R=0;R<W;R++){var P=B[R];if(!po(S,P))return!1;S=S[P]}return!!W}function fh(S){return S}function Ho(S){return S=Fs({},S),function(B){return hu(B,S)}}function mh(S){return S=Xa(S),function(B){return yu(B,S)}}function Ja(S,B,W){if(B===void 0)return S;switch(W??3){case 1:return function(R){return S.call(B,R)};case 3:return function(R,P,ht){return S.call(B,R,P,ht)};case 4:return function(R,P,ht,wt){return S.call(B,R,P,ht,wt)}}return function(){return S.apply(B,arguments)}}function Ep(S,B,W){return S==null?fh:$i(S)?Ja(S,B,W):uo(S)&&!go(S)?Ho(S):mh(S)}function vh(S,B){return Ep(S,B,1/0)}Ze.iteratee=vh;function yn(S,B,W){return Ze.iteratee!==vh?Ze.iteratee(S,B):Ep(S,B,W)}function Lp(S,B,W){B=yn(B,W);for(var R=Pi(S),P=R.length,ht={},wt=0;wt<P;wt++){var St=R[wt];ht[St]=B(S[St],St,S)}return ht}function xu(){}function Dp(S){return S==null?xu:function(B){return bu(S,B)}}function Bp(S,B,W){var R=Array(Math.max(0,S));B=Ja(B,W,1);for(var P=0;P<S;P++)R[P]=B(P);return R}function lh(S,B){return B==null&&(B=S,S=0),S+Math.floor(Math.random()*(B-S+1))}const _s=Date.now||function(){return new Date().getTime()};function zp(S){var B=function(ht){return S[ht]},W="(?:"+Pi(S).join("|")+")",R=RegExp(W),P=RegExp(W,"g");return function(ht){return ht=ht==null?"":""+ht,R.test(ht)?ht.replace(P,B):ht}}const Op={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Rp=zp(Op),Um=gu(Op),jp=zp(Um),Gp=Ze.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Uc=/(.)^/,Hm={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Xm=/\\|'|\r|\n|\u2028|\u2029/g;function Jm(S){return"\\"+Hm[S]}var $m=/^\s*(\w|\$)+\s*$/;function Vp(S,B,W){!B&&W&&(B=W),B=mu({},B,Ze.templateSettings);var R=RegExp([(B.escape||Uc).source,(B.interpolate||Uc).source,(B.evaluate||Uc).source].join("|")+"|$","g"),P=0,ht="__p+='";S.replace(R,function(Wt,Oe,Ce,On,bn){return ht+=S.slice(P,bn).replace(Xm,Jm),P=bn+Wt.length,Oe?ht+=`'+
((__t=(`+Oe+`))==null?'':_.escape(__t))+
'`:Ce?ht+=`'+
((__t=(`+Ce+`))==null?'':__t)+
'`:On&&(ht+=`';
`+On+`
__p+='`),Wt}),ht+=`';
`;var wt=B.variable;if(wt){if(!$m.test(wt))throw new Error("variable is not a bare identifier: "+wt)}else ht=`with(obj||{}){
`+ht+`}
`,wt="obj";ht=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+ht+`return __p;
`;var St;try{St=new Function(wt,"_",ht)}catch(Wt){throw Wt.source=ht,Wt}var Xt=function(Wt){return St.call(this,Wt,Ze)};return Xt.source="function("+wt+`){
`+ht+"}",Xt}function Zp(S,B,W){B=Xa(B);var R=B.length;if(!R)return $i(W)?W.call(S):W;for(var P=0;P<R;P++){var ht=S==null?void 0:S[B[P]];ht===void 0&&(ht=W,P=R),S=$i(ht)?ht.call(S):ht}return S}var Km=0;function Fp(S){var B=++Km+"";return S?S+B:B}function _p(S){var B=Ze(S);return B._chain=!0,B}function Wp(S,B,W,R,P){if(!(R instanceof B))return S.apply(W,P);var ht=Sp(S.prototype),wt=S.apply(ht,P);return uo(wt)?wt:ht}var Jo=ln(function(S,B){var W=Jo.placeholder,R=function(){for(var P=0,ht=B.length,wt=Array(ht),St=0;St<ht;St++)wt[St]=B[St]===W?arguments[P++]:B[St];for(;P<arguments.length;)wt.push(arguments[P++]);return Wp(S,R,this,this,wt)};return R});Jo.placeholder=Ze;const wu=ln(function(S,B,W){if(!$i(S))throw new TypeError("Bind must be called on a function");var R=ln(function(P){return Wp(S,R,B,this,W.concat(P))});return R}),zn=dp(vn);function $o(S,B,W,R){if(R=R||[],!B&&B!==0)B=1/0;else if(B<=0)return R.concat(S);for(var P=R.length,ht=0,wt=vn(S);ht<wt;ht++){var St=S[ht];if(zn(St)&&(go(St)||ph(St)))if(B>1)$o(St,B-1,W,R),P=R.length;else for(var Xt=0,Wt=St.length;Xt<Wt;)R[P++]=St[Xt++];else W||(R[P++]=St)}return R}const Yp=ln(function(S,B){B=$o(B,!1,!1);var W=B.length;if(W<1)throw new Error("bindAll must be passed function names");for(;W--;){var R=B[W];S[R]=wu(S[R],S)}return S});function Up(S,B){var W=function(R){var P=W.cache,ht=""+(B?B.apply(this,arguments):R);return po(P,ht)||(P[ht]=S.apply(this,arguments)),P[ht]};return W.cache={},W}const Au=ln(function(S,B,W){return setTimeout(function(){return S.apply(null,W)},B)}),Hp=Jo(Au,Ze,1);function Xp(S,B,W){var R,P,ht,wt,St=0;W||(W={});var Xt=function(){St=W.leading===!1?0:_s(),R=null,wt=S.apply(P,ht),R||(P=ht=null)},Wt=function(){var Oe=_s();!St&&W.leading===!1&&(St=Oe);var Ce=B-(Oe-St);return P=this,ht=arguments,Ce<=0||Ce>B?(R&&(clearTimeout(R),R=null),St=Oe,wt=S.apply(P,ht),R||(P=ht=null)):!R&&W.trailing!==!1&&(R=setTimeout(Xt,Ce)),wt};return Wt.cancel=function(){clearTimeout(R),St=0,R=P=ht=null},Wt}function Jp(S,B,W){var R,P,ht,wt,St,Xt=function(){var Oe=_s()-P;B>Oe?R=setTimeout(Xt,B-Oe):(R=null,W||(wt=S.apply(St,ht)),R||(ht=St=null))},Wt=ln(function(Oe){return St=this,ht=Oe,P=_s(),R||(R=setTimeout(Xt,B),W&&(wt=S.apply(St,ht))),wt});return Wt.cancel=function(){clearTimeout(R),R=ht=St=null},Wt}function $p(S,B){return Jo(B,S)}function yh(S){return function(){return!S.apply(this,arguments)}}function Kp(){var S=arguments,B=S.length-1;return function(){for(var W=B,R=S[B].apply(this,arguments);W--;)R=S[W].call(this,R);return R}}function Qp(S,B){return function(){if(--S<1)return B.apply(this,arguments)}}function Cu(S,B){var W;return function(){return--S>0&&(W=B.apply(this,arguments)),S<=1&&(B=null),W}}const qp=Jo(Cu,2);function Iu(S,B,W){B=yn(B,W);for(var R=Pi(S),P,ht=0,wt=R.length;ht<wt;ht++)if(P=R[ht],B(S[P],P,S))return P}function tf(S){return function(B,W,R){W=yn(W,R);for(var P=vn(B),ht=S>0?0:P-1;ht>=0&&ht<P;ht+=S)if(W(B[ht],ht,B))return ht;return-1}}const bh=tf(1),Mu=tf(-1);function Su(S,B,W,R){W=yn(W,R,1);for(var P=W(B),ht=0,wt=vn(S);ht<wt;){var St=Math.floor((ht+wt)/2);W(S[St])<P?ht=St+1:wt=St}return ht}function ef(S,B,W){return function(R,P,ht){var wt=0,St=vn(R);if(typeof ht=="number")S>0?wt=ht>=0?ht:Math.max(ht+St,wt):St=ht>=0?Math.min(ht+1,St):ht+St+1;else if(W&&ht&&St)return ht=W(R,P),R[ht]===P?ht:-1;if(P!==P)return ht=B(Ha.call(R,wt,St),su),ht>=0?ht+wt:-1;for(ht=S>0?wt:St-1;ht>=0&&ht<St;ht+=S)if(R[ht]===P)return ht;return-1}}const ku=ef(1,bh,Su),nf=ef(-1,Mu);function Wa(S,B,W){var R=zn(S)?bh:Iu,P=R(S,B,W);if(P!==void 0&&P!==-1)return S[P]}function rf(S,B){return Wa(S,Ho(B))}function or(S,B,W){B=Ja(B,W);var R,P;if(zn(S))for(R=0,P=S.length;R<P;R++)B(S[R],R,S);else{var ht=Pi(S);for(R=0,P=ht.length;R<P;R++)B(S[ht[R]],ht[R],S)}return S}function zr(S,B,W){B=yn(B,W);for(var R=!zn(S)&&Pi(S),P=(R||S).length,ht=Array(P),wt=0;wt<P;wt++){var St=R?R[wt]:wt;ht[wt]=B(S[St],St,S)}return ht}function of(S){var B=function(W,R,P,ht){var wt=!zn(W)&&Pi(W),St=(wt||W).length,Xt=S>0?0:St-1;for(ht||(P=W[wt?wt[Xt]:Xt],Xt+=S);Xt>=0&&Xt<St;Xt+=S){var Wt=wt?wt[Xt]:Xt;P=R(P,W[Wt],Wt,W)}return P};return function(W,R,P,ht){var wt=arguments.length>=3;return B(W,Ja(R,ht,4),P,wt)}}const Vs=of(1),hh=of(-1);function co(S,B,W){var R=[];return B=yn(B,W),or(S,function(P,ht,wt){B(P,ht,wt)&&R.push(P)}),R}function sf(S,B,W){return co(S,yh(yn(B)),W)}function ch(S,B,W){B=yn(B,W);for(var R=!zn(S)&&Pi(S),P=(R||S).length,ht=0;ht<P;ht++){var wt=R?R[ht]:ht;if(!B(S[wt],wt,S))return!1}return!0}function uh(S,B,W){B=yn(B,W);for(var R=!zn(S)&&Pi(S),P=(R||S).length,ht=0;ht<P;ht++){var wt=R?R[ht]:ht;if(B(S[wt],wt,S))return!0}return!1}function Un(S,B,W,R){return zn(S)||(S=Xo(S)),(typeof W!="number"||R)&&(W=0),ku(S,B,W)>=0}const af=ln(function(S,B,W){var R,P;return $i(B)?P=B:(B=Xa(B),R=B.slice(0,-1),B=B[B.length-1]),zr(S,function(ht){var wt=P;if(!wt){if(R&&R.length&&(ht=yu(ht,R)),ht==null)return;wt=ht[B]}return wt==null?wt:wt.apply(ht,W)})});function xh(S,B){return zr(S,mh(B))}function lf(S,B){return co(S,Ho(B))}function Tu(S,B,W){var R=-1/0,P=-1/0,ht,wt;if(B==null||typeof B=="number"&&typeof S[0]!="object"&&S!=null){S=zn(S)?S:Xo(S);for(var St=0,Xt=S.length;St<Xt;St++)ht=S[St],ht!=null&&ht>R&&(R=ht)}else B=yn(B,W),or(S,function(Wt,Oe,Ce){wt=B(Wt,Oe,Ce),(wt>P||wt===-1/0&&R===-1/0)&&(R=Wt,P=wt)});return R}function hf(S,B,W){var R=1/0,P=1/0,ht,wt;if(B==null||typeof B=="number"&&typeof S[0]!="object"&&S!=null){S=zn(S)?S:Xo(S);for(var St=0,Xt=S.length;St<Xt;St++)ht=S[St],ht!=null&&ht<R&&(R=ht)}else B=yn(B,W),or(S,function(Wt,Oe,Ce){wt=B(Wt,Oe,Ce),(wt<P||wt===1/0&&R===1/0)&&(R=Wt,P=wt)});return R}var Qm=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Nu(S){return S?go(S)?Ha.call(S):gh(S)?S.match(Qm):zn(S)?zr(S,fh):Xo(S):[]}function Pu(S,B,W){if(B==null||W)return zn(S)||(S=Xo(S)),S[lh(S.length-1)];var R=Nu(S),P=vn(R);B=Math.max(Math.min(B,P),0);for(var ht=P-1,wt=0;wt<B;wt++){var St=lh(wt,ht),Xt=R[wt];R[wt]=R[St],R[St]=Xt}return R.slice(0,B)}function cf(S){return Pu(S,1/0)}function uf(S,B,W){var R=0;return B=yn(B,W),xh(zr(S,function(P,ht,wt){return{value:P,index:R++,criteria:B(P,ht,wt)}}).sort(function(P,ht){var wt=P.criteria,St=ht.criteria;if(wt!==St){if(wt>St||wt===void 0)return 1;if(wt<St||St===void 0)return-1}return P.index-ht.index}),"value")}function wh(S,B){return function(W,R,P){var ht=B?[[],[]]:{};return R=yn(R,P),or(W,function(wt,St){var Xt=R(wt,St,W);S(ht,wt,Xt)}),ht}}const df=wh(function(S,B,W){po(S,W)?S[W].push(B):S[W]=[B]}),gf=wh(function(S,B,W){S[W]=B}),pf=wh(function(S,B,W){po(S,W)?S[W]++:S[W]=1}),ff=wh(function(S,B,W){S[W?0:1].push(B)},!0);function mf(S){return S==null?0:zn(S)?S.length:Pi(S).length}function qm(S,B,W){return B in W}const Eu=ln(function(S,B){var W={},R=B[0];if(S==null)return W;$i(R)?(B.length>1&&(R=Ja(R,B[1])),B=Ws(S)):(R=qm,B=$o(B,!1,!1),S=Object(S));for(var P=0,ht=B.length;P<ht;P++){var wt=B[P],St=S[wt];R(St,wt,S)&&(W[wt]=St)}return W}),vf=ln(function(S,B){var W=B[0],R;return $i(W)?(W=yh(W),B.length>1&&(R=B[1])):(B=zr($o(B,!1,!1),String),W=function(P,ht){return!Un(B,ht)}),Eu(S,W,R)});function Lu(S,B,W){return Ha.call(S,0,Math.max(0,S.length-(B==null||W?1:B)))}function Zs(S,B,W){return S==null||S.length<1?B==null||W?void 0:[]:B==null||W?S[0]:Lu(S,S.length-B)}function Uo(S,B,W){return Ha.call(S,B==null||W?1:B)}function yf(S,B,W){return S==null||S.length<1?B==null||W?void 0:[]:B==null||W?S[S.length-1]:Uo(S,Math.max(0,S.length-B))}function bf(S){return co(S,Boolean)}function xf(S,B){return $o(S,B,!1)}const Du=ln(function(S,B){return B=$o(B,!0,!0),co(S,function(W){return!Un(B,W)})}),wf=ln(function(S,B){return Du(S,B)});function Ya(S,B,W,R){eu(B)||(R=W,W=B,B=!1),W!=null&&(W=yn(W,R));for(var P=[],ht=[],wt=0,St=vn(S);wt<St;wt++){var Xt=S[wt],Wt=W?W(Xt,wt,S):Xt;B&&!W?((!wt||ht!==Wt)&&P.push(Xt),ht=Wt):W?Un(ht,Wt)||(ht.push(Wt),P.push(Xt)):Un(P,Xt)||P.push(Xt)}return P}const Af=ln(function(S){return Ya($o(S,!0,!0))});function Cf(S){for(var B=[],W=arguments.length,R=0,P=vn(S);R<P;R++){var ht=S[R];if(!Un(B,ht)){var wt;for(wt=1;wt<W&&Un(arguments[wt],ht);wt++);wt===W&&B.push(ht)}}return B}function Ua(S){for(var B=S&&Tu(S,vn).length||0,W=Array(B),R=0;R<B;R++)W[R]=xh(S,R);return W}const If=ln(Ua);function Mf(S,B){for(var W={},R=0,P=vn(S);R<P;R++)B?W[S[R]]=B[R]:W[S[R][0]]=S[R][1];return W}function Sf(S,B,W){B==null&&(B=S||0,S=0),W||(W=B<S?-1:1);for(var R=Math.max(Math.ceil((B-S)/W),0),P=Array(R),ht=0;ht<R;ht++,S+=W)P[ht]=S;return P}function kf(S,B){if(B==null||B<1)return[];for(var W=[],R=0,P=S.length;R<P;)W.push(Ha.call(S,R,R+=B));return W}function Bu(S,B){return S._chain?Ze(B).chain():B}function zu(S){return or(_a(S),function(B){var W=Ze[B]=S[B];Ze.prototype[B]=function(){var R=[this._wrapped];return Nm.apply(R,arguments),Bu(this,W.apply(Ze,R))}}),Ze}or(["pop","push","reverse","shift","sort","splice","unshift"],function(S){var B=dh[S];Ze.prototype[S]=function(){var W=this._wrapped;return W!=null&&(B.apply(W,arguments),(S==="shift"||S==="splice")&&W.length===0&&delete W[0]),Bu(this,W)}});or(["concat","join","slice"],function(S){var B=dh[S];Ze.prototype[S]=function(){var W=this._wrapped;return W!=null&&(W=B.apply(W,arguments)),Bu(this,W)}});const t0=Object.freeze(Object.defineProperty({__proto__:null,VERSION:Qc,after:Qp,all:ch,allKeys:Ws,any:uh,assign:Fs,before:Cu,bind:wu,bindAll:Yp,chain:_p,chunk:kf,clone:Tp,collect:zr,compact:bf,compose:Kp,constant:au,contains:Un,countBy:pf,create:kp,debounce:Jp,default:Ze,defaults:mu,defer:Hp,delay:Au,detect:Wa,difference:Du,drop:Uo,each:or,escape:Rp,every:ch,extend:fu,extendOwn:Fs,filter:co,find:Wa,findIndex:bh,findKey:Iu,findLastIndex:Mu,findWhere:rf,first:Zs,flatten:xf,foldl:Vs,foldr:hh,forEach:or,functions:_a,get:bu,groupBy:df,has:Pp,head:Zs,identity:fh,include:Un,includes:Un,indexBy:gf,indexOf:ku,initial:Lu,inject:Vs,intersection:Cf,invert:gu,invoke:af,isArguments:ph,isArray:go,isArrayBuffer:ru,isBoolean:eu,isDataView:Fa,isDate:op,isElement:rp,isEmpty:fp,isEqual:vp,isError:ap,isFinite:up,isFunction:$i,isMap:wp,isMatch:hu,isNaN:su,isNull:np,isNumber:iu,isObject:uo,isRegExp:sp,isSet:Cp,isString:gh,isSymbol:nu,isTypedArray:lu,isUndefined:tu,isWeakMap:Ap,isWeakSet:Ip,iteratee:vh,keys:Pi,last:yf,lastIndexOf:nf,map:zr,mapObject:Lp,matcher:Ho,matches:Ho,max:Tu,memoize:Up,methods:_a,min:hf,mixin:zu,negate:yh,noop:xu,now:_s,object:Mf,omit:vf,once:qp,pairs:Mp,partial:Jo,partition:ff,pick:Eu,pluck:xh,property:mh,propertyOf:Dp,random:lh,range:Sf,reduce:Vs,reduceRight:hh,reject:sf,rest:Uo,restArguments:ln,result:Zp,sample:Pu,select:co,shuffle:cf,size:mf,some:uh,sortBy:uf,sortedIndex:Su,tail:Uo,take:Zs,tap:Np,template:Vp,templateSettings:Gp,throttle:Xp,times:Bp,toArray:Nu,toPath:vu,transpose:Ua,unescape:jp,union:Af,uniq:Ya,unique:Ya,uniqueId:Fp,unzip:Ua,values:Xo,where:lf,without:wf,wrap:$p,zip:If},Symbol.toStringTag,{value:"Module"}));var $c=zu(t0);$c._=$c;const e0=Object.freeze(Object.defineProperty({__proto__:null,VERSION:Qc,after:Qp,all:ch,allKeys:Ws,any:uh,assign:Fs,before:Cu,bind:wu,bindAll:Yp,chain:_p,chunk:kf,clone:Tp,collect:zr,compact:bf,compose:Kp,constant:au,contains:Un,countBy:pf,create:kp,debounce:Jp,default:$c,defaults:mu,defer:Hp,delay:Au,detect:Wa,difference:Du,drop:Uo,each:or,escape:Rp,every:ch,extend:fu,extendOwn:Fs,filter:co,find:Wa,findIndex:bh,findKey:Iu,findLastIndex:Mu,findWhere:rf,first:Zs,flatten:xf,foldl:Vs,foldr:hh,forEach:or,functions:_a,get:bu,groupBy:df,has:Pp,head:Zs,identity:fh,include:Un,includes:Un,indexBy:gf,indexOf:ku,initial:Lu,inject:Vs,intersection:Cf,invert:gu,invoke:af,isArguments:ph,isArray:go,isArrayBuffer:ru,isBoolean:eu,isDataView:Fa,isDate:op,isElement:rp,isEmpty:fp,isEqual:vp,isError:ap,isFinite:up,isFunction:$i,isMap:wp,isMatch:hu,isNaN:su,isNull:np,isNumber:iu,isObject:uo,isRegExp:sp,isSet:Cp,isString:gh,isSymbol:nu,isTypedArray:lu,isUndefined:tu,isWeakMap:Ap,isWeakSet:Ip,iteratee:vh,keys:Pi,last:yf,lastIndexOf:nf,map:zr,mapObject:Lp,matcher:Ho,matches:Ho,max:Tu,memoize:Up,methods:_a,min:hf,mixin:zu,negate:yh,noop:xu,now:_s,object:Mf,omit:vf,once:qp,pairs:Mp,partial:Jo,partition:ff,pick:Eu,pluck:xh,property:mh,propertyOf:Dp,random:lh,range:Sf,reduce:Vs,reduceRight:hh,reject:sf,rest:Uo,restArguments:ln,result:Zp,sample:Pu,select:co,shuffle:cf,size:mf,some:uh,sortBy:uf,sortedIndex:Su,tail:Uo,take:Zs,tap:Np,template:Vp,templateSettings:Gp,throttle:Xp,times:Bp,toArray:Nu,toPath:vu,transpose:Ua,unescape:jp,union:Af,uniq:Ya,unique:Ya,uniqueId:Fp,unzip:Ua,values:Xo,where:lf,without:wf,wrap:$p,zip:If},Symbol.toStringTag,{value:"Module"})),i0=Tm(e0);var Hc={exports:{}};var qg;function Tf(){return qg||(qg=1,function(S){(function(B,W){S.exports=B.document?W(B,!0):function(R){if(!R.document)throw new Error("jQuery requires a window with a document");return W(R)}})(typeof window<"u"?window:ho,function(B,W){var R=[],P=Object.getPrototypeOf,ht=R.slice,wt=R.flat?function(c){return R.flat.call(c)}:function(c){return R.concat.apply([],c)},St=R.push,Xt=R.indexOf,Wt={},Oe=Wt.toString,Ce=Wt.hasOwnProperty,On=Ce.toString,bn=On.call(Object),re={},oe=function(g){return typeof g=="function"&&typeof g.nodeType!="number"&&typeof g.item!="function"},Rn=function(g){return g!=null&&g===g.window},qt=B.document,yr={type:!0,src:!0,nonce:!0,noModule:!0};function Hn(c,g,y){y=y||qt;var w,E,L=y.createElement("script");if(L.text=c,g)for(w in yr)E=g[w]||g.getAttribute&&g.getAttribute(w),E&&L.setAttribute(w,E);y.head.appendChild(L).parentNode.removeChild(L)}function Ge(c){return c==null?c+"":typeof c=="object"||typeof c=="function"?Wt[Oe.call(c)]||"object":typeof c}var Xe="3.7.1",Qe=/HTML$/i,A=function(c,g){return new A.fn.init(c,g)};A.fn=A.prototype={jquery:Xe,constructor:A,length:0,toArray:function(){return ht.call(this)},get:function(c){return c==null?ht.call(this):c<0?this[c+this.length]:this[c]},pushStack:function(c){var g=A.merge(this.constructor(),c);return g.prevObject=this,g},each:function(c){return A.each(this,c)},map:function(c){return this.pushStack(A.map(this,function(g,y){return c.call(g,y,g)}))},slice:function(){return this.pushStack(ht.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(A.grep(this,function(c,g){return(g+1)%2}))},odd:function(){return this.pushStack(A.grep(this,function(c,g){return g%2}))},eq:function(c){var g=this.length,y=+c+(c<0?g:0);return this.pushStack(y>=0&&y<g?[this[y]]:[])},end:function(){return this.prevObject||this.constructor()},push:St,sort:R.sort,splice:R.splice},A.extend=A.fn.extend=function(){var c,g,y,w,E,L,V=arguments[0]||{},rt=1,q=arguments.length,ut=!1;for(typeof V=="boolean"&&(ut=V,V=arguments[rt]||{},rt++),typeof V!="object"&&!oe(V)&&(V={}),rt===q&&(V=this,rt--);rt<q;rt++)if((c=arguments[rt])!=null)for(g in c)w=c[g],!(g==="__proto__"||V===w)&&(ut&&w&&(A.isPlainObject(w)||(E=Array.isArray(w)))?(y=V[g],E&&!Array.isArray(y)?L=[]:!E&&!A.isPlainObject(y)?L={}:L=y,E=!1,V[g]=A.extend(ut,L,w)):w!==void 0&&(V[g]=w));return V},A.extend({expando:"jQuery"+(Xe+Math.random()).replace(/\D/g,""),isReady:!0,error:function(c){throw new Error(c)},noop:function(){},isPlainObject:function(c){var g,y;return!c||Oe.call(c)!=="[object Object]"?!1:(g=P(c),g?(y=Ce.call(g,"constructor")&&g.constructor,typeof y=="function"&&On.call(y)===bn):!0)},isEmptyObject:function(c){var g;for(g in c)return!1;return!0},globalEval:function(c,g,y){Hn(c,{nonce:g&&g.nonce},y)},each:function(c,g){var y,w=0;if(xn(c))for(y=c.length;w<y&&g.call(c[w],w,c[w])!==!1;w++);else for(w in c)if(g.call(c[w],w,c[w])===!1)break;return c},text:function(c){var g,y="",w=0,E=c.nodeType;if(!E)for(;g=c[w++];)y+=A.text(g);return E===1||E===11?c.textContent:E===9?c.documentElement.textContent:E===3||E===4?c.nodeValue:y},makeArray:function(c,g){var y=g||[];return c!=null&&(xn(Object(c))?A.merge(y,typeof c=="string"?[c]:c):St.call(y,c)),y},inArray:function(c,g,y){return g==null?-1:Xt.call(g,c,y)},isXMLDoc:function(c){var g=c&&c.namespaceURI,y=c&&(c.ownerDocument||c).documentElement;return!Qe.test(g||y&&y.nodeName||"HTML")},merge:function(c,g){for(var y=+g.length,w=0,E=c.length;w<y;w++)c[E++]=g[w];return c.length=E,c},grep:function(c,g,y){for(var w,E=[],L=0,V=c.length,rt=!y;L<V;L++)w=!g(c[L],L),w!==rt&&E.push(c[L]);return E},map:function(c,g,y){var w,E,L=0,V=[];if(xn(c))for(w=c.length;L<w;L++)E=g(c[L],L,y),E!=null&&V.push(E);else for(L in c)E=g(c[L],L,y),E!=null&&V.push(E);return wt(V)},guid:1,support:re}),typeof Symbol=="function"&&(A.fn[Symbol.iterator]=R[Symbol.iterator]),A.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(c,g){Wt["[object "+g+"]"]=g.toLowerCase()});function xn(c){var g=!!c&&"length"in c&&c.length,y=Ge(c);return oe(c)||Rn(c)?!1:y==="array"||g===0||typeof g=="number"&&g>0&&g-1 in c}function Ve(c,g){return c.nodeName&&c.nodeName.toLowerCase()===g.toLowerCase()}var le=R.pop,Or=R.sort,Rr=R.splice,Ee="[\\x20\\t\\r\\n\\f]",sr=new RegExp("^"+Ee+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Ee+"+$","g");A.contains=function(c,g){var y=g&&g.parentNode;return c===y||!!(y&&y.nodeType===1&&(c.contains?c.contains(y):c.compareDocumentPosition&&c.compareDocumentPosition(y)&16))};var Ko=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function fo(c,g){return g?c==="\0"?"�":c.slice(0,-1)+"\\"+c.charCodeAt(c.length-1).toString(16)+" ":"\\"+c}A.escapeSelector=function(c){return(c+"").replace(Ko,fo)};var hn=qt,jr=St;(function(){var c,g,y,w,E,L=jr,V,rt,q,ut,bt,Ct=A.expando,ft=0,Pt=0,te=ds(),Ie=ds(),ne=ds(),ii=ds(),gi=function(J,ot){return J===ot&&(E=!0),0},In="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",pi="(?:\\\\[\\da-fA-F]{1,6}"+Ee+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",de="\\["+Ee+"*("+pi+")(?:"+Ee+"*([*^$|!~]?=)"+Ee+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+pi+"))|)"+Ee+"*\\]",Sr=":("+pi+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+de+")*)|.*)\\)|)",Me=new RegExp(Ee+"+","g"),$e=new RegExp("^"+Ee+"*,"+Ee+"*"),Xr=new RegExp("^"+Ee+"*([>+~]|"+Ee+")"+Ee+"*"),sa=new RegExp(Ee+"|>"),Mn=new RegExp(Sr),Jr=new RegExp("^"+pi+"$"),un={ID:new RegExp("^#("+pi+")"),CLASS:new RegExp("^\\.("+pi+")"),TAG:new RegExp("^("+pi+"|[*])"),ATTR:new RegExp("^"+de),PSEUDO:new RegExp("^"+Sr),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Ee+"*(even|odd|(([+-]|)(\\d*)n|)"+Ee+"*(?:([+-]|)"+Ee+"*(\\d+)|))"+Ee+"*\\)|)","i"),bool:new RegExp("^(?:"+In+")$","i"),needsContext:new RegExp("^"+Ee+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Ee+"*((?:-\\d)?\\d*)"+Ee+"*\\)|)(?=[^-]|$)","i")},jn=/^(?:input|select|textarea|button)$/i,gr=/^h\d$/i,Yi=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,aa=/[+~]/,Gn=new RegExp("\\\\[\\da-fA-F]{1,6}"+Ee+"?|\\\\([^\\r\\n\\f])","g"),tr=function(J,ot){var dt="0x"+J.slice(1)-65536;return ot||(dt<0?String.fromCharCode(dt+65536):String.fromCharCode(dt>>10|55296,dt&1023|56320))},ml=function(){ir()},vl=ps(function(J){return J.disabled===!0&&Ve(J,"fieldset")},{dir:"parentNode",next:"legend"});function yl(){try{return V.activeElement}catch{}}try{L.apply(R=ht.call(hn.childNodes),hn.childNodes),R[hn.childNodes.length].nodeType}catch{L={apply:function(ot,dt){jr.apply(ot,ht.call(dt))},call:function(ot){jr.apply(ot,ht.call(arguments,1))}}}function Re(J,ot,dt,pt){var yt,Lt,Gt,_t,Vt,he,Dt,Nt=ot&&ot.ownerDocument,Ft=ot?ot.nodeType:9;if(dt=dt||[],typeof J!="string"||!J||Ft!==1&&Ft!==9&&Ft!==11)return dt;if(!pt&&(ir(ot),ot=ot||V,q)){if(Ft!==11&&(Vt=Yi.exec(J)))if(yt=Vt[1]){if(Ft===9)if(Gt=ot.getElementById(yt)){if(Gt.id===yt)return L.call(dt,Gt),dt}else return dt;else if(Nt&&(Gt=Nt.getElementById(yt))&&Re.contains(ot,Gt)&&Gt.id===yt)return L.call(dt,Gt),dt}else{if(Vt[2])return L.apply(dt,ot.getElementsByTagName(J)),dt;if((yt=Vt[3])&&ot.getElementsByClassName)return L.apply(dt,ot.getElementsByClassName(yt)),dt}if(!ii[J+" "]&&(!ut||!ut.test(J))){if(Dt=J,Nt=ot,Ft===1&&(sa.test(J)||Xr.test(J))){for(Nt=aa.test(J)&&la(ot.parentNode)||ot,(Nt!=ot||!re.scope)&&((_t=ot.getAttribute("id"))?_t=A.escapeSelector(_t):ot.setAttribute("id",_t=Ct)),he=Po(J),Lt=he.length;Lt--;)he[Lt]=(_t?"#"+_t:":scope")+" "+gs(he[Lt]);Dt=he.join(",")}try{return L.apply(dt,Nt.querySelectorAll(Dt)),dt}catch{ii(J,!0)}finally{_t===Ct&&ot.removeAttribute("id")}}}return Eo(J.replace(sr,"$1"),ot,dt,pt)}function ds(){var J=[];function ot(dt,pt){return J.push(dt+" ")>g.cacheLength&&delete ot[J.shift()],ot[dt+" "]=pt}return ot}function Sn(J){return J[Ct]=!0,J}function er(J){var ot=V.createElement("fieldset");try{return!!J(ot)}catch{return!1}finally{ot.parentNode&&ot.parentNode.removeChild(ot),ot=null}}function Ph(J){return function(ot){return Ve(ot,"input")&&ot.type===J}}function Eh(J){return function(ot){return(Ve(ot,"input")||Ve(ot,"button"))&&ot.type===J}}function bl(J){return function(ot){return"form"in ot?ot.parentNode&&ot.disabled===!1?"label"in ot?"label"in ot.parentNode?ot.parentNode.disabled===J:ot.disabled===J:ot.isDisabled===J||ot.isDisabled!==!J&&vl(ot)===J:ot.disabled===J:"label"in ot?ot.disabled===J:!1}}function kr(J){return Sn(function(ot){return ot=+ot,Sn(function(dt,pt){for(var yt,Lt=J([],dt.length,ot),Gt=Lt.length;Gt--;)dt[yt=Lt[Gt]]&&(dt[yt]=!(pt[yt]=dt[yt]))})})}function la(J){return J&&typeof J.getElementsByTagName<"u"&&J}function ir(J){var ot,dt=J?J.ownerDocument||J:hn;return dt==V||dt.nodeType!==9||!dt.documentElement||(V=dt,rt=V.documentElement,q=!A.isXMLDoc(V),bt=rt.matches||rt.webkitMatchesSelector||rt.msMatchesSelector,rt.msMatchesSelector&&hn!=V&&(ot=V.defaultView)&&ot.top!==ot&&ot.addEventListener("unload",ml),re.getById=er(function(pt){return rt.appendChild(pt).id=A.expando,!V.getElementsByName||!V.getElementsByName(A.expando).length}),re.disconnectedMatch=er(function(pt){return bt.call(pt,"*")}),re.scope=er(function(){return V.querySelectorAll(":scope")}),re.cssHas=er(function(){try{return V.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),re.getById?(g.filter.ID=function(pt){var yt=pt.replace(Gn,tr);return function(Lt){return Lt.getAttribute("id")===yt}},g.find.ID=function(pt,yt){if(typeof yt.getElementById<"u"&&q){var Lt=yt.getElementById(pt);return Lt?[Lt]:[]}}):(g.filter.ID=function(pt){var yt=pt.replace(Gn,tr);return function(Lt){var Gt=typeof Lt.getAttributeNode<"u"&&Lt.getAttributeNode("id");return Gt&&Gt.value===yt}},g.find.ID=function(pt,yt){if(typeof yt.getElementById<"u"&&q){var Lt,Gt,_t,Vt=yt.getElementById(pt);if(Vt){if(Lt=Vt.getAttributeNode("id"),Lt&&Lt.value===pt)return[Vt];for(_t=yt.getElementsByName(pt),Gt=0;Vt=_t[Gt++];)if(Lt=Vt.getAttributeNode("id"),Lt&&Lt.value===pt)return[Vt]}return[]}}),g.find.TAG=function(pt,yt){return typeof yt.getElementsByTagName<"u"?yt.getElementsByTagName(pt):yt.querySelectorAll(pt)},g.find.CLASS=function(pt,yt){if(typeof yt.getElementsByClassName<"u"&&q)return yt.getElementsByClassName(pt)},ut=[],er(function(pt){var yt;rt.appendChild(pt).innerHTML="<a id='"+Ct+"' href='' disabled='disabled'></a><select id='"+Ct+"-\r\\' disabled='disabled'><option selected=''></option></select>",pt.querySelectorAll("[selected]").length||ut.push("\\["+Ee+"*(?:value|"+In+")"),pt.querySelectorAll("[id~="+Ct+"-]").length||ut.push("~="),pt.querySelectorAll("a#"+Ct+"+*").length||ut.push(".#.+[+~]"),pt.querySelectorAll(":checked").length||ut.push(":checked"),yt=V.createElement("input"),yt.setAttribute("type","hidden"),pt.appendChild(yt).setAttribute("name","D"),rt.appendChild(pt).disabled=!0,pt.querySelectorAll(":disabled").length!==2&&ut.push(":enabled",":disabled"),yt=V.createElement("input"),yt.setAttribute("name",""),pt.appendChild(yt),pt.querySelectorAll("[name='']").length||ut.push("\\["+Ee+"*name"+Ee+"*="+Ee+`*(?:''|"")`)}),re.cssHas||ut.push(":has"),ut=ut.length&&new RegExp(ut.join("|")),gi=function(pt,yt){if(pt===yt)return E=!0,0;var Lt=!pt.compareDocumentPosition-!yt.compareDocumentPosition;return Lt||(Lt=(pt.ownerDocument||pt)==(yt.ownerDocument||yt)?pt.compareDocumentPosition(yt):1,Lt&1||!re.sortDetached&&yt.compareDocumentPosition(pt)===Lt?pt===V||pt.ownerDocument==hn&&Re.contains(hn,pt)?-1:yt===V||yt.ownerDocument==hn&&Re.contains(hn,yt)?1:w?Xt.call(w,pt)-Xt.call(w,yt):0:Lt&4?-1:1)}),V}Re.matches=function(J,ot){return Re(J,null,null,ot)},Re.matchesSelector=function(J,ot){if(ir(J),q&&!ii[ot+" "]&&(!ut||!ut.test(ot)))try{var dt=bt.call(J,ot);if(dt||re.disconnectedMatch||J.document&&J.document.nodeType!==11)return dt}catch{ii(ot,!0)}return Re(ot,V,null,[J]).length>0},Re.contains=function(J,ot){return(J.ownerDocument||J)!=V&&ir(J),A.contains(J,ot)},Re.attr=function(J,ot){(J.ownerDocument||J)!=V&&ir(J);var dt=g.attrHandle[ot.toLowerCase()],pt=dt&&Ce.call(g.attrHandle,ot.toLowerCase())?dt(J,ot,!q):void 0;return pt!==void 0?pt:J.getAttribute(ot)},Re.error=function(J){throw new Error("Syntax error, unrecognized expression: "+J)},A.uniqueSort=function(J){var ot,dt=[],pt=0,yt=0;if(E=!re.sortStable,w=!re.sortStable&&ht.call(J,0),Or.call(J,gi),E){for(;ot=J[yt++];)ot===J[yt]&&(pt=dt.push(yt));for(;pt--;)Rr.call(J,dt[pt],1)}return w=null,J},A.fn.uniqueSort=function(){return this.pushStack(A.uniqueSort(ht.apply(this)))},g=A.expr={cacheLength:50,createPseudo:Sn,match:un,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(J){return J[1]=J[1].replace(Gn,tr),J[3]=(J[3]||J[4]||J[5]||"").replace(Gn,tr),J[2]==="~="&&(J[3]=" "+J[3]+" "),J.slice(0,4)},CHILD:function(J){return J[1]=J[1].toLowerCase(),J[1].slice(0,3)==="nth"?(J[3]||Re.error(J[0]),J[4]=+(J[4]?J[5]+(J[6]||1):2*(J[3]==="even"||J[3]==="odd")),J[5]=+(J[7]+J[8]||J[3]==="odd")):J[3]&&Re.error(J[0]),J},PSEUDO:function(J){var ot,dt=!J[6]&&J[2];return un.CHILD.test(J[0])?null:(J[3]?J[2]=J[4]||J[5]||"":dt&&Mn.test(dt)&&(ot=Po(dt,!0))&&(ot=dt.indexOf(")",dt.length-ot)-dt.length)&&(J[0]=J[0].slice(0,ot),J[2]=dt.slice(0,ot)),J.slice(0,3))}},filter:{TAG:function(J){var ot=J.replace(Gn,tr).toLowerCase();return J==="*"?function(){return!0}:function(dt){return Ve(dt,ot)}},CLASS:function(J){var ot=te[J+" "];return ot||(ot=new RegExp("(^|"+Ee+")"+J+"("+Ee+"|$)"))&&te(J,function(dt){return ot.test(typeof dt.className=="string"&&dt.className||typeof dt.getAttribute<"u"&&dt.getAttribute("class")||"")})},ATTR:function(J,ot,dt){return function(pt){var yt=Re.attr(pt,J);return yt==null?ot==="!=":ot?(yt+="",ot==="="?yt===dt:ot==="!="?yt!==dt:ot==="^="?dt&&yt.indexOf(dt)===0:ot==="*="?dt&&yt.indexOf(dt)>-1:ot==="$="?dt&&yt.slice(-dt.length)===dt:ot==="~="?(" "+yt.replace(Me," ")+" ").indexOf(dt)>-1:ot==="|="?yt===dt||yt.slice(0,dt.length+1)===dt+"-":!1):!0}},CHILD:function(J,ot,dt,pt,yt){var Lt=J.slice(0,3)!=="nth",Gt=J.slice(-4)!=="last",_t=ot==="of-type";return pt===1&&yt===0?function(Vt){return!!Vt.parentNode}:function(Vt,he,Dt){var Nt,Ft,ct,Jt,mi,Rt=Lt!==Gt?"nextSibling":"previousSibling",ve=Vt.parentNode,kt=_t&&Vt.nodeName.toLowerCase(),Vn=!Dt&&!_t,Si=!1;if(ve){if(Lt){for(;Rt;){for(ct=Vt;ct=ct[Rt];)if(_t?Ve(ct,kt):ct.nodeType===1)return!1;mi=Rt=J==="only"&&!mi&&"nextSibling"}return!0}if(mi=[Gt?ve.firstChild:ve.lastChild],Gt&&Vn){for(Ft=ve[Ct]||(ve[Ct]={}),Nt=Ft[J]||[],Jt=Nt[0]===ft&&Nt[1],Si=Jt&&Nt[2],ct=Jt&&ve.childNodes[Jt];ct=++Jt&&ct&&ct[Rt]||(Si=Jt=0)||mi.pop();)if(ct.nodeType===1&&++Si&&ct===Vt){Ft[J]=[ft,Jt,Si];break}}else if(Vn&&(Ft=Vt[Ct]||(Vt[Ct]={}),Nt=Ft[J]||[],Jt=Nt[0]===ft&&Nt[1],Si=Jt),Si===!1)for(;(ct=++Jt&&ct&&ct[Rt]||(Si=Jt=0)||mi.pop())&&!((_t?Ve(ct,kt):ct.nodeType===1)&&++Si&&(Vn&&(Ft=ct[Ct]||(ct[Ct]={}),Ft[J]=[ft,Si]),ct===Vt)););return Si-=yt,Si===pt||Si%pt===0&&Si/pt>=0}}},PSEUDO:function(J,ot){var dt,pt=g.pseudos[J]||g.setFilters[J.toLowerCase()]||Re.error("unsupported pseudo: "+J);return pt[Ct]?pt(ot):pt.length>1?(dt=[J,J,"",ot],g.setFilters.hasOwnProperty(J.toLowerCase())?Sn(function(yt,Lt){for(var Gt,_t=pt(yt,ot),Vt=_t.length;Vt--;)Gt=Xt.call(yt,_t[Vt]),yt[Gt]=!(Lt[Gt]=_t[Vt])}):function(yt){return pt(yt,0,dt)}):pt}},pseudos:{not:Sn(function(J){var ot=[],dt=[],pt=ms(J.replace(sr,"$1"));return pt[Ct]?Sn(function(yt,Lt,Gt,_t){for(var Vt,he=pt(yt,null,_t,[]),Dt=yt.length;Dt--;)(Vt=he[Dt])&&(yt[Dt]=!(Lt[Dt]=Vt))}):function(yt,Lt,Gt){return ot[0]=yt,pt(ot,null,Gt,dt),ot[0]=null,!dt.pop()}}),has:Sn(function(J){return function(ot){return Re(J,ot).length>0}}),contains:Sn(function(J){return J=J.replace(Gn,tr),function(ot){return(ot.textContent||A.text(ot)).indexOf(J)>-1}}),lang:Sn(function(J){return Jr.test(J||"")||Re.error("unsupported lang: "+J),J=J.replace(Gn,tr).toLowerCase(),function(ot){var dt;do if(dt=q?ot.lang:ot.getAttribute("xml:lang")||ot.getAttribute("lang"))return dt=dt.toLowerCase(),dt===J||dt.indexOf(J+"-")===0;while((ot=ot.parentNode)&&ot.nodeType===1);return!1}}),target:function(J){var ot=B.location&&B.location.hash;return ot&&ot.slice(1)===J.id},root:function(J){return J===rt},focus:function(J){return J===yl()&&V.hasFocus()&&!!(J.type||J.href||~J.tabIndex)},enabled:bl(!1),disabled:bl(!0),checked:function(J){return Ve(J,"input")&&!!J.checked||Ve(J,"option")&&!!J.selected},selected:function(J){return J.parentNode&&J.parentNode.selectedIndex,J.selected===!0},empty:function(J){for(J=J.firstChild;J;J=J.nextSibling)if(J.nodeType<6)return!1;return!0},parent:function(J){return!g.pseudos.empty(J)},header:function(J){return gr.test(J.nodeName)},input:function(J){return jn.test(J.nodeName)},button:function(J){return Ve(J,"input")&&J.type==="button"||Ve(J,"button")},text:function(J){var ot;return Ve(J,"input")&&J.type==="text"&&((ot=J.getAttribute("type"))==null||ot.toLowerCase()==="text")},first:kr(function(){return[0]}),last:kr(function(J,ot){return[ot-1]}),eq:kr(function(J,ot,dt){return[dt<0?dt+ot:dt]}),even:kr(function(J,ot){for(var dt=0;dt<ot;dt+=2)J.push(dt);return J}),odd:kr(function(J,ot){for(var dt=1;dt<ot;dt+=2)J.push(dt);return J}),lt:kr(function(J,ot,dt){var pt;for(dt<0?pt=dt+ot:dt>ot?pt=ot:pt=dt;--pt>=0;)J.push(pt);return J}),gt:kr(function(J,ot,dt){for(var pt=dt<0?dt+ot:dt;++pt<ot;)J.push(pt);return J})}},g.pseudos.nth=g.pseudos.eq;for(c in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})g.pseudos[c]=Ph(c);for(c in{submit:!0,reset:!0})g.pseudos[c]=Eh(c);function $r(){}$r.prototype=g.filters=g.pseudos,g.setFilters=new $r;function Po(J,ot){var dt,pt,yt,Lt,Gt,_t,Vt,he=Ie[J+" "];if(he)return ot?0:he.slice(0);for(Gt=J,_t=[],Vt=g.preFilter;Gt;){(!dt||(pt=$e.exec(Gt)))&&(pt&&(Gt=Gt.slice(pt[0].length)||Gt),_t.push(yt=[])),dt=!1,(pt=Xr.exec(Gt))&&(dt=pt.shift(),yt.push({value:dt,type:pt[0].replace(sr," ")}),Gt=Gt.slice(dt.length));for(Lt in g.filter)(pt=un[Lt].exec(Gt))&&(!Vt[Lt]||(pt=Vt[Lt](pt)))&&(dt=pt.shift(),yt.push({value:dt,type:Lt,matches:pt}),Gt=Gt.slice(dt.length));if(!dt)break}return ot?Gt.length:Gt?Re.error(J):Ie(J,_t).slice(0)}function gs(J){for(var ot=0,dt=J.length,pt="";ot<dt;ot++)pt+=J[ot].value;return pt}function ps(J,ot,dt){var pt=ot.dir,yt=ot.next,Lt=yt||pt,Gt=dt&&Lt==="parentNode",_t=Pt++;return ot.first?function(Vt,he,Dt){for(;Vt=Vt[pt];)if(Vt.nodeType===1||Gt)return J(Vt,he,Dt);return!1}:function(Vt,he,Dt){var Nt,Ft,ct=[ft,_t];if(Dt){for(;Vt=Vt[pt];)if((Vt.nodeType===1||Gt)&&J(Vt,he,Dt))return!0}else for(;Vt=Vt[pt];)if(Vt.nodeType===1||Gt)if(Ft=Vt[Ct]||(Vt[Ct]={}),yt&&Ve(Vt,yt))Vt=Vt[pt]||Vt;else{if((Nt=Ft[Lt])&&Nt[0]===ft&&Nt[1]===_t)return ct[2]=Nt[2];if(Ft[Lt]=ct,ct[2]=J(Vt,he,Dt))return!0}return!1}}function ha(J){return J.length>1?function(ot,dt,pt){for(var yt=J.length;yt--;)if(!J[yt](ot,dt,pt))return!1;return!0}:J[0]}function Lh(J,ot,dt){for(var pt=0,yt=ot.length;pt<yt;pt++)Re(J,ot[pt],dt);return dt}function Kr(J,ot,dt,pt,yt){for(var Lt,Gt=[],_t=0,Vt=J.length,he=ot!=null;_t<Vt;_t++)(Lt=J[_t])&&(!dt||dt(Lt,pt,yt))&&(Gt.push(Lt),he&&ot.push(_t));return Gt}function fs(J,ot,dt,pt,yt,Lt){return pt&&!pt[Ct]&&(pt=fs(pt)),yt&&!yt[Ct]&&(yt=fs(yt,Lt)),Sn(function(Gt,_t,Vt,he){var Dt,Nt,Ft,ct,Jt=[],mi=[],Rt=_t.length,ve=Gt||Lh(ot||"*",Vt.nodeType?[Vt]:Vt,[]),kt=J&&(Gt||!ot)?Kr(ve,Jt,J,Vt,he):ve;if(dt?(ct=yt||(Gt?J:Rt||pt)?[]:_t,dt(kt,ct,Vt,he)):ct=kt,pt)for(Dt=Kr(ct,mi),pt(Dt,[],Vt,he),Nt=Dt.length;Nt--;)(Ft=Dt[Nt])&&(ct[mi[Nt]]=!(kt[mi[Nt]]=Ft));if(Gt){if(yt||J){if(yt){for(Dt=[],Nt=ct.length;Nt--;)(Ft=ct[Nt])&&Dt.push(kt[Nt]=Ft);yt(null,ct=[],Dt,he)}for(Nt=ct.length;Nt--;)(Ft=ct[Nt])&&(Dt=yt?Xt.call(Gt,Ft):Jt[Nt])>-1&&(Gt[Dt]=!(_t[Dt]=Ft))}}else ct=Kr(ct===_t?ct.splice(Rt,ct.length):ct),yt?yt(null,_t,ct,he):L.apply(_t,ct)})}function fi(J){for(var ot,dt,pt,yt=J.length,Lt=g.relative[J[0].type],Gt=Lt||g.relative[" "],_t=Lt?1:0,Vt=ps(function(Nt){return Nt===ot},Gt,!0),he=ps(function(Nt){return Xt.call(ot,Nt)>-1},Gt,!0),Dt=[function(Nt,Ft,ct){var Jt=!Lt&&(ct||Ft!=y)||((ot=Ft).nodeType?Vt(Nt,Ft,ct):he(Nt,Ft,ct));return ot=null,Jt}];_t<yt;_t++)if(dt=g.relative[J[_t].type])Dt=[ps(ha(Dt),dt)];else{if(dt=g.filter[J[_t].type].apply(null,J[_t].matches),dt[Ct]){for(pt=++_t;pt<yt&&!g.relative[J[pt].type];pt++);return fs(_t>1&&ha(Dt),_t>1&&gs(J.slice(0,_t-1).concat({value:J[_t-2].type===" "?"*":""})).replace(sr,"$1"),dt,_t<pt&&fi(J.slice(_t,pt)),pt<yt&&fi(J=J.slice(pt)),pt<yt&&gs(J))}Dt.push(dt)}return ha(Dt)}function qe(J,ot){var dt=ot.length>0,pt=J.length>0,yt=function(Lt,Gt,_t,Vt,he){var Dt,Nt,Ft,ct=0,Jt="0",mi=Lt&&[],Rt=[],ve=y,kt=Lt||pt&&g.find.TAG("*",he),Vn=ft+=ve==null?1:Math.random()||.1,Si=kt.length;for(he&&(y=Gt==V||Gt||he);Jt!==Si&&(Dt=kt[Jt])!=null;Jt++){if(pt&&Dt){for(Nt=0,!Gt&&Dt.ownerDocument!=V&&(ir(Dt),_t=!q);Ft=J[Nt++];)if(Ft(Dt,Gt||V,_t)){L.call(Vt,Dt);break}he&&(ft=Vn)}dt&&((Dt=!Ft&&Dt)&&ct--,Lt&&mi.push(Dt))}if(ct+=Jt,dt&&Jt!==ct){for(Nt=0;Ft=ot[Nt++];)Ft(mi,Rt,Gt,_t);if(Lt){if(ct>0)for(;Jt--;)mi[Jt]||Rt[Jt]||(Rt[Jt]=le.call(Vt));Rt=Kr(Rt)}L.apply(Vt,Rt),he&&!Lt&&Rt.length>0&&ct+ot.length>1&&A.uniqueSort(Vt)}return he&&(ft=Vn,y=ve),mi};return dt?Sn(yt):yt}function ms(J,ot){var dt,pt=[],yt=[],Lt=ne[J+" "];if(!Lt){for(ot||(ot=Po(J)),dt=ot.length;dt--;)Lt=fi(ot[dt]),Lt[Ct]?pt.push(Lt):yt.push(Lt);Lt=ne(J,qe(yt,pt)),Lt.selector=J}return Lt}function Eo(J,ot,dt,pt){var yt,Lt,Gt,_t,Vt,he=typeof J=="function"&&J,Dt=!pt&&Po(J=he.selector||J);if(dt=dt||[],Dt.length===1){if(Lt=Dt[0]=Dt[0].slice(0),Lt.length>2&&(Gt=Lt[0]).type==="ID"&&ot.nodeType===9&&q&&g.relative[Lt[1].type]){if(ot=(g.find.ID(Gt.matches[0].replace(Gn,tr),ot)||[])[0],ot)he&&(ot=ot.parentNode);else return dt;J=J.slice(Lt.shift().value.length)}for(yt=un.needsContext.test(J)?0:Lt.length;yt--&&(Gt=Lt[yt],!g.relative[_t=Gt.type]);)if((Vt=g.find[_t])&&(pt=Vt(Gt.matches[0].replace(Gn,tr),aa.test(Lt[0].type)&&la(ot.parentNode)||ot))){if(Lt.splice(yt,1),J=pt.length&&gs(Lt),!J)return L.apply(dt,pt),dt;break}}return(he||ms(J,Dt))(pt,ot,!q,dt,!ot||aa.test(J)&&la(ot.parentNode)||ot),dt}re.sortStable=Ct.split("").sort(gi).join("")===Ct,ir(),re.sortDetached=er(function(J){return J.compareDocumentPosition(V.createElement("fieldset"))&1}),A.find=Re,A.expr[":"]=A.expr.pseudos,A.unique=A.uniqueSort,Re.compile=ms,Re.select=Eo,Re.setDocument=ir,Re.tokenize=Po,Re.escape=A.escapeSelector,Re.getText=A.text,Re.isXML=A.isXMLDoc,Re.selectors=A.expr,Re.support=A.support,Re.uniqueSort=A.uniqueSort})();var ar=function(c,g,y){for(var w=[],E=y!==void 0;(c=c[g])&&c.nodeType!==9;)if(c.nodeType===1){if(E&&A(c).is(y))break;w.push(c)}return w},mo=function(c,g){for(var y=[];c;c=c.nextSibling)c.nodeType===1&&c!==g&&y.push(c);return y},Q=A.expr.match.needsContext,se=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function br(c,g,y){return oe(g)?A.grep(c,function(w,E){return!!g.call(w,E,w)!==y}):g.nodeType?A.grep(c,function(w){return w===g!==y}):typeof g!="string"?A.grep(c,function(w){return Xt.call(g,w)>-1!==y}):A.filter(g,c,y)}A.filter=function(c,g,y){var w=g[0];return y&&(c=":not("+c+")"),g.length===1&&w.nodeType===1?A.find.matchesSelector(w,c)?[w]:[]:A.find.matches(c,A.grep(g,function(E){return E.nodeType===1}))},A.fn.extend({find:function(c){var g,y,w=this.length,E=this;if(typeof c!="string")return this.pushStack(A(c).filter(function(){for(g=0;g<w;g++)if(A.contains(E[g],this))return!0}));for(y=this.pushStack([]),g=0;g<w;g++)A.find(c,E[g],y);return w>1?A.uniqueSort(y):y},filter:function(c){return this.pushStack(br(this,c||[],!1))},not:function(c){return this.pushStack(br(this,c||[],!0))},is:function(c){return!!br(this,typeof c=="string"&&Q.test(c)?A(c):c||[],!1).length}});var Gr,Ot=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,Xn=A.fn.init=function(c,g,y){var w,E;if(!c)return this;if(y=y||Gr,typeof c=="string")if(c[0]==="<"&&c[c.length-1]===">"&&c.length>=3?w=[null,c,null]:w=Ot.exec(c),w&&(w[1]||!g))if(w[1]){if(g=g instanceof A?g[0]:g,A.merge(this,A.parseHTML(w[1],g&&g.nodeType?g.ownerDocument||g:qt,!0)),se.test(w[1])&&A.isPlainObject(g))for(w in g)oe(this[w])?this[w](g[w]):this.attr(w,g[w]);return this}else return E=qt.getElementById(w[2]),E&&(this[0]=E,this.length=1),this;else return!g||g.jquery?(g||y).find(c):this.constructor(g).find(c);else{if(c.nodeType)return this[0]=c,this.length=1,this;if(oe(c))return y.ready!==void 0?y.ready(c):c(A)}return A.makeArray(c,this)};Xn.prototype=A.fn,Gr=A(qt);var wn=/^(?:parents|prev(?:Until|All))/,Vr={children:!0,contents:!0,next:!0,prev:!0};A.fn.extend({has:function(c){var g=A(c,this),y=g.length;return this.filter(function(){for(var w=0;w<y;w++)if(A.contains(this,g[w]))return!0})},closest:function(c,g){var y,w=0,E=this.length,L=[],V=typeof c!="string"&&A(c);if(!Q.test(c)){for(;w<E;w++)for(y=this[w];y&&y!==g;y=y.parentNode)if(y.nodeType<11&&(V?V.index(y)>-1:y.nodeType===1&&A.find.matchesSelector(y,c))){L.push(y);break}}return this.pushStack(L.length>1?A.uniqueSort(L):L)},index:function(c){return c?typeof c=="string"?Xt.call(A(c),this[0]):Xt.call(this,c.jquery?c[0]:c):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(c,g){return this.pushStack(A.uniqueSort(A.merge(this.get(),A(c,g))))},addBack:function(c){return this.add(c==null?this.prevObject:this.prevObject.filter(c))}});function Qo(c,g){for(;(c=c[g])&&c.nodeType!==1;);return c}A.each({parent:function(c){var g=c.parentNode;return g&&g.nodeType!==11?g:null},parents:function(c){return ar(c,"parentNode")},parentsUntil:function(c,g,y){return ar(c,"parentNode",y)},next:function(c){return Qo(c,"nextSibling")},prev:function(c){return Qo(c,"previousSibling")},nextAll:function(c){return ar(c,"nextSibling")},prevAll:function(c){return ar(c,"previousSibling")},nextUntil:function(c,g,y){return ar(c,"nextSibling",y)},prevUntil:function(c,g,y){return ar(c,"previousSibling",y)},siblings:function(c){return mo((c.parentNode||{}).firstChild,c)},children:function(c){return mo(c.firstChild)},contents:function(c){return c.contentDocument!=null&&P(c.contentDocument)?c.contentDocument:(Ve(c,"template")&&(c=c.content||c),A.merge([],c.childNodes))}},function(c,g){A.fn[c]=function(y,w){var E=A.map(this,g,y);return c.slice(-5)!=="Until"&&(w=y),w&&typeof w=="string"&&(E=A.filter(w,E)),this.length>1&&(Vr[c]||A.uniqueSort(E),wn.test(c)&&E.reverse()),this.pushStack(E)}});var We=/[^\x20\t\r\n\f]+/g;function qo(c){var g={};return A.each(c.match(We)||[],function(y,w){g[w]=!0}),g}A.Callbacks=function(c){c=typeof c=="string"?qo(c):A.extend({},c);var g,y,w,E,L=[],V=[],rt=-1,q=function(){for(E=E||c.once,w=g=!0;V.length;rt=-1)for(y=V.shift();++rt<L.length;)L[rt].apply(y[0],y[1])===!1&&c.stopOnFalse&&(rt=L.length,y=!1);c.memory||(y=!1),g=!1,E&&(y?L=[]:L="")},ut={add:function(){return L&&(y&&!g&&(rt=L.length-1,V.push(y)),function bt(Ct){A.each(Ct,function(ft,Pt){oe(Pt)?(!c.unique||!ut.has(Pt))&&L.push(Pt):Pt&&Pt.length&&Ge(Pt)!=="string"&&bt(Pt)})}(arguments),y&&!g&&q()),this},remove:function(){return A.each(arguments,function(bt,Ct){for(var ft;(ft=A.inArray(Ct,L,ft))>-1;)L.splice(ft,1),ft<=rt&&rt--}),this},has:function(bt){return bt?A.inArray(bt,L)>-1:L.length>0},empty:function(){return L&&(L=[]),this},disable:function(){return E=V=[],L=y="",this},disabled:function(){return!L},lock:function(){return E=V=[],!y&&!g&&(L=y=""),this},locked:function(){return!!E},fireWith:function(bt,Ct){return E||(Ct=Ct||[],Ct=[bt,Ct.slice?Ct.slice():Ct],V.push(Ct),g||q()),this},fire:function(){return ut.fireWith(this,arguments),this},fired:function(){return!!w}};return ut};function Jn(c){return c}function $n(c){throw c}function z(c,g,y,w){var E;try{c&&oe(E=c.promise)?E.call(c).done(g).fail(y):c&&oe(E=c.then)?E.call(c,g,y):g.apply(void 0,[c].slice(w))}catch(L){y.apply(void 0,[L])}}A.extend({Deferred:function(c){var g=[["notify","progress",A.Callbacks("memory"),A.Callbacks("memory"),2],["resolve","done",A.Callbacks("once memory"),A.Callbacks("once memory"),0,"resolved"],["reject","fail",A.Callbacks("once memory"),A.Callbacks("once memory"),1,"rejected"]],y="pending",w={state:function(){return y},always:function(){return E.done(arguments).fail(arguments),this},catch:function(L){return w.then(null,L)},pipe:function(){var L=arguments;return A.Deferred(function(V){A.each(g,function(rt,q){var ut=oe(L[q[4]])&&L[q[4]];E[q[1]](function(){var bt=ut&&ut.apply(this,arguments);bt&&oe(bt.promise)?bt.promise().progress(V.notify).done(V.resolve).fail(V.reject):V[q[0]+"With"](this,ut?[bt]:arguments)})}),L=null}).promise()},then:function(L,V,rt){var q=0;function ut(bt,Ct,ft,Pt){return function(){var te=this,Ie=arguments,ne=function(){var gi,In;if(!(bt<q)){if(gi=ft.apply(te,Ie),gi===Ct.promise())throw new TypeError("Thenable self-resolution");In=gi&&(typeof gi=="object"||typeof gi=="function")&&gi.then,oe(In)?Pt?In.call(gi,ut(q,Ct,Jn,Pt),ut(q,Ct,$n,Pt)):(q++,In.call(gi,ut(q,Ct,Jn,Pt),ut(q,Ct,$n,Pt),ut(q,Ct,Jn,Ct.notifyWith))):(ft!==Jn&&(te=void 0,Ie=[gi]),(Pt||Ct.resolveWith)(te,Ie))}},ii=Pt?ne:function(){try{ne()}catch(gi){A.Deferred.exceptionHook&&A.Deferred.exceptionHook(gi,ii.error),bt+1>=q&&(ft!==$n&&(te=void 0,Ie=[gi]),Ct.rejectWith(te,Ie))}};bt?ii():(A.Deferred.getErrorHook?ii.error=A.Deferred.getErrorHook():A.Deferred.getStackHook&&(ii.error=A.Deferred.getStackHook()),B.setTimeout(ii))}}return A.Deferred(function(bt){g[0][3].add(ut(0,bt,oe(rt)?rt:Jn,bt.notifyWith)),g[1][3].add(ut(0,bt,oe(L)?L:Jn)),g[2][3].add(ut(0,bt,oe(V)?V:$n))}).promise()},promise:function(L){return L!=null?A.extend(L,w):w}},E={};return A.each(g,function(L,V){var rt=V[2],q=V[5];w[V[1]]=rt.add,q&&rt.add(function(){y=q},g[3-L][2].disable,g[3-L][3].disable,g[0][2].lock,g[0][3].lock),rt.add(V[3].fire),E[V[0]]=function(){return E[V[0]+"With"](this===E?void 0:this,arguments),this},E[V[0]+"With"]=rt.fireWith}),w.promise(E),c&&c.call(E,E),E},when:function(c){var g=arguments.length,y=g,w=Array(y),E=ht.call(arguments),L=A.Deferred(),V=function(rt){return function(q){w[rt]=this,E[rt]=arguments.length>1?ht.call(arguments):q,--g||L.resolveWith(w,E)}};if(g<=1&&(z(c,L.done(V(y)).resolve,L.reject,!g),L.state()==="pending"||oe(E[y]&&E[y].then)))return L.then();for(;y--;)z(E[y],V(y),L.reject);return L.promise()}});var U=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;A.Deferred.exceptionHook=function(c,g){B.console&&B.console.warn&&c&&U.test(c.name)&&B.console.warn("jQuery.Deferred exception: "+c.message,c.stack,g)},A.readyException=function(c){B.setTimeout(function(){throw c})};var et=A.Deferred();A.fn.ready=function(c){return et.then(c).catch(function(g){A.readyException(g)}),this},A.extend({isReady:!1,readyWait:1,ready:function(c){(c===!0?--A.readyWait:A.isReady)||(A.isReady=!0,!(c!==!0&&--A.readyWait>0)&&et.resolveWith(qt,[A]))}}),A.ready.then=et.then;function gt(){qt.removeEventListener("DOMContentLoaded",gt),B.removeEventListener("load",gt),A.ready()}qt.readyState==="complete"||qt.readyState!=="loading"&&!qt.documentElement.doScroll?B.setTimeout(A.ready):(qt.addEventListener("DOMContentLoaded",gt),B.addEventListener("load",gt));var nt=function(c,g,y,w,E,L,V){var rt=0,q=c.length,ut=y==null;if(Ge(y)==="object"){E=!0;for(rt in y)nt(c,g,rt,y[rt],!0,L,V)}else if(w!==void 0&&(E=!0,oe(w)||(V=!0),ut&&(V?(g.call(c,w),g=null):(ut=g,g=function(bt,Ct,ft){return ut.call(A(bt),ft)})),g))for(;rt<q;rt++)g(c[rt],y,V?w:w.call(c[rt],rt,g(c[rt],y)));return E?c:ut?g.call(c):q?g(c[0],y):L},It=/^-ms-/,Yt=/-([a-z])/g;function we(c,g){return g.toUpperCase()}function Le(c){return c.replace(It,"ms-").replace(Yt,we)}var ie=function(c){return c.nodeType===1||c.nodeType===9||!+c.nodeType};function Je(){this.expando=A.expando+Je.uid++}Je.uid=1,Je.prototype={cache:function(c){var g=c[this.expando];return g||(g={},ie(c)&&(c.nodeType?c[this.expando]=g:Object.defineProperty(c,this.expando,{value:g,configurable:!0}))),g},set:function(c,g,y){var w,E=this.cache(c);if(typeof g=="string")E[Le(g)]=y;else for(w in g)E[Le(w)]=g[w];return E},get:function(c,g){return g===void 0?this.cache(c):c[this.expando]&&c[this.expando][Le(g)]},access:function(c,g,y){return g===void 0||g&&typeof g=="string"&&y===void 0?this.get(c,g):(this.set(c,g,y),y!==void 0?y:g)},remove:function(c,g){var y,w=c[this.expando];if(w!==void 0){if(g!==void 0)for(Array.isArray(g)?g=g.map(Le):(g=Le(g),g=g in w?[g]:g.match(We)||[]),y=g.length;y--;)delete w[g[y]];(g===void 0||A.isEmptyObject(w))&&(c.nodeType?c[this.expando]=void 0:delete c[this.expando])}},hasData:function(c){var g=c[this.expando];return g!==void 0&&!A.isEmptyObject(g)}};var jt=new Je,Ye=new Je,An=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,vo=/[A-Z]/g;function $t(c){return c==="true"?!0:c==="false"?!1:c==="null"?null:c===+c+""?+c:An.test(c)?JSON.parse(c):c}function ui(c,g,y){var w;if(y===void 0&&c.nodeType===1)if(w="data-"+g.replace(vo,"-$&").toLowerCase(),y=c.getAttribute(w),typeof y=="string"){try{y=$t(y)}catch{}Ye.set(c,g,y)}else y=void 0;return y}A.extend({hasData:function(c){return Ye.hasData(c)||jt.hasData(c)},data:function(c,g,y){return Ye.access(c,g,y)},removeData:function(c,g){Ye.remove(c,g)},_data:function(c,g,y){return jt.access(c,g,y)},_removeData:function(c,g){jt.remove(c,g)}}),A.fn.extend({data:function(c,g){var y,w,E,L=this[0],V=L&&L.attributes;if(c===void 0){if(this.length&&(E=Ye.get(L),L.nodeType===1&&!jt.get(L,"hasDataAttrs"))){for(y=V.length;y--;)V[y]&&(w=V[y].name,w.indexOf("data-")===0&&(w=Le(w.slice(5)),ui(L,w,E[w])));jt.set(L,"hasDataAttrs",!0)}return E}return typeof c=="object"?this.each(function(){Ye.set(this,c)}):nt(this,function(rt){var q;if(L&&rt===void 0)return q=Ye.get(L,c),q!==void 0||(q=ui(L,c),q!==void 0)?q:void 0;this.each(function(){Ye.set(this,c,rt)})},null,g,arguments.length>1,null,!0)},removeData:function(c){return this.each(function(){Ye.remove(this,c)})}}),A.extend({queue:function(c,g,y){var w;if(c)return g=(g||"fx")+"queue",w=jt.get(c,g),y&&(!w||Array.isArray(y)?w=jt.access(c,g,A.makeArray(y)):w.push(y)),w||[]},dequeue:function(c,g){g=g||"fx";var y=A.queue(c,g),w=y.length,E=y.shift(),L=A._queueHooks(c,g),V=function(){A.dequeue(c,g)};E==="inprogress"&&(E=y.shift(),w--),E&&(g==="fx"&&y.unshift("inprogress"),delete L.stop,E.call(c,V,L)),!w&&L&&L.empty.fire()},_queueHooks:function(c,g){var y=g+"queueHooks";return jt.get(c,y)||jt.access(c,y,{empty:A.Callbacks("once memory").add(function(){jt.remove(c,[g+"queue",y])})})}}),A.fn.extend({queue:function(c,g){var y=2;return typeof c!="string"&&(g=c,c="fx",y--),arguments.length<y?A.queue(this[0],c):g===void 0?this:this.each(function(){var w=A.queue(this,c,g);A._queueHooks(this,c),c==="fx"&&w[0]!=="inprogress"&&A.dequeue(this,c)})},dequeue:function(c){return this.each(function(){A.dequeue(this,c)})},clearQueue:function(c){return this.queue(c||"fx",[])},promise:function(c,g){var y,w=1,E=A.Deferred(),L=this,V=this.length,rt=function(){--w||E.resolveWith(L,[L])};for(typeof c!="string"&&(g=c,c=void 0),c=c||"fx";V--;)y=jt.get(L[V],c+"queueHooks"),y&&y.empty&&(w++,y.empty.add(rt));return rt(),E.promise(g)}});var Mi=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,At=new RegExp("^(?:([+-])=|)("+Mi+")([a-z%]*)$","i"),ei=["Top","Right","Bottom","Left"],Ue=qt.documentElement,si=function(c){return A.contains(c.ownerDocument,c)},Kn={composed:!0};Ue.getRootNode&&(si=function(c){return A.contains(c.ownerDocument,c)||c.getRootNode(Kn)===c.ownerDocument});var Qn=function(c,g){return c=g||c,c.style.display==="none"||c.style.display===""&&si(c)&&A.css(c,"display")==="none"};function ji(c,g,y,w){var E,L,V=20,rt=w?function(){return w.cur()}:function(){return A.css(c,g,"")},q=rt(),ut=y&&y[3]||(A.cssNumber[g]?"":"px"),bt=c.nodeType&&(A.cssNumber[g]||ut!=="px"&&+q)&&At.exec(A.css(c,g));if(bt&&bt[3]!==ut){for(q=q/2,ut=ut||bt[3],bt=+q||1;V--;)A.style(c,g,bt+ut),(1-L)*(1-(L=rt()/q||.5))<=0&&(V=0),bt=bt/L;bt=bt*2,A.style(c,g,bt+ut),y=y||[]}return y&&(bt=+bt||+q||0,E=y[1]?bt+(y[1]+1)*y[2]:+y[2],w&&(w.unit=ut,w.start=bt,w.end=E)),E}var lr={};function Ys(c){var g,y=c.ownerDocument,w=c.nodeName,E=lr[w];return E||(g=y.body.appendChild(y.createElement(w)),E=A.css(g,"display"),g.parentNode.removeChild(g),E==="none"&&(E="block"),lr[w]=E,E)}function xr(c,g){for(var y,w,E=[],L=0,V=c.length;L<V;L++)w=c[L],w.style&&(y=w.style.display,g?(y==="none"&&(E[L]=jt.get(w,"display")||null,E[L]||(w.style.display="")),w.style.display===""&&Qn(w)&&(E[L]=Ys(w))):y!=="none"&&(E[L]="none",jt.set(w,"display",y)));for(L=0;L<V;L++)E[L]!=null&&(c[L].style.display=E[L]);return c}A.fn.extend({show:function(){return xr(this,!0)},hide:function(){return xr(this)},toggle:function(c){return typeof c=="boolean"?c?this.show():this.hide():this.each(function(){Qn(this)?A(this).show():A(this).hide()})}});var Zr=/^(?:checkbox|radio)$/i,Us=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,ts=/^$|^module$|\/(?:java|ecma)script/i;(function(){var c=qt.createDocumentFragment(),g=c.appendChild(qt.createElement("div")),y=qt.createElement("input");y.setAttribute("type","radio"),y.setAttribute("checked","checked"),y.setAttribute("name","t"),g.appendChild(y),re.checkClone=g.cloneNode(!0).cloneNode(!0).lastChild.checked,g.innerHTML="<textarea>x</textarea>",re.noCloneChecked=!!g.cloneNode(!0).lastChild.defaultValue,g.innerHTML="<option></option>",re.option=!!g.lastChild})();var Gi={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Gi.tbody=Gi.tfoot=Gi.colgroup=Gi.caption=Gi.thead,Gi.th=Gi.td,re.option||(Gi.optgroup=Gi.option=[1,"<select multiple='multiple'>","</select>"]);function Ei(c,g){var y;return typeof c.getElementsByTagName<"u"?y=c.getElementsByTagName(g||"*"):typeof c.querySelectorAll<"u"?y=c.querySelectorAll(g||"*"):y=[],g===void 0||g&&Ve(c,g)?A.merge([c],y):y}function es(c,g){for(var y=0,w=c.length;y<w;y++)jt.set(c[y],"globalEval",!g||jt.get(g[y],"globalEval"))}var $a=/<|&#?\w+;/;function is(c,g,y,w,E){for(var L,V,rt,q,ut,bt,Ct=g.createDocumentFragment(),ft=[],Pt=0,te=c.length;Pt<te;Pt++)if(L=c[Pt],L||L===0)if(Ge(L)==="object")A.merge(ft,L.nodeType?[L]:L);else if(!$a.test(L))ft.push(g.createTextNode(L));else{for(V=V||Ct.appendChild(g.createElement("div")),rt=(Us.exec(L)||["",""])[1].toLowerCase(),q=Gi[rt]||Gi._default,V.innerHTML=q[1]+A.htmlPrefilter(L)+q[2],bt=q[0];bt--;)V=V.lastChild;A.merge(ft,V.childNodes),V=Ct.firstChild,V.textContent=""}for(Ct.textContent="",Pt=0;L=ft[Pt++];){if(w&&A.inArray(L,w)>-1){E&&E.push(L);continue}if(ut=si(L),V=Ei(Ct.appendChild(L),"script"),ut&&es(V),y)for(bt=0;L=V[bt++];)ts.test(L.type||"")&&y.push(L)}return Ct}var yo=/^([^.]*)(?:\.(.+)|)/;function wr(){return!0}function Ar(){return!1}function ns(c,g,y,w,E,L){var V,rt;if(typeof g=="object"){typeof y!="string"&&(w=w||y,y=void 0);for(rt in g)ns(c,rt,y,w,g[rt],L);return c}if(w==null&&E==null?(E=y,w=y=void 0):E==null&&(typeof y=="string"?(E=w,w=void 0):(E=w,w=y,y=void 0)),E===!1)E=Ar;else if(!E)return c;return L===1&&(V=E,E=function(q){return A().off(q),V.apply(this,arguments)},E.guid=V.guid||(V.guid=A.guid++)),c.each(function(){A.event.add(this,g,E,w,y)})}A.event={global:{},add:function(c,g,y,w,E){var L,V,rt,q,ut,bt,Ct,ft,Pt,te,Ie,ne=jt.get(c);if(ie(c))for(y.handler&&(L=y,y=L.handler,E=L.selector),E&&A.find.matchesSelector(Ue,E),y.guid||(y.guid=A.guid++),(q=ne.events)||(q=ne.events=Object.create(null)),(V=ne.handle)||(V=ne.handle=function(ii){return typeof A<"u"&&A.event.triggered!==ii.type?A.event.dispatch.apply(c,arguments):void 0}),g=(g||"").match(We)||[""],ut=g.length;ut--;)rt=yo.exec(g[ut])||[],Pt=Ie=rt[1],te=(rt[2]||"").split(".").sort(),Pt&&(Ct=A.event.special[Pt]||{},Pt=(E?Ct.delegateType:Ct.bindType)||Pt,Ct=A.event.special[Pt]||{},bt=A.extend({type:Pt,origType:Ie,data:w,handler:y,guid:y.guid,selector:E,needsContext:E&&A.expr.match.needsContext.test(E),namespace:te.join(".")},L),(ft=q[Pt])||(ft=q[Pt]=[],ft.delegateCount=0,(!Ct.setup||Ct.setup.call(c,w,te,V)===!1)&&c.addEventListener&&c.addEventListener(Pt,V)),Ct.add&&(Ct.add.call(c,bt),bt.handler.guid||(bt.handler.guid=y.guid)),E?ft.splice(ft.delegateCount++,0,bt):ft.push(bt),A.event.global[Pt]=!0)},remove:function(c,g,y,w,E){var L,V,rt,q,ut,bt,Ct,ft,Pt,te,Ie,ne=jt.hasData(c)&&jt.get(c);if(!(!ne||!(q=ne.events))){for(g=(g||"").match(We)||[""],ut=g.length;ut--;){if(rt=yo.exec(g[ut])||[],Pt=Ie=rt[1],te=(rt[2]||"").split(".").sort(),!Pt){for(Pt in q)A.event.remove(c,Pt+g[ut],y,w,!0);continue}for(Ct=A.event.special[Pt]||{},Pt=(w?Ct.delegateType:Ct.bindType)||Pt,ft=q[Pt]||[],rt=rt[2]&&new RegExp("(^|\\.)"+te.join("\\.(?:.*\\.|)")+"(\\.|$)"),V=L=ft.length;L--;)bt=ft[L],(E||Ie===bt.origType)&&(!y||y.guid===bt.guid)&&(!rt||rt.test(bt.namespace))&&(!w||w===bt.selector||w==="**"&&bt.selector)&&(ft.splice(L,1),bt.selector&&ft.delegateCount--,Ct.remove&&Ct.remove.call(c,bt));V&&!ft.length&&((!Ct.teardown||Ct.teardown.call(c,te,ne.handle)===!1)&&A.removeEvent(c,Pt,ne.handle),delete q[Pt])}A.isEmptyObject(q)&&jt.remove(c,"handle events")}},dispatch:function(c){var g,y,w,E,L,V,rt=new Array(arguments.length),q=A.event.fix(c),ut=(jt.get(this,"events")||Object.create(null))[q.type]||[],bt=A.event.special[q.type]||{};for(rt[0]=q,g=1;g<arguments.length;g++)rt[g]=arguments[g];if(q.delegateTarget=this,!(bt.preDispatch&&bt.preDispatch.call(this,q)===!1)){for(V=A.event.handlers.call(this,q,ut),g=0;(E=V[g++])&&!q.isPropagationStopped();)for(q.currentTarget=E.elem,y=0;(L=E.handlers[y++])&&!q.isImmediatePropagationStopped();)(!q.rnamespace||L.namespace===!1||q.rnamespace.test(L.namespace))&&(q.handleObj=L,q.data=L.data,w=((A.event.special[L.origType]||{}).handle||L.handler).apply(E.elem,rt),w!==void 0&&(q.result=w)===!1&&(q.preventDefault(),q.stopPropagation()));return bt.postDispatch&&bt.postDispatch.call(this,q),q.result}},handlers:function(c,g){var y,w,E,L,V,rt=[],q=g.delegateCount,ut=c.target;if(q&&ut.nodeType&&!(c.type==="click"&&c.button>=1)){for(;ut!==this;ut=ut.parentNode||this)if(ut.nodeType===1&&!(c.type==="click"&&ut.disabled===!0)){for(L=[],V={},y=0;y<q;y++)w=g[y],E=w.selector+" ",V[E]===void 0&&(V[E]=w.needsContext?A(E,this).index(ut)>-1:A.find(E,this,null,[ut]).length),V[E]&&L.push(w);L.length&&rt.push({elem:ut,handlers:L})}}return ut=this,q<g.length&&rt.push({elem:ut,handlers:g.slice(q)}),rt},addProp:function(c,g){Object.defineProperty(A.Event.prototype,c,{enumerable:!0,configurable:!0,get:oe(g)?function(){if(this.originalEvent)return g(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[c]},set:function(y){Object.defineProperty(this,c,{enumerable:!0,configurable:!0,writable:!0,value:y})}})},fix:function(c){return c[A.expando]?c:new A.Event(c)},special:{load:{noBubble:!0},click:{setup:function(c){var g=this||c;return Zr.test(g.type)&&g.click&&Ve(g,"input")&&bo(g,"click",!0),!1},trigger:function(c){var g=this||c;return Zr.test(g.type)&&g.click&&Ve(g,"input")&&bo(g,"click"),!0},_default:function(c){var g=c.target;return Zr.test(g.type)&&g.click&&Ve(g,"input")&&jt.get(g,"click")||Ve(g,"a")}},beforeunload:{postDispatch:function(c){c.result!==void 0&&c.originalEvent&&(c.originalEvent.returnValue=c.result)}}}};function bo(c,g,y){if(!y){jt.get(c,g)===void 0&&A.event.add(c,g,wr);return}jt.set(c,g,!1),A.event.add(c,g,{namespace:!1,handler:function(w){var E,L=jt.get(this,g);if(w.isTrigger&1&&this[g]){if(L)(A.event.special[g]||{}).delegateType&&w.stopPropagation();else if(L=ht.call(arguments),jt.set(this,g,L),this[g](),E=jt.get(this,g),jt.set(this,g,!1),L!==E)return w.stopImmediatePropagation(),w.preventDefault(),E}else L&&(jt.set(this,g,A.event.trigger(L[0],L.slice(1),this)),w.stopPropagation(),w.isImmediatePropagationStopped=wr)}})}A.removeEvent=function(c,g,y){c.removeEventListener&&c.removeEventListener(g,y)},A.Event=function(c,g){if(!(this instanceof A.Event))return new A.Event(c,g);c&&c.type?(this.originalEvent=c,this.type=c.type,this.isDefaultPrevented=c.defaultPrevented||c.defaultPrevented===void 0&&c.returnValue===!1?wr:Ar,this.target=c.target&&c.target.nodeType===3?c.target.parentNode:c.target,this.currentTarget=c.currentTarget,this.relatedTarget=c.relatedTarget):this.type=c,g&&A.extend(this,g),this.timeStamp=c&&c.timeStamp||Date.now(),this[A.expando]=!0},A.Event.prototype={constructor:A.Event,isDefaultPrevented:Ar,isPropagationStopped:Ar,isImmediatePropagationStopped:Ar,isSimulated:!1,preventDefault:function(){var c=this.originalEvent;this.isDefaultPrevented=wr,c&&!this.isSimulated&&c.preventDefault()},stopPropagation:function(){var c=this.originalEvent;this.isPropagationStopped=wr,c&&!this.isSimulated&&c.stopPropagation()},stopImmediatePropagation:function(){var c=this.originalEvent;this.isImmediatePropagationStopped=wr,c&&!this.isSimulated&&c.stopImmediatePropagation(),this.stopPropagation()}},A.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},A.event.addProp),A.each({focus:"focusin",blur:"focusout"},function(c,g){function y(w){if(qt.documentMode){var E=jt.get(this,"handle"),L=A.event.fix(w);L.type=w.type==="focusin"?"focus":"blur",L.isSimulated=!0,E(w),L.target===L.currentTarget&&E(L)}else A.event.simulate(g,w.target,A.event.fix(w))}A.event.special[c]={setup:function(){var w;if(bo(this,c,!0),qt.documentMode)w=jt.get(this,g),w||this.addEventListener(g,y),jt.set(this,g,(w||0)+1);else return!1},trigger:function(){return bo(this,c),!0},teardown:function(){var w;if(qt.documentMode)w=jt.get(this,g)-1,w?jt.set(this,g,w):(this.removeEventListener(g,y),jt.remove(this,g));else return!1},_default:function(w){return jt.get(w.target,c)},delegateType:g},A.event.special[g]={setup:function(){var w=this.ownerDocument||this.document||this,E=qt.documentMode?this:w,L=jt.get(E,g);L||(qt.documentMode?this.addEventListener(g,y):w.addEventListener(c,y,!0)),jt.set(E,g,(L||0)+1)},teardown:function(){var w=this.ownerDocument||this.document||this,E=qt.documentMode?this:w,L=jt.get(E,g)-1;L?jt.set(E,g,L):(qt.documentMode?this.removeEventListener(g,y):w.removeEventListener(c,y,!0),jt.remove(E,g))}}}),A.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(c,g){A.event.special[c]={delegateType:g,bindType:g,handle:function(y){var w,E=this,L=y.relatedTarget,V=y.handleObj;return(!L||L!==E&&!A.contains(E,L))&&(y.type=V.origType,w=V.handler.apply(this,arguments),y.type=g),w}}}),A.fn.extend({on:function(c,g,y,w){return ns(this,c,g,y,w)},one:function(c,g,y,w){return ns(this,c,g,y,w,1)},off:function(c,g,y){var w,E;if(c&&c.preventDefault&&c.handleObj)return w=c.handleObj,A(c.delegateTarget).off(w.namespace?w.origType+"."+w.namespace:w.origType,w.selector,w.handler),this;if(typeof c=="object"){for(E in c)this.off(E,g,c[E]);return this}return(g===!1||typeof g=="function")&&(y=g,g=void 0),y===!1&&(y=Ar),this.each(function(){A.event.remove(this,c,y,g)})}});var Ka=/<script|<style|<link/i,Qa=/checked\s*(?:[^=]|=\s*.checked.)/i,Hs=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function xo(c,g){return Ve(c,"table")&&Ve(g.nodeType!==11?g:g.firstChild,"tr")&&A(c).children("tbody")[0]||c}function qa(c){return c.type=(c.getAttribute("type")!==null)+"/"+c.type,c}function tl(c){return(c.type||"").slice(0,5)==="true/"?c.type=c.type.slice(5):c.removeAttribute("type"),c}function Xs(c,g){var y,w,E,L,V,rt,q;if(g.nodeType===1){if(jt.hasData(c)&&(L=jt.get(c),q=L.events,q)){jt.remove(g,"handle events");for(E in q)for(y=0,w=q[E].length;y<w;y++)A.event.add(g,E,q[E][y])}Ye.hasData(c)&&(V=Ye.access(c),rt=A.extend({},V),Ye.set(g,rt))}}function el(c,g){var y=g.nodeName.toLowerCase();y==="input"&&Zr.test(c.type)?g.checked=c.checked:(y==="input"||y==="textarea")&&(g.defaultValue=c.defaultValue)}function Cr(c,g,y,w){g=wt(g);var E,L,V,rt,q,ut,bt=0,Ct=c.length,ft=Ct-1,Pt=g[0],te=oe(Pt);if(te||Ct>1&&typeof Pt=="string"&&!re.checkClone&&Qa.test(Pt))return c.each(function(Ie){var ne=c.eq(Ie);te&&(g[0]=Pt.call(this,Ie,ne.html())),Cr(ne,g,y,w)});if(Ct&&(E=is(g,c[0].ownerDocument,!1,c,w),L=E.firstChild,E.childNodes.length===1&&(E=L),L||w)){for(V=A.map(Ei(E,"script"),qa),rt=V.length;bt<Ct;bt++)q=E,bt!==ft&&(q=A.clone(q,!0,!0),rt&&A.merge(V,Ei(q,"script"))),y.call(c[bt],q,bt);if(rt)for(ut=V[V.length-1].ownerDocument,A.map(V,tl),bt=0;bt<rt;bt++)q=V[bt],ts.test(q.type||"")&&!jt.access(q,"globalEval")&&A.contains(ut,q)&&(q.src&&(q.type||"").toLowerCase()!=="module"?A._evalUrl&&!q.noModule&&A._evalUrl(q.src,{nonce:q.nonce||q.getAttribute("nonce")},ut):Hn(q.textContent.replace(Hs,""),q,ut))}return c}function wo(c,g,y){for(var w,E=g?A.filter(g,c):c,L=0;(w=E[L])!=null;L++)!y&&w.nodeType===1&&A.cleanData(Ei(w)),w.parentNode&&(y&&si(w)&&es(Ei(w,"script")),w.parentNode.removeChild(w));return c}A.extend({htmlPrefilter:function(c){return c},clone:function(c,g,y){var w,E,L,V,rt=c.cloneNode(!0),q=si(c);if(!re.noCloneChecked&&(c.nodeType===1||c.nodeType===11)&&!A.isXMLDoc(c))for(V=Ei(rt),L=Ei(c),w=0,E=L.length;w<E;w++)el(L[w],V[w]);if(g)if(y)for(L=L||Ei(c),V=V||Ei(rt),w=0,E=L.length;w<E;w++)Xs(L[w],V[w]);else Xs(c,rt);return V=Ei(rt,"script"),V.length>0&&es(V,!q&&Ei(c,"script")),rt},cleanData:function(c){for(var g,y,w,E=A.event.special,L=0;(y=c[L])!==void 0;L++)if(ie(y)){if(g=y[jt.expando]){if(g.events)for(w in g.events)E[w]?A.event.remove(y,w):A.removeEvent(y,w,g.handle);y[jt.expando]=void 0}y[Ye.expando]&&(y[Ye.expando]=void 0)}}}),A.fn.extend({detach:function(c){return wo(this,c,!0)},remove:function(c){return wo(this,c)},text:function(c){return nt(this,function(g){return g===void 0?A.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=g)})},null,c,arguments.length)},append:function(){return Cr(this,arguments,function(c){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var g=xo(this,c);g.appendChild(c)}})},prepend:function(){return Cr(this,arguments,function(c){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var g=xo(this,c);g.insertBefore(c,g.firstChild)}})},before:function(){return Cr(this,arguments,function(c){this.parentNode&&this.parentNode.insertBefore(c,this)})},after:function(){return Cr(this,arguments,function(c){this.parentNode&&this.parentNode.insertBefore(c,this.nextSibling)})},empty:function(){for(var c,g=0;(c=this[g])!=null;g++)c.nodeType===1&&(A.cleanData(Ei(c,!1)),c.textContent="");return this},clone:function(c,g){return c=c??!1,g=g??c,this.map(function(){return A.clone(this,c,g)})},html:function(c){return nt(this,function(g){var y=this[0]||{},w=0,E=this.length;if(g===void 0&&y.nodeType===1)return y.innerHTML;if(typeof g=="string"&&!Ka.test(g)&&!Gi[(Us.exec(g)||["",""])[1].toLowerCase()]){g=A.htmlPrefilter(g);try{for(;w<E;w++)y=this[w]||{},y.nodeType===1&&(A.cleanData(Ei(y,!1)),y.innerHTML=g);y=0}catch{}}y&&this.empty().append(g)},null,c,arguments.length)},replaceWith:function(){var c=[];return Cr(this,arguments,function(g){var y=this.parentNode;A.inArray(this,c)<0&&(A.cleanData(Ei(this)),y&&y.replaceChild(g,this))},c)}}),A.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(c,g){A.fn[c]=function(y){for(var w,E=[],L=A(y),V=L.length-1,rt=0;rt<=V;rt++)w=rt===V?this:this.clone(!0),A(L[rt])[g](w),St.apply(E,w.get());return this.pushStack(E)}});var Ao=new RegExp("^("+Mi+")(?!px)[a-z%]+$","i"),Fr=/^--/,Cn=function(c){var g=c.ownerDocument.defaultView;return(!g||!g.opener)&&(g=B),g.getComputedStyle(c)},Co=function(c,g,y){var w,E,L={};for(E in g)L[E]=c.style[E],c.style[E]=g[E];w=y.call(c);for(E in g)c.style[E]=L[E];return w},rs=new RegExp(ei.join("|"),"i");(function(){function c(){if(ut){q.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",ut.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Ue.appendChild(q).appendChild(ut);var bt=B.getComputedStyle(ut);y=bt.top!=="1%",rt=g(bt.marginLeft)===12,ut.style.right="60%",L=g(bt.right)===36,w=g(bt.width)===36,ut.style.position="absolute",E=g(ut.offsetWidth/3)===12,Ue.removeChild(q),ut=null}}function g(bt){return Math.round(parseFloat(bt))}var y,w,E,L,V,rt,q=qt.createElement("div"),ut=qt.createElement("div");ut.style&&(ut.style.backgroundClip="content-box",ut.cloneNode(!0).style.backgroundClip="",re.clearCloneStyle=ut.style.backgroundClip==="content-box",A.extend(re,{boxSizingReliable:function(){return c(),w},pixelBoxStyles:function(){return c(),L},pixelPosition:function(){return c(),y},reliableMarginLeft:function(){return c(),rt},scrollboxSize:function(){return c(),E},reliableTrDimensions:function(){var bt,Ct,ft,Pt;return V==null&&(bt=qt.createElement("table"),Ct=qt.createElement("tr"),ft=qt.createElement("div"),bt.style.cssText="position:absolute;left:-11111px;border-collapse:separate",Ct.style.cssText="box-sizing:content-box;border:1px solid",Ct.style.height="1px",ft.style.height="9px",ft.style.display="block",Ue.appendChild(bt).appendChild(Ct).appendChild(ft),Pt=B.getComputedStyle(Ct),V=parseInt(Pt.height,10)+parseInt(Pt.borderTopWidth,10)+parseInt(Pt.borderBottomWidth,10)===Ct.offsetHeight,Ue.removeChild(bt)),V}}))})();function Ir(c,g,y){var w,E,L,V,rt=Fr.test(g),q=c.style;return y=y||Cn(c),y&&(V=y.getPropertyValue(g)||y[g],rt&&V&&(V=V.replace(sr,"$1")||void 0),V===""&&!si(c)&&(V=A.style(c,g)),!re.pixelBoxStyles()&&Ao.test(V)&&rs.test(g)&&(w=q.width,E=q.minWidth,L=q.maxWidth,q.minWidth=q.maxWidth=q.width=V,V=y.width,q.width=w,q.minWidth=E,q.maxWidth=L)),V!==void 0?V+"":V}function os(c,g){return{get:function(){if(c()){delete this.get;return}return(this.get=g).apply(this,arguments)}}}var Js=["Webkit","Moz","ms"],X=qt.createElement("div").style,_i={};function Io(c){for(var g=c[0].toUpperCase()+c.slice(1),y=Js.length;y--;)if(c=Js[y]+g,c in X)return c}function Mo(c){var g=A.cssProps[c]||_i[c];return g||(c in X?c:_i[c]=Io(c)||c)}var ss=/^(none|table(?!-c[ea]).+)/,$s={position:"absolute",visibility:"hidden",display:"block"},Ks={letterSpacing:"0",fontWeight:"400"};function _r(c,g,y){var w=At.exec(g);return w?Math.max(0,w[2]-(y||0))+(w[3]||"px"):g}function Wr(c,g,y,w,E,L){var V=g==="width"?1:0,rt=0,q=0,ut=0;if(y===(w?"border":"content"))return 0;for(;V<4;V+=2)y==="margin"&&(ut+=A.css(c,y+ei[V],!0,E)),w?(y==="content"&&(q-=A.css(c,"padding"+ei[V],!0,E)),y!=="margin"&&(q-=A.css(c,"border"+ei[V]+"Width",!0,E))):(q+=A.css(c,"padding"+ei[V],!0,E),y!=="padding"?q+=A.css(c,"border"+ei[V]+"Width",!0,E):rt+=A.css(c,"border"+ei[V]+"Width",!0,E));return!w&&L>=0&&(q+=Math.max(0,Math.ceil(c["offset"+g[0].toUpperCase()+g.slice(1)]-L-q-rt-.5))||0),q+ut}function il(c,g,y){var w=Cn(c),E=!re.boxSizingReliable()||y,L=E&&A.css(c,"boxSizing",!1,w)==="border-box",V=L,rt=Ir(c,g,w),q="offset"+g[0].toUpperCase()+g.slice(1);if(Ao.test(rt)){if(!y)return rt;rt="auto"}return(!re.boxSizingReliable()&&L||!re.reliableTrDimensions()&&Ve(c,"tr")||rt==="auto"||!parseFloat(rt)&&A.css(c,"display",!1,w)==="inline")&&c.getClientRects().length&&(L=A.css(c,"boxSizing",!1,w)==="border-box",V=q in c,V&&(rt=c[q])),rt=parseFloat(rt)||0,rt+Wr(c,g,y||(L?"border":"content"),V,w,rt)+"px"}A.extend({cssHooks:{opacity:{get:function(c,g){if(g){var y=Ir(c,"opacity");return y===""?"1":y}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(c,g,y,w){if(!(!c||c.nodeType===3||c.nodeType===8||!c.style)){var E,L,V,rt=Le(g),q=Fr.test(g),ut=c.style;if(q||(g=Mo(rt)),V=A.cssHooks[g]||A.cssHooks[rt],y!==void 0){if(L=typeof y,L==="string"&&(E=At.exec(y))&&E[1]&&(y=ji(c,g,E),L="number"),y==null||y!==y)return;L==="number"&&!q&&(y+=E&&E[3]||(A.cssNumber[rt]?"":"px")),!re.clearCloneStyle&&y===""&&g.indexOf("background")===0&&(ut[g]="inherit"),(!V||!("set"in V)||(y=V.set(c,y,w))!==void 0)&&(q?ut.setProperty(g,y):ut[g]=y)}else return V&&"get"in V&&(E=V.get(c,!1,w))!==void 0?E:ut[g]}},css:function(c,g,y,w){var E,L,V,rt=Le(g),q=Fr.test(g);return q||(g=Mo(rt)),V=A.cssHooks[g]||A.cssHooks[rt],V&&"get"in V&&(E=V.get(c,!0,y)),E===void 0&&(E=Ir(c,g,w)),E==="normal"&&g in Ks&&(E=Ks[g]),y===""||y?(L=parseFloat(E),y===!0||isFinite(L)?L||0:E):E}}),A.each(["height","width"],function(c,g){A.cssHooks[g]={get:function(y,w,E){if(w)return ss.test(A.css(y,"display"))&&(!y.getClientRects().length||!y.getBoundingClientRect().width)?Co(y,$s,function(){return il(y,g,E)}):il(y,g,E)},set:function(y,w,E){var L,V=Cn(y),rt=!re.scrollboxSize()&&V.position==="absolute",q=rt||E,ut=q&&A.css(y,"boxSizing",!1,V)==="border-box",bt=E?Wr(y,g,E,ut,V):0;return ut&&rt&&(bt-=Math.ceil(y["offset"+g[0].toUpperCase()+g.slice(1)]-parseFloat(V[g])-Wr(y,g,"border",!1,V)-.5)),bt&&(L=At.exec(w))&&(L[3]||"px")!=="px"&&(y.style[g]=w,w=A.css(y,g)),_r(y,w,bt)}}}),A.cssHooks.marginLeft=os(re.reliableMarginLeft,function(c,g){if(g)return(parseFloat(Ir(c,"marginLeft"))||c.getBoundingClientRect().left-Co(c,{marginLeft:0},function(){return c.getBoundingClientRect().left}))+"px"}),A.each({margin:"",padding:"",border:"Width"},function(c,g){A.cssHooks[c+g]={expand:function(y){for(var w=0,E={},L=typeof y=="string"?y.split(" "):[y];w<4;w++)E[c+ei[w]+g]=L[w]||L[w-2]||L[0];return E}},c!=="margin"&&(A.cssHooks[c+g].set=_r)}),A.fn.extend({css:function(c,g){return nt(this,function(y,w,E){var L,V,rt={},q=0;if(Array.isArray(w)){for(L=Cn(y),V=w.length;q<V;q++)rt[w[q]]=A.css(y,w[q],!1,L);return rt}return E!==void 0?A.style(y,w,E):A.css(y,w)},c,g,arguments.length>1)}});function di(c,g,y,w,E){return new di.prototype.init(c,g,y,w,E)}A.Tween=di,di.prototype={constructor:di,init:function(c,g,y,w,E,L){this.elem=c,this.prop=y,this.easing=E||A.easing._default,this.options=g,this.start=this.now=this.cur(),this.end=w,this.unit=L||(A.cssNumber[y]?"":"px")},cur:function(){var c=di.propHooks[this.prop];return c&&c.get?c.get(this):di.propHooks._default.get(this)},run:function(c){var g,y=di.propHooks[this.prop];return this.options.duration?this.pos=g=A.easing[this.easing](c,this.options.duration*c,0,1,this.options.duration):this.pos=g=c,this.now=(this.end-this.start)*g+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),y&&y.set?y.set(this):di.propHooks._default.set(this),this}},di.prototype.init.prototype=di.prototype,di.propHooks={_default:{get:function(c){var g;return c.elem.nodeType!==1||c.elem[c.prop]!=null&&c.elem.style[c.prop]==null?c.elem[c.prop]:(g=A.css(c.elem,c.prop,""),!g||g==="auto"?0:g)},set:function(c){A.fx.step[c.prop]?A.fx.step[c.prop](c):c.elem.nodeType===1&&(A.cssHooks[c.prop]||c.elem.style[Mo(c.prop)]!=null)?A.style(c.elem,c.prop,c.now+c.unit):c.elem[c.prop]=c.now}}},di.propHooks.scrollTop=di.propHooks.scrollLeft={set:function(c){c.elem.nodeType&&c.elem.parentNode&&(c.elem[c.prop]=c.now)}},A.easing={linear:function(c){return c},swing:function(c){return .5-Math.cos(c*Math.PI)/2},_default:"swing"},A.fx=di.prototype.init,A.fx.step={};var hr,cr,as=/^(?:toggle|show|hide)$/,ls=/queueHooks$/;function Qs(){cr&&(qt.hidden===!1&&B.requestAnimationFrame?B.requestAnimationFrame(Qs):B.setTimeout(Qs,A.fx.interval),A.fx.tick())}function hs(){return B.setTimeout(function(){hr=void 0}),hr=Date.now()}function Yr(c,g){var y,w=0,E={height:c};for(g=g?1:0;w<4;w+=2-g)y=ei[w],E["margin"+y]=E["padding"+y]=c;return g&&(E.opacity=E.width=c),E}function qs(c,g,y){for(var w,E=(cn.tweeners[g]||[]).concat(cn.tweeners["*"]),L=0,V=E.length;L<V;L++)if(w=E[L].call(y,g,c))return w}function nl(c,g,y){var w,E,L,V,rt,q,ut,bt,Ct="width"in g||"height"in g,ft=this,Pt={},te=c.style,Ie=c.nodeType&&Qn(c),ne=jt.get(c,"fxshow");y.queue||(V=A._queueHooks(c,"fx"),V.unqueued==null&&(V.unqueued=0,rt=V.empty.fire,V.empty.fire=function(){V.unqueued||rt()}),V.unqueued++,ft.always(function(){ft.always(function(){V.unqueued--,A.queue(c,"fx").length||V.empty.fire()})}));for(w in g)if(E=g[w],as.test(E)){if(delete g[w],L=L||E==="toggle",E===(Ie?"hide":"show"))if(E==="show"&&ne&&ne[w]!==void 0)Ie=!0;else continue;Pt[w]=ne&&ne[w]||A.style(c,w)}if(q=!A.isEmptyObject(g),!(!q&&A.isEmptyObject(Pt))){Ct&&c.nodeType===1&&(y.overflow=[te.overflow,te.overflowX,te.overflowY],ut=ne&&ne.display,ut==null&&(ut=jt.get(c,"display")),bt=A.css(c,"display"),bt==="none"&&(ut?bt=ut:(xr([c],!0),ut=c.style.display||ut,bt=A.css(c,"display"),xr([c]))),(bt==="inline"||bt==="inline-block"&&ut!=null)&&A.css(c,"float")==="none"&&(q||(ft.done(function(){te.display=ut}),ut==null&&(bt=te.display,ut=bt==="none"?"":bt)),te.display="inline-block")),y.overflow&&(te.overflow="hidden",ft.always(function(){te.overflow=y.overflow[0],te.overflowX=y.overflow[1],te.overflowY=y.overflow[2]})),q=!1;for(w in Pt)q||(ne?"hidden"in ne&&(Ie=ne.hidden):ne=jt.access(c,"fxshow",{display:ut}),L&&(ne.hidden=!Ie),Ie&&xr([c],!0),ft.done(function(){Ie||xr([c]),jt.remove(c,"fxshow");for(w in Pt)A.style(c,w,Pt[w])})),q=qs(Ie?ne[w]:0,w,ft),w in ne||(ne[w]=q.start,Ie&&(q.end=q.start,q.start=0))}}function rl(c,g){var y,w,E,L,V;for(y in c)if(w=Le(y),E=g[w],L=c[y],Array.isArray(L)&&(E=L[1],L=c[y]=L[0]),y!==w&&(c[w]=L,delete c[y]),V=A.cssHooks[w],V&&"expand"in V){L=V.expand(L),delete c[w];for(y in L)y in c||(c[y]=L[y],g[y]=E)}else g[w]=E}function cn(c,g,y){var w,E,L=0,V=cn.prefilters.length,rt=A.Deferred().always(function(){delete q.elem}),q=function(){if(E)return!1;for(var Ct=hr||hs(),ft=Math.max(0,ut.startTime+ut.duration-Ct),Pt=ft/ut.duration||0,te=1-Pt,Ie=0,ne=ut.tweens.length;Ie<ne;Ie++)ut.tweens[Ie].run(te);return rt.notifyWith(c,[ut,te,ft]),te<1&&ne?ft:(ne||rt.notifyWith(c,[ut,1,0]),rt.resolveWith(c,[ut]),!1)},ut=rt.promise({elem:c,props:A.extend({},g),opts:A.extend(!0,{specialEasing:{},easing:A.easing._default},y),originalProperties:g,originalOptions:y,startTime:hr||hs(),duration:y.duration,tweens:[],createTween:function(Ct,ft){var Pt=A.Tween(c,ut.opts,Ct,ft,ut.opts.specialEasing[Ct]||ut.opts.easing);return ut.tweens.push(Pt),Pt},stop:function(Ct){var ft=0,Pt=Ct?ut.tweens.length:0;if(E)return this;for(E=!0;ft<Pt;ft++)ut.tweens[ft].run(1);return Ct?(rt.notifyWith(c,[ut,1,0]),rt.resolveWith(c,[ut,Ct])):rt.rejectWith(c,[ut,Ct]),this}}),bt=ut.props;for(rl(bt,ut.opts.specialEasing);L<V;L++)if(w=cn.prefilters[L].call(ut,c,bt,ut.opts),w)return oe(w.stop)&&(A._queueHooks(ut.elem,ut.opts.queue).stop=w.stop.bind(w)),w;return A.map(bt,qs,ut),oe(ut.opts.start)&&ut.opts.start.call(c,ut),ut.progress(ut.opts.progress).done(ut.opts.done,ut.opts.complete).fail(ut.opts.fail).always(ut.opts.always),A.fx.timer(A.extend(q,{elem:c,anim:ut,queue:ut.opts.queue})),ut}A.Animation=A.extend(cn,{tweeners:{"*":[function(c,g){var y=this.createTween(c,g);return ji(y.elem,c,At.exec(g),y),y}]},tweener:function(c,g){oe(c)?(g=c,c=["*"]):c=c.match(We);for(var y,w=0,E=c.length;w<E;w++)y=c[w],cn.tweeners[y]=cn.tweeners[y]||[],cn.tweeners[y].unshift(g)},prefilters:[nl],prefilter:function(c,g){g?cn.prefilters.unshift(c):cn.prefilters.push(c)}}),A.speed=function(c,g,y){var w=c&&typeof c=="object"?A.extend({},c):{complete:y||!y&&g||oe(c)&&c,duration:c,easing:y&&g||g&&!oe(g)&&g};return A.fx.off?w.duration=0:typeof w.duration!="number"&&(w.duration in A.fx.speeds?w.duration=A.fx.speeds[w.duration]:w.duration=A.fx.speeds._default),(w.queue==null||w.queue===!0)&&(w.queue="fx"),w.old=w.complete,w.complete=function(){oe(w.old)&&w.old.call(this),w.queue&&A.dequeue(this,w.queue)},w},A.fn.extend({fadeTo:function(c,g,y,w){return this.filter(Qn).css("opacity",0).show().end().animate({opacity:g},c,y,w)},animate:function(c,g,y,w){var E=A.isEmptyObject(c),L=A.speed(g,y,w),V=function(){var rt=cn(this,A.extend({},c),L);(E||jt.get(this,"finish"))&&rt.stop(!0)};return V.finish=V,E||L.queue===!1?this.each(V):this.queue(L.queue,V)},stop:function(c,g,y){var w=function(E){var L=E.stop;delete E.stop,L(y)};return typeof c!="string"&&(y=g,g=c,c=void 0),g&&this.queue(c||"fx",[]),this.each(function(){var E=!0,L=c!=null&&c+"queueHooks",V=A.timers,rt=jt.get(this);if(L)rt[L]&&rt[L].stop&&w(rt[L]);else for(L in rt)rt[L]&&rt[L].stop&&ls.test(L)&&w(rt[L]);for(L=V.length;L--;)V[L].elem===this&&(c==null||V[L].queue===c)&&(V[L].anim.stop(y),E=!1,V.splice(L,1));(E||!y)&&A.dequeue(this,c)})},finish:function(c){return c!==!1&&(c=c||"fx"),this.each(function(){var g,y=jt.get(this),w=y[c+"queue"],E=y[c+"queueHooks"],L=A.timers,V=w?w.length:0;for(y.finish=!0,A.queue(this,c,[]),E&&E.stop&&E.stop.call(this,!0),g=L.length;g--;)L[g].elem===this&&L[g].queue===c&&(L[g].anim.stop(!0),L.splice(g,1));for(g=0;g<V;g++)w[g]&&w[g].finish&&w[g].finish.call(this);delete y.finish})}}),A.each(["toggle","show","hide"],function(c,g){var y=A.fn[g];A.fn[g]=function(w,E,L){return w==null||typeof w=="boolean"?y.apply(this,arguments):this.animate(Yr(g,!0),w,E,L)}}),A.each({slideDown:Yr("show"),slideUp:Yr("hide"),slideToggle:Yr("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(c,g){A.fn[c]=function(y,w,E){return this.animate(g,y,w,E)}}),A.timers=[],A.fx.tick=function(){var c,g=0,y=A.timers;for(hr=Date.now();g<y.length;g++)c=y[g],!c()&&y[g]===c&&y.splice(g--,1);y.length||A.fx.stop(),hr=void 0},A.fx.timer=function(c){A.timers.push(c),A.fx.start()},A.fx.interval=13,A.fx.start=function(){cr||(cr=!0,Qs())},A.fx.stop=function(){cr=null},A.fx.speeds={slow:600,fast:200,_default:400},A.fn.delay=function(c,g){return c=A.fx&&A.fx.speeds[c]||c,g=g||"fx",this.queue(g,function(y,w){var E=B.setTimeout(y,c);w.stop=function(){B.clearTimeout(E)}})},function(){var c=qt.createElement("input"),g=qt.createElement("select"),y=g.appendChild(qt.createElement("option"));c.type="checkbox",re.checkOn=c.value!=="",re.optSelected=y.selected,c=qt.createElement("input"),c.value="t",c.type="radio",re.radioValue=c.value==="t"}();var ta,Ur=A.expr.attrHandle;A.fn.extend({attr:function(c,g){return nt(this,A.attr,c,g,arguments.length>1)},removeAttr:function(c){return this.each(function(){A.removeAttr(this,c)})}}),A.extend({attr:function(c,g,y){var w,E,L=c.nodeType;if(!(L===3||L===8||L===2)){if(typeof c.getAttribute>"u")return A.prop(c,g,y);if((L!==1||!A.isXMLDoc(c))&&(E=A.attrHooks[g.toLowerCase()]||(A.expr.match.bool.test(g)?ta:void 0)),y!==void 0){if(y===null){A.removeAttr(c,g);return}return E&&"set"in E&&(w=E.set(c,y,g))!==void 0?w:(c.setAttribute(g,y+""),y)}return E&&"get"in E&&(w=E.get(c,g))!==null?w:(w=A.find.attr(c,g),w??void 0)}},attrHooks:{type:{set:function(c,g){if(!re.radioValue&&g==="radio"&&Ve(c,"input")){var y=c.value;return c.setAttribute("type",g),y&&(c.value=y),g}}}},removeAttr:function(c,g){var y,w=0,E=g&&g.match(We);if(E&&c.nodeType===1)for(;y=E[w++];)c.removeAttribute(y)}}),ta={set:function(c,g,y){return g===!1?A.removeAttr(c,y):c.setAttribute(y,y),y}},A.each(A.expr.match.bool.source.match(/\w+/g),function(c,g){var y=Ur[g]||A.find.attr;Ur[g]=function(w,E,L){var V,rt,q=E.toLowerCase();return L||(rt=Ur[q],Ur[q]=V,V=y(w,E,L)!=null?q:null,Ur[q]=rt),V}});var ol=/^(?:input|select|textarea|button)$/i,sl=/^(?:a|area)$/i;A.fn.extend({prop:function(c,g){return nt(this,A.prop,c,g,arguments.length>1)},removeProp:function(c){return this.each(function(){delete this[A.propFix[c]||c]})}}),A.extend({prop:function(c,g,y){var w,E,L=c.nodeType;if(!(L===3||L===8||L===2))return(L!==1||!A.isXMLDoc(c))&&(g=A.propFix[g]||g,E=A.propHooks[g]),y!==void 0?E&&"set"in E&&(w=E.set(c,y,g))!==void 0?w:c[g]=y:E&&"get"in E&&(w=E.get(c,g))!==null?w:c[g]},propHooks:{tabIndex:{get:function(c){var g=A.find.attr(c,"tabindex");return g?parseInt(g,10):ol.test(c.nodeName)||sl.test(c.nodeName)&&c.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),re.optSelected||(A.propHooks.selected={get:function(c){var g=c.parentNode;return g&&g.parentNode&&g.parentNode.selectedIndex,null},set:function(c){var g=c.parentNode;g&&(g.selectedIndex,g.parentNode&&g.parentNode.selectedIndex)}}),A.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){A.propFix[this.toLowerCase()]=this});function ur(c){var g=c.match(We)||[];return g.join(" ")}function De(c){return c.getAttribute&&c.getAttribute("class")||""}function ea(c){return Array.isArray(c)?c:typeof c=="string"?c.match(We)||[]:[]}A.fn.extend({addClass:function(c){var g,y,w,E,L,V;return oe(c)?this.each(function(rt){A(this).addClass(c.call(this,rt,De(this)))}):(g=ea(c),g.length?this.each(function(){if(w=De(this),y=this.nodeType===1&&" "+ur(w)+" ",y){for(L=0;L<g.length;L++)E=g[L],y.indexOf(" "+E+" ")<0&&(y+=E+" ");V=ur(y),w!==V&&this.setAttribute("class",V)}}):this)},removeClass:function(c){var g,y,w,E,L,V;return oe(c)?this.each(function(rt){A(this).removeClass(c.call(this,rt,De(this)))}):arguments.length?(g=ea(c),g.length?this.each(function(){if(w=De(this),y=this.nodeType===1&&" "+ur(w)+" ",y){for(L=0;L<g.length;L++)for(E=g[L];y.indexOf(" "+E+" ")>-1;)y=y.replace(" "+E+" "," ");V=ur(y),w!==V&&this.setAttribute("class",V)}}):this):this.attr("class","")},toggleClass:function(c,g){var y,w,E,L,V=typeof c,rt=V==="string"||Array.isArray(c);return oe(c)?this.each(function(q){A(this).toggleClass(c.call(this,q,De(this),g),g)}):typeof g=="boolean"&&rt?g?this.addClass(c):this.removeClass(c):(y=ea(c),this.each(function(){if(rt)for(L=A(this),E=0;E<y.length;E++)w=y[E],L.hasClass(w)?L.removeClass(w):L.addClass(w);else(c===void 0||V==="boolean")&&(w=De(this),w&&jt.set(this,"__className__",w),this.setAttribute&&this.setAttribute("class",w||c===!1?"":jt.get(this,"__className__")||""))}))},hasClass:function(c){var g,y,w=0;for(g=" "+c+" ";y=this[w++];)if(y.nodeType===1&&(" "+ur(De(y))+" ").indexOf(g)>-1)return!0;return!1}});var ia=/\r/g;A.fn.extend({val:function(c){var g,y,w,E=this[0];return arguments.length?(w=oe(c),this.each(function(L){var V;this.nodeType===1&&(w?V=c.call(this,L,A(this).val()):V=c,V==null?V="":typeof V=="number"?V+="":Array.isArray(V)&&(V=A.map(V,function(rt){return rt==null?"":rt+""})),g=A.valHooks[this.type]||A.valHooks[this.nodeName.toLowerCase()],(!g||!("set"in g)||g.set(this,V,"value")===void 0)&&(this.value=V))})):E?(g=A.valHooks[E.type]||A.valHooks[E.nodeName.toLowerCase()],g&&"get"in g&&(y=g.get(E,"value"))!==void 0?y:(y=E.value,typeof y=="string"?y.replace(ia,""):y??"")):void 0}}),A.extend({valHooks:{option:{get:function(c){var g=A.find.attr(c,"value");return g??ur(A.text(c))}},select:{get:function(c){var g,y,w,E=c.options,L=c.selectedIndex,V=c.type==="select-one",rt=V?null:[],q=V?L+1:E.length;for(L<0?w=q:w=V?L:0;w<q;w++)if(y=E[w],(y.selected||w===L)&&!y.disabled&&(!y.parentNode.disabled||!Ve(y.parentNode,"optgroup"))){if(g=A(y).val(),V)return g;rt.push(g)}return rt},set:function(c,g){for(var y,w,E=c.options,L=A.makeArray(g),V=E.length;V--;)w=E[V],(w.selected=A.inArray(A.valHooks.option.get(w),L)>-1)&&(y=!0);return y||(c.selectedIndex=-1),L}}}}),A.each(["radio","checkbox"],function(){A.valHooks[this]={set:function(c,g){if(Array.isArray(g))return c.checked=A.inArray(A(c).val(),g)>-1}},re.checkOn||(A.valHooks[this].get=function(c){return c.getAttribute("value")===null?"on":c.value})});var Mr=B.location,al={guid:Date.now()},cs=/\?/;A.parseXML=function(c){var g,y;if(!c||typeof c!="string")return null;try{g=new B.DOMParser().parseFromString(c,"text/xml")}catch{}return y=g&&g.getElementsByTagName("parsererror")[0],(!g||y)&&A.error("Invalid XML: "+(y?A.map(y.childNodes,function(w){return w.textContent}).join(`
`):c)),g};var ll=/^(?:focusinfocus|focusoutblur)$/,hl=function(c){c.stopPropagation()};A.extend(A.event,{trigger:function(c,g,y,w){var E,L,V,rt,q,ut,bt,Ct,ft=[y||qt],Pt=Ce.call(c,"type")?c.type:c,te=Ce.call(c,"namespace")?c.namespace.split("."):[];if(L=Ct=V=y=y||qt,!(y.nodeType===3||y.nodeType===8)&&!ll.test(Pt+A.event.triggered)&&(Pt.indexOf(".")>-1&&(te=Pt.split("."),Pt=te.shift(),te.sort()),q=Pt.indexOf(":")<0&&"on"+Pt,c=c[A.expando]?c:new A.Event(Pt,typeof c=="object"&&c),c.isTrigger=w?2:3,c.namespace=te.join("."),c.rnamespace=c.namespace?new RegExp("(^|\\.)"+te.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,c.result=void 0,c.target||(c.target=y),g=g==null?[c]:A.makeArray(g,[c]),bt=A.event.special[Pt]||{},!(!w&&bt.trigger&&bt.trigger.apply(y,g)===!1))){if(!w&&!bt.noBubble&&!Rn(y)){for(rt=bt.delegateType||Pt,ll.test(rt+Pt)||(L=L.parentNode);L;L=L.parentNode)ft.push(L),V=L;V===(y.ownerDocument||qt)&&ft.push(V.defaultView||V.parentWindow||B)}for(E=0;(L=ft[E++])&&!c.isPropagationStopped();)Ct=L,c.type=E>1?rt:bt.bindType||Pt,ut=(jt.get(L,"events")||Object.create(null))[c.type]&&jt.get(L,"handle"),ut&&ut.apply(L,g),ut=q&&L[q],ut&&ut.apply&&ie(L)&&(c.result=ut.apply(L,g),c.result===!1&&c.preventDefault());return c.type=Pt,!w&&!c.isDefaultPrevented()&&(!bt._default||bt._default.apply(ft.pop(),g)===!1)&&ie(y)&&q&&oe(y[Pt])&&!Rn(y)&&(V=y[q],V&&(y[q]=null),A.event.triggered=Pt,c.isPropagationStopped()&&Ct.addEventListener(Pt,hl),y[Pt](),c.isPropagationStopped()&&Ct.removeEventListener(Pt,hl),A.event.triggered=void 0,V&&(y[q]=V)),c.result}},simulate:function(c,g,y){var w=A.extend(new A.Event,y,{type:c,isSimulated:!0});A.event.trigger(w,null,g)}}),A.fn.extend({trigger:function(c,g){return this.each(function(){A.event.trigger(c,g,this)})},triggerHandler:function(c,g){var y=this[0];if(y)return A.event.trigger(c,g,y,!0)}});var Ah=/\[\]$/,cl=/\r?\n/g,Ch=/^(?:submit|button|image|reset|file)$/i,Ih=/^(?:input|select|textarea|keygen)/i;function na(c,g,y,w){var E;if(Array.isArray(g))A.each(g,function(L,V){y||Ah.test(c)?w(c,V):na(c+"["+(typeof V=="object"&&V!=null?L:"")+"]",V,y,w)});else if(!y&&Ge(g)==="object")for(E in g)na(c+"["+E+"]",g[E],y,w);else w(c,g)}A.param=function(c,g){var y,w=[],E=function(L,V){var rt=oe(V)?V():V;w[w.length]=encodeURIComponent(L)+"="+encodeURIComponent(rt??"")};if(c==null)return"";if(Array.isArray(c)||c.jquery&&!A.isPlainObject(c))A.each(c,function(){E(this.name,this.value)});else for(y in c)na(y,c[y],g,E);return w.join("&")},A.fn.extend({serialize:function(){return A.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var c=A.prop(this,"elements");return c?A.makeArray(c):this}).filter(function(){var c=this.type;return this.name&&!A(this).is(":disabled")&&Ih.test(this.nodeName)&&!Ch.test(c)&&(this.checked||!Zr.test(c))}).map(function(c,g){var y=A(this).val();return y==null?null:Array.isArray(y)?A.map(y,function(w){return{name:g.name,value:w.replace(cl,`\r
`)}}):{name:g.name,value:y.replace(cl,`\r
`)}}).get()}});var Mh=/%20/g,ul=/#.*$/,Sh=/([?&])_=[^&]*/,kh=/^(.*?):[ \t]*([^\r\n]*)$/mg,dl=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Th=/^(?:GET|HEAD)$/,So=/^\/\//,ra={},dr={},Qi="*/".concat("*"),oa=qt.createElement("a");oa.href=Mr.href;function gl(c){return function(g,y){typeof g!="string"&&(y=g,g="*");var w,E=0,L=g.toLowerCase().match(We)||[];if(oe(y))for(;w=L[E++];)w[0]==="+"?(w=w.slice(1)||"*",(c[w]=c[w]||[]).unshift(y)):(c[w]=c[w]||[]).push(y)}}function ko(c,g,y,w){var E={},L=c===dr;function V(rt){var q;return E[rt]=!0,A.each(c[rt]||[],function(ut,bt){var Ct=bt(g,y,w);if(typeof Ct=="string"&&!L&&!E[Ct])return g.dataTypes.unshift(Ct),V(Ct),!1;if(L)return!(q=Ct)}),q}return V(g.dataTypes[0])||!E["*"]&&V("*")}function qn(c,g){var y,w,E=A.ajaxSettings.flatOptions||{};for(y in g)g[y]!==void 0&&((E[y]?c:w||(w={}))[y]=g[y]);return w&&A.extend(!0,c,w),c}function To(c,g,y){for(var w,E,L,V,rt=c.contents,q=c.dataTypes;q[0]==="*";)q.shift(),w===void 0&&(w=c.mimeType||g.getResponseHeader("Content-Type"));if(w){for(E in rt)if(rt[E]&&rt[E].test(w)){q.unshift(E);break}}if(q[0]in y)L=q[0];else{for(E in y){if(!q[0]||c.converters[E+" "+q[0]]){L=E;break}V||(V=E)}L=L||V}if(L)return L!==q[0]&&q.unshift(L),y[L]}function qi(c,g,y,w){var E,L,V,rt,q,ut={},bt=c.dataTypes.slice();if(bt[1])for(V in c.converters)ut[V.toLowerCase()]=c.converters[V];for(L=bt.shift();L;)if(c.responseFields[L]&&(y[c.responseFields[L]]=g),!q&&w&&c.dataFilter&&(g=c.dataFilter(g,c.dataType)),q=L,L=bt.shift(),L){if(L==="*")L=q;else if(q!=="*"&&q!==L){if(V=ut[q+" "+L]||ut["* "+L],!V){for(E in ut)if(rt=E.split(" "),rt[1]===L&&(V=ut[q+" "+rt[0]]||ut["* "+rt[0]],V)){V===!0?V=ut[E]:ut[E]!==!0&&(L=rt[0],bt.unshift(rt[1]));break}}if(V!==!0)if(V&&c.throws)g=V(g);else try{g=V(g)}catch(Ct){return{state:"parsererror",error:V?Ct:"No conversion from "+q+" to "+L}}}}return{state:"success",data:g}}A.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Mr.href,type:"GET",isLocal:dl.test(Mr.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Qi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":A.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(c,g){return g?qn(qn(c,A.ajaxSettings),g):qn(A.ajaxSettings,c)},ajaxPrefilter:gl(ra),ajaxTransport:gl(dr),ajax:function(c,g){typeof c=="object"&&(g=c,c=void 0),g=g||{};var y,w,E,L,V,rt,q,ut,bt,Ct,ft=A.ajaxSetup({},g),Pt=ft.context||ft,te=ft.context&&(Pt.nodeType||Pt.jquery)?A(Pt):A.event,Ie=A.Deferred(),ne=A.Callbacks("once memory"),ii=ft.statusCode||{},gi={},In={},pi="canceled",de={readyState:0,getResponseHeader:function(Me){var $e;if(q){if(!L)for(L={};$e=kh.exec(E);)L[$e[1].toLowerCase()+" "]=(L[$e[1].toLowerCase()+" "]||[]).concat($e[2]);$e=L[Me.toLowerCase()+" "]}return $e==null?null:$e.join(", ")},getAllResponseHeaders:function(){return q?E:null},setRequestHeader:function(Me,$e){return q==null&&(Me=In[Me.toLowerCase()]=In[Me.toLowerCase()]||Me,gi[Me]=$e),this},overrideMimeType:function(Me){return q==null&&(ft.mimeType=Me),this},statusCode:function(Me){var $e;if(Me)if(q)de.always(Me[de.status]);else for($e in Me)ii[$e]=[ii[$e],Me[$e]];return this},abort:function(Me){var $e=Me||pi;return y&&y.abort($e),Sr(0,$e),this}};if(Ie.promise(de),ft.url=((c||ft.url||Mr.href)+"").replace(So,Mr.protocol+"//"),ft.type=g.method||g.type||ft.method||ft.type,ft.dataTypes=(ft.dataType||"*").toLowerCase().match(We)||[""],ft.crossDomain==null){rt=qt.createElement("a");try{rt.href=ft.url,rt.href=rt.href,ft.crossDomain=oa.protocol+"//"+oa.host!=rt.protocol+"//"+rt.host}catch{ft.crossDomain=!0}}if(ft.data&&ft.processData&&typeof ft.data!="string"&&(ft.data=A.param(ft.data,ft.traditional)),ko(ra,ft,g,de),q)return de;ut=A.event&&ft.global,ut&&A.active++===0&&A.event.trigger("ajaxStart"),ft.type=ft.type.toUpperCase(),ft.hasContent=!Th.test(ft.type),w=ft.url.replace(ul,""),ft.hasContent?ft.data&&ft.processData&&(ft.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(ft.data=ft.data.replace(Mh,"+")):(Ct=ft.url.slice(w.length),ft.data&&(ft.processData||typeof ft.data=="string")&&(w+=(cs.test(w)?"&":"?")+ft.data,delete ft.data),ft.cache===!1&&(w=w.replace(Sh,"$1"),Ct=(cs.test(w)?"&":"?")+"_="+al.guid+++Ct),ft.url=w+Ct),ft.ifModified&&(A.lastModified[w]&&de.setRequestHeader("If-Modified-Since",A.lastModified[w]),A.etag[w]&&de.setRequestHeader("If-None-Match",A.etag[w])),(ft.data&&ft.hasContent&&ft.contentType!==!1||g.contentType)&&de.setRequestHeader("Content-Type",ft.contentType),de.setRequestHeader("Accept",ft.dataTypes[0]&&ft.accepts[ft.dataTypes[0]]?ft.accepts[ft.dataTypes[0]]+(ft.dataTypes[0]!=="*"?", "+Qi+"; q=0.01":""):ft.accepts["*"]);for(bt in ft.headers)de.setRequestHeader(bt,ft.headers[bt]);if(ft.beforeSend&&(ft.beforeSend.call(Pt,de,ft)===!1||q))return de.abort();if(pi="abort",ne.add(ft.complete),de.done(ft.success),de.fail(ft.error),y=ko(dr,ft,g,de),!y)Sr(-1,"No Transport");else{if(de.readyState=1,ut&&te.trigger("ajaxSend",[de,ft]),q)return de;ft.async&&ft.timeout>0&&(V=B.setTimeout(function(){de.abort("timeout")},ft.timeout));try{q=!1,y.send(gi,Sr)}catch(Me){if(q)throw Me;Sr(-1,Me)}}function Sr(Me,$e,Xr,sa){var Mn,Jr,un,jn,gr,Yi=$e;q||(q=!0,V&&B.clearTimeout(V),y=void 0,E=sa||"",de.readyState=Me>0?4:0,Mn=Me>=200&&Me<300||Me===304,Xr&&(jn=To(ft,de,Xr)),!Mn&&A.inArray("script",ft.dataTypes)>-1&&A.inArray("json",ft.dataTypes)<0&&(ft.converters["text script"]=function(){}),jn=qi(ft,jn,de,Mn),Mn?(ft.ifModified&&(gr=de.getResponseHeader("Last-Modified"),gr&&(A.lastModified[w]=gr),gr=de.getResponseHeader("etag"),gr&&(A.etag[w]=gr)),Me===204||ft.type==="HEAD"?Yi="nocontent":Me===304?Yi="notmodified":(Yi=jn.state,Jr=jn.data,un=jn.error,Mn=!un)):(un=Yi,(Me||!Yi)&&(Yi="error",Me<0&&(Me=0))),de.status=Me,de.statusText=($e||Yi)+"",Mn?Ie.resolveWith(Pt,[Jr,Yi,de]):Ie.rejectWith(Pt,[de,Yi,un]),de.statusCode(ii),ii=void 0,ut&&te.trigger(Mn?"ajaxSuccess":"ajaxError",[de,ft,Mn?Jr:un]),ne.fireWith(Pt,[de,Yi]),ut&&(te.trigger("ajaxComplete",[de,ft]),--A.active||A.event.trigger("ajaxStop")))}return de},getJSON:function(c,g,y){return A.get(c,g,y,"json")},getScript:function(c,g){return A.get(c,void 0,g,"script")}}),A.each(["get","post"],function(c,g){A[g]=function(y,w,E,L){return oe(w)&&(L=L||E,E=w,w=void 0),A.ajax(A.extend({url:y,type:g,dataType:L,data:w,success:E},A.isPlainObject(y)&&y))}}),A.ajaxPrefilter(function(c){var g;for(g in c.headers)g.toLowerCase()==="content-type"&&(c.contentType=c.headers[g]||"")}),A._evalUrl=function(c,g,y){return A.ajax({url:c,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(w){A.globalEval(w,g,y)}})},A.fn.extend({wrapAll:function(c){var g;return this[0]&&(oe(c)&&(c=c.call(this[0])),g=A(c,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&g.insertBefore(this[0]),g.map(function(){for(var y=this;y.firstElementChild;)y=y.firstElementChild;return y}).append(this)),this},wrapInner:function(c){return oe(c)?this.each(function(g){A(this).wrapInner(c.call(this,g))}):this.each(function(){var g=A(this),y=g.contents();y.length?y.wrapAll(c):g.append(c)})},wrap:function(c){var g=oe(c);return this.each(function(y){A(this).wrapAll(g?c.call(this,y):c)})},unwrap:function(c){return this.parent(c).not("body").each(function(){A(this).replaceWith(this.childNodes)}),this}}),A.expr.pseudos.hidden=function(c){return!A.expr.pseudos.visible(c)},A.expr.pseudos.visible=function(c){return!!(c.offsetWidth||c.offsetHeight||c.getClientRects().length)},A.ajaxSettings.xhr=function(){try{return new B.XMLHttpRequest}catch{}};var Hr={0:200,1223:204},No=A.ajaxSettings.xhr();re.cors=!!No&&"withCredentials"in No,re.ajax=No=!!No,A.ajaxTransport(function(c){var g,y;if(re.cors||No&&!c.crossDomain)return{send:function(w,E){var L,V=c.xhr();if(V.open(c.type,c.url,c.async,c.username,c.password),c.xhrFields)for(L in c.xhrFields)V[L]=c.xhrFields[L];c.mimeType&&V.overrideMimeType&&V.overrideMimeType(c.mimeType),!c.crossDomain&&!w["X-Requested-With"]&&(w["X-Requested-With"]="XMLHttpRequest");for(L in w)V.setRequestHeader(L,w[L]);g=function(rt){return function(){g&&(g=y=V.onload=V.onerror=V.onabort=V.ontimeout=V.onreadystatechange=null,rt==="abort"?V.abort():rt==="error"?typeof V.status!="number"?E(0,"error"):E(V.status,V.statusText):E(Hr[V.status]||V.status,V.statusText,(V.responseType||"text")!=="text"||typeof V.responseText!="string"?{binary:V.response}:{text:V.responseText},V.getAllResponseHeaders()))}},V.onload=g(),y=V.onerror=V.ontimeout=g("error"),V.onabort!==void 0?V.onabort=y:V.onreadystatechange=function(){V.readyState===4&&B.setTimeout(function(){g&&y()})},g=g("abort");try{V.send(c.hasContent&&c.data||null)}catch(rt){if(g)throw rt}},abort:function(){g&&g()}}}),A.ajaxPrefilter(function(c){c.crossDomain&&(c.contents.script=!1)}),A.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(c){return A.globalEval(c),c}}}),A.ajaxPrefilter("script",function(c){c.cache===void 0&&(c.cache=!1),c.crossDomain&&(c.type="GET")}),A.ajaxTransport("script",function(c){if(c.crossDomain||c.scriptAttrs){var g,y;return{send:function(w,E){g=A("<script>").attr(c.scriptAttrs||{}).prop({charset:c.scriptCharset,src:c.url}).on("load error",y=function(L){g.remove(),y=null,L&&E(L.type==="error"?404:200,L.type)}),qt.head.appendChild(g[0])},abort:function(){y&&y()}}}});var us=[],Wi=/(=)\?(?=&|$)|\?\?/;A.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var c=us.pop()||A.expando+"_"+al.guid++;return this[c]=!0,c}}),A.ajaxPrefilter("json jsonp",function(c,g,y){var w,E,L,V=c.jsonp!==!1&&(Wi.test(c.url)?"url":typeof c.data=="string"&&(c.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Wi.test(c.data)&&"data");if(V||c.dataTypes[0]==="jsonp")return w=c.jsonpCallback=oe(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,V?c[V]=c[V].replace(Wi,"$1"+w):c.jsonp!==!1&&(c.url+=(cs.test(c.url)?"&":"?")+c.jsonp+"="+w),c.converters["script json"]=function(){return L||A.error(w+" was not called"),L[0]},c.dataTypes[0]="json",E=B[w],B[w]=function(){L=arguments},y.always(function(){E===void 0?A(B).removeProp(w):B[w]=E,c[w]&&(c.jsonpCallback=g.jsonpCallback,us.push(w)),L&&oe(E)&&E(L[0]),L=E=void 0}),"script"}),re.createHTMLDocument=function(){var c=qt.implementation.createHTMLDocument("").body;return c.innerHTML="<form></form><form></form>",c.childNodes.length===2}(),A.parseHTML=function(c,g,y){if(typeof c!="string")return[];typeof g=="boolean"&&(y=g,g=!1);var w,E,L;return g||(re.createHTMLDocument?(g=qt.implementation.createHTMLDocument(""),w=g.createElement("base"),w.href=qt.location.href,g.head.appendChild(w)):g=qt),E=se.exec(c),L=!y&&[],E?[g.createElement(E[1])]:(E=is([c],g,L),L&&L.length&&A(L).remove(),A.merge([],E.childNodes))},A.fn.load=function(c,g,y){var w,E,L,V=this,rt=c.indexOf(" ");return rt>-1&&(w=ur(c.slice(rt)),c=c.slice(0,rt)),oe(g)?(y=g,g=void 0):g&&typeof g=="object"&&(E="POST"),V.length>0&&A.ajax({url:c,type:E||"GET",dataType:"html",data:g}).done(function(q){L=arguments,V.html(w?A("<div>").append(A.parseHTML(q)).find(w):q)}).always(y&&function(q,ut){V.each(function(){y.apply(this,L||[q.responseText,ut,q])})}),this},A.expr.pseudos.animated=function(c){return A.grep(A.timers,function(g){return c===g.elem}).length},A.offset={setOffset:function(c,g,y){var w,E,L,V,rt,q,ut,bt=A.css(c,"position"),Ct=A(c),ft={};bt==="static"&&(c.style.position="relative"),rt=Ct.offset(),L=A.css(c,"top"),q=A.css(c,"left"),ut=(bt==="absolute"||bt==="fixed")&&(L+q).indexOf("auto")>-1,ut?(w=Ct.position(),V=w.top,E=w.left):(V=parseFloat(L)||0,E=parseFloat(q)||0),oe(g)&&(g=g.call(c,y,A.extend({},rt))),g.top!=null&&(ft.top=g.top-rt.top+V),g.left!=null&&(ft.left=g.left-rt.left+E),"using"in g?g.using.call(c,ft):Ct.css(ft)}},A.fn.extend({offset:function(c){if(arguments.length)return c===void 0?this:this.each(function(E){A.offset.setOffset(this,c,E)});var g,y,w=this[0];if(w)return w.getClientRects().length?(g=w.getBoundingClientRect(),y=w.ownerDocument.defaultView,{top:g.top+y.pageYOffset,left:g.left+y.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var c,g,y,w=this[0],E={top:0,left:0};if(A.css(w,"position")==="fixed")g=w.getBoundingClientRect();else{for(g=this.offset(),y=w.ownerDocument,c=w.offsetParent||y.documentElement;c&&(c===y.body||c===y.documentElement)&&A.css(c,"position")==="static";)c=c.parentNode;c&&c!==w&&c.nodeType===1&&(E=A(c).offset(),E.top+=A.css(c,"borderTopWidth",!0),E.left+=A.css(c,"borderLeftWidth",!0))}return{top:g.top-E.top-A.css(w,"marginTop",!0),left:g.left-E.left-A.css(w,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var c=this.offsetParent;c&&A.css(c,"position")==="static";)c=c.offsetParent;return c||Ue})}}),A.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(c,g){var y=g==="pageYOffset";A.fn[c]=function(w){return nt(this,function(E,L,V){var rt;if(Rn(E)?rt=E:E.nodeType===9&&(rt=E.defaultView),V===void 0)return rt?rt[g]:E[L];rt?rt.scrollTo(y?rt.pageXOffset:V,y?V:rt.pageYOffset):E[L]=V},c,w,arguments.length)}}),A.each(["top","left"],function(c,g){A.cssHooks[g]=os(re.pixelPosition,function(y,w){if(w)return w=Ir(y,g),Ao.test(w)?A(y).position()[g]+"px":w})}),A.each({Height:"height",Width:"width"},function(c,g){A.each({padding:"inner"+c,content:g,"":"outer"+c},function(y,w){A.fn[w]=function(E,L){var V=arguments.length&&(y||typeof E!="boolean"),rt=y||(E===!0||L===!0?"margin":"border");return nt(this,function(q,ut,bt){var Ct;return Rn(q)?w.indexOf("outer")===0?q["inner"+c]:q.document.documentElement["client"+c]:q.nodeType===9?(Ct=q.documentElement,Math.max(q.body["scroll"+c],Ct["scroll"+c],q.body["offset"+c],Ct["offset"+c],Ct["client"+c])):bt===void 0?A.css(q,ut,rt):A.style(q,ut,bt,rt)},g,V?E:void 0,V)}})}),A.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(c,g){A.fn[g]=function(y){return this.on(g,y)}}),A.fn.extend({bind:function(c,g,y){return this.on(c,null,g,y)},unbind:function(c,g){return this.off(c,null,g)},delegate:function(c,g,y,w){return this.on(g,c,y,w)},undelegate:function(c,g,y){return arguments.length===1?this.off(c,"**"):this.off(g,c||"**",y)},hover:function(c,g){return this.on("mouseenter",c).on("mouseleave",g||c)}}),A.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(c,g){A.fn[g]=function(y,w){return arguments.length>0?this.on(g,null,y,w):this.trigger(g)}});var pl=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;A.proxy=function(c,g){var y,w,E;if(typeof g=="string"&&(y=c[g],g=c,c=y),!!oe(c))return w=ht.call(arguments,2),E=function(){return c.apply(g||this,w.concat(ht.call(arguments)))},E.guid=c.guid=c.guid||A.guid++,E},A.holdReady=function(c){c?A.readyWait++:A.ready(!0)},A.isArray=Array.isArray,A.parseJSON=JSON.parse,A.nodeName=Ve,A.isFunction=oe,A.isWindow=Rn,A.camelCase=Le,A.type=Ge,A.now=Date.now,A.isNumeric=function(c){var g=A.type(c);return(g==="number"||g==="string")&&!isNaN(c-parseFloat(c))},A.trim=function(c){return c==null?"":(c+"").replace(pl,"$1")};var fl=B.jQuery,Nh=B.$;return A.noConflict=function(c){return B.$===A&&(B.$=Nh),c&&B.jQuery===A&&(B.jQuery=fl),A},typeof W>"u"&&(B.jQuery=B.$=A),A})}(Hc)),Hc.exports}(function(S){(function(B){var W=typeof self=="object"&&self.self===self&&self||typeof ho=="object"&&ho.global===ho&&ho;{var R=i0,P;try{P=Tf()}catch{}B(W,S,R,P)}})(function(B,W,R,P){var ht=B.Backbone,wt=Array.prototype.slice;W.VERSION="1.4.1",W.$=P,W.noConflict=function(){return B.Backbone=ht,this},W.emulateHTTP=!1,W.emulateJSON=!1;var St=W.Events={},Xt=/\s+/,Wt,Oe=function(z,U,et,gt,nt){var It=0,Yt;if(et&&typeof et=="object")for(gt!==void 0&&("context"in nt)&&nt.context===void 0&&(nt.context=gt),Yt=R.keys(et);It<Yt.length;It++)U=Oe(z,U,Yt[It],et[Yt[It]],nt);else if(et&&Xt.test(et))for(Yt=et.split(Xt);It<Yt.length;It++)U=z(U,Yt[It],gt,nt);else U=z(U,et,gt,nt);return U};St.on=function(z,U,et){if(this._events=Oe(Ce,this._events||{},z,U,{context:et,ctx:this,listening:Wt}),Wt){var gt=this._listeners||(this._listeners={});gt[Wt.id]=Wt,Wt.interop=!1}return this},St.listenTo=function(z,U,et){if(!z)return this;var gt=z._listenId||(z._listenId=R.uniqueId("l")),nt=this._listeningTo||(this._listeningTo={}),It=Wt=nt[gt];It||(this._listenId||(this._listenId=R.uniqueId("l")),It=Wt=nt[gt]=new qt(this,z));var Yt=On(z,U,et,this);if(Wt=void 0,Yt)throw Yt;return It.interop&&It.on(U,et),this};var Ce=function(z,U,et,gt){if(et){var nt=z[U]||(z[U]=[]),It=gt.context,Yt=gt.ctx,we=gt.listening;we&&we.count++,nt.push({callback:et,context:It,ctx:It||Yt,listening:we})}return z},On=function(z,U,et,gt){try{z.on(U,et,gt)}catch(nt){return nt}};St.off=function(z,U,et){return this._events?(this._events=Oe(bn,this._events,z,U,{context:et,listeners:this._listeners}),this):this},St.stopListening=function(z,U,et){var gt=this._listeningTo;if(!gt)return this;for(var nt=z?[z._listenId]:R.keys(gt),It=0;It<nt.length;It++){var Yt=gt[nt[It]];if(!Yt)break;Yt.obj.off(U,et,this),Yt.interop&&Yt.off(U,et)}return R.isEmpty(gt)&&(this._listeningTo=void 0),this};var bn=function(z,U,et,gt){if(z){var nt=gt.context,It=gt.listeners,Yt=0,we;if(!U&&!nt&&!et){for(we=R.keys(It);Yt<we.length;Yt++)It[we[Yt]].cleanup();return}for(we=U?[U]:R.keys(z);Yt<we.length;Yt++){U=we[Yt];var Le=z[U];if(!Le)break;for(var ie=[],Je=0;Je<Le.length;Je++){var jt=Le[Je];if(et&&et!==jt.callback&&et!==jt.callback._callback||nt&&nt!==jt.context)ie.push(jt);else{var Ye=jt.listening;Ye&&Ye.off(U,et)}}ie.length?z[U]=ie:delete z[U]}return z}};St.once=function(z,U,et){var gt=Oe(re,{},z,U,this.off.bind(this));return typeof z=="string"&&et==null&&(U=void 0),this.on(gt,U,et)},St.listenToOnce=function(z,U,et){var gt=Oe(re,{},U,et,this.stopListening.bind(this,z));return this.listenTo(z,gt)};var re=function(z,U,et,gt){if(et){var nt=z[U]=R.once(function(){gt(U,nt),et.apply(this,arguments)});nt._callback=et}return z};St.trigger=function(z){if(!this._events)return this;for(var U=Math.max(0,arguments.length-1),et=Array(U),gt=0;gt<U;gt++)et[gt]=arguments[gt+1];return Oe(oe,this._events,z,void 0,et),this};var oe=function(z,U,et,gt){if(z){var nt=z[U],It=z.all;nt&&It&&(It=It.slice()),nt&&Rn(nt,gt),It&&Rn(It,[U].concat(gt))}return z},Rn=function(z,U){var et,gt=-1,nt=z.length,It=U[0],Yt=U[1],we=U[2];switch(U.length){case 0:for(;++gt<nt;)(et=z[gt]).callback.call(et.ctx);return;case 1:for(;++gt<nt;)(et=z[gt]).callback.call(et.ctx,It);return;case 2:for(;++gt<nt;)(et=z[gt]).callback.call(et.ctx,It,Yt);return;case 3:for(;++gt<nt;)(et=z[gt]).callback.call(et.ctx,It,Yt,we);return;default:for(;++gt<nt;)(et=z[gt]).callback.apply(et.ctx,U);return}},qt=function(z,U){this.id=z._listenId,this.listener=z,this.obj=U,this.interop=!0,this.count=0,this._events=void 0};qt.prototype.on=St.on,qt.prototype.off=function(z,U){var et;this.interop?(this._events=Oe(bn,this._events,z,U,{context:void 0,listeners:void 0}),et=!this._events):(this.count--,et=this.count===0),et&&this.cleanup()},qt.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},St.bind=St.on,St.unbind=St.off,R.extend(W,St);var yr=W.Model=function(z,U){var et=z||{};U||(U={}),this.preinitialize.apply(this,arguments),this.cid=R.uniqueId(this.cidPrefix),this.attributes={},U.collection&&(this.collection=U.collection),U.parse&&(et=this.parse(et,U)||{});var gt=R.result(this,"defaults");et=R.defaults(R.extend({},gt,et),gt),this.set(et,U),this.changed={},this.initialize.apply(this,arguments)};R.extend(yr.prototype,St,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(z){return R.clone(this.attributes)},sync:function(){return W.sync.apply(this,arguments)},get:function(z){return this.attributes[z]},escape:function(z){return R.escape(this.get(z))},has:function(z){return this.get(z)!=null},matches:function(z){return!!R.iteratee(z,this)(this.attributes)},set:function(z,U,et){if(z==null)return this;var gt;if(typeof z=="object"?(gt=z,et=U):(gt={})[z]=U,et||(et={}),!this._validate(gt,et))return!1;var nt=et.unset,It=et.silent,Yt=[],we=this._changing;this._changing=!0,we||(this._previousAttributes=R.clone(this.attributes),this.changed={});var Le=this.attributes,ie=this.changed,Je=this._previousAttributes;for(var jt in gt)U=gt[jt],R.isEqual(Le[jt],U)||Yt.push(jt),R.isEqual(Je[jt],U)?delete ie[jt]:ie[jt]=U,nt?delete Le[jt]:Le[jt]=U;if(this.idAttribute in gt){var Ye=this.id;this.id=this.get(this.idAttribute),this.trigger("changeId",this,Ye,et)}if(!It){Yt.length&&(this._pending=et);for(var An=0;An<Yt.length;An++)this.trigger("change:"+Yt[An],this,Le[Yt[An]],et)}if(we)return this;if(!It)for(;this._pending;)et=this._pending,this._pending=!1,this.trigger("change",this,et);return this._pending=!1,this._changing=!1,this},unset:function(z,U){return this.set(z,void 0,R.extend({},U,{unset:!0}))},clear:function(z){var U={};for(var et in this.attributes)U[et]=void 0;return this.set(U,R.extend({},z,{unset:!0}))},hasChanged:function(z){return z==null?!R.isEmpty(this.changed):R.has(this.changed,z)},changedAttributes:function(z){if(!z)return this.hasChanged()?R.clone(this.changed):!1;var U=this._changing?this._previousAttributes:this.attributes,et={},gt;for(var nt in z){var It=z[nt];R.isEqual(U[nt],It)||(et[nt]=It,gt=!0)}return gt?et:!1},previous:function(z){return z==null||!this._previousAttributes?null:this._previousAttributes[z]},previousAttributes:function(){return R.clone(this._previousAttributes)},fetch:function(z){z=R.extend({parse:!0},z);var U=this,et=z.success;return z.success=function(gt){var nt=z.parse?U.parse(gt,z):gt;if(!U.set(nt,z))return!1;et&&et.call(z.context,U,gt,z),U.trigger("sync",U,gt,z)},$n(this,z),this.sync("read",this,z)},save:function(z,U,et){var gt;z==null||typeof z=="object"?(gt=z,et=U):(gt={})[z]=U,et=R.extend({validate:!0,parse:!0},et);var nt=et.wait;if(gt&&!nt){if(!this.set(gt,et))return!1}else if(!this._validate(gt,et))return!1;var It=this,Yt=et.success,we=this.attributes;et.success=function(Je){It.attributes=we;var jt=et.parse?It.parse(Je,et):Je;if(nt&&(jt=R.extend({},gt,jt)),jt&&!It.set(jt,et))return!1;Yt&&Yt.call(et.context,It,Je,et),It.trigger("sync",It,Je,et)},$n(this,et),gt&&nt&&(this.attributes=R.extend({},we,gt));var Le=this.isNew()?"create":et.patch?"patch":"update";Le==="patch"&&!et.attrs&&(et.attrs=gt);var ie=this.sync(Le,this,et);return this.attributes=we,ie},destroy:function(z){z=z?R.clone(z):{};var U=this,et=z.success,gt=z.wait,nt=function(){U.stopListening(),U.trigger("destroy",U,U.collection,z)};z.success=function(Yt){gt&&nt(),et&&et.call(z.context,U,Yt,z),U.isNew()||U.trigger("sync",U,Yt,z)};var It=!1;return this.isNew()?R.defer(z.success):($n(this,z),It=this.sync("delete",this,z)),gt||nt(),It},url:function(){var z=R.result(this,"urlRoot")||R.result(this.collection,"url")||Jn();if(this.isNew())return z;var U=this.get(this.idAttribute);return z.replace(/[^\/]$/,"$&/")+encodeURIComponent(U)},parse:function(z,U){return z},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(z){return this._validate({},R.extend({},z,{validate:!0}))},_validate:function(z,U){if(!U.validate||!this.validate)return!0;z=R.extend({},this.attributes,z);var et=this.validationError=this.validate(z,U)||null;return et?(this.trigger("invalid",this,et,R.extend(U,{validationError:et})),!1):!0}});var Hn=W.Collection=function(z,U){U||(U={}),this.preinitialize.apply(this,arguments),U.model&&(this.model=U.model),U.comparator!==void 0&&(this.comparator=U.comparator),this._reset(),this.initialize.apply(this,arguments),z&&this.reset(z,R.extend({silent:!0},U))},Ge={add:!0,remove:!0,merge:!0},Xe={add:!0,remove:!1},Qe=function(z,U,et){et=Math.min(Math.max(et,0),z.length);var gt=Array(z.length-et),nt=U.length,It;for(It=0;It<gt.length;It++)gt[It]=z[It+et];for(It=0;It<nt;It++)z[It+et]=U[It];for(It=0;It<gt.length;It++)z[It+nt+et]=gt[It]};R.extend(Hn.prototype,St,{model:yr,preinitialize:function(){},initialize:function(){},toJSON:function(z){return this.map(function(U){return U.toJSON(z)})},sync:function(){return W.sync.apply(this,arguments)},add:function(z,U){return this.set(z,R.extend({merge:!1},U,Xe))},remove:function(z,U){U=R.extend({},U);var et=!R.isArray(z);z=et?[z]:z.slice();var gt=this._removeModels(z,U);return!U.silent&&gt.length&&(U.changes={added:[],merged:[],removed:gt},this.trigger("update",this,U)),et?gt[0]:gt},set:function(z,U){if(z!=null){U=R.extend({},Ge,U),U.parse&&!this._isModel(z)&&(z=this.parse(z,U)||[]);var et=!R.isArray(z);z=et?[z]:z.slice();var gt=U.at;gt!=null&&(gt=+gt),gt>this.length&&(gt=this.length),gt<0&&(gt+=this.length+1);var nt=[],It=[],Yt=[],we=[],Le={},ie=U.add,Je=U.merge,jt=U.remove,Ye=!1,An=this.comparator&&gt==null&&U.sort!==!1,vo=R.isString(this.comparator)?this.comparator:null,$t,ui;for(ui=0;ui<z.length;ui++){$t=z[ui];var Mi=this.get($t);if(Mi){if(Je&&$t!==Mi){var At=this._isModel($t)?$t.attributes:$t;U.parse&&(At=Mi.parse(At,U)),Mi.set(At,U),Yt.push(Mi),An&&!Ye&&(Ye=Mi.hasChanged(vo))}Le[Mi.cid]||(Le[Mi.cid]=!0,nt.push(Mi)),z[ui]=Mi}else ie&&($t=z[ui]=this._prepareModel($t,U),$t&&(It.push($t),this._addReference($t,U),Le[$t.cid]=!0,nt.push($t)))}if(jt){for(ui=0;ui<this.length;ui++)$t=this.models[ui],Le[$t.cid]||we.push($t);we.length&&this._removeModels(we,U)}var ei=!1,Ue=!An&&ie&&jt;if(nt.length&&Ue?(ei=this.length!==nt.length||R.some(this.models,function(si,Kn){return si!==nt[Kn]}),this.models.length=0,Qe(this.models,nt,0),this.length=this.models.length):It.length&&(An&&(Ye=!0),Qe(this.models,It,gt??this.length),this.length=this.models.length),Ye&&this.sort({silent:!0}),!U.silent){for(ui=0;ui<It.length;ui++)gt!=null&&(U.index=gt+ui),$t=It[ui],$t.trigger("add",$t,this,U);(Ye||ei)&&this.trigger("sort",this,U),(It.length||we.length||Yt.length)&&(U.changes={added:It,removed:we,merged:Yt},this.trigger("update",this,U))}return et?z[0]:z}},reset:function(z,U){U=U?R.clone(U):{};for(var et=0;et<this.models.length;et++)this._removeReference(this.models[et],U);return U.previousModels=this.models,this._reset(),z=this.add(z,R.extend({silent:!0},U)),U.silent||this.trigger("reset",this,U),z},push:function(z,U){return this.add(z,R.extend({at:this.length},U))},pop:function(z){var U=this.at(this.length-1);return this.remove(U,z)},unshift:function(z,U){return this.add(z,R.extend({at:0},U))},shift:function(z){var U=this.at(0);return this.remove(U,z)},slice:function(){return wt.apply(this.models,arguments)},get:function(z){if(z!=null)return this._byId[z]||this._byId[this.modelId(this._isModel(z)?z.attributes:z,z.idAttribute)]||z.cid&&this._byId[z.cid]},has:function(z){return this.get(z)!=null},at:function(z){return z<0&&(z+=this.length),this.models[z]},where:function(z,U){return this[U?"find":"filter"](z)},findWhere:function(z){return this.where(z,!0)},sort:function(z){var U=this.comparator;if(!U)throw new Error("Cannot sort a set without a comparator");z||(z={});var et=U.length;return R.isFunction(U)&&(U=U.bind(this)),et===1||R.isString(U)?this.models=this.sortBy(U):this.models.sort(U),z.silent||this.trigger("sort",this,z),this},pluck:function(z){return this.map(z+"")},fetch:function(z){z=R.extend({parse:!0},z);var U=z.success,et=this;return z.success=function(gt){var nt=z.reset?"reset":"set";et[nt](gt,z),U&&U.call(z.context,et,gt,z),et.trigger("sync",et,gt,z)},$n(this,z),this.sync("read",this,z)},create:function(z,U){U=U?R.clone(U):{};var et=U.wait;if(z=this._prepareModel(z,U),!z)return!1;et||this.add(z,U);var gt=this,nt=U.success;return U.success=function(It,Yt,we){et&&gt.add(It,we),nt&&nt.call(we.context,It,Yt,we)},z.save(null,U),z},parse:function(z,U){return z},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(z,U){return z[U||this.model.prototype.idAttribute||"id"]},values:function(){return new xn(this,Ve)},keys:function(){return new xn(this,le)},entries:function(){return new xn(this,Or)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(z,U){if(this._isModel(z))return z.collection||(z.collection=this),z;U=U?R.clone(U):{},U.collection=this;var et;return this.model.prototype?et=new this.model(z,U):et=this.model(z,U),et.validationError?(this.trigger("invalid",this,et.validationError,U),!1):et},_removeModels:function(z,U){for(var et=[],gt=0;gt<z.length;gt++){var nt=this.get(z[gt]);if(nt){var It=this.indexOf(nt);this.models.splice(It,1),this.length--,delete this._byId[nt.cid];var Yt=this.modelId(nt.attributes,nt.idAttribute);Yt!=null&&delete this._byId[Yt],U.silent||(U.index=It,nt.trigger("remove",nt,this,U)),et.push(nt),this._removeReference(nt,U)}}return et},_isModel:function(z){return z instanceof yr},_addReference:function(z,U){this._byId[z.cid]=z;var et=this.modelId(z.attributes,z.idAttribute);et!=null&&(this._byId[et]=z),z.on("all",this._onModelEvent,this)},_removeReference:function(z,U){delete this._byId[z.cid];var et=this.modelId(z.attributes,z.idAttribute);et!=null&&delete this._byId[et],this===z.collection&&delete z.collection,z.off("all",this._onModelEvent,this)},_onModelEvent:function(z,U,et,gt){if(U){if((z==="add"||z==="remove")&&et!==this)return;if(z==="destroy"&&this.remove(U,gt),z==="changeId"){var nt=this.modelId(U.previousAttributes(),U.idAttribute),It=this.modelId(U.attributes,U.idAttribute);nt!=null&&delete this._byId[nt],It!=null&&(this._byId[It]=U)}}this.trigger.apply(this,arguments)}});var A=typeof Symbol=="function"&&Symbol.iterator;A&&(Hn.prototype[A]=Hn.prototype.values);var xn=function(z,U){this._collection=z,this._kind=U,this._index=0},Ve=1,le=2,Or=3;A&&(xn.prototype[A]=function(){return this}),xn.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var z=this._collection.at(this._index);this._index++;var U;if(this._kind===Ve)U=z;else{var et=this._collection.modelId(z.attributes,z.idAttribute);this._kind===le?U=et:U=[et,z]}return{value:U,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var Rr=W.View=function(z){this.cid=R.uniqueId("view"),this.preinitialize.apply(this,arguments),R.extend(this,R.pick(z,sr)),this._ensureElement(),this.initialize.apply(this,arguments)},Ee=/^(\S+)\s*(.*)$/,sr=["model","collection","el","id","attributes","className","tagName","events"];R.extend(Rr.prototype,St,{tagName:"div",$:function(z){return this.$el.find(z)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(z){return this.undelegateEvents(),this._setElement(z),this.delegateEvents(),this},_setElement:function(z){this.$el=z instanceof W.$?z:W.$(z),this.el=this.$el[0]},delegateEvents:function(z){if(z||(z=R.result(this,"events")),!z)return this;this.undelegateEvents();for(var U in z){var et=z[U];if(R.isFunction(et)||(et=this[et]),!!et){var gt=U.match(Ee);this.delegate(gt[1],gt[2],et.bind(this))}}return this},delegate:function(z,U,et){return this.$el.on(z+".delegateEvents"+this.cid,U,et),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(z,U,et){return this.$el.off(z+".delegateEvents"+this.cid,U,et),this},_createElement:function(z){return document.createElement(z)},_ensureElement:function(){if(this.el)this.setElement(R.result(this,"el"));else{var z=R.extend({},R.result(this,"attributes"));this.id&&(z.id=R.result(this,"id")),this.className&&(z.class=R.result(this,"className")),this.setElement(this._createElement(R.result(this,"tagName"))),this._setAttributes(z)}},_setAttributes:function(z){this.$el.attr(z)}});var Ko=function(z,U,et,gt){switch(U){case 1:return function(){return z[et](this[gt])};case 2:return function(nt){return z[et](this[gt],nt)};case 3:return function(nt,It){return z[et](this[gt],hn(nt,this),It)};case 4:return function(nt,It,Yt){return z[et](this[gt],hn(nt,this),It,Yt)};default:return function(){var nt=wt.call(arguments);return nt.unshift(this[gt]),z[et].apply(z,nt)}}},fo=function(z,U,et,gt){R.each(et,function(nt,It){U[It]&&(z.prototype[It]=Ko(U,nt,It,gt))})},hn=function(z,U){return R.isFunction(z)?z:R.isObject(z)&&!U._isModel(z)?jr(z):R.isString(z)?function(et){return et.get(z)}:z},jr=function(z){var U=R.matches(z);return function(et){return U(et.attributes)}},ar={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},mo={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};R.each([[Hn,ar,"models"],[yr,mo,"attributes"]],function(z){var U=z[0],et=z[1],gt=z[2];U.mixin=function(nt){var It=R.reduce(R.functions(nt),function(Yt,we){return Yt[we]=0,Yt},{});fo(U,nt,It,gt)},fo(U,R,et,gt)}),W.sync=function(z,U,et){var gt=Q[z];R.defaults(et||(et={}),{emulateHTTP:W.emulateHTTP,emulateJSON:W.emulateJSON});var nt={type:gt,dataType:"json"};if(et.url||(nt.url=R.result(U,"url")||Jn()),et.data==null&&U&&(z==="create"||z==="update"||z==="patch")&&(nt.contentType="application/json",nt.data=JSON.stringify(et.attrs||U.toJSON(et))),et.emulateJSON&&(nt.contentType="application/x-www-form-urlencoded",nt.data=nt.data?{model:nt.data}:{}),et.emulateHTTP&&(gt==="PUT"||gt==="DELETE"||gt==="PATCH")){nt.type="POST",et.emulateJSON&&(nt.data._method=gt);var It=et.beforeSend;et.beforeSend=function(Le){if(Le.setRequestHeader("X-HTTP-Method-Override",gt),It)return It.apply(this,arguments)}}nt.type!=="GET"&&!et.emulateJSON&&(nt.processData=!1);var Yt=et.error;et.error=function(Le,ie,Je){et.textStatus=ie,et.errorThrown=Je,Yt&&Yt.call(et.context,Le,ie,Je)};var we=et.xhr=W.ajax(R.extend(nt,et));return U.trigger("request",U,we,et),we};var Q={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};W.ajax=function(){return W.$.ajax.apply(W.$,arguments)};var se=W.Router=function(z){z||(z={}),this.preinitialize.apply(this,arguments),z.routes&&(this.routes=z.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},br=/\((.*?)\)/g,Gr=/(\(\?)?:\w+/g,Ot=/\*\w+/g,Xn=/[\-{}\[\]+?.,\\\^$|#\s]/g;R.extend(se.prototype,St,{preinitialize:function(){},initialize:function(){},route:function(z,U,et){R.isRegExp(z)||(z=this._routeToRegExp(z)),R.isFunction(U)&&(et=U,U=""),et||(et=this[U]);var gt=this;return W.history.route(z,function(nt){var It=gt._extractParameters(z,nt);gt.execute(et,It,U)!==!1&&(gt.trigger.apply(gt,["route:"+U].concat(It)),gt.trigger("route",U,It),W.history.trigger("route",gt,U,It))}),this},execute:function(z,U,et){z&&z.apply(this,U)},navigate:function(z,U){return W.history.navigate(z,U),this},_bindRoutes:function(){if(this.routes){this.routes=R.result(this,"routes");for(var z,U=R.keys(this.routes);(z=U.pop())!=null;)this.route(z,this.routes[z])}},_routeToRegExp:function(z){return z=z.replace(Xn,"\\$&").replace(br,"(?:$1)?").replace(Gr,function(U,et){return et?U:"([^/?]+)"}).replace(Ot,"([^?]*?)"),new RegExp("^"+z+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(z,U){var et=z.exec(U).slice(1);return R.map(et,function(gt,nt){return nt===et.length-1?gt||null:gt?decodeURIComponent(gt):null})}});var wn=W.History=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),typeof window<"u"&&(this.location=window.location,this.history=window.history)},Vr=/^[#\/]|\s+$/g,Qo=/^\/+|\/+$/g,We=/#.*$/;wn.started=!1,R.extend(wn.prototype,St,{interval:50,atRoot:function(){var z=this.location.pathname.replace(/[^\/]$/,"$&/");return z===this.root&&!this.getSearch()},matchRoot:function(){var z=this.decodeFragment(this.location.pathname),U=z.slice(0,this.root.length-1)+"/";return U===this.root},decodeFragment:function(z){return decodeURI(z.replace(/%25/g,"%2525"))},getSearch:function(){var z=this.location.href.replace(/#.*/,"").match(/\?.+/);return z?z[0]:""},getHash:function(z){var U=(z||this).location.href.match(/#(.*)$/);return U?U[1]:""},getPath:function(){var z=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return z.charAt(0)==="/"?z.slice(1):z},getFragment:function(z){return z==null&&(this._usePushState||!this._wantsHashChange?z=this.getPath():z=this.getHash()),z.replace(Vr,"")},start:function(z){if(wn.started)throw new Error("Backbone.history has already been started");if(wn.started=!0,this.options=R.extend({root:"/"},this.options,z),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(document.documentMode===void 0||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.history&&this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(Qo,"/"),this._wantsHashChange&&this._wantsPushState)if(!this._hasPushState&&!this.atRoot()){var U=this.root.slice(0,-1)||"/";return this.location.replace(U+"#"+this.getPath()),!0}else this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0});if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var et=document.body,gt=et.insertBefore(this.iframe,et.firstChild).contentWindow;gt.document.open(),gt.document.close(),gt.location.hash="#"+this.fragment}var nt=window.addEventListener||function(It,Yt){return attachEvent("on"+It,Yt)};if(this._usePushState?nt("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?nt("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var z=window.removeEventListener||function(U,et){return detachEvent("on"+U,et)};this._usePushState?z("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&z("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),wn.started=!1},route:function(z,U){this.handlers.unshift({route:z,callback:U})},checkUrl:function(z){var U=this.getFragment();if(U===this.fragment&&this.iframe&&(U=this.getHash(this.iframe.contentWindow)),U===this.fragment)return!1;this.iframe&&this.navigate(U),this.loadUrl()},loadUrl:function(z){return this.matchRoot()?(z=this.fragment=this.getFragment(z),R.some(this.handlers,function(U){if(U.route.test(z))return U.callback(z),!0})):!1},navigate:function(z,U){if(!wn.started)return!1;(!U||U===!0)&&(U={trigger:!!U}),z=this.getFragment(z||"");var et=this.root;(z===""||z.charAt(0)==="?")&&(et=et.slice(0,-1)||"/");var gt=et+z;z=z.replace(We,"");var nt=this.decodeFragment(z);if(this.fragment!==nt){if(this.fragment=nt,this._usePushState)this.history[U.replace?"replaceState":"pushState"]({},document.title,gt);else if(this._wantsHashChange){if(this._updateHash(this.location,z,U.replace),this.iframe&&z!==this.getHash(this.iframe.contentWindow)){var It=this.iframe.contentWindow;U.replace||(It.document.open(),It.document.close()),this._updateHash(It.location,z,U.replace)}}else return this.location.assign(gt);if(U.trigger)return this.loadUrl(z)}},_updateHash:function(z,U,et){if(et){var gt=z.href.replace(/(javascript:|#).*$/,"");z.replace(gt+"#"+U)}else z.hash="#"+U}}),W.history=new wn;var qo=function(z,U){var et=this,gt;return z&&R.has(z,"constructor")?gt=z.constructor:gt=function(){return et.apply(this,arguments)},R.extend(gt,et,U),gt.prototype=R.create(et.prototype,z),gt.prototype.constructor=gt,gt.__super__=et.prototype,gt};yr.extend=Hn.extend=se.extend=Rr.extend=wn.extend=qo;var Jn=function(){throw new Error('A "url" property or function must be specified')},$n=function(z,U){var et=U.error;U.error=function(gt){et&&et.call(U.context,z,gt,U),z.trigger("error",z,gt,U)}};return W})})(tp);var Kc={exports:{}};(function(S,B){(function(W,R){R(B,tp,Tf())})(ho,function(W,R,P){R=R&&Object.prototype.hasOwnProperty.call(R,"default")?R.default:R,P=P&&Object.prototype.hasOwnProperty.call(P,"default")?P.default:P;var ht=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ho<"u"?ho:typeof self<"u"?self:{};function wt(t){this.ok=!1,this.alpha=1,t=(t=(t=t.charAt(0)=="#"?t.substr(1,6):t).replace(/ /g,"")).toLowerCase();for(var e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},i=(t=e[t]||t,[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(s){return[parseInt(s[1]),parseInt(s[2]),parseInt(s[3]),parseFloat(s[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(s){return[parseInt(s[1]),parseInt(s[2]),parseInt(s[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(s){return[parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(s){return[parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16),parseInt(s[3]+s[3],16)]}}]),n=0;n<i.length;n++){var o=i[n].re,r=i[n].process,o=o.exec(t);o&&(r=r(o),this.r=r[0],this.g=r[1],this.b=r[2],3<r.length&&(this.alpha=r[3]),this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:255<this.r?255:this.r,this.g=this.g<0||isNaN(this.g)?0:255<this.g?255:this.g,this.b=this.b<0||isNaN(this.b)?0:255<this.b?255:this.b,this.alpha=this.alpha<0?0:1<this.alpha||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var s=this.r.toString(16),a=this.g.toString(16),l=this.b.toString(16);return"#"+(s=s.length==1?"0"+s:s)+(a=a.length==1?"0"+a:a)+(l=l.length==1?"0"+l:l)},this.getHelpXML=function(){for(var s,a=new Array,l=0;l<i.length;l++)for(var h=i[l].example,u=0;u<h.length;u++)a[a.length]=h[u];for(s in e)a[a.length]=s;var d=document.createElement("ul");for(d.setAttribute("id","rgbcolor-examples"),l=0;l<a.length;l++)try{var p=document.createElement("li"),m=new RGBColor(a[l]),v=document.createElement("div"),k=(v.style.cssText="margin: 3px; border: 1px solid black; background:"+m.toHex()+"; color:"+m.toHex(),v.appendChild(document.createTextNode("test")),document.createTextNode(" "+a[l]+" -> "+m.toRGB()+" -> "+m.toHex()));p.appendChild(v),p.appendChild(k),d.appendChild(p)}catch{}return d}}var St=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],Xt=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function Wt(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}function Oe(t,e,i,n){if(!(isNaN(n)||n<1)){for(var r,o,s,a,l,h,u,d,p,m,v,k,I,N,G,F,H,Y,_,K,tt,b=(n|=0)+n+1,vt=e-1,O=i-1,M=n+1,T=M*(M+1)/2,j=new Wt,f=j,x=1;x<b;x++){var C,f=f.next=new Wt;x==M&&(C=f)}f.next=j;for(var D=null,Z=null,it=a=0,st=St[n],lt=Xt[n],at=0;at<i;at++){for(I=N=G=F=l=h=u=d=0,p=M*(H=t[a]),m=M*(Y=t[a+1]),v=M*(_=t[a+2]),k=M*(K=t[a+3]),l+=T*H,h+=T*Y,u+=T*_,d+=T*K,f=j,x=0;x<M;x++)f.r=H,f.g=Y,f.b=_,f.a=K,f=f.next;for(x=1;x<M;x++)l+=(f.r=H=t[o=a+((vt<x?vt:x)<<2)])*(tt=M-x),h+=(f.g=Y=t[o+1])*tt,u+=(f.b=_=t[o+2])*tt,d+=(f.a=K=t[o+3])*tt,I+=H,N+=Y,G+=_,F+=K,f=f.next;for(D=j,Z=C,r=0;r<e;r++)t[a+3]=K=d*st>>lt,K!=0?(t[a]=(l*st>>lt)*(K=255/K),t[a+1]=(h*st>>lt)*K,t[a+2]=(u*st>>lt)*K):t[a]=t[a+1]=t[a+2]=0,l-=p,h-=m,u-=v,d-=k,p-=D.r,m-=D.g,v-=D.b,k-=D.a,o=it+((o=r+n+1)<vt?o:vt)<<2,l+=I+=D.r=t[o],h+=N+=D.g=t[o+1],u+=G+=D.b=t[o+2],d+=F+=D.a=t[o+3],D=D.next,p+=H=Z.r,m+=Y=Z.g,v+=_=Z.b,k+=K=Z.a,I-=H,N-=Y,G-=_,F-=K,Z=Z.next,a+=4;it+=e}for(r=0;r<e;r++){for(N=G=F=I=h=u=d=l=0,p=M*(H=t[a=r<<2]),m=M*(Y=t[a+1]),v=M*(_=t[a+2]),k=M*(K=t[a+3]),l+=T*H,h+=T*Y,u+=T*_,d+=T*K,f=j,x=0;x<M;x++)f.r=H,f.g=Y,f.b=_,f.a=K,f=f.next;for(s=e,x=1;x<=n;x++)l+=(f.r=H=t[a=s+r<<2])*(tt=M-x),h+=(f.g=Y=t[a+1])*tt,u+=(f.b=_=t[a+2])*tt,d+=(f.a=K=t[a+3])*tt,I+=H,N+=Y,G+=_,F+=K,f=f.next,x<O&&(s+=e);for(a=r,D=j,Z=C,at=0;at<i;at++)t[(o=a<<2)+3]=K=d*st>>lt,0<K?(t[o]=(l*st>>lt)*(K=255/K),t[o+1]=(h*st>>lt)*K,t[o+2]=(u*st>>lt)*K):t[o]=t[o+1]=t[o+2]=0,l-=p,h-=m,u-=v,d-=k,p-=D.r,m-=D.g,v-=D.b,k-=D.a,o=r+((o=at+M)<O?o:O)*e<<2,l+=I+=D.r=t[o],h+=N+=D.g=t[o+1],u+=G+=D.b=t[o+2],d+=F+=D.a=t[o+3],D=D.next,p+=H=Z.r,m+=Y=Z.g,v+=_=Z.b,k+=K=Z.a,I-=H,N-=Y,G-=_,F-=K,Z=Z.next,a+=e}}}(function(t){var e,i,n,r;e=typeof window<"u"?window:ht,i=function(o,s){var a,l,h,u,d,p,m,v,k;if(typeof Element<"u")return a=function(I,N,G){if(I==null&&N==null&&G==null)for(var F=document.querySelectorAll("svg"),H=0;H<F.length;H++){var Y=F[H],_=document.createElement("canvas"),K=(_.width=Y.clientWidth,_.height=Y.clientHeight,Y.parentNode.insertBefore(_,Y),Y.parentNode.removeChild(Y),document.createElement("div"));K.appendChild(Y),a(_,K.innerHTML)}else(I=typeof I=="string"?document.getElementById(I):I).svg!=null&&I.svg.stop(),G=function(tt){var b={opts:tt,FRAMERATE:30,MAX_VIRTUAL_PIXELS:3e4,log:function(O){}};b.opts.log==1&&typeof console<"u"&&(b.log=function(O){console.log(O)}),b.init=function(O){var M=0;b.UniqueId=function(){return"canvg"+ ++M},b.Definitions={},b.Styles={},b.StylesSpecificity={},b.Animations=[],b.Images=[],b.ctx=O,b.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(T,j){this.viewPorts.push({width:T,height:j})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(T){return T!=null&&typeof T=="number"?T:T=="x"?this.width():T=="y"?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},b.init(),b.ImagesLoaded=function(){for(var O=0;O<b.Images.length;O++)if(!b.Images[O].loaded)return!1;return!0},b.trim=function(O){return O.replace(/^\s+|\s+$/g,"")},b.compressSpaces=function(O){return O.replace(/[\s\r\t\n]+/gm," ")},b.ajax=function(O){var M=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return M?(M.open("GET",O,!1),M.send(null),M.responseText):null},b.parseXml=function(O){var M,T;if(typeof Windows<"u"&&Windows.Data!==void 0&&Windows.Data.Xml!==void 0)return T=new Windows.Data.Xml.Dom.XmlDocument,(M=new Windows.Data.Xml.Dom.XmlLoadSettings).prohibitDtd=!1,T.loadXml(O,M),T;if(!window.DOMParser)return O=O.replace(/<!DOCTYPE svg[^>]*>/,""),(T=new ActiveXObject("Microsoft.XMLDOM")).async="false",T.loadXML(O),T;try{var j=new DOMParser;return j.parseFromString(O,"image/svg+xml")}catch{return(j=new DOMParser).parseFromString(O,"text/xml")}},b.Property=function(O,M){this.name=O,this.value=M},b.Property.prototype.getValue=function(){return this.value},b.Property.prototype.hasValue=function(){return this.value!=null&&this.value!==""},b.Property.prototype.numValue=function(){var O;return this.hasValue()?(O=parseFloat(this.value),(this.value+"").match(/%$/)&&(O/=100),O):0},b.Property.prototype.valueOrDefault=function(O){return this.hasValue()?this.value:O},b.Property.prototype.numValueOrDefault=function(O){return this.hasValue()?this.numValue():O},b.Property.prototype.addOpacity=function(O){var M,T=this.value;return O.value!=null&&O.value!=""&&typeof this.value=="string"&&(M=new o(this.value)).ok&&(T="rgba("+M.r+", "+M.g+", "+M.b+", "+O.numValue()+")"),new b.Property(this.name,T)},b.Property.prototype.getDefinition=function(){var O=this.value.match(/#([^\)'"]+)/);return O=(O=O&&O[1])||this.value,b.Definitions[O]},b.Property.prototype.isUrlDefinition=function(){return this.value.indexOf("url(")==0},b.Property.prototype.getFillStyleDefinition=function(O,M){var T=this.getDefinition();return T!=null&&T.createGradient?T.createGradient(b.ctx,O,M):T!=null&&T.createPattern?(T.getHrefAttribute().hasValue()&&(M=T.attribute("patternTransform"),T=T.getHrefAttribute().getDefinition(),M.hasValue()&&(T.attribute("patternTransform",!0).value=M.value)),T.createPattern(b.ctx,O)):null},b.Property.prototype.getDPI=function(O){return 96},b.Property.prototype.getEM=function(O){var M=12,T=new b.Property("fontSize",b.Font.Parse(b.ctx.font).fontSize);return M=T.hasValue()?T.toPixels(O):M},b.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")},b.Property.prototype.toPixels=function(O,M){var T;return this.hasValue()?(T=this.value+"").match(/em$/)?this.numValue()*this.getEM(O):T.match(/ex$/)?this.numValue()*this.getEM(O)/2:T.match(/px$/)?this.numValue():T.match(/pt$/)?this.numValue()*this.getDPI(O)*(1/72):T.match(/pc$/)?15*this.numValue():T.match(/cm$/)?this.numValue()*this.getDPI(O)/2.54:T.match(/mm$/)?this.numValue()*this.getDPI(O)/25.4:T.match(/in$/)?this.numValue()*this.getDPI(O):T.match(/%$/)?this.numValue()*b.ViewPort.ComputeSize(O):(T=this.numValue(),M&&T<1?T*b.ViewPort.ComputeSize(O):T):0},b.Property.prototype.toMilliseconds=function(){var O;return this.hasValue()?(O=this.value+"").match(/s$/)?1e3*this.numValue():(O.match(/ms$/),this.numValue()):0},b.Property.prototype.toRadians=function(){var O;return this.hasValue()?(O=this.value+"").match(/deg$/)?this.numValue()*(Math.PI/180):O.match(/grad$/)?this.numValue()*(Math.PI/200):O.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180):0};var vt={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return b.Property.prototype.toTextBaseline=function(){return this.hasValue()?vt[this.value]:null},b.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(M,T,j,f,x,C){return C=C!=null?this.Parse(C):this.CreateFont("","","","","",b.ctx.font),{fontFamily:x||C.fontFamily,fontSize:f||C.fontSize,fontStyle:M||C.fontStyle,fontWeight:j||C.fontWeight,fontVariant:T||C.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var O=this;this.Parse=function(M){for(var T={},j=b.trim(b.compressSpaces(M||"")).split(" "),f={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},x="",C=0;C<j.length;C++)f.fontStyle||O.Styles.indexOf(j[C])==-1?f.fontVariant||O.Variants.indexOf(j[C])==-1?f.fontWeight||O.Weights.indexOf(j[C])==-1?f.fontSize?j[C]!="inherit"&&(x+=j[C]):(j[C]!="inherit"&&(T.fontSize=j[C].split("/")[0]),f.fontStyle=f.fontVariant=f.fontWeight=f.fontSize=!0):(j[C]!="inherit"&&(T.fontWeight=j[C]),f.fontStyle=f.fontVariant=f.fontWeight=!0):(j[C]!="inherit"&&(T.fontVariant=j[C]),f.fontStyle=f.fontVariant=!0):(j[C]!="inherit"&&(T.fontStyle=j[C]),f.fontStyle=!0);return x!=""&&(T.fontFamily=x),T}},b.ToNumberArray=function(O){for(var M=b.trim(b.compressSpaces((O||"").replace(/,/g," "))).split(" "),T=0;T<M.length;T++)M[T]=parseFloat(M[T]);return M},b.Point=function(O,M){this.x=O,this.y=M},b.Point.prototype.angleTo=function(O){return Math.atan2(O.y-this.y,O.x-this.x)},b.Point.prototype.applyTransform=function(T){var M=this.x*T[0]+this.y*T[2]+T[4],T=this.x*T[1]+this.y*T[3]+T[5];this.x=M,this.y=T},b.CreatePoint=function(O){return O=b.ToNumberArray(O),new b.Point(O[0],O[1])},b.CreatePath=function(O){for(var M=b.ToNumberArray(O),T=[],j=0;j<M.length;j+=2)T.push(new b.Point(M[j],M[j+1]));return T},b.BoundingBox=function(O,M,T,j){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(f,x){f!=null&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=f,this.x2=f),f<this.x1&&(this.x1=f),f>this.x2&&(this.x2=f)),x!=null&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=x,this.y2=x),x<this.y1&&(this.y1=x),x>this.y2&&(this.y2=x))},this.addX=function(f){this.addPoint(f,null)},this.addY=function(f){this.addPoint(null,f)},this.addBoundingBox=function(f){this.addPoint(f.x1,f.y1),this.addPoint(f.x2,f.y2)},this.addQuadraticCurve=function(f,x,C,D,Z,it){C=f+2/3*(C-f),D=x+2/3*(D-x),this.addBezierCurve(f,x,C,C+1/3*(Z-f),D,D+1/3*(it-x),Z,it)},this.addBezierCurve=function(f,x,C,D,Z,it,st,lt){var at=[f,x],mt=[C,D],Mt=[Z,it],Et=[st,lt];this.addPoint(at[0],at[1]),this.addPoint(Et[0],Et[1]);for(var Zt=0;Zt<=1;Zt++){var xt,Bt=function(be){return Math.pow(1-be,3)*at[Zt]+3*Math.pow(1-be,2)*be*mt[Zt]+3*(1-be)*Math.pow(be,2)*Mt[Zt]+Math.pow(be,3)*Et[Zt]},ce=6*at[Zt]-12*mt[Zt]+6*Mt[Zt],me=-3*at[Zt]+9*mt[Zt]-9*Mt[Zt]+3*Et[Zt],Ut=3*mt[Zt]-3*at[Zt];me==0?ce==0||0<(xt=-Ut/ce)&&xt<1&&(Zt==0&&this.addX(Bt(xt)),Zt==1&&this.addY(Bt(xt))):(xt=Math.pow(ce,2)-4*Ut*me)<0||(0<(Ut=(-ce+Math.sqrt(xt))/(2*me))&&Ut<1&&(Zt==0&&this.addX(Bt(Ut)),Zt==1&&this.addY(Bt(Ut))),0<(Ut=(-ce-Math.sqrt(xt))/(2*me))&&Ut<1&&(Zt==0&&this.addX(Bt(Ut)),Zt==1&&this.addY(Bt(Ut))))}},this.isPointInBox=function(f,x){return this.x1<=f&&f<=this.x2&&this.y1<=x&&x<=this.y2},this.addPoint(O,M),this.addPoint(T,j)},b.Transform=function(O){for(var M=this,T=(this.Type={},this.Type.translate=function(D){this.p=b.CreatePoint(D),this.apply=function(Z){Z.translate(this.p.x||0,this.p.y||0)},this.unapply=function(Z){Z.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(Z){Z.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(D){D=b.ToNumberArray(D),this.angle=new b.Property("angle",D[0]),this.cx=D[1]||0,this.cy=D[2]||0,this.apply=function(Z){Z.translate(this.cx,this.cy),Z.rotate(this.angle.toRadians()),Z.translate(-this.cx,-this.cy)},this.unapply=function(Z){Z.translate(this.cx,this.cy),Z.rotate(-1*this.angle.toRadians()),Z.translate(-this.cx,-this.cy)},this.applyToPoint=function(Z){var it=this.angle.toRadians();Z.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),Z.applyTransform([Math.cos(it),Math.sin(it),-Math.sin(it),Math.cos(it),0,0]),Z.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(D){this.p=b.CreatePoint(D),this.apply=function(Z){Z.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(Z){Z.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(Z){Z.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(D){this.m=b.ToNumberArray(D),this.apply=function(Z){Z.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(Z){var it=this.m[0],st=this.m[2],lt=this.m[4],at=this.m[1],mt=this.m[3],Mt=this.m[5],Et=1/(it*(+mt-0*Mt)-st*(+at-0*Mt)+lt*(0*at-0*mt));Z.transform(Et*(+mt-0*Mt),Et*(0*Mt-+at),Et*(0*lt-+st),Et*(+it-0*lt),Et*(st*Mt-lt*mt),Et*(lt*at-it*Mt))},this.applyToPoint=function(Z){Z.applyTransform(this.m)}},this.Type.SkewBase=function(D){this.base=M.Type.matrix,this.base(D),this.angle=new b.Property("angle",D)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(D){this.base=M.Type.SkewBase,this.base(D),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(D){this.base=M.Type.SkewBase,this.base(D),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(D){for(var Z=0;Z<this.transforms.length;Z++)this.transforms[Z].apply(D)},this.unapply=function(D){for(var Z=this.transforms.length-1;0<=Z;Z--)this.transforms[Z].unapply(D)},this.applyToPoint=function(D){for(var Z=0;Z<this.transforms.length;Z++)this.transforms[Z].applyToPoint(D)},b.trim(b.compressSpaces(O)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)),j=0;j<T.length;j++){var f=b.trim(T[j].split("(")[0]),x=T[j].split("(")[1].replace(")",""),C=this.Type[f];C!==void 0&&((C=new C(x)).type=f,this.transforms.push(C))}},b.AspectRatio=function(O,lt,T,j,f,x,C,D,Z,it){var st=(lt=(lt=b.compressSpaces(lt)).replace(/^defer\s/,"")).split(" ")[0]||"xMidYMid",lt=lt.split(" ")[1]||"meet",at=T/j,mt=f/x,Mt=Math.min(at,mt),Et=Math.max(at,mt);lt=="meet"&&(j*=Mt,x*=Mt),lt=="slice"&&(j*=Et,x*=Et),Z=new b.Property("refX",Z),it=new b.Property("refY",it),Z.hasValue()&&it.hasValue()?O.translate(-Mt*Z.toPixels("x"),-Mt*it.toPixels("y")):(st.match(/^xMid/)&&(lt=="meet"&&Mt==mt||lt=="slice"&&Et==mt)&&O.translate(T/2-j/2,0),st.match(/YMid$/)&&(lt=="meet"&&Mt==at||lt=="slice"&&Et==at)&&O.translate(0,f/2-x/2),st.match(/^xMax/)&&(lt=="meet"&&Mt==mt||lt=="slice"&&Et==mt)&&O.translate(T-j,0),st.match(/YMax$/)&&(lt=="meet"&&Mt==at||lt=="slice"&&Et==at)&&O.translate(0,f-x)),st=="none"?O.scale(at,mt):lt=="meet"?O.scale(Mt,Mt):lt=="slice"&&O.scale(Et,Et),O.translate(C==null?0:-C,D==null?0:-D)},b.Element={},b.EmptyProperty=new b.Property("EMPTY",""),b.Element.ElementBase=function(O){this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(st,lt){var at=this.attributes[st];return at??(lt==1&&(at=new b.Property(st,""),this.attributes[st]=at),at||b.EmptyProperty)},this.getHrefAttribute=function(){for(var st in this.attributes)if(st=="href"||st.match(/:href$/))return this.attributes[st];return b.EmptyProperty},this.style=function(st,lt,at){var mt=this.styles[st];if(mt!=null)return mt;var Mt=this.attribute(st);return Mt!=null&&Mt.hasValue()?this.styles[st]=Mt:at!=1&&(Mt=this.parent,Mt!=null&&(at=Mt.style(st),at!=null&&at.hasValue()))?at:(lt==1&&(mt=new b.Property(st,""),this.styles[st]=mt),mt||b.EmptyProperty)},this.render=function(st){var lt;this.style("display").value!="none"&&this.style("visibility").value!="hidden"&&(st.save(),this.style("mask").hasValue()?(lt=this.style("mask").getDefinition())!=null&&lt.apply(st,this):this.style("filter").hasValue()?(lt=this.style("filter").getDefinition())!=null&&lt.apply(st,this):(this.setContext(st),this.renderChildren(st),this.clearContext(st)),st.restore())},this.setContext=function(st){},this.clearContext=function(st){},this.renderChildren=function(st){for(var lt=0;lt<this.children.length;lt++)this.children[lt].render(st)},this.addChild=function(st,lt){var at=st;(at=lt?b.CreateElement(st):at).parent=this,at.type!="title"&&this.children.push(at)},this.addStylesFromStyleDefinition=function(){for(var st in b.Styles)if(st[0]!="@"&&l(O,st)){var lt=b.Styles[st],at=b.StylesSpecificity[st];if(lt!=null)for(var mt in lt){var Mt=this.stylesSpecificity[mt];(Mt=Mt===void 0?"000":Mt)<at&&(this.styles[mt]=lt[mt],this.stylesSpecificity[mt]=at)}}};var M=new RegExp("^[A-Z-]+$");if(O!=null&&O.nodeType==1){for(var T=0;T<O.attributes.length;T++){var j=O.attributes[T],f=(f=j.nodeName,M.test(f)?f.toLowerCase():f);this.attributes[f]=new b.Property(f,j.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue())for(var x,C,D=this.attribute("style").value.split(";"),T=0;T<D.length;T++)b.trim(D[T])!=""&&(C=D[T].split(":"),x=b.trim(C[0]),C=b.trim(C[1]),this.styles[x]=new b.Property(x,C));for(this.attribute("id").hasValue()&&b.Definitions[this.attribute("id").value]==null&&(b.Definitions[this.attribute("id").value]=this),T=0;T<O.childNodes.length;T++){var Z,it=O.childNodes[T];it.nodeType==1&&this.addChild(it,!0),!this.captureTextNodes||it.nodeType!=3&&it.nodeType!=4||(Z=it.value||it.text||it.textContent||"",b.compressSpaces(Z)!=""&&this.addChild(new b.Element.tspan(it),!1))}}},b.Element.RenderedElementBase=function(O){this.base=b.Element.ElementBase,this.base(O),this.setContext=function(M){var T,j,f;this.style("fill").isUrlDefinition()?(T=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity")))!=null&&(M.fillStyle=T):this.style("fill").hasValue()&&((f=this.style("fill")).value=="currentColor"&&(f.value=this.style("color").value),f.value!="inherit"&&(M.fillStyle=f.value=="none"?"rgba(0,0,0,0)":f.value)),this.style("fill-opacity").hasValue()&&(f=(f=new b.Property("fill",M.fillStyle)).addOpacity(this.style("fill-opacity")),M.fillStyle=f.value),this.style("stroke").isUrlDefinition()?(T=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity")))!=null&&(M.strokeStyle=T):this.style("stroke").hasValue()&&((j=this.style("stroke")).value=="currentColor"&&(j.value=this.style("color").value),j.value!="inherit"&&(M.strokeStyle=j.value=="none"?"rgba(0,0,0,0)":j.value)),this.style("stroke-opacity").hasValue()&&(j=(j=new b.Property("stroke",M.strokeStyle)).addOpacity(this.style("stroke-opacity")),M.strokeStyle=j.value),this.style("stroke-width").hasValue()&&(f=this.style("stroke-width").toPixels(),M.lineWidth=f==0?.001:f),this.style("stroke-linecap").hasValue()&&(M.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(M.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(M.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&this.style("stroke-dasharray").value!="none"&&(T=b.ToNumberArray(this.style("stroke-dasharray").value),M.setLineDash!==void 0?M.setLineDash(T):M.webkitLineDash!==void 0?M.webkitLineDash=T:M.mozDash===void 0||T.length==1&&T[0]==0||(M.mozDash=T),j=this.style("stroke-dashoffset").numValueOrDefault(1),M.lineDashOffset!==void 0?M.lineDashOffset=j:M.webkitLineDashOffset!==void 0?M.webkitLineDashOffset=j:M.mozDashOffset!==void 0&&(M.mozDashOffset=j)),M.font!==void 0&&(M.font=b.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.style("transform",!1,!0).hasValue()&&new b.Transform(this.style("transform",!1,!0).value).apply(M),this.style("clip-path",!1,!0).hasValue()&&(f=this.style("clip-path",!1,!0).getDefinition())!=null&&f.apply(M),this.style("opacity").hasValue()&&(M.globalAlpha=this.style("opacity").numValue())}},b.Element.RenderedElementBase.prototype=new b.Element.ElementBase,b.Element.PathElementBase=function(O){this.base=b.Element.RenderedElementBase,this.base(O),this.path=function(M){return M!=null&&M.beginPath(),new b.BoundingBox},this.renderChildren=function(M){this.path(M),b.Mouse.checkPath(this,M),M.fillStyle!=""&&(this.style("fill-rule").valueOrDefault("inherit")!="inherit"?M.fill(this.style("fill-rule").value):M.fill()),M.strokeStyle!=""&&M.stroke();var T=this.getMarkers();if(T!=null){if(this.style("marker-start").isUrlDefinition()&&(j=this.style("marker-start").getDefinition()).render(M,T[0][0],T[0][1]),this.style("marker-mid").isUrlDefinition())for(var j=this.style("marker-mid").getDefinition(),f=1;f<T.length-1;f++)j.render(M,T[f][0],T[f][1]);this.style("marker-end").isUrlDefinition()&&(j=this.style("marker-end").getDefinition()).render(M,T[T.length-1][0],T[T.length-1][1])}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},b.Element.PathElementBase.prototype=new b.Element.RenderedElementBase,b.Element.svg=function(O){this.base=b.Element.RenderedElementBase,this.base(O),this.baseClearContext=this.clearContext,this.clearContext=function(M){this.baseClearContext(M),b.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(M){M.strokeStyle="rgba(0,0,0,0)",M.lineCap="butt",M.lineJoin="miter",M.miterLimit=4,M.font!==void 0&&window.getComputedStyle!==void 0&&(M.font=window.getComputedStyle(M.canvas).getPropertyValue("font")),this.baseSetContext(M),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),M.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var T,j,f,x=b.ViewPort.width(),C=b.ViewPort.height();this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),this.root===void 0&&(x=this.attribute("width").toPixels("x"),C=this.attribute("height").toPixels("y"),T=j=0,this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(j=-this.attribute("refX").toPixels("x"),T=-this.attribute("refY").toPixels("y")),this.attribute("overflow").valueOrDefault("hidden")!="visible"&&(M.beginPath(),M.moveTo(j,T),M.lineTo(x,T),M.lineTo(x,C),M.lineTo(j,C),M.closePath(),M.clip())),b.ViewPort.SetCurrent(x,C),this.attribute("viewBox").hasValue()&&(j=(T=b.ToNumberArray(this.attribute("viewBox").value))[0],f=T[1],x=T[2],C=T[3],b.AspectRatio(M,this.attribute("preserveAspectRatio").value,b.ViewPort.width(),x,b.ViewPort.height(),C,j,f,this.attribute("refX").value,this.attribute("refY").value),b.ViewPort.RemoveCurrent(),b.ViewPort.SetCurrent(T[2],T[3]))}},b.Element.svg.prototype=new b.Element.RenderedElementBase,b.Element.rect=function(O){this.base=b.Element.PathElementBase,this.base(O),this.path=function(M){var T=this.attribute("x").toPixels("x"),j=this.attribute("y").toPixels("y"),f=this.attribute("width").toPixels("x"),x=this.attribute("height").toPixels("y"),C=this.attribute("rx").toPixels("x"),D=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(D=C),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(C=D),C=Math.min(C,f/2),D=Math.min(D,x/2),M!=null&&(M.beginPath(),M.moveTo(T+C,j),M.lineTo(T+f-C,j),M.quadraticCurveTo(T+f,j,T+f,j+D),M.lineTo(T+f,j+x-D),M.quadraticCurveTo(T+f,j+x,T+f-C,j+x),M.lineTo(T+C,j+x),M.quadraticCurveTo(T,j+x,T,j+x-D),M.lineTo(T,j+D),M.quadraticCurveTo(T,j,T+C,j),M.closePath()),new b.BoundingBox(T,j,T+f,j+x)}},b.Element.rect.prototype=new b.Element.PathElementBase,b.Element.circle=function(O){this.base=b.Element.PathElementBase,this.base(O),this.path=function(M){var T=this.attribute("cx").toPixels("x"),j=this.attribute("cy").toPixels("y"),f=this.attribute("r").toPixels();return M!=null&&(M.beginPath(),M.arc(T,j,f,0,2*Math.PI,!0),M.closePath()),new b.BoundingBox(T-f,j-f,T+f,j+f)}},b.Element.circle.prototype=new b.Element.PathElementBase,b.Element.ellipse=function(O){this.base=b.Element.PathElementBase,this.base(O),this.path=function(M){var T=(Math.sqrt(2)-1)/3*4,j=this.attribute("rx").toPixels("x"),f=this.attribute("ry").toPixels("y"),x=this.attribute("cx").toPixels("x"),C=this.attribute("cy").toPixels("y");return M!=null&&(M.beginPath(),M.moveTo(x,C-f),M.bezierCurveTo(x+T*j,C-f,x+j,C-T*f,x+j,C),M.bezierCurveTo(x+j,C+T*f,x+T*j,C+f,x,C+f),M.bezierCurveTo(x-T*j,C+f,x-j,C+T*f,x-j,C),M.bezierCurveTo(x-j,C-T*f,x-T*j,C-f,x,C-f),M.closePath()),new b.BoundingBox(x-j,C-f,x+j,C+f)}},b.Element.ellipse.prototype=new b.Element.PathElementBase,b.Element.line=function(O){this.base=b.Element.PathElementBase,this.base(O),this.getPoints=function(){return[new b.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new b.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(M){var T=this.getPoints();return M!=null&&(M.beginPath(),M.moveTo(T[0].x,T[0].y),M.lineTo(T[1].x,T[1].y)),new b.BoundingBox(T[0].x,T[0].y,T[1].x,T[1].y)},this.getMarkers=function(){var M=this.getPoints(),T=M[0].angleTo(M[1]);return[[M[0],T],[M[1],T]]}},b.Element.line.prototype=new b.Element.PathElementBase,b.Element.polyline=function(O){this.base=b.Element.PathElementBase,this.base(O),this.points=b.CreatePath(this.attribute("points").value),this.path=function(M){var T=new b.BoundingBox(this.points[0].x,this.points[0].y);M!=null&&(M.beginPath(),M.moveTo(this.points[0].x,this.points[0].y));for(var j=1;j<this.points.length;j++)T.addPoint(this.points[j].x,this.points[j].y),M!=null&&M.lineTo(this.points[j].x,this.points[j].y);return T},this.getMarkers=function(){for(var M=[],T=0;T<this.points.length-1;T++)M.push([this.points[T],this.points[T].angleTo(this.points[T+1])]);return 0<M.length&&M.push([this.points[this.points.length-1],M[M.length-1][1]]),M}},b.Element.polyline.prototype=new b.Element.PathElementBase,b.Element.polygon=function(O){this.base=b.Element.polyline,this.base(O),this.basePath=this.path,this.path=function(M){var T=this.basePath(M);return M!=null&&(M.lineTo(this.points[0].x,this.points[0].y),M.closePath()),T}},b.Element.polygon.prototype=new b.Element.polyline,b.Element.path=function(O){this.base=b.Element.PathElementBase,this.base(O);for(var M=(M=this.attribute("d").value).replace(/,/gm," "),T=0;T<2;T++)M=M.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");for(M=(M=M.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2"),T=0;T<2;T++)M=M.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");M=M.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),M=b.compressSpaces(M),M=b.trim(M),this.PathParser=new function(j){this.tokens=j.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new b.Point(0,0),this.control=new b.Point(0,0),this.current=new b.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||this.tokens[this.i+1].match(/^[A-Za-z]$/)!=null},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var f=new b.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(f)},this.getAsControlPoint=function(){var f=this.getPoint();return this.control=f},this.getAsCurrentPoint=function(){var f=this.getPoint();return this.current=f},this.getReflectedControlPoint=function(){return this.previousCommand.toLowerCase()!="c"&&this.previousCommand.toLowerCase()!="s"&&this.previousCommand.toLowerCase()!="q"&&this.previousCommand.toLowerCase()!="t"?this.current:new b.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},this.makeAbsolute=function(f){return this.isRelativeCommand()&&(f.x+=this.current.x,f.y+=this.current.y),f},this.addMarker=function(f,x,C){C!=null&&0<this.angles.length&&this.angles[this.angles.length-1]==null&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(C)),this.addMarkerAngle(f,x==null?null:x.angleTo(f))},this.addMarkerAngle=function(f,x){this.points.push(f),this.angles.push(x)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var f=0;f<this.angles.length;f++)if(this.angles[f]==null){for(var x=f+1;x<this.angles.length;x++)if(this.angles[x]!=null){this.angles[f]=this.angles[x];break}}return this.angles}}(M),this.path=function(j){var f=this.PathParser,x=(f.reset(),new b.BoundingBox);for(j!=null&&j.beginPath();!f.isEnd();)switch(f.nextCommand(),f.command){case"M":case"m":var C=f.getAsCurrentPoint();for(f.addMarker(C),x.addPoint(C.x,C.y),j!=null&&j.moveTo(C.x,C.y),f.start=f.current;!f.isCommandOrEnd();)C=f.getAsCurrentPoint(),f.addMarker(C,f.start),x.addPoint(C.x,C.y),j!=null&&j.lineTo(C.x,C.y);break;case"L":case"l":for(;!f.isCommandOrEnd();){var D=f.current,C=f.getAsCurrentPoint();f.addMarker(C,D),x.addPoint(C.x,C.y),j!=null&&j.lineTo(C.x,C.y)}break;case"H":case"h":for(;!f.isCommandOrEnd();){var Z=new b.Point((f.isRelativeCommand()?f.current.x:0)+f.getScalar(),f.current.y);f.addMarker(Z,f.current),f.current=Z,x.addPoint(f.current.x,f.current.y),j!=null&&j.lineTo(f.current.x,f.current.y)}break;case"V":case"v":for(;!f.isCommandOrEnd();)Z=new b.Point(f.current.x,(f.isRelativeCommand()?f.current.y:0)+f.getScalar()),f.addMarker(Z,f.current),f.current=Z,x.addPoint(f.current.x,f.current.y),j!=null&&j.lineTo(f.current.x,f.current.y);break;case"C":case"c":for(;!f.isCommandOrEnd();){var it=f.current,st=f.getPoint(),lt=f.getAsControlPoint(),at=f.getAsCurrentPoint();f.addMarker(at,lt,st),x.addBezierCurve(it.x,it.y,st.x,st.y,lt.x,lt.y,at.x,at.y),j!=null&&j.bezierCurveTo(st.x,st.y,lt.x,lt.y,at.x,at.y)}break;case"S":case"s":for(;!f.isCommandOrEnd();)it=f.current,st=f.getReflectedControlPoint(),lt=f.getAsControlPoint(),at=f.getAsCurrentPoint(),f.addMarker(at,lt,st),x.addBezierCurve(it.x,it.y,st.x,st.y,lt.x,lt.y,at.x,at.y),j!=null&&j.bezierCurveTo(st.x,st.y,lt.x,lt.y,at.x,at.y);break;case"Q":case"q":for(;!f.isCommandOrEnd();)it=f.current,lt=f.getAsControlPoint(),at=f.getAsCurrentPoint(),f.addMarker(at,lt,lt),x.addQuadraticCurve(it.x,it.y,lt.x,lt.y,at.x,at.y),j!=null&&j.quadraticCurveTo(lt.x,lt.y,at.x,at.y);break;case"T":case"t":for(;!f.isCommandOrEnd();)it=f.current,lt=f.getReflectedControlPoint(),at=(f.control=lt,f.getAsCurrentPoint()),f.addMarker(at,lt,lt),x.addQuadraticCurve(it.x,it.y,lt.x,lt.y,at.x,at.y),j!=null&&j.quadraticCurveTo(lt.x,lt.y,at.x,at.y);break;case"A":case"a":for(;!f.isCommandOrEnd();){var it=f.current,mt=f.getScalar(),Mt=f.getScalar(),Et=f.getScalar()*(Math.PI/180),Ut=f.getScalar(),Zt=f.getScalar(),at=f.getAsCurrentPoint(),Ht=new b.Point(Math.cos(Et)*(it.x-at.x)/2+Math.sin(Et)*(it.y-at.y)/2,-Math.sin(Et)*(it.x-at.x)/2+Math.cos(Et)*(it.y-at.y)/2),xt=Math.pow(Ht.x,2)/Math.pow(mt,2)+Math.pow(Ht.y,2)/Math.pow(Mt,2),xt=(1<xt&&(mt*=Math.sqrt(xt),Mt*=Math.sqrt(xt)),(Ut==Zt?-1:1)*Math.sqrt((Math.pow(mt,2)*Math.pow(Mt,2)-Math.pow(mt,2)*Math.pow(Ht.y,2)-Math.pow(Mt,2)*Math.pow(Ht.x,2))/(Math.pow(mt,2)*Math.pow(Ht.y,2)+Math.pow(Mt,2)*Math.pow(Ht.x,2)))),Ut=(isNaN(xt)&&(xt=0),new b.Point(xt*mt*Ht.y/Mt,xt*-Mt*Ht.x/mt)),xt=new b.Point((it.x+at.x)/2+Math.cos(Et)*Ut.x-Math.sin(Et)*Ut.y,(it.y+at.y)/2+Math.sin(Et)*Ut.x+Math.cos(Et)*Ut.y),Bt=function(Pe){return Math.sqrt(Math.pow(Pe[0],2)+Math.pow(Pe[1],2))},ce=function(Pe,oi){return(Pe[0]*oi[0]+Pe[1]*oi[1])/(Bt(Pe)*Bt(oi))},be=function(Pe,oi){return(Pe[0]*oi[1]<Pe[1]*oi[0]?-1:1)*Math.acos(ce(Pe,oi))},me=be([1,0],[(Ht.x-Ut.x)/mt,(Ht.y-Ut.y)/Mt]),xe=[(Ht.x-Ut.x)/mt,(Ht.y-Ut.y)/Mt],Ht=[(-Ht.x-Ut.x)/mt,(-Ht.y-Ut.y)/Mt],Ut=be(xe,Ht),be=(ce(xe,Ht)<=-1&&(Ut=Math.PI),1-Zt?1:-1),xe=me+(Ut=1<=ce(xe,Ht)?0:Ut)/2*be,Ht=new b.Point(xt.x+mt*Math.cos(xe),xt.y+Mt*Math.sin(xe));f.addMarkerAngle(Ht,xe-be*Math.PI/2),f.addMarkerAngle(at,xe-be*Math.PI),x.addPoint(at.x,at.y),j!=null&&(ce=Mt<mt?mt:Mt,Ht=Mt<mt?1:mt/Mt,xe=Mt<mt?Mt/mt:1,j.translate(xt.x,xt.y),j.rotate(Et),j.scale(Ht,xe),j.arc(0,0,ce,me,me+Ut,1-Zt),j.scale(1/Ht,1/xe),j.rotate(-Et),j.translate(-xt.x,-xt.y))}break;case"Z":case"z":j!=null&&j.closePath(),f.current=f.start}return x},this.getMarkers=function(){for(var j=this.PathParser.getMarkerPoints(),f=this.PathParser.getMarkerAngles(),x=[],C=0;C<j.length;C++)x.push([j[C],f[C]]);return x}},b.Element.path.prototype=new b.Element.PathElementBase,b.Element.pattern=function(O){this.base=b.Element.ElementBase,this.base(O),this.createPattern=function(M,T){var j=this.attribute("width").toPixels("x",!0),f=this.attribute("height").toPixels("y",!0),x=new b.Element.svg,C=(x.attributes.viewBox=new b.Property("viewBox",this.attribute("viewBox").value),x.attributes.width=new b.Property("width",j+"px"),x.attributes.height=new b.Property("height",f+"px"),x.attributes.transform=new b.Property("transform",this.attribute("patternTransform").value),x.children=this.children,document.createElement("canvas")),D=(C.width=j,C.height=f,C.getContext("2d"));this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&D.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var Z=-1;Z<=1;Z++)for(var it=-1;it<=1;it++)D.save(),x.attributes.x=new b.Property("x",Z*C.width),x.attributes.y=new b.Property("y",it*C.height),x.render(D),D.restore();return M.createPattern(C,"repeat")}},b.Element.pattern.prototype=new b.Element.ElementBase,b.Element.marker=function(O){this.base=b.Element.ElementBase,this.base(O),this.baseRender=this.render,this.render=function(M,T,j){M.translate(T.x,T.y),this.attribute("orient").valueOrDefault("auto")=="auto"&&M.rotate(j),this.attribute("markerUnits").valueOrDefault("strokeWidth")=="strokeWidth"&&M.scale(M.lineWidth,M.lineWidth),M.save();var f=new b.Element.svg;f.attributes.viewBox=new b.Property("viewBox",this.attribute("viewBox").value),f.attributes.refX=new b.Property("refX",this.attribute("refX").value),f.attributes.refY=new b.Property("refY",this.attribute("refY").value),f.attributes.width=new b.Property("width",this.attribute("markerWidth").value),f.attributes.height=new b.Property("height",this.attribute("markerHeight").value),f.attributes.fill=new b.Property("fill",this.attribute("fill").valueOrDefault("black")),f.attributes.stroke=new b.Property("stroke",this.attribute("stroke").valueOrDefault("none")),f.children=this.children,f.render(M),M.restore(),this.attribute("markerUnits").valueOrDefault("strokeWidth")=="strokeWidth"&&M.scale(1/M.lineWidth,1/M.lineWidth),this.attribute("orient").valueOrDefault("auto")=="auto"&&M.rotate(-j),M.translate(-T.x,-T.y)}},b.Element.marker.prototype=new b.Element.ElementBase,b.Element.defs=function(O){this.base=b.Element.ElementBase,this.base(O),this.render=function(M){}},b.Element.defs.prototype=new b.Element.ElementBase,b.Element.GradientBase=function(O){this.base=b.Element.ElementBase,this.base(O),this.stops=[];for(var M=0;M<this.children.length;M++){var T=this.children[M];T.type=="stop"&&this.stops.push(T)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits"],this.inheritStopContainer=function(j){for(var f=0;f<this.attributesToInherit.length;f++){var x=this.attributesToInherit[f];!this.attribute(x).hasValue()&&j.attribute(x).hasValue()&&(this.attribute(x,!0).value=j.attribute(x).value)}},this.createGradient=function(j,f,x){function C(lt){return x.hasValue()?new b.Property("color",lt).addOpacity(x).value:lt}var D=this,Z=(this.getHrefAttribute().hasValue()&&(D=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(D)),this.getGradient(j,f));if(Z==null)return C(D.stops[D.stops.length-1].color);for(var it,st=0;st<D.stops.length;st++)Z.addColorStop(D.stops[st].offset,C(D.stops[st].color));return this.attribute("gradientTransform").hasValue()?(j=b.ViewPort.viewPorts[0],(f=new b.Element.rect).attributes.x=new b.Property("x",-b.MAX_VIRTUAL_PIXELS/3),f.attributes.y=new b.Property("y",-b.MAX_VIRTUAL_PIXELS/3),f.attributes.width=new b.Property("width",b.MAX_VIRTUAL_PIXELS),f.attributes.height=new b.Property("height",b.MAX_VIRTUAL_PIXELS),(it=new b.Element.g).attributes.transform=new b.Property("transform",this.attribute("gradientTransform").value),it.children=[f],(f=new b.Element.svg).attributes.x=new b.Property("x",0),f.attributes.y=new b.Property("y",0),f.attributes.width=new b.Property("width",j.width),f.attributes.height=new b.Property("height",j.height),f.children=[it],(it=document.createElement("canvas")).width=j.width,it.height=j.height,(j=it.getContext("2d")).fillStyle=Z,f.render(j),j.createPattern(it,"no-repeat")):Z}},b.Element.GradientBase.prototype=new b.Element.ElementBase,b.Element.linearGradient=function(O){this.base=b.Element.GradientBase,this.base(O),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(M,C){var C=this.gradientUnits()=="objectBoundingBox"?C.getBoundingBox():null,j=(this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0),this.gradientUnits()=="objectBoundingBox"?C.x()+C.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x")),f=this.gradientUnits()=="objectBoundingBox"?C.y()+C.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),x=this.gradientUnits()=="objectBoundingBox"?C.x()+C.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),C=this.gradientUnits()=="objectBoundingBox"?C.y()+C.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return j==x&&f==C?null:M.createLinearGradient(j,f,x,C)}},b.Element.linearGradient.prototype=new b.Element.GradientBase,b.Element.radialGradient=function(O){this.base=b.Element.GradientBase,this.base(O),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.getGradient=function(M,D){var D=D.getBoundingBox(),j=(this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%"),this.gradientUnits()=="objectBoundingBox"?D.x()+D.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x")),f=this.gradientUnits()=="objectBoundingBox"?D.y()+D.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),x=j,C=f,D=(this.attribute("fx").hasValue()&&(x=this.gradientUnits()=="objectBoundingBox"?D.x()+D.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(C=this.gradientUnits()=="objectBoundingBox"?D.y()+D.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y")),this.gradientUnits()=="objectBoundingBox"?(D.width()+D.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels());return M.createRadialGradient(x,C,0,j,f,D)}},b.Element.radialGradient.prototype=new b.Element.GradientBase,b.Element.stop=function(O){this.base=b.Element.ElementBase,this.base(O),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),1<this.offset&&(this.offset=1),O=this.style("stop-color",!0),O.value===""&&(O.value="#000"),this.style("stop-opacity").hasValue()&&(O=O.addOpacity(this.style("stop-opacity"))),this.color=O.value},b.Element.stop.prototype=new b.Element.ElementBase,b.Element.AnimateBase=function(O){this.base=b.Element.ElementBase,this.base(O),b.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var M=this.attribute("attributeType").value,T=this.attribute("attributeName").value;return M=="CSS"?this.parent.style(T,!0):this.parent.attribute(T,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(j){if(this.initialValue==null&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if(this.attribute("repeatCount").value=="indefinite"||this.attribute("repeatDur").value=="indefinite")this.duration=0;else if(this.attribute("fill").valueOrDefault("remove")!="freeze"||this.frozen){if(this.attribute("fill").valueOrDefault("remove")=="remove"&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+j;var T,j=!1;return this.begin<this.duration&&(T=this.calcValue(),this.attribute("type").hasValue()&&(T=this.attribute("type").value+"("+T+")"),this.getProperty().value=T,j=!0),j},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var M,T,j,f={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};return this.values.hasValue()?(M=f.progress*(this.values.value.length-1),T=Math.floor(M),j=Math.ceil(M),f.from=new b.Property("from",parseFloat(this.values.value[T])),f.to=new b.Property("to",parseFloat(this.values.value[j])),f.progress=(M-T)/(j-T)):(f.from=this.from,f.to=this.to),f}},b.Element.AnimateBase.prototype=new b.Element.ElementBase,b.Element.animate=function(O){this.base=b.Element.AnimateBase,this.base(O),this.calcValue=function(){var M=this.progress();return M.from.numValue()+(M.to.numValue()-M.from.numValue())*M.progress+this.initialUnits}},b.Element.animate.prototype=new b.Element.AnimateBase,b.Element.animateColor=function(O){this.base=b.Element.AnimateBase,this.base(O),this.calcValue=function(){var M,T,j=this.progress(),f=new o(j.from.value),x=new o(j.to.value);return f.ok&&x.ok?(M=f.r+(x.r-f.r)*j.progress,T=f.g+(x.g-f.g)*j.progress,x=f.b+(x.b-f.b)*j.progress,"rgb("+parseInt(M,10)+","+parseInt(T,10)+","+parseInt(x,10)+")"):this.attribute("from").value}},b.Element.animateColor.prototype=new b.Element.AnimateBase,b.Element.animateTransform=function(O){this.base=b.Element.AnimateBase,this.base(O),this.calcValue=function(){for(var M=this.progress(),T=b.ToNumberArray(M.from.value),j=b.ToNumberArray(M.to.value),f="",x=0;x<T.length;x++)f+=T[x]+(j[x]-T[x])*M.progress+" ";return f}},b.Element.animateTransform.prototype=new b.Element.animate,b.Element.font=function(O){this.base=b.Element.ElementBase,this.base(O),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var M=0;M<this.children.length;M++){var T=this.children[M];T.type=="font-face"?(this.fontFace=T).style("font-family").hasValue()&&(b.Definitions[T.style("font-family").value]=this):T.type=="missing-glyph"?this.missingGlyph=T:T.type=="glyph"&&(T.arabicForm!=""?(this.isRTL=!0,this.isArabic=!0,this.glyphs[T.unicode]===void 0&&(this.glyphs[T.unicode]=[]),this.glyphs[T.unicode][T.arabicForm]=T):this.glyphs[T.unicode]=T)}},b.Element.font.prototype=new b.Element.ElementBase,b.Element.fontface=function(O){this.base=b.Element.ElementBase,this.base(O),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},b.Element.fontface.prototype=new b.Element.ElementBase,b.Element.missingglyph=function(O){this.base=b.Element.path,this.base(O),this.horizAdvX=0},b.Element.missingglyph.prototype=new b.Element.path,b.Element.glyph=function(O){this.base=b.Element.path,this.base(O),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},b.Element.glyph.prototype=new b.Element.path,b.Element.text=function(O){this.captureTextNodes=!0,this.base=b.Element.RenderedElementBase,this.base(O),this.baseSetContext=this.setContext,this.setContext=function(M){this.baseSetContext(M);var T=this.style("dominant-baseline").toTextBaseline();(T=T??this.style("alignment-baseline").toTextBaseline())!=null&&(M.textBaseline=T)},this.getBoundingBox=function(){var M=this.attribute("x").toPixels("x"),T=this.attribute("y").toPixels("y"),j=this.parent.style("font-size").numValueOrDefault(b.Font.Parse(b.ctx.font).fontSize);return new b.BoundingBox(M,T-j,M+Math.floor(2*j/3)*this.children[0].getText().length,T)},this.renderChildren=function(M){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(M,this,0);for(var T=0;T<this.children.length;T++)this.renderChild(M,this,this,T)},this.getAnchorDelta=function(M,T,j){var f=this.style("text-anchor").valueOrDefault("start");if(f=="start")return 0;for(var x=0,C=j;C<T.children.length;C++){var D=T.children[C];if(j<C&&D.attribute("x").hasValue())break;x+=D.measureTextRecursive(M)}return-1*(f=="end"?x:x/2)},this.renderChild=function(M,T,j,f){var x=j.children[f];for(x.attribute("x").hasValue()?(x.x=x.attribute("x").toPixels("x")+T.getAnchorDelta(M,j,f),x.attribute("dx").hasValue()&&(x.x+=x.attribute("dx").toPixels("x"))):(x.attribute("dx").hasValue()&&(T.x+=x.attribute("dx").toPixels("x")),x.x=T.x),T.x=x.x+x.measureText(M),x.attribute("y").hasValue()?(x.y=x.attribute("y").toPixels("y"),x.attribute("dy").hasValue()&&(x.y+=x.attribute("dy").toPixels("y"))):(x.attribute("dy").hasValue()&&(T.y+=x.attribute("dy").toPixels("y")),x.y=T.y),T.y=x.y,x.render(M),f=0;f<x.children.length;f++)T.renderChild(M,T,x,f)}},b.Element.text.prototype=new b.Element.RenderedElementBase,b.Element.TextElementBase=function(O){this.base=b.Element.RenderedElementBase,this.base(O),this.getGlyph=function(M,T,j){var f,x=T[j],C=null;return C=(C=M.isArabic&&(f="isolated",(j==0||T[j-1]==" ")&&j<T.length-2&&T[j+1]!=" "&&(f="terminal"),0<j&&T[j-1]!=" "&&j<T.length-2&&T[j+1]!=" "&&(f="medial"),0<j&&T[j-1]!=" "&&(j==T.length-1||T[j+1]==" ")&&(f="initial"),M.glyphs[x]===void 0||(C=M.glyphs[x][f])!=null||M.glyphs[x].type!="glyph")?C:M.glyphs[x])==null?M.missingGlyph:C},this.renderChildren=function(M){var T=this.parent.style("font-family").getDefinition();if(T!=null)for(var j=this.parent.style("font-size").numValueOrDefault(b.Font.Parse(b.ctx.font).fontSize),f=this.parent.style("font-style").valueOrDefault(b.Font.Parse(b.ctx.font).fontStyle),x=this.getText(),C=(T.isRTL&&(x=x.split("").reverse().join("")),b.ToNumberArray(this.parent.attribute("dx").value)),D=0;D<x.length;D++){var Z=this.getGlyph(T,x,D),it=j/T.fontFace.unitsPerEm,st=(M.translate(this.x,this.y),M.scale(it,-it),M.lineWidth);M.lineWidth=M.lineWidth*T.fontFace.unitsPerEm/j,f=="italic"&&M.transform(1,0,.4,1,0,0),Z.render(M),f=="italic"&&M.transform(1,0,-.4,1,0,0),M.lineWidth=st,M.scale(1/it,-1/it),M.translate(-this.x,-this.y),this.x+=j*(Z.horizAdvX||T.horizAdvX)/T.fontFace.unitsPerEm,C[D]===void 0||isNaN(C[D])||(this.x+=C[D])}else M.fillStyle!=""&&M.fillText(b.compressSpaces(this.getText()),this.x,this.y),M.strokeStyle!=""&&M.strokeText(b.compressSpaces(this.getText()),this.x,this.y)},this.getText=function(){},this.measureTextRecursive=function(M){for(var T=this.measureText(M),j=0;j<this.children.length;j++)T+=this.children[j].measureTextRecursive(M);return T},this.measureText=function(M){var T=this.parent.style("font-family").getDefinition();if(T!=null){for(var j=this.parent.style("font-size").numValueOrDefault(b.Font.Parse(b.ctx.font).fontSize),f=0,x=this.getText(),C=(T.isRTL&&(x=x.split("").reverse().join("")),b.ToNumberArray(this.parent.attribute("dx").value)),D=0;D<x.length;D++)f+=(this.getGlyph(T,x,D).horizAdvX||T.horizAdvX)*j/T.fontFace.unitsPerEm,C[D]===void 0||isNaN(C[D])||(f+=C[D]);return f}var Z=b.compressSpaces(this.getText());return M.measureText?(M.save(),this.setContext(M),Z=M.measureText(Z).width,M.restore(),Z):10*Z.length}},b.Element.TextElementBase.prototype=new b.Element.RenderedElementBase,b.Element.tspan=function(O){this.captureTextNodes=!0,this.base=b.Element.TextElementBase,this.base(O),this.text=b.compressSpaces(O.value||O.text||O.textContent||""),this.getText=function(){return 0<this.children.length?"":this.text}},b.Element.tspan.prototype=new b.Element.TextElementBase,b.Element.tref=function(O){this.base=b.Element.TextElementBase,this.base(O),this.getText=function(){var M=this.getHrefAttribute().getDefinition();if(M!=null)return M.children[0].getText()}},b.Element.tref.prototype=new b.Element.TextElementBase,b.Element.a=function(O){this.base=b.Element.TextElementBase,this.base(O),this.hasText=0<O.childNodes.length;for(var M=0;M<O.childNodes.length;M++)O.childNodes[M].nodeType!=3&&(this.hasText=!1);this.text=this.hasText?O.childNodes[0].value:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(T){var j;this.hasText?(this.baseRenderChildren(T),j=new b.Property("fontSize",b.Font.Parse(b.ctx.font).fontSize),b.Mouse.checkBoundingBox(this,new b.BoundingBox(this.x,this.y-j.toPixels("y"),this.x+this.measureText(T),this.y))):0<this.children.length&&((j=new b.Element.g).children=this.children,j.parent=this,j.render(T))},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){b.ctx.canvas.style.cursor="pointer"}},b.Element.a.prototype=new b.Element.TextElementBase,b.Element.image=function(O){this.base=b.Element.RenderedElementBase,this.base(O);var M,T,j=this.getHrefAttribute().value;j!=""&&(M=j.match(/\.svg$/),b.Images.push(this),this.loaded=!1,M?(this.img=b.ajax(j),this.loaded=!0):(this.img=document.createElement("img"),b.opts.useCORS==1&&(this.img.crossOrigin="Anonymous"),(T=this).img.onload=function(){T.loaded=!0},this.img.onerror=function(){b.log('ERROR: image "'+j+'" not found'),T.loaded=!0},this.img.src=j),this.renderChildren=function(f){var x=this.attribute("x").toPixels("x"),C=this.attribute("y").toPixels("y"),D=this.attribute("width").toPixels("x"),Z=this.attribute("height").toPixels("y");D!=0&&Z!=0&&(f.save(),M?f.drawSvg(this.img,x,C,D,Z):(f.translate(x,C),b.AspectRatio(f,this.attribute("preserveAspectRatio").value,D,this.img.width,Z,this.img.height,0,0),f.drawImage(this.img,0,0)),f.restore())},this.getBoundingBox=function(){var f=this.attribute("x").toPixels("x"),x=this.attribute("y").toPixels("y"),C=this.attribute("width").toPixels("x"),D=this.attribute("height").toPixels("y");return new b.BoundingBox(f,x,f+C,x+D)})},b.Element.image.prototype=new b.Element.RenderedElementBase,b.Element.g=function(O){this.base=b.Element.RenderedElementBase,this.base(O),this.getBoundingBox=function(){for(var M=new b.BoundingBox,T=0;T<this.children.length;T++)M.addBoundingBox(this.children[T].getBoundingBox());return M}},b.Element.g.prototype=new b.Element.RenderedElementBase,b.Element.symbol=function(O){this.base=b.Element.RenderedElementBase,this.base(O),this.render=function(M){}},b.Element.symbol.prototype=new b.Element.RenderedElementBase,b.Element.style=function(O){this.base=b.Element.ElementBase,this.base(O);for(var M="",T=0;T<O.childNodes.length;T++)M+=O.childNodes[T].data;M=M.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");for(var j=(M=b.compressSpaces(M)).split("}"),T=0;T<j.length;T++)if(b.trim(j[T])!="")for(var f=j[T].split("{"),x=f[0].split(","),C=f[1].split(";"),D=0;D<x.length;D++){var Z=b.trim(x[D]);if(Z!=""){for(var it=b.Styles[Z]||{},st=0;st<C.length;st++){var at=C[st].indexOf(":"),lt=C[st].substr(0,at),at=C[st].substr(at+1,C[st].length-at);lt!=null&&at!=null&&(it[b.trim(lt)]=new b.Property(b.trim(lt),b.trim(at)))}if(b.Styles[Z]=it,b.StylesSpecificity[Z]=function(be){function xe(pe,Ne){var Pe=be.match(pe);Pe!=null&&(Ht[Ne]+=Pe.length,be=be.replace(pe," "))}var Ht=[0,0,0];return be=(be=be.replace(/:not\(([^\)]*)\)/g,"     $1 ")).replace(/{[\s\S]*/gm," "),xe(h,1),xe(u,0),xe(d,1),xe(p,2),xe(m,1),xe(v,1),be=(be=be.replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," "),xe(k,2),Ht.join("")}(Z),Z=="@font-face"){for(var mt=it["font-family"].value.replace(/"/g,""),Mt=it.src.value.split(","),Et=0;Et<Mt.length;Et++)if(0<Mt[Et].indexOf('format("svg")'))for(var Zt=Mt[Et].indexOf("url"),xt=Mt[Et].indexOf(")",Zt),xt=Mt[Et].substr(Zt+5,xt-Zt-6),Bt=b.parseXml(b.ajax(xt)).getElementsByTagName("font"),ce=0;ce<Bt.length;ce++){var me=b.CreateElement(Bt[ce]);b.Definitions[mt]=me}}}}},b.Element.style.prototype=new b.Element.ElementBase,b.Element.use=function(O){this.base=b.Element.RenderedElementBase,this.base(O),this.baseSetContext=this.setContext,this.setContext=function(T){this.baseSetContext(T),this.attribute("x").hasValue()&&T.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&T.translate(0,this.attribute("y").toPixels("y"))};var M=this.getHrefAttribute().getDefinition();this.path=function(T){M!=null&&M.path(T)},this.getBoundingBox=function(){if(M!=null)return M.getBoundingBox()},this.renderChildren=function(T){var j,f;M!=null&&((j=M).type=="symbol"&&((j=new b.Element.svg).type="svg",j.attributes.viewBox=new b.Property("viewBox",M.attribute("viewBox").value),j.attributes.preserveAspectRatio=new b.Property("preserveAspectRatio",M.attribute("preserveAspectRatio").value),j.attributes.overflow=new b.Property("overflow",M.attribute("overflow").value),j.children=M.children),j.type=="svg"&&(this.attribute("width").hasValue()&&(j.attributes.width=new b.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(j.attributes.height=new b.Property("height",this.attribute("height").value))),f=j.parent,j.parent=null,j.render(T),j.parent=f)}},b.Element.use.prototype=new b.Element.RenderedElementBase,b.Element.mask=function(O){this.base=b.Element.ElementBase,this.base(O),this.apply=function(M,T){var j=this.attribute("x").toPixels("x"),f=this.attribute("y").toPixels("y"),x=this.attribute("width").toPixels("x"),C=this.attribute("height").toPixels("y");if(x==0&&C==0){for(var D=new b.BoundingBox,Z=0;Z<this.children.length;Z++)D.addBoundingBox(this.children[Z].getBoundingBox());j=Math.floor(D.x1),f=Math.floor(D.y1),x=Math.floor(D.width()),C=Math.floor(D.height())}var it=T.attribute("mask").value,st=(T.attribute("mask").value="",document.createElement("canvas")),lt=(st.width=j+x,st.height=f+C,st.getContext("2d")),at=(this.renderChildren(lt),document.createElement("canvas")),mt=(at.width=j+x,at.height=f+C,at.getContext("2d"));T.render(mt),mt.globalCompositeOperation="destination-in",mt.fillStyle=lt.createPattern(st,"no-repeat"),mt.fillRect(0,0,j+x,f+C),M.fillStyle=mt.createPattern(at,"no-repeat"),M.fillRect(0,0,j+x,f+C),T.attribute("mask").value=it},this.render=function(M){}},b.Element.mask.prototype=new b.Element.ElementBase,b.Element.clipPath=function(O){this.base=b.Element.ElementBase,this.base(O),this.apply=function(M){var T=CanvasRenderingContext2D.prototype.beginPath,j=(CanvasRenderingContext2D.prototype.beginPath=function(){},CanvasRenderingContext2D.prototype.closePath);CanvasRenderingContext2D.prototype.closePath=function(){},T.call(M);for(var f=0;f<this.children.length;f++){var x,C=this.children[f];C.path!==void 0&&(C.style("transform",!1,!(x=null)).hasValue()&&(x=new b.Transform(C.style("transform",!1,!0).value)).apply(M),C.path(M),CanvasRenderingContext2D.prototype.closePath=j,x&&x.unapply(M))}j.call(M),M.clip(),CanvasRenderingContext2D.prototype.beginPath=T,CanvasRenderingContext2D.prototype.closePath=j},this.render=function(M){}},b.Element.clipPath.prototype=new b.Element.ElementBase,b.Element.filter=function(O){this.base=b.Element.ElementBase,this.base(O),this.apply=function(M,T){for(var D=T.getBoundingBox(),j=Math.floor(D.x1),f=Math.floor(D.y1),x=Math.floor(D.width()),C=Math.floor(D.height()),D=T.style("filter").value,st=(T.style("filter").value="",0),lt=0,Z=0;Z<this.children.length;Z++)var it=this.children[Z].extraFilterDistance||0,st=Math.max(st,it),lt=Math.max(lt,it);var at=document.createElement("canvas"),mt=(at.width=x+2*st,at.height=C+2*lt,at.getContext("2d"));for(mt.translate(-j+st,-f+lt),T.render(mt),Z=0;Z<this.children.length;Z++)typeof this.children[Z].apply=="function"&&this.children[Z].apply(mt,0,0,x+2*st,C+2*lt);M.drawImage(at,0,0,x+2*st,C+2*lt,j-st,f-lt,x+2*st,C+2*lt),T.style("filter",!0).value=D},this.render=function(M){}},b.Element.filter.prototype=new b.Element.ElementBase,b.Element.feDropShadow=function(O){this.base=b.Element.ElementBase,this.base(O),this.addStylesFromStyleDefinition(),this.apply=function(M,T,j,f,x){}},b.Element.feDropShadow.prototype=new b.Element.ElementBase,b.Element.feMorphology=function(O){this.base=b.Element.ElementBase,this.base(O),this.apply=function(M,T,j,f,x){}},b.Element.feMorphology.prototype=new b.Element.ElementBase,b.Element.feComposite=function(O){this.base=b.Element.ElementBase,this.base(O),this.apply=function(M,T,j,f,x){}},b.Element.feComposite.prototype=new b.Element.ElementBase,b.Element.feColorMatrix=function(O){this.base=b.Element.ElementBase,this.base(O);var M=b.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var j=M[0],M=[.213+.787*j,.715-.715*j,.072-.072*j,0,0,.213-.213*j,.715+.285*j,.072-.072*j,0,0,.213-.213*j,.715-.715*j,.072+.928*j,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var T=M[0]*Math.PI/180,j=function(Z,it,st){return Z+Math.cos(T)*it+Math.sin(T)*st};M=[j(.213,.787,-.213),j(.715,-.715,-.715),j(.072,-.072,.928),0,0,j(.213,-.213,.143),j(.715,.285,.14),j(.072,-.072,-.283),0,0,j(.213,-.213,-.787),j(.715,-.715,.715),j(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":M=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}function f(D,Z,it,st,lt,at){return D[it*st*4+4*Z+at]}function x(D,Z,it,st,lt,at,mt){D[it*st*4+4*Z+at]=mt}function C(D,Z){return D=M[D],D*(D<0?Z-255:Z)}this.apply=function(D,Z,it,st,lt){for(var at=D.getImageData(0,0,st,lt),it=0;it<lt;it++)for(Z=0;Z<st;Z++){var mt=f(at.data,Z,it,st,0,0),Mt=f(at.data,Z,it,st,0,1),Et=f(at.data,Z,it,st,0,2),Zt=f(at.data,Z,it,st,0,3);x(at.data,Z,it,st,0,0,C(0,mt)+C(1,Mt)+C(2,Et)+C(3,Zt)+C(4,1)),x(at.data,Z,it,st,0,1,C(5,mt)+C(6,Mt)+C(7,Et)+C(8,Zt)+C(9,1)),x(at.data,Z,it,st,0,2,C(10,mt)+C(11,Mt)+C(12,Et)+C(13,Zt)+C(14,1)),x(at.data,Z,it,st,0,3,C(15,mt)+C(16,Mt)+C(17,Et)+C(18,Zt)+C(19,1))}D.clearRect(0,0,st,lt),D.putImageData(at,0,0)}},b.Element.feColorMatrix.prototype=new b.Element.ElementBase,b.Element.feGaussianBlur=function(O){this.base=b.Element.ElementBase,this.base(O),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(M,T,j,f,x){s.canvasRGBA===void 0?b.log("ERROR: StackBlur.js must be included for blur to work"):(M.canvas.id=b.UniqueId(),M.canvas.style.display="none",document.body.appendChild(M.canvas),s.canvasRGBA(M.canvas.id,T,j,f,x,this.blurRadius),document.body.removeChild(M.canvas))}},b.Element.feGaussianBlur.prototype=new b.Element.ElementBase,b.Element.title=function(O){},b.Element.title.prototype=new b.Element.ElementBase,b.Element.desc=function(O){},b.Element.desc.prototype=new b.Element.ElementBase,b.Element.MISSING=function(O){b.log("ERROR: Element '"+O.nodeName+"' not yet implemented.")},b.Element.MISSING.prototype=new b.Element.ElementBase,b.CreateElement=function(O){var M=(M=O.nodeName.replace(/^[^:]+:/,"")).replace(/\-/g,""),T=null;return(T=new(b.Element[M]!==void 0?b.Element[M]:b.Element.MISSING)(O)).type=O.nodeName,T},b.load=function(O,M){b.loadXml(O,b.ajax(M))},b.loadXml=function(O,M){b.loadXmlDoc(O,b.parseXml(M))},b.loadXmlDoc=function(O,M){b.init(O);function T(D){for(var Z=O.canvas;Z;)D.x-=Z.offsetLeft,D.y-=Z.offsetTop,Z=Z.offsetParent;return window.scrollX&&(D.x+=window.scrollX),window.scrollY&&(D.y+=window.scrollY),D}function j(){b.ViewPort.Clear(),O.canvas.parentNode&&b.ViewPort.SetCurrent(O.canvas.parentNode.clientWidth,O.canvas.parentNode.clientHeight),b.opts.ignoreDimensions!=1&&(f.style("width").hasValue()&&(O.canvas.width=f.style("width").toPixels("x"),O.canvas.style.width=O.canvas.width+"px"),f.style("height").hasValue()&&(O.canvas.height=f.style("height").toPixels("y"),O.canvas.style.height=O.canvas.height+"px"));var D,Z,it,st=O.canvas.clientWidth||O.canvas.width,lt=O.canvas.clientHeight||O.canvas.height;b.opts.ignoreDimensions==1&&f.style("width").hasValue()&&f.style("height").hasValue()&&(st=f.style("width").toPixels("x"),lt=f.style("height").toPixels("y")),b.ViewPort.SetCurrent(st,lt),b.opts.offsetX!=null&&(f.attribute("x",!0).value=b.opts.offsetX),b.opts.offsetY!=null&&(f.attribute("y",!0).value=b.opts.offsetY),b.opts.scaleWidth==null&&b.opts.scaleHeight==null||(Z=D=null,it=b.ToNumberArray(f.attribute("viewBox").value),b.opts.scaleWidth!=null&&(f.attribute("width").hasValue()?D=f.attribute("width").toPixels("x")/b.opts.scaleWidth:isNaN(it[2])||(D=it[2]/b.opts.scaleWidth)),b.opts.scaleHeight!=null&&(f.attribute("height").hasValue()?Z=f.attribute("height").toPixels("y")/b.opts.scaleHeight:isNaN(it[3])||(Z=it[3]/b.opts.scaleHeight)),D==null&&(D=Z),Z==null&&(Z=D),f.attribute("width",!0).value=b.opts.scaleWidth,f.attribute("height",!0).value=b.opts.scaleHeight,f.style("transform",!0,!0).value+=" scale("+1/D+","+1/Z+")"),b.opts.ignoreClear!=1&&O.clearRect(0,0,st,lt),f.render(O),x&&(x=!1,typeof b.opts.renderCallback=="function"&&b.opts.renderCallback(M))}b.opts.ignoreMouse!=1&&(O.canvas.onclick=function(D){D=T(new b.Point((D??event).clientX,(D??event).clientY)),b.Mouse.onclick(D.x,D.y)},O.canvas.onmousemove=function(D){D=T(new b.Point((D??event).clientX,(D??event).clientY)),b.Mouse.onmousemove(D.x,D.y)});var f=b.CreateElement(M.documentElement),x=(f.root=!0,f.addStylesFromStyleDefinition(),!0),C=!0;b.ImagesLoaded()&&(C=!1,j()),b.intervalID=setInterval(function(){var D=!1;if(C&&b.ImagesLoaded()&&(D=!(C=!1)),b.opts.ignoreMouse!=1&&(D|=b.Mouse.hasEvents()),b.opts.ignoreAnimation!=1)for(var Z=0;Z<b.Animations.length;Z++)D|=b.Animations[Z].update(1e3/b.FRAMERATE);(D=typeof b.opts.forceRedraw=="function"&&b.opts.forceRedraw()==1?!0:D)&&(j(),b.Mouse.runEvents())},1e3/b.FRAMERATE)},b.stop=function(){b.intervalID&&clearInterval(b.intervalID)},b.Mouse=new function(){this.events=[],this.hasEvents=function(){return this.events.length!=0},this.onclick=function(O,M){this.events.push({type:"onclick",x:O,y:M,run:function(T){T.onclick&&T.onclick()}})},this.onmousemove=function(O,M){this.events.push({type:"onmousemove",x:O,y:M,run:function(T){T.onmousemove&&T.onmousemove()}})},this.eventElements=[],this.checkPath=function(O,M){for(var T=0;T<this.events.length;T++){var j=this.events[T];M.isPointInPath&&M.isPointInPath(j.x,j.y)&&(this.eventElements[T]=O)}},this.checkBoundingBox=function(O,M){for(var T=0;T<this.events.length;T++){var j=this.events[T];M.isPointInBox(j.x,j.y)&&(this.eventElements[T]=O)}},this.runEvents=function(){b.ctx.canvas.style.cursor="";for(var O=0;O<this.events.length;O++)for(var M=this.events[O],T=this.eventElements[O];T;)M.run(T),T=T.parent;this.events=[],this.eventElements=[]}},b}(G||{}),I=(I.childNodes.length==1&&I.childNodes[0].nodeName=="OBJECT"||(I.svg=G),I.getContext("2d")),N.documentElement!==void 0?G.loadXmlDoc(I,N):N.substr(0,1)=="<"?G.loadXml(I,N):G.load(I,N)},Element.prototype.matches!==void 0?l=function(I,N){return I.matches(N)}:Element.prototype.webkitMatchesSelector!==void 0?l=function(I,N){return I.webkitMatchesSelector(N)}:Element.prototype.mozMatchesSelector!==void 0?l=function(I,N){return I.mozMatchesSelector(N)}:Element.prototype.msMatchesSelector!==void 0?l=function(I,N){return I.msMatchesSelector(N)}:Element.prototype.oMatchesSelector!==void 0?l=function(I,N){return I.oMatchesSelector(N)}:(l=typeof jQuery!="function"&&typeof Zepto!="function"?l:function(I,N){return $(I).is(N)})===void 0&&(l=Sizzle.matchesSelector),h=/(\[[^\]]+\])/g,u=/(#[^\s\+>~\.\[:]+)/g,d=/(\.[^\s\+>~\.\[:]+)/g,p=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,m=/(:[\w-]+\([^\)]*\))/gi,v=/(:[^\s\+>~\.\[:]+)/g,k=/([^\s\+>~\.\[:]+)/g,typeof CanvasRenderingContext2D<"u"&&(CanvasRenderingContext2D.prototype.drawSvg=function(I,N,G,F,H,Y){var _,K={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:N,offsetY:G,scaleWidth:F,scaleHeight:H};for(_ in Y)Y.hasOwnProperty(_)&&(K[_]=Y[_]);a(this.canvas,I,K)}),a},t.exports&&(t.exports=i(n=wt,r=Oe)),e.canvg=i(n!==void 0?n:e.RGBColor,typeof statckblur<"u"?r:e.stackBlur)})({exports:{}});function Ce(t,e){return e*qt(t/e)}function On(t){return 180*t/Hn%360}function bn(t,e){var i;return e===void 0?(e=t===void 0?1:t,t=0):e<t&&(i=t,t=e,e=i),yr(Math.random()*(e-t+1)+t)}function re(r,n){var o=Qe(r.y),i=Qe(n.y),r=r.x,n=n.x,n=Qe(n-r),r=xn(n)*A(i),o=A(o)*xn(i)-xn(o)*A(i)*A(n);return(i=On(Ve(r,o))-22.5)<0&&(i+=360),["NE","E","SE","S","SW","W","NW","N"][i=parseInt(i/45)]}function oe(n,e){var i=n.x,n=n.y;return(i-=e.x)*i+(n-=e.y)*n}function Rn(t,e){return Math.sqrt(oe(t,e))}var qt=Math.round,yr=Math.floor,Hn=Math.PI,Ge={linear:function(t,e,i){var n=t[1]-t[0],r=e[1]-e[0];return(i-t[0])/n*r+e[0]||0}},Xe=function(t){return t%360+(t<0?360:0)},Qe=function(t,e){return(t=(e=e||!1)?t:t%360)*Hn/180},A=Math.cos,xn=Math.sin,Ve=Math.atan2,le={Point:1,Line:2,Ellipse:3,Rect:4,Polyline:5,Polygon:6,Curve:7,Path:8},Or=Math.abs,Rr=Math.cos,Ee=Math.sin,sr=Math.sqrt,Ko=Math.min,fo=Math.max,hn=Math.atan2,jr=Math.round,ar=Math.pow,mo=Math.PI,Q=function(t,e){if(!(this instanceof Q))return new Q(t,e);var i;typeof t=="string"?(i=t.split(t.indexOf("@")===-1?" ":"@"),t=parseFloat(i[0]),e=parseFloat(i[1])):Object(t)===t&&(e=t.y,t=t.x),this.x=t===void 0?0:t,this.y=e===void 0?0:e},se=(Q.fromPolar=function(r,o,i){i=new Q(i);var n=Or(r*Rr(o)),r=Or(r*Ee(o)),o=Xe(On(o));return o<90?r=-r:o<180?(n=-n,r=-r):o<270&&(n=-n),new Q(i.x+n,i.y+r)},Q.random=function(t,e,i,n){return new Q(bn(t,e),bn(i,n))},Q.prototype={type:le.Point,chooseClosest:function(t){var e=t.length;if(e===1)return new Q(t[0]);for(var i=null,n=1/0,r=0;r<e;r++){var o=new Q(t[r]),s=this.squaredDistance(o);s<n&&(i=o,n=s)}return i},adhereToRect:function(t){return t.containsPoint(this)||(this.x=Ko(fo(this.x,t.x),t.x+t.width),this.y=Ko(fo(this.y,t.y),t.y+t.height)),this},angleBetween:function(t,e){return e=this.equals(t)||this.equals(e)?NaN:this.theta(e)-this.theta(t),e<0&&(e+=360),e},bearing:function(t){return re(this,t)},changeInAngle:function(t,e,i){return this.clone().offset(-t,-e).theta(i)-this.theta(i)},clone:function(){return new Q(this)},cross:function(t,e){return t&&e?(e.x-this.x)*(t.y-this.y)-(e.y-this.y)*(t.x-this.x):NaN},difference:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),new Q(this.x-(t||0),this.y-(e||0))},distance:function(t){return Rn(this,t)},dot:function(t){return t?this.x*t.x+this.y*t.y:NaN},equals:function(t){return!!t&&this.x===t.x&&this.y===t.y},lerp:function(t,e){var i=this.x,n=this.y;return new Q((1-e)*i+e*t.x,(1-e)*n+e*t.y)},magnitude:function(){return sr(this.x*this.x+this.y*this.y)||.01},manhattanDistance:function(t){return Or(t.x-this.x)+Or(t.y-this.y)},move:function(t,e){return t=Qe(new Q(t).theta(this)),this.offset(Rr(t)*e,-Ee(t)*e)},normalize:function(t){return t=(t||1)/this.magnitude(),this.scale(t,t)},offset:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),this.x+=t||0,this.y+=e||0,this},reflection:function(t){return new Q(t).move(this,this.distance(t))},rotate:function(t,e){var i,n;return e!==0&&(t=t||new Q(0,0),e=Qe(Xe(-e)),i=Rr(e),e=Ee(e),n=i*(this.x-t.x)-e*(this.y-t.y)+t.x,e=e*(this.x-t.x)+i*(this.y-t.y)+t.y,this.x=n,this.y=e),this},round:function(t){var e=1;if(t)switch(t){case 1:e=10;break;case 2:e=100;break;case 3:e=1e3;break;default:e=ar(10,t)}return this.x=jr(this.x*e)/e,this.y=jr(this.y*e)/e,this},scale:function(t,e,i){return i=i&&new Q(i)||new Q(0,0),this.x=i.x+t*(this.x-i.x),this.y=i.y+e*(this.y-i.y),this},snapToGrid:function(t,e){return this.x=Ce(this.x,t),this.y=Ce(this.y,e||t),this},squaredDistance:function(t){return oe(this,t)},theta:function(e){var i=-((e=new Q(e)).y-this.y),e=e.x-this.x,i=hn(i,e);return 180*(i=i<0?2*mo+i:i)/mo},toJSON:function(){return{x:this.x,y:this.y}},toPolar:function(t){t=t&&new Q(t)||new Q(0,0);var e=this.x,i=this.y;return this.x=sr((e-t.x)*(e-t.x)+(i-t.y)*(i-t.y)),this.y=Qe(t.theta(new Q(e,i))),this},toString:function(){return this.x+"@"+this.y},serialize:function(){return this.x+","+this.y},update:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),this.x=t||0,this.y=e||0,this},vectorAngle:function(t){return new Q(0,0).angleBetween(this,t)}},Q.prototype.translate=Q.prototype.offset,Q),br=Math.max,Gr=Math.min,Ot=function(t,e){return this instanceof Ot?t instanceof Ot?new Ot(t.start,t.end):(this.start=new Q(t),void(this.end=new Q(e))):new Ot(t,e)},Xn=(Ot.prototype={type:le.Line,angle:function(){var t=new Q(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,t)},bbox:function(){var t=Gr(this.start.x,this.end.x),e=Gr(this.start.y,this.end.y),i=br(this.start.x,this.end.x),n=br(this.start.y,this.end.y);return new nt(t,e,i-t,n-e)},bearing:function(){return re(this.start,this.end)},clone:function(){return new Ot(this.start,this.end)},closestPoint:function(t){return this.pointAt(this.closestPointNormalizedLength(t))},closestPointLength:function(t){return this.closestPointNormalizedLength(t)*this.length()},closestPointNormalizedLength:function(t){return t=this.vector().dot(new Ot(this.start,t).vector()),t=Gr(1,br(0,t/this.squaredLength())),t!=t?0:t},closestPointTangent:function(t){return this.tangentAt(this.closestPointNormalizedLength(t))},containsPoint:function(t){var e,i=this.start,n=this.end;return i.cross(t,n)===0&&(e=this.length(),!(new Ot(i,t).length()>e)&&!(new Ot(t,n).length()>e))},divideAt:function(t){return t=this.pointAt(t),[new Ot(this.start,t),new Ot(t,this.end)]},divideAtLength:function(t){return t=this.pointAtLength(t),[new Ot(this.start,t),new Ot(t,this.end)]},equals:function(t){return!!t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.end.x===t.end.x&&this.end.y===t.end.y},intersect:function(t,e){return t&&t.intersectionWithLine?(e=t.intersectionWithLine(this,e))&&t instanceof Ot?e[0]:e:null},intersectionWithLine:function(r){var e=new Q(this.end.x-this.start.x,this.end.y-this.start.y),n=new Q(r.end.x-r.start.x,r.end.y-r.start.y),i=e.x*n.y-e.y*n.x,r=new Q(r.start.x-this.start.x,r.start.y-this.start.y),n=r.x*n.y-r.y*n.x,r=r.x*e.y-r.y*e.x;if(i==0||n*i<0||r*i<0)return null;if(0<i){if(i<n||i<r)return null}else if(n<i||r<i)return null;return[new Q(this.start.x+n*e.x/i,this.start.y+n*e.y/i)]},isDifferentiable:function(){return!this.start.equals(this.end)},length:function(){return Rn(this.start,this.end)},midpoint:function(){return new Q((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)},parallel:function(t){var e,i,n,r,o=this.clone();return this.isDifferentiable()&&(e=o.start,i=o.end,n=e.clone().rotate(i,270),r=i.clone().rotate(e,90),e.move(r,t),i.move(n,t)),o},pointAt:function(t){var e=this.start,i=this.end;return t<=0?e.clone():1<=t?i.clone():e.lerp(i,t)},pointAtLength:function(t){var e=this.start,i=this.end,n=!0,r=(t<0&&(n=!1,t=-t),this.length());return r<=t?(n?i:e).clone():this.pointAt((n?t:r-t)/r)},pointOffset:function(t){t=new Q(t);var e=this.start,i=this.end;return((i.x-e.x)*(t.y-e.y)-(i.y-e.y)*(t.x-e.x))/this.length()},rotate:function(t,e){return this.start.rotate(t,e),this.end.rotate(t,e),this},round:function(t){return this.start.round(t),this.end.round(t),this},scale:function(t,e,i){return this.start.scale(t,e,i),this.end.scale(t,e,i),this},setLength:function(t){var e=this.length();return e?this.scale(t=t/e,t,this.start):this},squaredLength:function(){return oe(this.start,this.end)},tangentAt:function(t){var e,i;return this.isDifferentiable()?(e=this.start,i=this.end,t=this.pointAt(t),(i=new Ot(e,i)).translate(t.x-e.x,t.y-e.y),i):null},tangentAtLength:function(t){var e,i;return this.isDifferentiable()?(e=this.start,i=this.end,t=this.pointAtLength(t),(i=new Ot(e,i)).translate(t.x-e.x,t.y-e.y),i):null},toString:function(){return this.start.toString()+" "+this.end.toString()},serialize:function(){return this.start.serialize()+" "+this.end.serialize()},translate:function(t,e){return this.start.translate(t,e),this.end.translate(t,e),this},vector:function(){return new Q(this.end.x-this.start.x,this.end.y-this.start.y)}},Ot.prototype.intersection=Ot.prototype.intersect,Ot),wn=Math.sqrt,Vr=Math.round,Qo=Math.pow,We=function(t,e,i){return this instanceof We?t instanceof We?new We(new Q(t.x,t.y),t.a,t.b):(t=new Q(t),this.x=t.x,this.y=t.y,this.a=e,void(this.b=i)):new We(t,e,i)},Zi=(We.fromRect=function(t){return t=new nt(t),new We(t.center(),t.width/2,t.height/2)},We.prototype={type:le.Ellipse,bbox:function(){return new nt(this.x-this.a,this.y-this.b,2*this.a,2*this.b)},center:function(){return new Q(this.x,this.y)},clone:function(){return new We(this)},containsPoint:function(t){return this.normalizedDistance(t)<=1},equals:function(t){return!!t&&t.x===this.x&&t.y===this.y&&t.a===this.a&&t.b===this.b},inflate:function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.a+=2*t,this.b+=2*e,this},intersectionWithLine:function(l){var e=[],i=l.start,n=l.end,o=this.a,s=this.b,l=l.vector(),r=i.difference(new Q(this)),a=new Q(l.x/(o*o),l.y/(s*s)),o=new Q(r.x/(o*o),r.y/(s*s)),s=l.dot(a),a=l.dot(o),l=a*a-s*(r.dot(o)-1);if(l<0)return null;if(0<l){if(r=wn(l),o=(-a-r)/s,l=(-a+r)/s,(o<0||1<o)&&(l<0||1<l))return null;0<=o&&o<=1&&e.push(i.lerp(n,o)),0<=l&&l<=1&&e.push(i.lerp(n,l))}else{if(r=-a/s,!(0<=r&&r<=1))return null;e.push(i.lerp(n,r))}return e},intersectionWithLineFromCenterToPoint:function(t,e){t=new Q(t),e&&t.rotate(new Q(this.x,this.y),e);var i,n,r=t.x-this.x,o=t.y-this.y;return n=r==0?this.bbox().pointNearestToPoint(t):(t=this.a*this.a,i=this.b*this.b,o=wn(1/(1/t+(t=o/r)*t/i)),new Q(this.x+(o=r<0?-o:o),this.y+t*o)),e?n.rotate(new Q(this.x,this.y),-e):n},normalizedDistance:function(i){var e=i.x,i=i.y,n=this.a,r=this.b,o=this.x,s=this.y;return(e-o)*(e-o)/(n*n)+(i-s)*(i-s)/(r*r)},round:function(t){var e=1;if(t)switch(t){case 1:e=10;break;case 2:e=100;break;case 3:e=1e3;break;default:e=Qo(10,t)}return this.x=Vr(this.x*e)/e,this.y=Vr(this.y*e)/e,this.a=Vr(this.a*e)/e,this.b=Vr(this.b*e)/e,this},tangentTheta:function(t){var e,i,n=t.x,r=t.y,o=this.a,s=this.b,a=this.bbox().center(),l=a.x,h=a.y,u=n>a.x+o/2,d=n<a.x-o/2;return u||d?i=o*o/(n-l)-o*o*(r-h)*((e=n>a.x?r-30:r+30)-h)/(s*s*(n-l))+l:e=s*s/(r-h)-s*s*(n-l)*((i=r>a.y?n+30:n-30)-l)/(o*o*(r-h))+h,new Q(i,e).theta(t)},toString:function(){return new Q(this.x,this.y).toString()+" "+this.a+" "+this.b}},We),qo=Math.abs,Jn=Math.cos,$n=Math.sin,z=Math.min,U=Math.max,et=Math.round,gt=Math.pow,nt=function(t,e,i,n){if(!(this instanceof nt))return new nt(t,e,i,n);Object(t)===t&&(e=t.y,i=t.width,n=t.height,t=t.x),this.x=t===void 0?0:t,this.y=e===void 0?0:e,this.width=i===void 0?0:i,this.height=n===void 0?0:n},It=(nt.fromEllipse=function(t){return t=new We(t),new nt(t.x-t.a,t.y-t.b,2*t.a,2*t.b)},nt.fromPointUnion=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t.length===0)return null;for(var i,n,r=new Q,o=i=1/0,s=n=-1/0,a=0;a<t.length;a++){r.update(t[a]);var l=r.x,h=r.y;l<o&&(o=l),s<l&&(s=l),h<i&&(i=h),n<h&&(n=h)}return new nt(o,i,s-o,n-i)},nt.fromRectUnion=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t.length===0)return null;for(var i,n,r=new nt,o=i=1/0,s=n=-1/0,a=0;a<t.length;a++){r.update(t[a]);var l=r.x,h=r.y,u=l+r.width,d=h+r.height;l<o&&(o=l),s<u&&(s=u),h<i&&(i=h),n<d&&(n=d)}return new nt(o,i,s-o,n-i)},nt.prototype={type:le.Rect,bbox:function(t){return this.clone().rotateAroundCenter(t)},rotateAroundCenter:function(t){var e,i,n,r;return t&&(n=this.width,e=this.height,t=Qe(t),r=n*(i=qo($n(t)))+e*(t=qo(Jn(t))),this.x+=(n-(n=n*t+e*i))/2,this.y+=(e-r)/2,this.width=n,this.height=r),this},bottomLeft:function(){return new Q(this.x,this.y+this.height)},bottomLine:function(){return new Ot(this.bottomLeft(),this.bottomRight())},bottomMiddle:function(){return new Q(this.x+this.width/2,this.y+this.height)},center:function(){return new Q(this.x+this.width/2,this.y+this.height/2)},clone:function(){return new nt(this)},containsPoint:function(t){return(t=t instanceof Q?t:new Q(t)).x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.y<=this.y+this.height},containsRect:function(r){var e,i,n=new nt(this).normalize(),r=new nt(r).normalize(),o=n.width,s=n.height,a=r.width,l=r.height;return!!(o&&s&&a&&l)&&(e=n.x,n=n.y,a+=i=r.x,o+=e,l+=r=r.y,s+=n,e<=i&&a<=o&&n<=r&&l<=s)},corner:function(){return new Q(this.x+this.width,this.y+this.height)},equals:function(i){var e=new nt(this).normalize(),i=new nt(i).normalize();return e.x===i.x&&e.y===i.y&&e.width===i.width&&e.height===i.height},inflate:function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},intersect:function(o){var e,i=this.origin(),n=this.corner(),r=o.origin(),o=o.corner();return o.x<=i.x||o.y<=i.y||r.x>=n.x||r.y>=n.y?null:(e=U(i.x,r.x),i=U(i.y,r.y),new nt(e,i,z(n.x,o.x)-e,z(n.y,o.y)-i))},intersectionWithLine:function(t){for(var e,i=[this.topLine(),this.rightLine(),this.bottomLine(),this.leftLine()],n=[],r=[],o=i.length,s=0;s<o;s++)(e=t.intersect(i[s]))!==null&&r.indexOf(e.toString())<0&&(n.push(e),r.push(e.toString()));return 0<n.length?n:null},intersectionWithLineFromCenterToPoint:function(t,e){t=new Q(t);for(var i,n=new Q(this.x+this.width/2,this.y+this.height/2),r=(e&&t.rotate(n,e),[this.topLine(),this.rightLine(),this.bottomLine(),this.leftLine()]),o=new Ot(n,t),s=r.length-1;0<=s;--s){var a=r[s].intersection(o);if(a!==null){i=a;break}}return i&&e&&i.rotate(n,-e),i},leftLine:function(){return new Ot(this.topLeft(),this.bottomLeft())},leftMiddle:function(){return new Q(this.x,this.y+this.height/2)},maxRectScaleToFit:function(t,u){t=new nt(t);var i,n,r,o,s,a,l,h=(u=u||t.center()).x,u=u.y,d=i=n=r=o=s=a=l=1/0,p=t.topLeft(),p=(p.x<h&&(d=(this.x-h)/(p.x-h)),p.y<u&&(o=(this.y-u)/(p.y-u)),t.bottomRight()),p=(p.x>h&&(i=(this.x+this.width-h)/(p.x-h)),p.y>u&&(s=(this.y+this.height-u)/(p.y-u)),t.topRight()),p=(p.x>h&&(n=(this.x+this.width-h)/(p.x-h)),p.y<u&&(a=(this.y-u)/(p.y-u)),t.bottomLeft());return p.x<h&&(r=(this.x-h)/(p.x-h)),p.y>u&&(l=(this.y+this.height-u)/(p.y-u)),{sx:z(d,i,n,r),sy:z(o,s,a,l)}},maxRectUniformScaleToFit:function(t,e){return t=this.maxRectScaleToFit(t,e),z(t.sx,t.sy)},moveAndExpand:function(t){return this.x+=t.x||0,this.y+=t.y||0,this.width+=t.width||0,this.height+=t.height||0,this},normalize:function(){var t=this.x,e=this.y,i=this.width,n=this.height;return this.width<0&&(t=this.x+this.width,i=-this.width),this.height<0&&(e=this.y+this.height,n=-this.height),this.x=t,this.y=e,this.width=i,this.height=n,this},offset:function(t,e){return Q.prototype.offset.call(this,t,e)},origin:function(){return new Q(this.x,this.y)},pointNearestToPoint:function(t){if(t=new Q(t),this.containsPoint(t))switch(this.sideNearestToPoint(t)){case"right":return new Q(this.x+this.width,t.y);case"left":return new Q(this.x,t.y);case"bottom":return new Q(t.x,this.y+this.height);case"top":return new Q(t.x,this.y)}return t.adhereToRect(this)},rightLine:function(){return new Ot(this.topRight(),this.bottomRight())},rightMiddle:function(){return new Q(this.x+this.width,this.y+this.height/2)},round:function(t){var e=1;if(t)switch(t){case 1:e=10;break;case 2:e=100;break;case 3:e=1e3;break;default:e=gt(10,t)}return this.x=et(this.x*e)/e,this.y=et(this.y*e)/e,this.width=et(this.width*e)/e,this.height=et(this.height*e)/e,this},scale:function(t,e,i){return i=this.origin().scale(t,e,i),this.x=i.x,this.y=i.y,this.width*=t,this.height*=e,this},sideNearestToPoint:function(t){var e=(t=new Q(t)).x-this.x,i=this.x+this.width-t.x,n=t.y-this.y,r="left";return i<e&&(e=i,r="right"),n<e&&(e=n,r="top"),r=this.y+this.height-t.y<e?"bottom":r},snapToGrid:function(n,e){var i=this.origin().snapToGrid(n,e),n=this.corner().snapToGrid(n,e);return this.x=i.x,this.y=i.y,this.width=n.x-i.x,this.height=n.y-i.y,this},toJSON:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},topLine:function(){return new Ot(this.topLeft(),this.topRight())},topMiddle:function(){return new Q(this.x+this.width/2,this.y)},topRight:function(){return new Q(this.x+this.width,this.y)},toString:function(){return this.origin().toString()+" "+this.corner().toString()},union:function(t){return nt.fromRectUnion(this,t)},update:function(t,e,i,n){return Object(t)===t&&(e=t.y,i=t.width,n=t.height,t=t.x),this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0,this}},nt.prototype.bottomRight=nt.prototype.corner,nt.prototype.topLeft=nt.prototype.origin,nt.prototype.translate=nt.prototype.offset,nt);function Yt(t){if(t=t.trim(),t==="")return[];for(var e=[],i=t.split(/\b\s*,\s*|,\s*|\s+/),n=i.length,r=0;r<n;r+=2)e.push({x:+i[r],y:+i[r+1]});return e}function we(t){var e=t.length;if(e===0)return[];for(var i=[],n=0;n<e;n++){var r=t[n].clone();i.push(r)}return i}function Le(t){var e,i=Math.abs,n=t.length;if(n===0)return[];for(o=0;o<n;o++)(e===void 0||t[o].y<e.y||t[o].y===e.y&&t[o].x>e.x)&&(e=t[o]);for(var r=[],o=0;o<n;o++){var s=e.theta(t[o]),s=(s===0&&(s=360),[t[o],o,s]);r.push(s)}r.sort(function(b,vt){var O=b[2]-vt[2];return O=O===0?vt[1]-b[1]:O}),2<r.length&&r.unshift(r[r.length-1]);for(var a,l,h,u={},d=[];r.length!==0;)if(l=(a=r.pop())[0],!u.hasOwnProperty(a[0]+"@@"+a[1]))for(var p,m,v,k,I,N=!1;!N;)d.length<2?(d.push(a),N=!0):(m=(p=d.pop())[0],(I=(k=(v=d.pop())[0]).cross(m,l))<0?(d.push(v),d.push(p),d.push(a),N=!0):I!==0||i((I=m.angleBetween(k,l))-180)<1e-10||m.equals(l)||k.equals(m)?(u[p[0]+"@@"+p[1]]=m,d.push(v)):i((I+1)%360-1)<1e-10&&(d.push(v),r.push(p)));2<d.length&&d.pop();var G=-1,F=d.length;for(o=0;o<F;o++){var H=d[o][1];(h===void 0||H<h)&&(h=H,G=o)}var Y,_,K=[],tt=[];for(F=(K=0<G?(Y=d.slice(G),_=d.slice(0,G),Y.concat(_)):d).length,o=0;o<F;o++)tt.push(K[o][0]);return tt}var ie=function(t){return this instanceof ie?typeof t=="string"?new ie.parse(t):void(this.points=Array.isArray(t)?t.map(Q):[]):new ie(t)},Je=(ie.parse=function(t){return new ie(Yt(t))},ie.fromRect=function(t){return new ie([t.topLeft(),t.topRight(),t.bottomRight(),t.bottomLeft(),t.topLeft()])},ie.prototype={type:le.Polyline,bbox:function(){var t=1/0,e=-1/0,i=1/0,n=-1/0,r=this.points,o=r.length;if(o===0)return null;for(var s=0;s<o;s++){var l=r[s],a=l.x,l=l.y;a<t&&(t=a),e<a&&(e=a),l<i&&(i=l),n<l&&(n=l)}return new nt(t,i,e-t,n-i)},clone:function(){return new ie(we(this.points))},closestPoint:function(t){return t=this.closestPointLength(t),this.pointAtLength(t)},closestPointLength:function(t){var e,i=this.lengthPoints(),n=i.length;if(n===0||n===1)return 0;for(var r=1/0,o=0,s=n-1,a=0;a<s;a++){var u=new Ot(i[a],i[a+1]),l=u.length(),h=u.closestPointNormalizedLength(t),u=u.pointAt(h).squaredDistance(t);u<r&&(r=u,e=o+h*l),o+=l}return e},closestPointNormalizedLength:function(i){var e,i=this.closestPointLength(i);return i===0||(e=this.length())===0?0:i/e},closestPointTangent:function(t){return t=this.closestPointLength(t),this.tangentAtLength(t)},containsPoint:function(t){var e=this.points,i=e.length;if(i===0)return!1;for(var n=t.x,r=t.y,o=i-1,s=0,a=0,l=new Ot,h=new Ot,u=new Q;s<i;s++){var d=e[o],p=e[s];if(t.equals(d)||(l.start=d,l.end=p,l.containsPoint(t)))return!0;!(r<=d.y&&r>p.y||r>d.y&&r<=p.y)||0<=(d=d.x-n>p.x-n?d.x-n:p.x-n)&&(u.x=n+d,u.y=r,h.start=t,h.end=u,l.intersect(h)&&a++),o=s}return a%2==1},close:function(){var t=this.start,e=this.end,i=this.points;return t&&e&&!t.equals(e)&&i.push(t.clone()),this},lengthPoints:function(){return this.points},convexHull:function(){return new ie(Le(this.points))},equals:function(t){if(!t)return!1;var e=this.points,i=t.points,n=e.length;if(i.length!==n)return!1;for(var r=0;r<n;r++){var o=e[r],s=t.points[r];if(!o.equals(s))return!1}return!0},intersectionWithLine:function(t){for(var e=new Ot(t),i=[],n=this.lengthPoints(),r=new Ot,o=0,s=n.length-1;o<s;o++){r.start=n[o],r.end=n[o+1];var a=e.intersectionWithLine(r);a&&i.push(a[0])}return 0<i.length?i:null},isDifferentiable:function(){var t=this.points,e=t.length;if(e!==0){for(var i=new Ot,n=e-1,r=0;r<n;r++)if(i.start=t[r],i.end=t[r+1],i.isDifferentiable())return!0}return!1},length:function(){var t=this.lengthPoints(),e=t.length;if(e===0)return 0;for(var i=0,n=e-1,r=0;r<n;r++)i+=t[r].distance(t[r+1]);return i},pointAt:function(t){var e=this.lengthPoints(),i=e.length;return i===0?null:i===1||t<=0?e[0].clone():1<=t?e[i-1].clone():(e=this.length(),this.pointAtLength(e*t))},pointAtLength:function(t){var e=this.lengthPoints(),i=e.length;if(i===0)return null;if(i===1)return e[0].clone();for(var n=!0,r=(t<0&&(n=!1,t=-t),0),o=i-1,s=0;s<o;s++){var a=n?s:o-1-s,h=e[a],a=e[a+1],l=new Ot(h,a),h=h.distance(a);if(t<=r+h)return l.pointAtLength((n?1:-1)*(t-r));r+=h}return(n?e[i-1]:e[0]).clone()},round:function(t){for(var e=this.points,i=e.length,n=0;n<i;n++)e[n].round(t);return this},scale:function(t,e,i){for(var n=this.points,r=n.length,o=0;o<r;o++)n[o].scale(t,e,i);return this},simplify:function(t){t===void 0&&(t={});var e=this.points;if(!(e.length<3))for(var i=t.threshold||1e-10,n=0;e[n+2];){var r=n+1,o=e[n],s=e[r],a=e[n+2];new Ot(o,a).closestPoint(s).distance(s)<=i?e.splice(r,1):n+=1}return this},tangentAt:function(t){var e=this.lengthPoints().length;return e===0||e===1?null:(1<(t=t<0?0:t)&&(t=1),e=this.length(),this.tangentAtLength(e*t))},tangentAtLength:function(t){var e=this.lengthPoints(),i=e.length;if(i===0||i===1)return null;for(var n,r=!0,o=(t<0&&(r=!1,t=-t),0),s=i-1,a=0;a<s;a++){var l=r?a:s-1-a,u=e[l],l=e[l+1],h=new Ot(u,l),u=u.distance(l);if(h.isDifferentiable()){if(t<=o+u)return h.tangentAtLength((r?1:-1)*(t-o));n=h}o+=u}return n?n.tangentAt(r?1:0):null},toString:function(){return this.points+""},translate:function(t,e){for(var i=this.points,n=i.length,r=0;r<n;r++)i[r].translate(t,e);return this},serialize:function(){var t=this.points,e=t.length;if(e===0)return"";for(var i="",n=0;n<e;n++){var r=t[n];i+=r.x+","+r.y+" "}return i.trim()}},Object.defineProperty(ie.prototype,"start",{configurable:!0,enumerable:!0,get:function(){return this.points.length===0?null:this.points[0]}}),Object.defineProperty(ie.prototype,"end",{configurable:!0,enumerable:!0,get:function(){var t=this.points.length;return t===0?null:this.points[t-1]}}),Math.abs),jt=Math.sqrt,Ye=Math.min,An=Math.max,vo=Math.pow,$t=function(t,e,i,n){return this instanceof $t?t instanceof $t?new $t(t.start,t.controlPoint1,t.controlPoint2,t.end):(this.start=new Q(t),this.controlPoint1=new Q(e),this.controlPoint2=new Q(i),void(this.end=new Q(n))):new $t(t,e,i,n)};function ui(t){var e=t.length,i=[],n=[],r=2;i[0]=t[0]/r;for(var o=1;o<e;o++)n[o]=1/r,i[o]=(t[o]-i[o-1])/(r=(o<e-1?4:3.5)-n[o]);for(o=1;o<e;o++)i[e-o-1]-=n[e-o]*i[e-o];return i}function Mi(t){for(var e=arguments,i=[],n=arguments.length,r=1;r<n;r++)i.push(e[r]);if(!t)throw new Error("Missing a parent object.");var o=Object.create(t);for(n=i.length,r=0;r<n;r++){var s,a,l=i[r];for(a in l)l.hasOwnProperty(a)&&(delete o[a],s=Object.getOwnPropertyDescriptor(l,a),Object.defineProperty(o,a,s))}return o}$t.throughPoints=function(t){if(!t||Array.isArray(t)&&t.length<2)throw new Error("At least 2 points are required");for(var e=function(a){var l=[],h=[],u=a.length-1;if(u==1)l[0]=new Q((2*a[0].x+a[1].x)/3,(2*a[0].y+a[1].y)/3),h[0]=new Q(2*l[0].x-a[0].x,2*l[0].y-a[0].y);else{for(var d=[],p=1;p<u-1;p++)d[p]=4*a[p].x+2*a[p+1].x;d[0]=a[0].x+2*a[1].x,d[u-1]=(8*a[u-1].x+a[u].x)/2;var m=ui(d);for(p=1;p<u-1;++p)d[p]=4*a[p].y+2*a[p+1].y;d[0]=a[0].y+2*a[1].y,d[u-1]=(8*a[u-1].y+a[u].y)/2;var v=ui(d);for(p=0;p<u;p++)l.push(new Q(m[p],v[p])),h.push(p<u-1?new Q(2*a[p+1].x-m[p+1],2*a[p+1].y-v[p+1]):new Q((a[u].x+m[u-1])/2,(a[u].y+v[u-1])/2))}return[l,h]}(t),i=[],n=e[0].length,r=0;r<n;r++){var o=new Q(e[0][r].x,e[0][r].y),s=new Q(e[1][r].x,e[1][r].y);i.push(new $t(t[r],o,s,t[r+1]))}return i},$t.prototype={type:le.Curve,bbox:function(){for(var t,e,i,n,r,o=this.start,s=this.controlPoint1,a=this.controlPoint2,l=this.end,h=o.x,u=o.y,d=s.x,p=s.y,m=a.x,v=a.y,k=l.x,I=l.y,N=new Array,G=new Array,F=[new Array,new Array],H=0;H<2;++H)n=H===0?(e=6*h-12*d+6*m,t=-3*h+9*d-9*m+3*k,3*d-3*h):(e=6*u-12*p+6*v,t=-3*u+9*p-9*v+3*I,3*p-3*u),Je(t)<1e-12?Je(e)<1e-12||0<(i=-n/e)&&i<1&&G.push(i):(r=jt(n=e*e-4*n*t),n<0||(0<(n=(-e+r)/(2*t))&&n<1&&G.push(n),0<(n=(-e-r)/(2*t))&&n<1&&G.push(n)));for(var Y,_,K=G.length,o=K;K--;)i=G[K],F[0][K]=Y=(_=1-i)*_*_*h+3*_*_*i*d+3*_*i*i*m+i*i*i*k,F[1][K]=_=_*_*_*u+3*_*_*i*p+3*_*i*i*v+i*i*i*I,N[K]={X:Y,Y:_};return G[o]=0,G[o+1]=1,N[o]={X:h,Y:u},N[o+1]={X:k,Y:I},F[0][o]=h,F[1][o]=u,F[0][o+1]=k,F[1][o+1]=I,G.length=o+2,F[0].length=o+2,F[1].length=o+2,N.length=o+2,s=Ye.apply(null,F[0]),a=Ye.apply(null,F[1]),l=An.apply(null,F[0]),o=An.apply(null,F[1]),new nt(s,a,l-s,o-a)},clone:function(){return new $t(this.start,this.controlPoint1,this.controlPoint2,this.end)},closestPoint:function(t,e){return this.pointAtT(this.closestPointT(t,e))},closestPointLength:function(t,e){var i=(e=e||{}).precision===void 0?this.PRECISION:e.precision,i={precision:i,subdivisions:e.subdivisions===void 0?this.getSubdivisions({precision:i}):e.subdivisions};return this.lengthAtT(this.closestPointT(t,i),i)},closestPointNormalizedLength:function(t,n){var i=(n=n||{}).precision===void 0?this.PRECISION:n.precision,i={precision:i,subdivisions:n.subdivisions===void 0?this.getSubdivisions({precision:i}):n.subdivisions},n=this.closestPointLength(t,i);return!n||(t=this.length(i))===0?0:n/t},closestPointT:function(t,e){for(var i,n,r,o,s,a,l=(e=e||{}).precision===void 0?this.PRECISION:e.precision,h=e.subdivisions===void 0?this.getSubdivisions({precision:l}):e.subdivisions,u=h.length,d=u?1/u:0,p=0;p<u;p++){var m=h[p],v=m.start.distance(t),k=m.end.distance(t),I=v+k;(!a||I<a)&&(n=p*d,r=(p+1)*d,o=v,tt=k,s=(i=m).start.distance(m.end),a=I)}for(var N=vo(10,-l);;){var G=o?Je(o-tt)/o:0,F=tt?Je(o-tt)/tt:0;if(G<N||F<N||!o||o<s*N||!tt||tt<s*N)return o<=tt?n:r;var G=i.divide(.5),F=(d/=2,G[0].start.distance(t)),H=G[0].end.distance(t),Y=F+H,_=G[1].start.distance(t),K=G[1].end.distance(t),tt=Y<=_+K?(i=G[0],r-=d,o=F,H):(i=G[1],n+=d,o=_,K)}},closestPointTangent:function(t,e){return this.tangentAtT(this.closestPointT(t,e))},containsPoint:function(t,e){return this.toPolyline(e).containsPoint(t)},divideAt:function(t,e){return t<=0?this.divideAtT(0):1<=t?this.divideAtT(1):(t=this.tAt(t,e),this.divideAtT(t))},divideAtLength:function(t,e){return t=this.tAtLength(t,e),this.divideAtT(t)},divideAtT:function(t){var e,i,n=this.start,r=this.controlPoint1,o=this.controlPoint2,s=this.end;return t<=0?[new $t(n,n,n,n),new $t(n,r,o,s)]:1<=t?[new $t(n,r,o,s),new $t(s,s,s,s)]:(o=(r=this.getSkeletonPoints(t)).startControlPoint1,t=r.startControlPoint2,e=r.divider,i=r.dividerControlPoint1,r=r.dividerControlPoint2,[new $t(n,o,t,e),new $t(e,i,r,s)])},endpointDistance:function(){return this.start.distance(this.end)},equals:function(t){return!!t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.controlPoint1.x===t.controlPoint1.x&&this.controlPoint1.y===t.controlPoint1.y&&this.controlPoint2.x===t.controlPoint2.x&&this.controlPoint2.y===t.controlPoint2.y&&this.end.x===t.end.x&&this.end.y===t.end.y},getSkeletonPoints:function(t){var e=this.start,i=this.controlPoint1,n=this.controlPoint2,r=this.end;return t<=0?{startControlPoint1:e.clone(),startControlPoint2:e.clone(),divider:e.clone(),dividerControlPoint1:i.clone(),dividerControlPoint2:n.clone()}:1<=t?{startControlPoint1:i.clone(),startControlPoint2:n.clone(),divider:r.clone(),dividerControlPoint1:r.clone(),dividerControlPoint2:r.clone()}:(e=new Ot(e,i).pointAt(t),i=new Ot(i,n).pointAt(t),n=new Ot(n,r).pointAt(t),r=new Ot(e,i).pointAt(t),i=new Ot(i,n).pointAt(t),{startControlPoint1:e,startControlPoint2:r,divider:new Ot(r,i).pointAt(t),dividerControlPoint1:i,dividerControlPoint2:n})},getSubdivisions:function(e){var e=(e=e||{}).precision===void 0?this.PRECISION:e.precision,i=this.start,n=this.controlPoint1,r=this.controlPoint2,o=this.end,s=[new $t(i,n,r,o)];if(e===0||!this.isDifferentiable())return s;for(var a=this.endpointDistance(),l=vo(10,-e),h=2,u=(n.cross(i,o)===0&&r.cross(i,o)===0&&(h=2*e),0);;){u+=1;for(var d=[],p=s.length,m=0;m<p;m++){var v=s[m].divide(.5);d.push(v[0],v[1])}for(var k=0,I=d.length,N=0;N<I;N++)k+=d[N].endpointDistance();if(h<=u&&(k!==0?(k-a)/k:0)<l)return d;s=d,a=k}},isDifferentiable:function(){var t=this.start,e=this.controlPoint1,i=this.controlPoint2,n=this.end;return!(t.equals(e)&&e.equals(i)&&i.equals(n))},length:function(t){for(var e=(t=t||{}).precision===void 0?this.PRECISION:t.precision,i=t.subdivisions===void 0?this.getSubdivisions({precision:e}):t.subdivisions,n=0,r=i.length,o=0;o<r;o++)n+=i[o].endpointDistance();return n},lengthAtT:function(t,e){return t<=0?0:(e=(e=e||{}).precision===void 0?this.PRECISION:e.precision,this.divide(t)[0].length({precision:e}))},pointAt:function(t,e){return t<=0?this.start.clone():1<=t?this.end.clone():(t=this.tAt(t,e),this.pointAtT(t))},pointAtLength:function(t,e){return t=this.tAtLength(t,e),this.pointAtT(t)},pointAtT:function(t){return t<=0?this.start.clone():1<=t?this.end.clone():this.getSkeletonPoints(t).divider},PRECISION:3,round:function(t){return this.start.round(t),this.controlPoint1.round(t),this.controlPoint2.round(t),this.end.round(t),this},scale:function(t,e,i){return this.start.scale(t,e,i),this.controlPoint1.scale(t,e,i),this.controlPoint2.scale(t,e,i),this.end.scale(t,e,i),this},tangentAt:function(t,e){return this.isDifferentiable()?(t<0?t=0:1<t&&(t=1),t=this.tAt(t,e),this.tangentAtT(t)):null},tangentAtLength:function(t,e){return this.isDifferentiable()?(t=this.tAtLength(t,e),this.tangentAtT(t)):null},tangentAtT:function(i){if(!this.isDifferentiable())return null;i<0?i=0:1<i&&(i=1);var i=this.getSkeletonPoints(i),e=i.startControlPoint2,n=i.dividerControlPoint1,i=i.divider,n=new Ot(e,n);return n.translate(i.x-e.x,i.y-e.y),n},tAt:function(t,e){var i;return t<=0?0:1<=t?1:(i={precision:i=(e=e||{}).precision===void 0?this.PRECISION:e.precision,subdivisions:e.subdivisions===void 0?this.getSubdivisions({precision:i}):e.subdivisions},e=this.length(i),this.tAtLength(e*t,i))},tAtLength:function(t,e){for(var i,n,r,o=!0,s=(t<0&&(o=!1,t=-t),(e=e||{}).precision===void 0?this.PRECISION:e.precision),a=e.subdivisions===void 0?this.getSubdivisions({precision:s}):e.subdivisions,e={precision:s,subdivisions:a},l=0,h=a.length,u=1/h,d=0;d<h;d++){var p=o?d:h-1-d,m=a[d],v=m.endpointDistance();if(t<=l+v){i=m,n=p*u,r=(p+1)*u,Y=o?t-l:v+l-t,_=o?v+l-t:t-l;break}l+=v}if(!i)return o?1:0;for(var k=this.length(e),I=vo(10,-s);;){var N,H=k!==0?Y/k:0;if(H<I)return n;if((k!==0?_/k:0)<I)return r;var H=i.divide(.5),G=(u/=2,H[0].endpointDistance()),F=H[1].endpointDistance(),H=Y<=G?(i=H[0],r-=u,G-(N=Y)):(i=H[1],n+=u,F-(N=Y-G)),Y=N,_=H}},toPoints:function(t){for(var e=(t=t||{}).precision===void 0?this.PRECISION:t.precision,i=t.subdivisions===void 0?this.getSubdivisions({precision:e}):t.subdivisions,n=[i[0].start.clone()],r=i.length,o=0;o<r;o++){var s=i[o];n.push(s.end.clone())}return n},toPolyline:function(t){return new ie(this.toPoints(t))},toString:function(){return this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end},translate:function(t,e){return this.start.translate(t,e),this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e),this}},$t.prototype.divide=$t.prototype.divideAtT;var At=function(t){if(!(this instanceof At))return new At(t);if(typeof t=="string")return new At.parse(t);var e;if(this.segments=[],t)if(Array.isArray(t)&&t.length!==0)if(e=(t=t.reduce(function(a,l){return a.concat(l)},[])).length,t[0].isSegment)for(r=0;r<e;r++){var i=t[r];this.appendSegment(i)}else for(var n=null,r=0;r<e;r++){var o=t[r];if(!(o instanceof Ot||o instanceof $t))throw new Error("Cannot construct a path segment from the provided object.");r===0&&this.appendSegment(At.createSegment("M",o.start)),n&&!n.end.equals(o.start)&&this.appendSegment(At.createSegment("M",o.start)),o instanceof Ot?this.appendSegment(At.createSegment("L",o.end)):o instanceof $t&&this.appendSegment(At.createSegment("C",o.controlPoint1,o.controlPoint2,o.end)),n=o}else if(t.isSegment)this.appendSegment(t);else if(t instanceof Ot)this.appendSegment(At.createSegment("M",t.start)),this.appendSegment(At.createSegment("L",t.end));else if(t instanceof $t)this.appendSegment(At.createSegment("M",t.start)),this.appendSegment(At.createSegment("C",t.controlPoint1,t.controlPoint2,t.end));else{if(!(t instanceof ie))throw new Error("Cannot construct a path from the provided object.");if(t.points&&t.points.length!==0)for(e=t.points.length,r=0;r<e;r++){var s=t.points[r];r===0?this.appendSegment(At.createSegment("M",s)):this.appendSegment(At.createSegment("L",s))}}};function ei(t,e){return e.unshift(null),new(Function.prototype.bind.apply(t,e))}At.parse=function(t){if(!t)return new At;for(var e=new At,i=t.match(/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g),n=i.length,r=0;r<n;r++){var o=i[r].match(/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g),o=At.createSegment.apply(this,o);e.appendSegment(o)}return e},At.createSegment=function(t){var e=arguments;if(!t)throw new Error("Type must be provided.");var i=At.segmentTypes[t];if(!i)throw new Error(t+" is not a recognized path segment type.");for(var n=[],r=arguments.length,o=1;o<r;o++)n.push(e[o]);return ei(i,n)},At.prototype={type:le.Path,appendSegment:function(t){var e=this.segments,i=e.length,n=i!==0?e[i-1]:null;if(Array.isArray(t)){if(!(t=t.reduce(function(l,h){return l.concat(h)},[]))[0].isSegment)throw new Error("Segments required.");for(var r=t.length,o=0;o<r;o++){var s=t[o],a=this.prepareSegment(s,n,null);e.push(a),n=a}}else{if(!t||!t.isSegment)throw new Error("Segment required.");a=this.prepareSegment(t,n,null),e.push(a)}},bbox:function(){var t=this.segments,e=t.length;if(e===0)return null;for(var i,n=0;n<e;n++){var r,o=t[n];o.isVisible&&(o=o.bbox(),r=r?r.union(o):o)}return r||(i=t[e-1],new nt(i.end.x,i.end.y,0,0))},clone:function(){for(var t=this.segments,e=t.length,i=new At,n=0;n<e;n++){var r=t[n].clone();i.appendSegment(r)}return i},closestPoint:function(t,e){return t=this.closestPointT(t,e),t?this.pointAtT(t):null},closestPointLength:function(t,n){var i=(n=n||{}).precision===void 0?this.PRECISION:n.precision,i={precision:i,segmentSubdivisions:n.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:i}):n.segmentSubdivisions},n=this.closestPointT(t,i);return n?this.lengthAtT(n,i):0},closestPointNormalizedLength:function(t,n){var i=(n=n||{}).precision===void 0?this.PRECISION:n.precision,i={precision:i,segmentSubdivisions:n.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:i}):n.segmentSubdivisions},n=this.closestPointLength(t,i);return n===0||(t=this.length(i))===0?0:n/t},closestPointT:function(t,e){var i=this.segments,n=i.length;if(n===0)return null;for(var r,o=(e=e||{}).precision===void 0?this.PRECISION:e.precision,s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:o}):e.segmentSubdivisions,a=1/0,l=0;l<n;l++){var h=i[l],u=s[l];h.isVisible&&(u=h.closestPointT(t,{precision:o,subdivisions:u}),h=h.pointAtT(u),(h=new Ot(h,t).squaredLength())<a&&(r={segmentIndex:l,value:u},a=h))}return r||{segmentIndex:n-1,value:1}},closestPointTangent:function(t,e){var i=this.segments,n=i.length;if(n===0)return null;for(var r,o=(e=e||{}).precision===void 0?this.PRECISION:e.precision,s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:o}):e.segmentSubdivisions,a=1/0,l=0;l<n;l++){var h,u=i[l],d=s[l];u.isDifferentiable()&&(d=u.closestPointT(t,{precision:o,subdivisions:d}),h=u.pointAtT(d),(h=new Ot(h,t).squaredLength())<a&&(r=u.tangentAtT(d),a=h))}return r||null},containsPoint:function(t,e){var i=this.toPolylines(e);if(!i)return!1;for(var n=i.length,r=0,o=0;o<n;o++)i[o].containsPoint(t)&&r++;return r%2==1},divideAt:function(t,n){if(this.segments.length===0)return null;1<(t=t<0?0:t)&&(t=1);var i=(n=n||{}).precision===void 0?this.PRECISION:n.precision,i={precision:i,segmentSubdivisions:n.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:i}):n.segmentSubdivisions},n=this.length(i);return this.divideAtLength(n*t,i)},divideAtLength:function(t,N){var i=this.segments.length;if(i===0)return null;for(var n,r,o,s,a=!0,l=(t<0&&(a=!1,t=-t),(N=N||{}).precision===void 0?this.PRECISION:N.precision),h=N.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:l}):N.segmentSubdivisions,u=0,d=0;d<i;d++){var p=a?d:i-1-d,m=this.getSegment(p),v=h[p],k=m.length({precision:l,subdivisions:v});if(m.isDifferentiable()&&(o=m,s=p,t<=u+k)){r=p,n=m.divideAtLength((a?1:-1)*(t-u),{precision:l,subdivisions:v});break}u+=k}if(!o)return null;n||(r=s,n=o.divideAtT(a?1:0));var I=this.clone(),N=(I.replaceSegment(r,n),r),G=r+1,F=r+2,H=(n[0].isDifferentiable()||(I.removeSegment(N),--G,--F),I.getSegment(G).start),Y=(I.insertSegment(G,At.createSegment("M",H)),F+=1,n[1].isDifferentiable()||(I.removeSegment(F-1),--F),F-N-1);for(d=F;d<I.segments.length;d++){var _=this.getSegment(d-Y);(m=I.getSegment(d)).type!=="Z"||_.subpathStartSegment.end.equals(m.subpathStartSegment.end)||(_=At.createSegment("L",_.end),I.replaceSegment(d,_))}return[new At(I.segments.slice(0,G)),new At(I.segments.slice(G))]},equals:function(t){if(!t)return!1;var e=this.segments,i=t.segments,n=e.length;if(i.length!==n)return!1;for(var r=0;r<n;r++){var o=e[r],s=i[r];if(o.type!==s.type||!o.equals(s))return!1}return!0},getSegment:function(t){var e=this.segments,i=e.length;if(i===0)throw new Error("Path has no segments.");if(i<=(t=t<0?i+t:t)||t<0)throw new Error("Index out of range.");return e[t]},getSegmentSubdivisions:function(t){for(var e=this.segments,i=e.length,n=(t=t||{}).precision===void 0?this.PRECISION:t.precision,r=[],o=0;o<i;o++){var s=e[o].getSubdivisions({precision:n});r.push(s)}return r},getSubpaths:function(){for(var t=this.clone().validate().segments,e=t.length,i=[],n=0;n<e;n++){var r=t[n];r.isSubpathStart?i.push(new At(r)):i[i.length-1].appendSegment(r)}return i},insertSegment:function(t,e){var i=this.segments,n=i.length;if(n<(t=t<0?n+t+1:t)||t<0)throw new Error("Index out of range.");var r=null,o=null;if(n!==0&&(o=1<=t?(r=i[t-1]).nextSegment:i[0]),Array.isArray(e)){if(!(e=e.reduce(function(u,d){return u.concat(d)},[]))[0].isSegment)throw new Error("Segments required.");for(var s=e.length,a=0;a<s;a++){var l=e[a],h=this.prepareSegment(l,r,o);i.splice(t+a,0,h),r=h}}else{if(!e||!e.isSegment)throw new Error("Segment required.");h=this.prepareSegment(e,r,o),i.splice(t,0,h)}},intersectionWithLine:function(t,e){var i=null,n=this.toPolylines(e);if(!n)return null;for(var r=0,o=n.length;r<o;r++){var s=n[r],s=t.intersect(s);s&&(i=i||[],Array.isArray(s)?Array.prototype.push.apply(i,s):i.push(s))}return i},isDifferentiable:function(){for(var t=this.segments,e=t.length,i=0;i<e;i++)if(t[i].isDifferentiable())return!0;return!1},isValid:function(){var t=this.segments;return t.length===0||t[0].type==="M"},length:function(t){var e=this.segments,i=e.length;if(i===0)return 0;for(var n=(t=t||{}).precision===void 0?this.PRECISION:t.precision,r=t.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:n}):t.segmentSubdivisions,o=0,s=0;s<i;s++){var a=e[s],l=r[s];o+=a.length({subdivisions:l})}return o},lengthAtT:function(t,e){var i=this.segments,n=i.length;if(n===0)return 0;var r=t.segmentIndex;if(r<0)return 0;for(var t=t.value,o=(n<=r?(r=n-1,t=1):t<0?t=0:1<t&&(t=1),(e=e||{}).precision===void 0?this.PRECISION:e.precision),s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:o}):e.segmentSubdivisions,a=0,l=0;l<r;l++){var h=i[l],u=s[l];a+=h.length({precisison:o,subdivisions:u})}return h=i[r],u=s[r],a+=h.lengthAtT(t,{precisison:o,subdivisions:u})},pointAt:function(t,e){var i;return this.segments.length===0?null:t<=0?this.start.clone():1<=t?this.end.clone():(i={precision:i=(e=e||{}).precision===void 0?this.PRECISION:e.precision,segmentSubdivisions:e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:i}):e.segmentSubdivisions},e=this.length(i),this.pointAtLength(e*t,i))},pointAtLength:function(t,e){var i=this.segments,n=i.length;if(n===0)return null;if(t===0)return this.start.clone();for(var r,o=!0,s=(t<0&&(o=!1,t=-t),(e=e||{}).precision===void 0?this.PRECISION:e.precision),a=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:s}):e.segmentSubdivisions,l=0,h=0;h<n;h++){var d=o?h:n-1-h,u=i[d],d=a[d],p=u.length({precision:s,subdivisions:d});if(u.isVisible){if(t<=l+p)return u.pointAtLength((o?1:-1)*(t-l),{precision:s,subdivisions:d});r=u}l+=p}return r?o?r.end:r.start:i[n-1].end.clone()},pointAtT:function(t){var e,i=this.segments,n=i.length;return n===0?null:(e=t.segmentIndex)<0?i[0].pointAtT(0):n<=e?i[n-1].pointAtT(1):((n=t.value)<0?n=0:1<n&&(n=1),i[e].pointAtT(n))},PRECISION:3,prepareSegment:function(t,e,i){return t.previousSegment=e,t.nextSegment=i,e&&(e.nextSegment=t),i&&(i.previousSegment=t),e=t,t.isSubpathStart&&(t.subpathStartSegment=t,e=i),e&&this.updateSubpathStartSegment(e),t},removeSegment:function(t){var e=this.segments,i=e.length;if(i===0)throw new Error("Path has no segments.");if(i<=(t=t<0?i+t:t)||t<0)throw new Error("Index out of range.");i=e.splice(t,1)[0],e=i.previousSegment,t=i.nextSegment,e&&(e.nextSegment=t),t&&(t.previousSegment=e),i.isSubpathStart&&t&&this.updateSubpathStartSegment(t)},replaceSegment:function(t,e){var i=this.segments,n=i.length;if(n===0)throw new Error("Path has no segments.");if(n<=(t=t<0?n+t:t)||t<0)throw new Error("Index out of range.");var n=i[t],r=n.previousSegment,o=n.nextSegment,s=n.isSubpathStart;if(Array.isArray(e)){if(!(e=e.reduce(function(d,p){return d.concat(p)},[]))[0].isSegment)throw new Error("Segments required.");i.splice(t,1);for(var a=e.length,l=0;l<a;l++){var h=e[l],u=this.prepareSegment(h,r,o);i.splice(t+l,0,u),r=u,s&&u.isSubpathStart&&(s=!1)}}else{if(!e||!e.isSegment)throw new Error("Segment required.");u=this.prepareSegment(e,r,o),i.splice(t,1,u),s&&u.isSubpathStart&&(s=!1)}s&&o&&this.updateSubpathStartSegment(o)},round:function(t){for(var e=this.segments,i=e.length,n=0;n<i;n++)e[n].round(t);return this},scale:function(t,e,i){for(var n=this.segments,r=n.length,o=0;o<r;o++)n[o].scale(t,e,i);return this},segmentAt:function(t,e){return t=this.segmentIndexAt(t,e),t?this.getSegment(t):null},segmentAtLength:function(t,e){return t=this.segmentIndexAtLength(t,e),t?this.getSegment(t):null},segmentIndexAt:function(t,n){if(this.segments.length===0)return null;1<(t=t<0?0:t)&&(t=1);var i=(n=n||{}).precision===void 0?this.PRECISION:n.precision,i={precision:i,segmentSubdivisions:n.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:i}):n.segmentSubdivisions},n=this.length(i);return this.segmentIndexAtLength(n*t,i)},segmentIndexAtLength:function(t,e){var i=this.segments,n=i.length;if(n===0)return null;for(var r=!0,o=(t<0&&(r=!1,t=-t),(e=e||{}).precision===void 0?this.PRECISION:e.precision),s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:o}):e.segmentSubdivisions,a=null,l=0,h=0;h<n;h++){var u=r?h:n-1-h,d=i[u],p=s[u],p=d.length({precision:o,subdivisions:p});if(d.isVisible){if(t<=l+p)return u;a=u}l+=p}return a},serialize:function(){if(this.isValid())return this.toString();throw new Error("Invalid path segments.")},tangentAt:function(t,n){if(this.segments.length===0)return null;1<(t=t<0?0:t)&&(t=1);var i=(n=n||{}).precision===void 0?this.PRECISION:n.precision,i={precision:i,segmentSubdivisions:n.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:i}):n.segmentSubdivisions},n=this.length(i);return this.tangentAtLength(n*t,i)},tangentAtLength:function(t,e){var i=this.segments,n=i.length;if(n===0)return null;for(var r,o=!0,s=(t<0&&(o=!1,t=-t),(e=e||{}).precision===void 0?this.PRECISION:e.precision),a=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:s}):e.segmentSubdivisions,l=0,h=0;h<n;h++){var d=o?h:n-1-h,u=i[d],d=a[d],p=u.length({precision:s,subdivisions:d});if(u.isDifferentiable()){if(t<=l+p)return u.tangentAtLength((o?1:-1)*(t-l),{precision:s,subdivisions:d});r=u}l+=p}return r?r.tangentAtT(o?1:0):null},tangentAtT:function(t){var e,i=this.segments,n=i.length;return n===0?null:(e=t.segmentIndex)<0?i[0].tangentAtT(0):n<=e?i[n-1].tangentAtT(1):((n=t.value)<0?n=0:1<n&&(n=1),i[e].tangentAtT(n))},toPoints:function(t){var e=this.segments,i=e.length;if(i===0)return null;for(var n=(t=t||{}).precision===void 0?this.PRECISION:t.precision,r=t.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:n}):t.segmentSubdivisions,o=[],s=[],a=0;a<i;a++){var l,h=e[a];h.isVisible?0<(l=r[a]).length?(l=l.map(function(u){return u.start}),Array.prototype.push.apply(s,l)):s.push(h.start):0<s.length&&(s.push(e[a-1].end),o.push(s),s=[])}return 0<s.length&&(s.push(this.end),o.push(s)),o},toPolylines:function(t){var e=[],i=this.toPoints(t);if(!i)return null;for(var n=0,r=i.length;n<r;n++)e.push(new ie(i[n]));return e},toString:function(){for(var t=this.segments,e=t.length,i="",n=0;n<e;n++)i+=t[n].serialize()+" ";return i.trim()},translate:function(t,e){for(var i=this.segments,n=i.length,r=0;r<n;r++)i[r].translate(t,e);return this},updateSubpathStartSegment:function(t){for(var e=t.previousSegment;t&&!t.isSubpathStart;)t.subpathStartSegment=e?e.subpathStartSegment:null,t=(e=t).nextSegment},validate:function(){return this.isValid()||this.insertSegment(0,At.createSegment("M",0,0)),this}},Object.defineProperty(At.prototype,"start",{configurable:!0,enumerable:!0,get:function(){var t=this.segments,e=t.length;if(e===0)return null;for(var i=0;i<e;i++){var n=t[i];if(n.isVisible)return n.start}return t[e-1].end}}),Object.defineProperty(At.prototype,"end",{configurable:!0,enumerable:!0,get:function(){var t=this.segments,e=t.length;if(e===0)return null;for(var i=e-1;0<=i;i--){var n=t[i];if(n.isVisible)return n.end}return t[e-1].end}});function Ue(){for(var t=arguments,e=[],i=arguments.length,n=0;n<i;n++)e.push(t[n]);if(!(this instanceof Ue))return ei(Ue,e);if(i===0)throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates (none provided).");if(e[0]instanceof Ot){if(i===1)return this.end=e[0].end.clone(),this;throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates ("+i+" lines provided).")}if(typeof e[0]=="string"||typeof e[0]=="number"){if(i===2)return this.end=new Q(+e[0],+e[1]),this;if(i<2)throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates ("+i+" coordinates provided).");for(var r,o=[],n=0;n<i;n+=2)r=e.slice(n,n+2),o.push(ei(Ue,r))}else{if(i===1)return this.end=new Q(e[0]),this;for(o=[],n=0;n<i;n+=1)o.push(new Ue(e[n]))}return o}function si(){for(var t,e=arguments,i=[],n=arguments.length,r=0;r<n;r++)i.push(e[r]);if(!(this instanceof si))return ei(si,i);if(n===0)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates (none provided).");if(i[0]instanceof $t){if(n===1)return this.controlPoint1=i[0].controlPoint1.clone(),this.controlPoint2=i[0].controlPoint2.clone(),this.end=i[0].end.clone(),this;throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+n+" curves provided).")}if(typeof i[0]=="string"||typeof i[0]=="number"){if(n===6)return this.controlPoint1=new Q(+i[0],+i[1]),this.controlPoint2=new Q(+i[2],+i[3]),this.end=new Q(+i[4],+i[5]),this;if(n<6)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+n+" coordinates provided).");for(var o,s=[],r=0;r<n;r+=6)o=i.slice(r,r+6),s.push(ei(si,o))}else{if(n===3)return this.controlPoint1=new Q(i[0]),this.controlPoint2=new Q(i[1]),this.end=new Q(i[2]),this;if(n<3)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+n+" points provided).");for(s=[],r=0;r<n;r+=3)t=i.slice(r,r+3),s.push(ei(si,t))}return s}function Kn(){for(var t,e=arguments,i=[],n=arguments.length,r=0;r<n;r++)i.push(e[r]);if(!(this instanceof Kn))return ei(Kn,i);if(n===0)throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates (none provided).");if(i[0]instanceof Ot){if(n===1)return this.end=i[0].end.clone(),this;throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+n+" lines provided).")}if(i[0]instanceof $t){if(n===1)return this.end=i[0].end.clone(),this;throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+n+" curves provided).")}if(typeof i[0]=="string"||typeof i[0]=="number"){if(n===2)return this.end=new Q(+i[0],+i[1]),this;if(n<2)throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+n+" coordinates provided).");for(var o,s=[],r=0;r<n;r+=2)o=i.slice(r,r+2),r===0?s.push(ei(Kn,o)):s.push(ei(Ue,o))}else{if(n===1)return this.end=new Q(i[0]),this;for(s=[],r=0;r<n;r+=1)t=i[r],r===0?s.push(new Kn(t)):s.push(new Ue(t))}return s}function Qn(){for(var t=arguments,e=[],i=arguments.length,n=0;n<i;n++)e.push(t[n]);if(!(this instanceof Qn))return ei(Qn,e);if(0<i)throw new Error("Closepath constructor expects no arguments.");return this}var je={bbox:function(){throw new Error("Declaration missing for virtual function.")},clone:function(){throw new Error("Declaration missing for virtual function.")},closestPoint:function(){throw new Error("Declaration missing for virtual function.")},closestPointLength:function(){throw new Error("Declaration missing for virtual function.")},closestPointNormalizedLength:function(){throw new Error("Declaration missing for virtual function.")},closestPointT:function(t){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(t);throw new Error("Neither closestPointT() nor closestPointNormalizedLength() function is implemented.")},closestPointTangent:function(){throw new Error("Declaration missing for virtual function.")},divideAt:function(){throw new Error("Declaration missing for virtual function.")},divideAtLength:function(){throw new Error("Declaration missing for virtual function.")},divideAtT:function(t){if(this.divideAt)return this.divideAt(t);throw new Error("Neither divideAtT() nor divideAt() function is implemented.")},equals:function(){throw new Error("Declaration missing for virtual function.")},getSubdivisions:function(){throw new Error("Declaration missing for virtual function.")},isDifferentiable:function(){throw new Error("Declaration missing for virtual function.")},isSegment:!0,isSubpathStart:!1,isVisible:!0,length:function(){throw new Error("Declaration missing for virtual function.")},lengthAtT:function(t){var e;return t<=0?0:(e=this.length(),1<=t?e:e*t)},nextSegment:null,pointAt:function(){throw new Error("Declaration missing for virtual function.")},pointAtLength:function(){throw new Error("Declaration missing for virtual function.")},pointAtT:function(t){if(this.pointAt)return this.pointAt(t);throw new Error("Neither pointAtT() nor pointAt() function is implemented.")},previousSegment:null,round:function(){throw new Error("Declaration missing for virtual function.")},subpathStartSegment:null,scale:function(){throw new Error("Declaration missing for virtual function.")},serialize:function(){throw new Error("Declaration missing for virtual function.")},tangentAt:function(){throw new Error("Declaration missing for virtual function.")},tangentAtLength:function(){throw new Error("Declaration missing for virtual function.")},tangentAtT:function(t){if(this.tangentAt)return this.tangentAt(t);throw new Error("Neither tangentAtT() nor tangentAt() function is implemented.")},toString:function(){throw new Error("Declaration missing for virtual function.")},translate:function(){throw new Error("Declaration missing for virtual function.")}},ge=(Object.defineProperty(je,"end",{configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(je,"start",{configurable:!0,enumerable:!0,get:function(){if(this.previousSegment)return this.previousSegment.end;throw new Error("Missing previous segment. (This segment cannot be the first segment of a path; OR segment has not yet been added to a path.)")}}),Object.defineProperty(je,"type",{configurable:!0,enumerable:!0,get:function(){throw new Error("Bad segment declaration. No type specified.")}}),{clone:function(){return new Ue(this.end)},divideAt:function(t){return t=new Ot(this.start,this.end).divideAt(t),[new Ue(t[0]),new Ue(t[1])]},divideAtLength:function(t){return t=new Ot(this.start,this.end).divideAtLength(t),[new Ue(t[0]),new Ue(t[1])]},getSubdivisions:function(){return[]},isDifferentiable:function(){return!!this.previousSegment&&!this.start.equals(this.end)},round:function(t){return this.end.round(t),this},scale:function(t,e,i){return this.end.scale(t,e,i),this},serialize:function(){var t=this.end;return this.type+" "+t.x+" "+t.y},toString:function(){return this.type+" "+this.start+" "+this.end},translate:function(t,e){return this.end.translate(t,e),this}}),ge=(Object.defineProperty(ge,"type",{configurable:!0,enumerable:!0,value:"L"}),Ue.prototype=Mi(je,Ot.prototype,ge),{clone:function(){return new si(this.controlPoint1,this.controlPoint2,this.end)},divideAt:function(t,e){return t=new $t(this.start,this.controlPoint1,this.controlPoint2,this.end).divideAt(t,e),[new si(t[0]),new si(t[1])]},divideAtLength:function(t,e){return t=new $t(this.start,this.controlPoint1,this.controlPoint2,this.end).divideAtLength(t,e),[new si(t[0]),new si(t[1])]},divideAtT:function(t){return t=new $t(this.start,this.controlPoint1,this.controlPoint2,this.end).divideAtT(t),[new si(t[0]),new si(t[1])]},isDifferentiable:function(){var t,e,i,n;return!!this.previousSegment&&(t=this.start,e=this.controlPoint1,i=this.controlPoint2,n=this.end,!(t.equals(e)&&e.equals(i)&&i.equals(n)))},round:function(t){return this.controlPoint1.round(t),this.controlPoint2.round(t),this.end.round(t),this},scale:function(t,e,i){return this.controlPoint1.scale(t,e,i),this.controlPoint2.scale(t,e,i),this.end.scale(t,e,i),this},serialize:function(){var t=this.controlPoint1,e=this.controlPoint2,i=this.end;return this.type+" "+t.x+" "+t.y+" "+e.x+" "+e.y+" "+i.x+" "+i.y},toString:function(){return this.type+" "+this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end},translate:function(t,e){return this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e),this}}),ge=(Object.defineProperty(ge,"type",{configurable:!0,enumerable:!0,value:"C"}),si.prototype=Mi(je,$t.prototype,ge),{bbox:function(){return null},clone:function(){return new Kn(this.end)},closestPoint:function(){return this.end.clone()},closestPointNormalizedLength:function(){return 0},closestPointLength:function(){return 0},closestPointT:function(){return 1},closestPointTangent:function(){return null},divideAt:function(){return[this.clone(),this.clone()]},divideAtLength:function(){return[this.clone(),this.clone()]},equals:function(t){return this.end.equals(t.end)},getSubdivisions:function(){return[]},isDifferentiable:function(){return!1},isSubpathStart:!0,isVisible:!1,length:function(){return 0},lengthAtT:function(){return 0},pointAt:function(){return this.end.clone()},pointAtLength:function(){return this.end.clone()},pointAtT:function(){return this.end.clone()},round:function(t){return this.end.round(t),this},scale:function(t,e,i){return this.end.scale(t,e,i),this},serialize:function(){var t=this.end;return this.type+" "+t.x+" "+t.y},tangentAt:function(){return null},tangentAtLength:function(){return null},tangentAtT:function(){return null},toString:function(){return this.type+" "+this.end},translate:function(t,e){return this.end.translate(t,e),this}}),ge=(Object.defineProperty(ge,"start",{configurable:!0,enumerable:!0,get:function(){throw new Error("Illegal access. Moveto segments should not need a start property.")}}),Object.defineProperty(ge,"type",{configurable:!0,enumerable:!0,value:"M"}),Kn.prototype=Mi(je,ge),{clone:function(){return new Qn},divideAt:function(t){return t=new Ot(this.start,this.end).divideAt(t),[t[1].isDifferentiable()?new Ue(t[0]):this.clone(),new Ue(t[1])]},divideAtLength:function(t){return t=new Ot(this.start,this.end).divideAtLength(t),[t[1].isDifferentiable()?new Ue(t[0]):this.clone(),new Ue(t[1])]},getSubdivisions:function(){return[]},isDifferentiable:function(){return!(!this.previousSegment||!this.subpathStartSegment)&&!this.start.equals(this.end)},round:function(){return this},scale:function(){return this},serialize:function(){return this.type},toString:function(){return this.type+" "+this.start+" "+this.end},translate:function(){return this}}),je=(Object.defineProperty(ge,"end",{configurable:!0,enumerable:!0,get:function(){if(this.subpathStartSegment)return this.subpathStartSegment.end;throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. Moveto); OR segment has not yet been added to a path.)")}}),Object.defineProperty(ge,"type",{configurable:!0,enumerable:!0,value:"Z"}),Qn.prototype=Mi(je,Ot.prototype,ge),At.segmentTypes={L:Ue,C:si,M:Kn,Z:Qn,z:Qn}),ge=(At.regexSupportedData=new RegExp("^[\\s\\d"+Object.keys(je).join("")+",.]*$"),At.isDataSupported=function(t){return typeof t=="string"&&this.regexSupportedData.test(t)},{curveThroughPoints:function(t){return console.warn("deprecated"),new At($t.throughPoints(t)).serialize()},getCurveControlPoints:function(t){console.warn("deprecated");var e=[],i=[],n=t.length-1;if(n==1)e[0]=new Q((2*t[0].x+t[1].x)/3,(2*t[0].y+t[1].y)/3),i[0]=new Q(2*e[0].x-t[0].x,2*e[0].y-t[0].y);else{for(var r=[],o=1;o<n-1;o++)r[o]=4*t[o].x+2*t[o+1].x;r[0]=t[0].x+2*t[1].x,r[n-1]=(8*t[n-1].x+t[n].x)/2;var s=this.getFirstControlPoints(r);for(o=1;o<n-1;++o)r[o]=4*t[o].y+2*t[o+1].y;r[0]=t[0].y+2*t[1].y,r[n-1]=(8*t[n-1].y+t[n].y)/2;var a=this.getFirstControlPoints(r);for(o=0;o<n;o++)e.push(new Q(s[o],a[o])),i.push(o<n-1?new Q(2*t[o+1].x-s[o+1],2*t[o+1].y-a[o+1]):new Q((t[n].x+s[n-1])/2,(t[n].y+a[n-1])/2))}return[e,i]},getCurveDivider:function(t,e,i,n){console.warn("deprecated");var r=new $t(t,e,i,n);return function(o){return o=r.divide(o),[{p0:o[0].start,p1:o[0].controlPoint1,p2:o[0].controlPoint2,p3:o[0].end},{p0:o[1].start,p1:o[1].controlPoint1,p2:o[1].controlPoint2,p3:o[1].end}]}},getFirstControlPoints:function(t){console.warn("deprecated");var e=t.length,i=[],n=[],r=2;i[0]=t[0]/r;for(var o=1;o<e;o++)n[o]=1/r,i[o]=(t[o]-i[o-1])/(r=(o<e-1?4:3.5)-n[o]);for(o=1;o<e;o++)i[e-o-1]-=n[e-o]*i[e-o];return i},getInversionSolver:function(t,e,i,n){console.warn("deprecated");var r=new $t(t,e,i,n);return function(o){return r.closestPointT(o)}}}),ji=function(t){return this instanceof ji?typeof t=="string"?new ji.parse(t):void(this.points=Array.isArray(t)?t.map(Q):[]):new ji(t)};function lr(i,r){var o=i.start.x,a=i.start.y,h=i.end.x,i=i.end.y,s=r.start.x,l=r.start.y,h=h-o,i=i-a,n=r.end.x-s,r=r.end.y-l,o=o-s,s=a-l,a=h*r-n*i,l=(h*s-i*o)/a,h=(n*s-r*o)/a;return 0<=l&&l<=1&&0<=h&&h<=1}function Ys(s,l){var r=s.a,o=s.b,a=s.x,s=s.y,i=l.start.x-a,a=l.end.x-a,n=l.start.y-s,r=r*r,o=o*o,a=a-i,l=l.end.y-s-n,s=a*a/r+l*l/o,a=2*i*a/r+2*n*l/o,l=a*a-4*s*(i*i/r+n*n/o-1);return l==0?0<=(i=-a/2/s)&&i<=1:0<l&&(n=(-a-(r=Math.sqrt(l)))/2/s,0<=(o=(-a+r)/2/s)&&o<=1||0<=n&&n<=1)}function xr(h,p){var r=0,n=0,u=Math.cos,o=(s=Math.sin)(r),r=u(r),s=s(n),u=u(n),n=o*o,N=r*r,o=o*r,r=s*s,I=u*u,s=s*u,u=h.a*h.a,d=h.b*h.b,m=p.a*p.a,v=p.b*p.b,k=u*n+d*N,i=m*r+v*I,N=u*N+d*n,n=m*I+v*r,I=2*(d-u)*o,r=2*(v-m)*s,o=-2*k*h.x-I*h.y,s=-2*i*p.x-r*p.y,a=-I*h.x-2*N*h.y,l=-r*p.x-2*n*p.y,h=k*h.x*h.x+N*h.y*h.y+I*h.x*h.y-u*d,u=i*p.x*p.x+n*p.y*p.y+r*p.x*p.y-m*v,d=(r/=2,s/=2,l/=2,Cn([[k,I/=2,o/=2],[I,N,a/=2],[o,a,h]])),p=Cn([[i,r,s],[r,n,l],[s,l,u]]),m=.33333333*(Cn([[i,I,o],[r,N,a],[s,a,h]])+Cn([[k,r,o],[I,n,a],[o,l,h]])+Cn([[k,I,s],[I,N,l],[o,a,u]])),v=.33333333*(Cn([[k,r,s],[I,n,l],[o,l,u]])+Cn([[i,I,s],[r,N,l],[s,a,u]])+Cn([[i,r,o],[r,n,a],[s,l,h]])),k=Fr([[d,m],[m,v]]),I=Fr([[d,v],[m,p]]),N=Fr([[m,v],[v,p]]);return!(0<Fr([[2*k,I],[I,2*N]])&&(0<v||0<m))}function Zr(t,e){var i=e.start,n=e.end,r=t.x,o=t.y,s=t.width,a=t.height;return!(i.x>r+s&&n.x>r+s||i.x<r&&n.x<r||i.y>o+a&&n.y>o+a||i.y<o&&n.y<o)&&(!(!t.containsPoint(e.start)&&!t.containsPoint(e.end))||lr(t.topLine(),e)||lr(t.rightLine(),e)||lr(t.bottomLine(),e)||lr(t.leftLine(),e))}function Us(t,e){return!!ts(t,nt.fromEllipse(e))&&yo(ji.fromRect(t),e)}function ts(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}function Gi(t,e){return tl(t,e,{interior:!1})}function Ei(t,e){return Xs(t,e,{interior:!1})}function es(t,e){return el(t,e,{interior:!1})}function $a(t,e){return wo(t,e,{interior:!1})}function is(t,e){return tl(t,e,{interior:!0})}function yo(t,e){return Xs(t,e,{interior:!0})}function wr(t,e){return el(t,e,{interior:!0})}function Ar(t,e){return wo(t,e,{interior:!0})}function ns(t,e){return Ao(t,e,{interior:!0})}function bo(t,e,i){return t.getSubpaths().some(function(n){var r=n.toPolylines(i)[0];return(n.getSegment(-1).type==="Z"?is:Gi)(r,e)})}function Ka(t,e,i){return t.getSubpaths().some(function(n){var r=n.toPolylines(i)[0];return(n.getSegment(-1).type==="Z"?yo:Ei)(r,e)})}function Qa(t,e,i){return xo(t,ji.fromRect(e),i)}function Hs(t,e,i){return Cr(t,e,i,{interior:!1})}function xo(t,e,i){return Cr(t,e,i,{interior:!0})}function qa(t,e,i,n){return t.getSubpaths().some(function(r){var o=r.toPolylines(i)[0];return(r.getSegment(-1).type==="Z"?xo:Hs)(e,o,n)})}function tl(t,e,i){if(i=(i=i===void 0?{}:i).interior,i=i===void 0?!1:i){if(t.containsPoint(e.start))return!0;var i=t.start,n=t.end,r=t.points,o=n.equals(i)?r:r.concat([i])}else o=t.points;for(var s=o.length,a=new Ot,l=0;l<s-1;l++)if(a.start=o[l],a.end=o[l+1],lr(e,a))return!0;return!1}function Xs(t,e,i){i===void 0&&(i={});var n,r=t.start,o=t.end,s=t.points;if(e.containsPoint(r))return!0;if(i=i.interior,i=i===void 0?!1:i){if(t.containsPoint(e.center()))return!0;n=o.equals(r)?s:s.concat([r])}else n=s;for(var a=n.length,l=new Ot,h=0;h<a-1;h++)if(l.start=n[h],l.end=n[h+1],Ys(e,l))return!0;return!1}function el(t,e,i){return Ao(t,ji.fromRect(e),i)}function Cr(t,e,i,n){return t.getSubpaths().some(function(r){var o=r.toPolylines(i)[0];return(r.getSegment(-1).type==="Z"?Ao:wo)(e,o,n)})}function wo(t,e,r){var n,r=(r=r===void 0?{}:r).interior;if(r=r===void 0?!1:r){if(r=e.start,t.containsPoint(r))return!0;n=t.clone().close()}else n=t;for(var o=e.points,s=o.length,a=new Ot,l=0;l<s-1;l++)if(a.start=o[l],a.end=o[l+1],Gi(n,a))return!0;return!1}function Ao(t,e,i){return e.containsPoint(t.start)||wo(t,e.clone().close(),i)}function Fr(t){return t[0][0]*t[1][1]-t[0][1]*t[1][0]}function Cn(t){return t[0][0]*t[1][1]*t[2][2]-t[0][0]*t[1][2]*t[2][1]-t[0][1]*t[1][0]*t[2][2]+t[0][1]*t[1][2]*t[2][0]+t[0][2]*t[1][0]*t[2][1]-t[0][2]*t[1][1]*t[2][0]}ji.parse=function(t){return new ji(Yt(t))},ji.fromRect=function(t){return new ji([t.topLeft(),t.topRight(),t.bottomRight(),t.bottomLeft()])},ji.prototype=Mi(ie.prototype,{type:le.Polygon,clone:function(){return new ji(we(this.points))},convexHull:function(){return new ji(Le(this.points))},lengthPoints:function(){var t=this.start,e=this.end,i=this.points;return i.length<=1||t.equals(e)?i:i.concat([t.clone()])}});function Co(t,e){for(var i=t.length;i--;)if(dr(t[i][0],e))return i;return-1}function rs(t,e,i){var n;return!!Dt(i)&&!!((n=typeof e)=="number"?qi(i)&&-1<e&&e<i.length:n=="string"&&e in i)&&dr(i[e],t)}function Ir(t){var e=new t.constructor(t.byteLength);return new Uint8Array(e).set(new Uint8Array(t)),e}function os(t){return t==null?[]:(t=Object(t),Object.getOwnPropertySymbols(t).filter(function(e){return propertyIsEnumerable.call(t,e)}))}var Js={__proto__:null,intersection:{__proto__:null,exists:function t(e,i,n,r){switch(e.type){case le.Line:if(i.type===le.Line)return lr(e,i);break;case le.Ellipse:switch(i.type){case le.Line:return Ys(e,i);case le.Ellipse:return xr(e,i)}break;case le.Rect:switch(i.type){case le.Line:return Zr(e,i);case le.Ellipse:return Us(e,i);case le.Rect:return ts(e,i)}break;case le.Polyline:switch(i.type){case le.Line:return Gi(e,i);case le.Ellipse:return Ei(e,i);case le.Rect:return es(e,i);case le.Polyline:return $a(e,i)}break;case le.Polygon:switch(i.type){case le.Line:return is(e,i);case le.Ellipse:return yo(e,i);case le.Rect:return wr(e,i);case le.Polyline:return Ar(e,i);case le.Polygon:return ns(e,i)}break;case le.Path:switch(i.type){case le.Line:return bo(e,i,n);case le.Ellipse:return Ka(e,i,n);case le.Rect:return Qa(e,i,n);case le.Polyline:return Hs(e,i,n);case le.Polygon:return xo(e,i,n);case le.Path:return qa(e,i,n,r)}}switch(i.type){case le.Ellipse:case le.Rect:case le.Polyline:case le.Polygon:case le.Path:return t(i,e,r,n);default:throw Error("The intersection for "+e+" and "+i+" could not be found.")}},lineWithLine:lr,ellipseWithLine:Ys,ellipseWithEllipse:xr,rectWithLine:Zr,rectWithEllipse:Us,rectWithRect:ts,polylineWithLine:Gi,polylineWithEllipse:Ei,polylineWithRect:es,polylineWithPolyline:$a,polygonWithLine:is,polygonWithEllipse:yo,polygonWithRect:wr,polygonWithPolyline:Ar,polygonWithPolygon:ns,pathWithLine:bo,pathWithEllipse:Ka,pathWithRect:Qa,pathWithPolyline:Hs,pathWithPolygon:xo,pathWithPath:qa},scale:Ge,normalizeAngle:Xe,snapToGrid:Ce,toDeg:On,toRad:Qe,random:bn,bezier:ge,Curve:$t,Ellipse:We,ellipse:Zi,Line:Ot,line:Xn,Path:At,Point:Q,point:se,Polyline:ie,Polygon:ji,Rect:nt,rect:It,types:le},X=function(){if(!(typeof window=="object"&&window.SVGAngle))return function(){throw new Error("SVG is required to use Vectorizer.")};function t(f,x,C){if(!(this instanceof t))return t.apply(Object.create(t.prototype),arguments);if(f){if(t.isV(f)&&(f=f.node),x=x||{},t.isString(f)){if((f=f.trim()).toLowerCase()==="svg")f=t.createSvgDocument();else if(f[0]==="<"){var D=t.createSvgDocument(f);if(1<D.childNodes.length){for(var Z=[],it=0,st=D.childNodes.length;it<st;it++){var lt=D.childNodes[it];Z.push(new t(document.importNode(lt,!0)))}return Z}f=document.importNode(D.firstChild,!0)}else f=document.createElementNS(e.svg,f);t.ensureId(f)}return this.node=f,this.setAttributes(x),C&&this.append(C),this}}var e={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},h=Math,i=h.PI,n=h.atan2,r=h.sqrt,o=h.min,s=h.max,a=h.cos,l=h.sin,h=t.prototype;Object.defineProperty(h,"id",{enumerable:!0,get:function(){return this.node.id},set:function(f){this.node.id=f}}),h.getTransformToElement=function(f){var x=this.node;return t.isSVGGraphicsElement(f)&&t.isSVGGraphicsElement(x)&&(f=t.toNode(f).getScreenCTM(),x=x.getScreenCTM(),f&&x)?f.inverse().multiply(x):t.createSVGMatrix()},h.transform=function(f,x){var C=this.node;return t.isUndefined(f)?t.transformStringToMatrix(this.attr("transform")):x&&x.absolute?this.attr("transform",t.matrixToTransformString(f)):(x=t.createSVGTransform(f),C.transform.baseVal.appendItem(x),this)},h.translate=function(f,x,C){C=C||{},x=x||0;var Z=this.attr("transform")||"",D=t.parseTransformString(Z),Z=D.value;return t.isUndefined(f)?D.translate:(Z=Z.replace(/translate\([^)]*\)/g,"").trim(),f=C.absolute?f:D.translate.tx+f,C=C.absolute?x:D.translate.ty+x,this.attr("transform",("translate("+f+","+C+") "+Z).trim()),this)},h.rotate=function(f,x,C,D){D=D||{};var it=this.attr("transform")||"",Z=t.parseTransformString(it),it=Z.value;return t.isUndefined(f)?Z.rotate:(it=it.replace(/rotate\([^)]*\)/g,"").trim(),f%=360,D=D.absolute?f:Z.rotate.angle+f,this.attr("transform",(it+" "+("rotate("+D+(x!==void 0&&C!==void 0?","+x+","+C:"")+")")).trim()),this)},h.scale=function(f,x){x=t.isUndefined(x)?f:x;var D=this.attr("transform")||"",C=t.parseTransformString(D),D=C.value;return t.isUndefined(f)?C.scale:(D=D.replace(/scale\([^)]*\)/g,"").trim(),this.attr("transform",(D+" "+("scale("+f+","+x+")")).trim()),this)},h.bbox=function(f,x){var C,D=this.node,Z=D.ownerSVGElement;if(!Z)return new nt(0,0,0,0);try{C=D.getBBox()}catch{C={x:D.clientLeft,y:D.clientTop,width:D.clientWidth,height:D.clientHeight}}return f?new nt(C):(D=this.getTransformToElement(x||Z),t.transformRect(C,D))},h.getBBox=function(f){var x={},C=this.node;if(!C.ownerSVGElement||!t.isSVGGraphicsElement(C))return new nt(0,0,0,0);if(f&&(f.target&&(x.target=t.toNode(f.target)),f.recursive&&(x.recursive=f.recursive)),x.recursive){var D=this.children(),Z=D.length;if(Z===0)return this.getBBox({target:x.target,recursive:!1});x.target||(x.target=this);for(var it=0;it<Z;it++)var st=D[it],st=st.children().length===0?st.getBBox({target:x.target,recursive:!1}):st.getBBox({target:x.target,recursive:!0}),lt=lt?lt.union(st):st;return lt}try{lt=C.getBBox()}catch{lt={x:C.clientLeft,y:C.clientTop,width:C.clientWidth,height:C.clientHeight}}return x.target?(f=this.getTransformToElement(x.target),t.transformRect(lt,f)):new nt(lt)};var u=/em$/;function d(f,x){var C=parseFloat(f);return u.test(f)?C*x:C}h.text=function(f,x){if(f&&typeof f!="string")throw new Error("Vectorizer: text() expects the first argument to be a string.");f=t.sanitizeText(f);for(var C,D,Z,it,st=(x=x||{}).displayEmpty,lt=x.eol,at=x.textPath,mt=x.textVerticalAnchor,Mt=mt==="middle"||mt==="bottom"||mt==="top",Et=x.x,Zt=(Et===void 0&&(Et=this.attr("x")||0),x.includeAnnotationIndices),xt=x.annotations,x=(xt&&!t.isArray(xt)&&(xt=[xt]),x.lineHeight),Bt=x==="auto",ce=Bt?"1.5em":x||"1em",me=(this.empty(),this.attr({"xml:space":"preserve",display:f||st?null:"none"}),parseFloat(this.attr("font-size"))),Ut=(me||(me=16,(Mt||xt)&&this.attr("font-size",me)),document),be=at?(x=this,st=(st=at=typeof at=="string"?{d:at}:at)||{},C=t("textPath"),(D=st.d)&&st["xlink:href"]===void 0&&(D=t("path").attr("d",D).appendTo(x.defs()),C.attr("xlink:href","#"+D.id)),t.isObject(st)&&C.attr(st),C.node):Ut.createDocumentFragment(),xe=0,Ht=f.split(`
`),pe=[],Ne=0,Pe=Ht.length-1;Ne<=Pe;Ne++){var oi,Ii=ce,Wg="v-line",Dr=Ut.createElementNS(e.svg,"tspan"),Ra=Ht[Ne];if(Ra)xt?((rh=(oi=function(Rs,Br,Yn){for(var oh=(Yn=Yn||{}).includeAnnotationIndices,ao=Yn.eol,Ga=Yn.lineHeight,lo=Yn.baseSize,mr=0,Yn={},Wo=Br.length-1,vr=0;vr<=Wo;vr++){var Yo,Yc,sh,Va,js=Br[vr],Gs=null;t.isObject(js)?(Yo=js.attrs,sh=(Yc=t("tspan",Yo)).node,Va=js.t,ao&&vr===Wo&&(Va+=ao),sh.textContent=Va,(Va=Yo.class)&&Yc.addClass(Va),oh&&Yc.attr("annotations",js.annotations),Gs=parseFloat(Yo["font-size"]),(Gs=isFinite(Gs)?Gs:lo)&&mr<Gs&&(mr=Gs)):(ao&&vr===Wo&&(js+=ao),sh=document.createTextNode(js||" "),lo&&mr<lo&&(mr=lo)),Rs.appendChild(sh)}return mr&&(Yn.maxFontSize=mr),Ga?Yn.lineHeight=Ga:mr&&(Yn.lineHeight=1.2*mr),Yn}(Dr,_c=t.annotateString(Ra,xt,{offset:-xe,includeAnnotationIndices:Zt}),{includeAnnotationIndices:Zt,eol:Ne!==Pe&&lt,lineHeight:Bt?null:ce,baseSize:me})).lineHeight)&&Bt&&Ne!==0&&(Ii=rh),Ne===0&&(Z=.8*oi.maxFontSize)):(lt&&Ne!==Pe&&(Ra+=lt),Dr.textContent=Ra);else{Dr.textContent="-",Wg+=" v-empty-line";var rh=Dr.style;if(rh.fillOpacity=0,rh.strokeOpacity=0,xt){oi={};for(var _c,ja=me,Wc=(_c=t.findAnnotationsAtIndex(xt,xe)).length;0<Wc;Wc--){var Os=_c[Wc-1].attrs;if(Os&&"font-size"in Os&&(Os=parseFloat(Os["font-size"]),isFinite(Os))){ja=Os;break}}Bt&&(0<Ne?Ii=1.2*ja:Z=.8*ja),Dr.setAttribute("font-size",ja),oi.maxFontSize=ja}}oi&&pe.push(oi),0<Ne&&Dr.setAttribute("dy",Ii),(0<Ne||at)&&Dr.setAttribute("x",Et),Dr.className.baseVal=Wg,be.appendChild(Dr),xe+=Ra.length+1}if(Mt)if(xt)Ii=function(km,Rs,Br,Yn){if(!Array.isArray(Rs))return 0;var oh=Rs.length;if(!oh)return 0;for(var ao=Rs[0],Ga=d(ao.maxFontSize,Br)||Br,lo=0,mr=d(Yn,Br),Wo=1;Wo<oh;Wo++)lo+=d((ao=Rs[Wo]).lineHeight,Br)||mr;var vr,Yo=d(ao.maxFontSize,Br)||Br;switch(km){case"middle":vr=Ga/2-.15*Yo-lo/2;break;case"bottom":vr=-.25*Yo-lo;break;default:vr=.8*Ga}return vr}(mt,pe,me,ce);else if(mt==="top")Ii="0.8em";else switch(0<Pe?(it=parseFloat(ce)||1,it*=Pe,u.test(ce)||(it/=me)):it=0,mt){case"middle":Ii=.3-it/2+"em";break;case"bottom":Ii=-it-.3+"em"}else mt===0?Ii="0em":mt?Ii=mt:(Ii=0,this.attr("y")===null&&this.attr("y",Z||"0.8em"));return be.firstChild.setAttribute("dy",Ii),this.append(be),this},h.removeAttr=function(x){var x=tt[x],D=t.qualifyAttr(x),C=D.ns,D=D.local,Z=this.node;return C?Z.hasAttributeNS(C,D)&&Z.removeAttributeNS(C,D):Z.hasAttribute(x)&&Z.removeAttribute(x),this},h.attr=function(f,x){if(t.isUndefined(f)){for(var C=this.node.attributes,D={},Z=0;Z<C.length;Z++)D[C[Z].name]=C[Z].value;return D}if(t.isString(f)&&t.isUndefined(x))return this.node.getAttribute(tt[f]);if(typeof f=="object")for(var it in f)f.hasOwnProperty(it)&&this.setAttribute(it,f[it]);else this.setAttribute(f,x);return this},h.normalizePath=function(){return this.tagName()==="PATH"&&this.attr("d",t.normalizePathData(this.attr("d"))),this},h.remove=function(){return this.node.parentNode&&this.node.parentNode.removeChild(this.node),this},h.empty=function(){for(;this.node.firstChild;)this.node.removeChild(this.node.firstChild);return this},h.setAttributes=function(f){for(var x in f)f.hasOwnProperty(x)&&this.setAttribute(x,f[x]);return this},h.append=function(f){for(var x=0,C=(f=t.isArray(f)?f:[f]).length;x<C;x++)this.node.appendChild(t.toNode(f[x]));return this},h.prepend=function(f){var x=this.node.firstChild;return x?t(x).before(f):this.append(f)},h.before=function(f){var x=this.node,C=x.parentNode;if(C)for(var D=0,Z=(f=t.isArray(f)?f:[f]).length;D<Z;D++)C.insertBefore(t.toNode(f[D]),x);return this},h.appendTo=function(f){return t.toNode(f).appendChild(this.node),this},h.svg=function(){return this.node instanceof window.SVGSVGElement?this:t(this.node.ownerSVGElement)},h.tagName=function(){return this.node.tagName.toUpperCase()},h.defs=function(){var f=this.svg()||this,x=f.node.getElementsByTagName("defs")[0];return x?t(x):t("defs").appendTo(f)},h.clone=function(){var f=t(this.node.cloneNode(!0));return f.node.id=t.uniqueId(),f},h.findOne=function(f){return f=this.node.querySelector(f),f?t(f):void 0},h.find=function(f){var x=[],C=this.node.querySelectorAll(f);if(C)for(var D=0;D<C.length;D++)x.push(t(C[D]));return x},h.children=function(){for(var f=this.node.childNodes,x=[],C=0;C<f.length;C++)f[C].nodeType===1&&x.push(t(f[C]));return x},h.parent=function(){return t(this.node.parentNode)||null},h.index=function(){for(var f=0,x=this.node.previousSibling;x;)x.nodeType===1&&f++,x=x.previousSibling;return f},h.findParentByClass=function(f,x){for(var C=this.node.ownerSVGElement,D=this.node.parentNode;D&&D!==x&&D!==C;){var Z=t(D);if(Z.hasClass(f))return Z;D=D.parentNode}return null},h.contains=function(C){var x=this.node,C=t.toNode(C),C=C&&C.parentNode;return x===C||!!(C&&C.nodeType===1&&16&x.compareDocumentPosition(C))},h.toLocalPoint=function(f,x){var C=this.svg().node,D=C.createSVGPoint();D.x=f,D.y=x;try{var Z=D.matrixTransform(C.getScreenCTM().inverse()),it=this.getTransformToElement(C).inverse()}catch{return D}return Z.matrixTransform(it)},h.translateCenterToPoint=function(f){var x=this.getBBox({target:this.svg()}).center();return this.translate(f.x-x.x,f.y-x.y),this},h.translateAndAutoOrient=function(mt,lt,C){mt=new Q(mt),lt=new Q(lt),C=C||this.svg();var D=this.scale(),at=(this.attr("transform",""),this.getBBox({target:C}).scale(D.sx,D.sy)),Z=t.createSVGTransform(),it=(Z.setTranslate(-at.x-at.width/2,-at.y-at.height/2),t.createSVGTransform()),st=mt.angleBetween(lt,mt.clone().offset(1,0)),st=(st&&it.setRotate(st,0,0),t.createSVGTransform()),lt=mt.clone().move(lt,at.width/2),at=(st.setTranslate(2*mt.x-lt.x,2*mt.y-lt.y),this.getTransformToElement(C)),mt=t.createSVGTransform();return mt.setMatrix(st.matrix.multiply(it.matrix.multiply(Z.matrix.multiply(at.scale(D.sx,D.sy))))),this.attr("transform",t.matrixToTransformString(mt.matrix)),this},h.animateAlongPath=function(f,x){x=t.toNode(x),x=t.ensureId(x),f=t("animateMotion",f),x=t("mpath",{"xlink:href":"#"+x}),f.append(x),this.append(f);try{f.node.beginElement()}catch{if(document.documentElement.getAttribute("smiling")==="fake")for(var C=f.node,x=(C.animators=[],C.getAttribute("id")),D=(x&&(id2anim[x]=C),getTargets(C)),Z=0,it=D.length;Z<it;Z++){var st=D[Z],st=new Animator(C,st,Z);animators.push(st),(C.animators[Z]=st).register()}}return this};var p=/[^\x20\t\r\n\f]+/g;function m(f){return t.isString(f)&&f.trim().match(p)||[]}h.hasClass=function(f){return!!t.isString(f)&&this.node.classList.contains(f.trim())},h.addClass=function(f){var x;return(x=this.node.classList).add.apply(x,m(f)),this},h.removeClass=function(f){var x;return(x=this.node.classList).remove.apply(x,m(f)),this},h.toggleClass=function(f,x){for(var C=m(f),D=0;D<C.length;D++)this.node.classList.toggle(C[D],x);return this},h.sample=function(f){f=f||1;for(var x,C=this.node,D=C.getTotalLength(),Z=[],it=0;it<D;)x=C.getPointAtLength(it),Z.push({x:x.x,y:x.y,distance:it}),it+=f;return Z},h.convertToPath=function(){var f=t("path"),x=(f.attr(this.attr()),this.convertToPathData());return x&&f.attr("d",x),f},h.convertToPathData=function(){var f=this.tagName();switch(f){case"PATH":return this.attr("d");case"LINE":return t.convertLineToPathData(this.node);case"POLYGON":return t.convertPolygonToPathData(this.node);case"POLYLINE":return t.convertPolylineToPathData(this.node);case"ELLIPSE":return t.convertEllipseToPathData(this.node);case"CIRCLE":return t.convertCircleToPathData(this.node);case"RECT":return t.convertRectToPathData(this.node)}throw new Error(f+" cannot be converted to PATH.")},t.prototype.toGeometryShape=function(){var f,x,C,D,Z,it,st;switch(this.tagName()){case"RECT":return D=parseFloat(this.attr("x"))||0,st=parseFloat(this.attr("y"))||0,f=parseFloat(this.attr("width"))||0,C=parseFloat(this.attr("height"))||0,new nt(D,st,f,C);case"CIRCLE":return it=parseFloat(this.attr("cx"))||0,Z=parseFloat(this.attr("cy"))||0,D=parseFloat(this.attr("r"))||0,new We({x:it,y:Z},D,D);case"ELLIPSE":return it=parseFloat(this.attr("cx"))||0,Z=parseFloat(this.attr("cy"))||0,st=parseFloat(this.attr("rx"))||0,f=parseFloat(this.attr("ry"))||0,new We({x:it,y:Z},st,f);case"POLYLINE":return x=t.getPointsFromSvgNode(this),new ie(x);case"POLYGON":return 1<(x=t.getPointsFromSvgNode(this)).length&&x.push(x[0]),new ie(x);case"PATH":return C=this.attr("d"),At.isDataSupported(C)||(C=t.normalizePathData(C)),new At(C);case"LINE":return D=parseFloat(this.attr("x1"))||0,it=parseFloat(this.attr("y1"))||0,Z=parseFloat(this.attr("x2"))||0,st=parseFloat(this.attr("y2"))||0,new Ot({x:D,y:it},{x:Z,y:st})}return this.getBBox()},h.findIntersection=function(f,x){var C=this.svg().node,D=this.getBBox({target:x=x||C}),Z=D.center();if(D.intersectionWithLineFromCenterToPoint(f)){if(D=this.tagName(),D==="RECT")var st=new nt(parseFloat(this.attr("x")||0),parseFloat(this.attr("y")||0),parseFloat(this.attr("width")),parseFloat(this.attr("height"))),lt=this.getTransformToElement(x),it=t.decomposeMatrix(lt),C=C.createSVGTransform(),st=(C.setRotate(-it.rotation,Z.x,Z.y),t.transformRect(st,C.matrix.multiply(lt))),lt=new nt(st).intersectionWithLineFromCenterToPoint(f,it.rotation);else if(D==="PATH"||D==="POLYGON"||D==="POLYLINE"||D==="CIRCLE"||D==="ELLIPSE"){for(var at,mt,Mt,Et=(D==="PATH"?this:this.convertToPath()).sample(),Zt=1/0,xt=[],Bt=0;Bt<Et.length;Bt++)at=Et[Bt],mt=(mt=t.createSVGPoint(at.x,at.y)).matrixTransform(this.getTransformToElement(x)),(Mt=(at=new Q(mt)).distance(Z)+(mt=1.1*at.distance(f)))<Zt?(Zt=Mt,xt=[{sample:at,refDistance:mt}]):Mt<Zt+1&&xt.push({sample:at,refDistance:mt});xt.sort(function(me,Ut){return me.refDistance-Ut.refDistance}),xt[0]&&(lt=xt[0].sample)}return lt}},h.setAttribute=function(f,x){var C,D=this.node;return x===null?this.removeAttr(f):(f=tt[f],(C=t.qualifyAttr(f).ns)?D.setAttributeNS(C,f,x):f==="id"?D.id=x:D.setAttribute(f,x)),this},t.createSvgDocument=function(f){return f?t.parseXML('<svg xmlns="'+e.svg+'" xmlns:xlink="'+e.xlink+'" version="1.1">'+f+"</svg>",{async:!1}).documentElement:((f=document.createElementNS(e.svg,"svg")).setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),f.setAttribute("version","1.1"),f)},t.createSVGStyle=function(f){return t("style",{type:"text/css"},[t.createCDATASection(f)]).node},t.createCDATASection=function(f){return f===void 0&&(f=""),document.implementation.createDocument(null,"xml",null).createCDATASection(f)},t.idCounter=0,t.uniqueId=function(){return"v-"+ ++t.idCounter},t.toNode=function(f){return t.isV(f)?f.node:f.nodeName&&f||f[0]},t.ensureId=function(f){return(f=t.toNode(f)).id||(f.id=t.uniqueId())},t.sanitizeText=function(f){return(f||"").replace(/ /g," ")},t.isUndefined=function(f){return f===void 0},t.isString=function(f){return typeof f=="string"},t.isObject=function(f){return f&&typeof f=="object"},t.isArray=Array.isArray,t.parseXML=function(f,x){var C;x=x||{};try{var D=new DOMParser;t.isUndefined(x.async)||(D.async=x.async),C=D.parseFromString(f,"text/xml")}catch{C=void 0}if(!C||C.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+f);return C};var v,k,I,N,G,F,H,Y,_,K=Object.create(null),tt=(["baseFrequency","baseProfile","clipPathUnits","contentScriptType","contentStyleType","diffuseConstant","edgeMode","externalResourcesRequired","filterRes","filterUnits","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].forEach(function(f){return K[f]=f}),new Proxy(K,{get:function(f,x){return t.supportCamelCaseAttributes?x in f?f[x]:f[x]=x.replace(/[A-Z]/g,"-$&").toLowerCase():x}})),b=(Object.defineProperty(t,"attributeNames",{value:tt,writable:!1}),Object.defineProperty(t,"supportCamelCaseAttributes",{value:!1,writable:!0}),t.qualifyAttr=function(f){var x;return f.indexOf(":")!==-1?(x=f.split(":"),{ns:e[x[0]],local:x[1]}):{ns:null,local:f}},t.transformSeparatorRegex=/[ ,]+/,t.transformRegex=/\b\w+\([^()]+\)/g,t.transformFunctionRegex=/\b(\w+)\(([^()]+)\)/,t.transformTranslateRegex=/\btranslate\(([^()]+)\)/,t.transformRotateRegex=/\brotate\(([^()]+)\)/,t.transformScaleRegex=/\bscale\(([^()]+)\)/,t.transformStringToMatrix=function(f){var x=t.createSVGMatrix(),C=f&&f.match(t.transformRegex);if(C)for(var D=C.length,Z=0;Z<D;Z++){var it=C[Z].match(t.transformFunctionRegex);if(it){var st,lt,at=void 0,mt=void 0,Mt=void 0,Et=t.createSVGMatrix(),Zt=it[1].toLowerCase(),xt=it[2].split(t.transformSeparatorRegex);switch(Zt){case"scale":st=parseFloat(xt[0]),lt=xt[1]===void 0?st:parseFloat(xt[1]),Et=Et.scaleNonUniform(st,lt);break;case"translate":at=parseFloat(xt[0]),mt=parseFloat(xt[1]),Et=Et.translate(at,mt);break;case"rotate":Mt=parseFloat(xt[0]),at=parseFloat(xt[1])||0,mt=parseFloat(xt[2])||0,Et=at!==0||mt!==0?Et.translate(at,mt).rotate(Mt).translate(-at,-mt):Et.rotate(Mt);break;case"skewx":Mt=parseFloat(xt[0]),Et=Et.skewX(Mt);break;case"skewy":Mt=parseFloat(xt[0]),Et=Et.skewY(Mt);break;case"matrix":Et.a=parseFloat(xt[0]),Et.b=parseFloat(xt[1]),Et.c=parseFloat(xt[2]),Et.d=parseFloat(xt[3]),Et.e=parseFloat(xt[4]),Et.f=parseFloat(xt[5]);break;default:continue}x=x.multiply(Et)}}return x},t.matrixToTransformString=function(f){return"matrix("+((f=f||!0).a!==void 0?f.a:1)+","+(f.b!==void 0?f.b:0)+","+(f.c!==void 0?f.c:0)+","+(f.d!==void 0?f.d:1)+","+(f.e!==void 0?f.e:0)+","+(f.f!==void 0?f.f:0)+")"},t.parseTransformString=function(f){f&&(x=t.transformSeparatorRegex,0<=f.trim().indexOf("matrix")?(Z=t.transformStringToMatrix(f),C=[(Z=t.decomposeMatrix(Z)).translateX,Z.translateY],D=[Z.scaleX,Z.scaleY],Z=[Z.rotation],it=[],C[0]===0&&C[1]===0||it.push("translate("+C+")"),D[0]===1&&D[1]===1||it.push("scale("+D+")"),Z[0]!==0&&it.push("rotate("+Z+")"),f=it.join(" ")):((it=f.match(t.transformTranslateRegex))&&(C=it[1].split(x)),(it=f.match(t.transformRotateRegex))&&(Z=it[1].split(x)),(it=f.match(t.transformScaleRegex))&&(D=it[1].split(x))));var x,C,D,Z,it=D&&D[0]?parseFloat(D[0]):1;return{value:f,translate:{tx:C&&C[0]?parseInt(C[0],10):0,ty:C&&C[1]?parseInt(C[1],10):0},rotate:{angle:Z&&Z[0]?parseInt(Z[0],10):0,cx:Z&&Z[1]?parseInt(Z[1],10):void 0,cy:Z&&Z[2]?parseInt(Z[2],10):void 0},scale:{sx:it,sy:D&&D[1]?parseFloat(D[1]):it}}},t.deltaTransformPoint=function(f,x){return{x:x.x*f.a+x.y*f.c,y:x.x*f.b+x.y*f.d}},t.decomposeMatrix=function(f){var x=t.deltaTransformPoint(f,{x:0,y:1}),C=t.deltaTransformPoint(f,{x:1,y:0}),x=180/i*n(x.y,x.x)-90,C=180/i*n(C.y,C.x);return{translateX:f.e,translateY:f.f,scaleX:r(f.a*f.a+f.b*f.b),scaleY:r(f.c*f.c+f.d*f.d),skewX:x,skewY:C,rotation:x}},t.matrixToScale=function(f){var x,C,D,Z;return f?(x=t.isUndefined(f.a)?1:f.a,Z=t.isUndefined(f.d)?1:f.d,C=f.b,D=f.c):x=Z=1,{sx:C?r(x*x+C*C):x,sy:D?r(D*D+Z*Z):Z}},t.matrixToRotate=function(f){var x={x:0,y:1};return f&&(x=t.deltaTransformPoint(f,x)),{angle:Xe(On(n(x.y,x.x))-90)}},t.matrixToTranslate=function(f){return{tx:f&&f.e||0,ty:f&&f.f||0}},t.isVElement=t.isV=function(f){return f instanceof t},t.isSVGGraphicsElement=function(f){return!!f&&(f=t.toNode(f))instanceof SVGElement&&typeof f.getScreenCTM=="function"},t("svg").node);function vt(f,x,C,D,Z,it){return[1/3*f+2/3*C,1/3*x+2/3*D,1/3*Z+2/3*C,1/3*it+2/3*D,Z,it]}function O(f,x,C){return{x:f*G(C)-x*N(C),y:f*N(C)+x*G(C)}}function M(f,x,C,D,xt,Ne,Bt,lt,at,mt){var Zt=120*I/180,Mt=I/180*(+xt||0),Et=[],Ne=(mt?(Ht=mt[0],pe=mt[1],be=mt[2],xe=mt[3]):(f=(Ut=O(f,x,-Mt)).x,x=Ut.y,1<(ce=(me=(f-(lt=(Ut=O(lt,at,-Mt)).x))/2)*me/(C*C)+(Ut=(x-(at=Ut.y))/2)*Ut/(D*D))&&(C*=ce=Y(ce),D*=ce),be=(ce=(Ne==Bt?-1:1)*Y(_(((ce=C*C)*(Ne=D*D)-ce*Ut*Ut-Ne*me*me)/(ce*Ut*Ut+Ne*me*me))))*C*Ut/D+(f+lt)/2,Ht=H(((x-(xe=ce*-D*me/C+(x+at)/2))/D).toFixed(9)),pe=H(((at-xe)/D).toFixed(9)),(Ht=f<be?I-Ht:Ht)<0&&(Ht=2*I+Ht),(pe=lt<be?I-pe:pe)<0&&(pe=2*I+pe),Bt&&pe<Ht&&(Ht-=2*I),!Bt&&Ht<pe&&(pe-=2*I)),pe-Ht),Zt=(_(Ne)>Zt&&(Ut=pe,ce=lt,me=at,Et=M(lt=be+C*G(pe=Ht+Zt*(Bt&&Ht<pe?1:-1)),at=xe+D*N(pe),C,D,xt,0,Bt,ce,me,[pe,Ut,be,xe])),Ne=pe-Ht,G(Ht)),xt=N(Ht),Bt=G(pe),ce=N(pe),me=F(Ne/4),Ut=4/3*(C*me),be=4/3*(D*me),xe=[f,x],Ht=[f+Ut*xt,x-be*Zt],pe=[lt+Ut*ce,at-be*Bt],Ne=[lt,at];if(Ht[0]=2*xe[0]-Ht[0],Ht[1]=2*xe[1]-Ht[1],mt)return[Ht,pe,Ne].concat(Et);for(var Pe=[],oi=(Et=[Ht,pe,Ne].concat(Et).join().split(",")).length,Ii=0;Ii<oi;Ii++)Pe[Ii]=Ii%2?O(Et[Ii-1],Et[Ii],Mt).y:O(Et[Ii],Et[Ii+1],Mt).x;return Pe}function T(f){var x,C,D;if(!(f=Array.isArray(f)&&Array.isArray(f&&f[0])?f:(x=f)?(C={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},D=[],String(x).replace(v,function(be,xe,Ht){var pe=[],Ne=xe.toLowerCase();for(Ht.replace(k,function(Pe,oi){oi&&pe.push(+oi)}),Ne==="m"&&2<pe.length&&(D.push([xe].concat(pe.splice(0,2))),Ne="l",xe=xe==="m"?"l":"L");C[Ne]<=pe.length&&(D.push([xe].concat(pe.splice(0,C[Ne]))),C[Ne]););}),D):null)||!f.length)return[["M",0,0]];for(var Z=[],it=0,st=0,lt=0,at=0,mt=f.length,Mt=0;Mt<mt;Mt++){var Et,Zt,xt=[],Bt=(Z.push(xt),f[Mt]),ce=Bt[0];if(ce!=ce.toUpperCase())switch(xt[0]=ce.toUpperCase(),xt[0]){case"A":xt[1]=Bt[1],xt[2]=Bt[2],xt[3]=Bt[3],xt[4]=Bt[4],xt[5]=Bt[5],xt[6]=+Bt[6]+it,xt[7]=+Bt[7]+st;break;case"V":xt[1]=+Bt[1]+st;break;case"H":xt[1]=+Bt[1]+it;break;case"M":for(lt=+Bt[1]+it,at=+Bt[2]+st,Et=Bt.length,Zt=1;Zt<Et;Zt++)xt[Zt]=+Bt[Zt]+(Zt%2?it:st);break;default:for(Et=Bt.length,Zt=1;Zt<Et;Zt++)xt[Zt]=+Bt[Zt]+(Zt%2?it:st)}else for(var me=Bt.length,Ut=0;Ut<me;Ut++)xt[Ut]=Bt[Ut];switch(xt[0]){case"Z":it=+lt,st=+at;break;case"H":it=xt[1];break;case"V":st=xt[1];break;case"M":lt=xt[xt.length-2],at=xt[xt.length-1],it=xt[xt.length-2],st=xt[xt.length-1];break;default:it=xt[xt.length-2],st=xt[xt.length-1]}}return Z}function j(f){for(var x=T(f),C={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},D=[],Z="",it="",st=x.length,lt=0;lt<st;lt++){(Z=x[lt]?x[lt][0]:Z)!=="C"&&(D[lt]=Z,0<lt&&(it=D[lt-1])),x[lt]=function(xt,Bt,ce){var me,Ut;if(!xt)return["C",Bt.x,Bt.y,Bt.x,Bt.y,Bt.x,Bt.y];switch(xt[0]in{T:1,Q:1}||(Bt.qx=null,Bt.qy=null),xt[0]){case"M":Bt.X=xt[1],Bt.Y=xt[2];break;case"A":xt=parseFloat(xt[1])===0||parseFloat(xt[2])===0?["L",xt[6],xt[7]]:["C"].concat(M.apply(0,[Bt.x,Bt.y].concat(xt.slice(1))));break;case"S":Ut=ce==="C"||ce==="S"?(me=2*Bt.x-Bt.bx,2*Bt.y-Bt.by):(me=Bt.x,Bt.y),xt=["C",me,Ut].concat(xt.slice(1));break;case"T":ce==="Q"||ce==="T"?(Bt.qx=2*Bt.x-Bt.qx,Bt.qy=2*Bt.y-Bt.qy):(Bt.qx=Bt.x,Bt.qy=Bt.y),xt=["C"].concat(vt(Bt.x,Bt.y,Bt.qx,Bt.qy,xt[1],xt[2]));break;case"Q":Bt.qx=xt[1],Bt.qy=xt[2],xt=["C"].concat(vt(Bt.x,Bt.y,xt[1],xt[2],xt[3],xt[4]));break;case"H":xt=["L"].concat(xt[1],Bt.y);break;case"V":xt=["L"].concat(Bt.x,xt[1])}return xt}(x[lt],C,it),D[lt]!=="A"&&Z==="C"&&(D[lt]="C"),Mt=mt=at=void 0;var at=x,mt=lt;if(7<at[mt].length){at[mt].shift();for(var Mt=at[mt];Mt.length;)D[mt]="A",at.splice(mt++,0,["C"].concat(Mt.splice(0,6)));at.splice(mt,1),st=x.length}var Et=x[lt],Zt=Et.length;C.x=Et[Zt-2],C.y=Et[Zt-1],C.bx=parseFloat(Et[Zt-4])||C.x,C.by=parseFloat(Et[Zt-3])||C.y}return x[0][0]&&x[0][0]==="M"||x.unshift(["M",0,0]),x}return t.createSVGMatrix=function(f){var x,C=b.createSVGMatrix();for(x in f)C[x]=f[x];return C},t.createSVGTransform=function(f){return t.isUndefined(f)?b.createSVGTransform():(f instanceof SVGMatrix||(f=t.createSVGMatrix(f)),b.createSVGTransformFromMatrix(f))},t.createSVGPoint=function(f,x){var C=b.createSVGPoint();return C.x=f,C.y=x,C},t.transformRect=function(Z,st){var it=b.createSVGPoint(),at=(it.x=Z.x,it.y=Z.y,it.matrixTransform(st)),C=(it.x=Z.x+Z.width,it.y=Z.y,it.matrixTransform(st)),D=(it.x=Z.x+Z.width,it.y=Z.y+Z.height,it.matrixTransform(st)),Z=(it.x=Z.x,it.y=Z.y+Z.height,it.matrixTransform(st)),it=o(at.x,C.x,D.x,Z.x),st=s(at.x,C.x,D.x,Z.x),lt=o(at.y,C.y,D.y,Z.y),at=s(at.y,C.y,D.y,Z.y);return new nt(it,lt,st-it,at-lt)},t.transformPoint=function(f,x){return new Q(t.createSVGPoint(f.x,f.y).matrixTransform(x))},t.transformLine=function(f,x){return new Ot(t.transformPoint(f.start,x),t.transformPoint(f.end,x))},t.transformPolyline=function(f,x){for(var C=f instanceof ie?f.points:f,D=[],Z=0,it=(C=t.isArray(C)?C:[]).length;Z<it;Z++)D[Z]=t.transformPoint(C[Z],x);return new ie(D)},t.styleToObject=function(f){for(var x={},C=f.split(";"),D=0;D<C.length;D++){var Z=C[D].split("=");x[Z[0].trim()]=Z[1].trim()}return x},t.createSlicePathData=function(f,x,at,Mt){var Z=2*i-1e-6,it=(Mt<at&&(it=at,at=Mt,Mt=it),Mt-at),st=it<i?"0":"1",lt=a(at),at=l(at),mt=a(Mt),Mt=l(Mt);return Z<=it?f?"M0,"+x+"A"+x+","+x+" 0 1,1 0,"+-x+"A"+x+","+x+" 0 1,1 0,"+x+"M0,"+f+"A"+f+","+f+" 0 1,0 0,"+-f+"A"+f+","+f+" 0 1,0 0,"+f+"Z":"M0,"+x+"A"+x+","+x+" 0 1,1 0,"+-x+"A"+x+","+x+" 0 1,1 0,"+x+"Z":f?"M"+x*lt+","+x*at+"A"+x+","+x+" 0 "+st+",1 "+x*mt+","+x*Mt+"L"+f*mt+","+f*Mt+"A"+f+","+f+" 0 "+st+",0 "+f*lt+","+f*at+"Z":"M"+x*lt+","+x*at+"A"+x+","+x+" 0 "+st+",1 "+x*mt+","+x*Mt+"L0,0Z"},t.mergeAttrs=function(f,x){for(var C in x)C==="class"?f[C]=f[C]?f[C]+" "+x[C]:x[C]:C==="style"?t.isObject(f[C])&&t.isObject(x[C])?f[C]=t.mergeAttrs(f[C],x[C]):t.isObject(f[C])?f[C]=t.mergeAttrs(f[C],t.styleToObject(x[C])):t.isObject(x[C])?f[C]=t.mergeAttrs(t.styleToObject(f[C]),x[C]):f[C]=t.mergeAttrs(t.styleToObject(f[C]),t.styleToObject(x[C])):f[C]=x[C];return f},t.annotateString=function(f,x,C){x=x||[];for(var D,Z,it=(C=C||{}).offset||0,st=[],lt=[],at=0;at<f.length;at++){for(var mt=lt[at]=f[at],Mt=0;Mt<x.length;Mt++){var Et=x[Mt],Zt=Et.start+it,xt=Et.end+it;Zt<=at&&at<xt&&(t.isObject(mt)?mt.attrs=t.mergeAttrs(t.mergeAttrs({},mt.attrs),Et.attrs):mt=lt[at]={t:f[at],attrs:Et.attrs},C.includeAnnotationIndices&&(mt.annotations||(mt.annotations=[])).push(Mt))}(Z=lt[at-1])?t.isObject(mt)&&t.isObject(Z)?JSON.stringify(mt.attrs)===JSON.stringify(Z.attrs)?D.t+=mt.t:(st.push(D),D=mt):D=t.isObject(mt)||t.isObject(Z)?(st.push(D),mt):(D||"")+mt:D=mt}return D&&st.push(D),st},t.findAnnotationsAtIndex=function(f,x){var C=[];return f&&f.forEach(function(D){D.start<x&&x<=D.end&&C.push(D)}),C},t.findAnnotationsBetweenIndexes=function(f,x,C){var D=[];return f&&f.forEach(function(Z){(x>=Z.start&&x<Z.end||C>Z.start&&C<=Z.end||Z.start>=x&&Z.end<C)&&D.push(Z)}),D},t.shiftAnnotations=function(f,x,C){return f&&f.forEach(function(D){D.start<x&&D.end>=x?D.end+=C:D.start>=x&&(D.start+=C,D.end+=C)}),f},t.convertLineToPathData=function(f){return["M",(f=t(f)).attr("x1"),f.attr("y1"),"L",f.attr("x2"),f.attr("y2")].join(" ")},t.convertPolygonToPathData=function(f){return f=t.getPointsFromSvgNode(f),f.length===0?null:t.svgPointsToPath(f)+" Z"},t.convertPolylineToPathData=function(f){return f=t.getPointsFromSvgNode(f),f.length===0?null:t.svgPointsToPath(f)},t.svgPointsToPath=function(f){for(var x=0,C=f.length;x<C;x++)f[x]=f[x].x+" "+f[x].y;return"M "+f.join(" L")},t.getPointsFromSvgNode=function(f){var x=[],C=(f=t.toNode(f)).points;if(C)for(var D=0,Z=C.numberOfItems;D<Z;D++)x.push(C.getItem(D));return x},t.KAPPA=.551784,t.convertCircleToPathData=function(D){D=t(D);var x=parseFloat(D.attr("cx"))||0,C=parseFloat(D.attr("cy"))||0,D=parseFloat(D.attr("r")),Z=D*t.KAPPA;return["M",x,C-D,"C",x+Z,C-D,x+D,C-Z,x+D,C,"C",x+D,C+Z,x+Z,C+D,x,C+D,"C",x-Z,C+D,x-D,C+Z,x-D,C,"C",x-D,C-Z,x-Z,C-D,x,C-D,"Z"].join(" ")},t.convertEllipseToPathData=function(Z){Z=t(Z);var x=parseFloat(Z.attr("cx"))||0,C=parseFloat(Z.attr("cy"))||0,D=parseFloat(Z.attr("rx")),Z=parseFloat(Z.attr("ry"))||D,it=D*t.KAPPA,st=Z*t.KAPPA;return["M",x,C-Z,"C",x+it,C-Z,x+D,C-st,x+D,C,"C",x+D,C+st,x+it,C+Z,x,C+Z,"C",x-it,C+Z,x-D,C+st,x-D,C,"C",x-D,C-st,x-it,C-Z,x,C-Z,"Z"].join(" ")},t.convertRectToPathData=function(f){return f=t(f),t.rectToPath({x:parseFloat(f.attr("x"))||0,y:parseFloat(f.attr("y"))||0,width:parseFloat(f.attr("width"))||0,height:parseFloat(f.attr("height"))||0,rx:parseFloat(f.attr("rx"))||0,ry:parseFloat(f.attr("ry"))||0})},t.rectToPath=function(lt){var x=lt.x,C=lt.y,D=lt.width,Z=lt.height,it=o(lt.rx||lt["top-rx"]||0,D/2),at=o(lt.rx||lt["bottom-rx"]||0,D/2),st=o(lt.ry||lt["top-ry"]||0,Z/2),lt=o(lt.ry||lt["bottom-ry"]||0,Z/2),at=it||at||st||lt?["M",x,C+st,"v",Z-st-lt,"a",at,lt,0,0,0,at,lt,"h",D-2*at,"a",at,lt,0,0,0,at,-lt,"v",-(Z-lt-st),"a",it,st,0,0,0,-it,-st,"h",-(D-2*it),"a",it,st,0,0,0,-it,st,"Z"]:["M",x,C,"H",x+D,"V",C+Z,"H",x,"V",C,"Z"];return at.join(" ")},t.normalizePathData=(h=`	
\v\f\r   ᠎             　\u2028\u2029`,v=new RegExp("([a-z])["+h+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+h+"]*,?["+h+"]*)+)","ig"),k=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+h+"]*,?["+h+"]*","ig"),h=Math,I=h.PI,N=h.sin,G=h.cos,F=h.tan,H=h.asin,Y=h.sqrt,_=h.abs,function(f){return j(f).join(",").split(",").join(" ")}),t.namespace=e,t.g=Js,t}(),_i={useCSSSelectors:!0,classNamePrefix:"joint-",defaultTheme:"default",doubleTapInterval:300},Io="[object Arguments]",Mo="[object Array]",ss="[object Boolean]",$s="[object Date]",Ks="[object Error]",_r="[object Map]",Wr="[object Number]",il="[object Null]",di="[object Object]",hr="[object RegExp]",cr="[object Set]",as="[object String]",ls="[object Symbol]",Qs="[object Undefined]",hs="[object ArrayBuffer]",Yr="[object DataView]",qs="[object Float32Array]",nl="[object Float64Array]",rl="[object Int8Array]",cn="[object Int16Array]",ta="[object Int32Array]",Ur="[object Uint8Array]",ol="[object Uint8ClampedArray]",sl="[object Uint16Array]",ur="[object Uint32Array]",De={},je=(De[Io]=!0,De[Mo]=!0,De[hs]=!0,De[Yr]=!0,De[ss]=!0,De[$s]=!0,De[qs]=!0,De[nl]=!0,De[rl]=!0,De[cn]=!0,De[ta]=!0,De[_r]=!0,De[Wr]=!0,De[di]=!0,De[hr]=!0,De[cr]=!0,De[as]=!0,De[ls]=!0,De[Ur]=!0,De[ol]=!0,De[sl]=!0,De[ur]=!0,De[Ks]=!1,De["[object Function]"]=!1,De["[object WeakMap]"]=!1,"\\ud800-\\udfff"),ge="\\u2700-\\u27bf",Zi="a-z\\xdf-\\xf6\\xf8-\\xff",tn="A-Z\\xc0-\\xd6\\xd8-\\xde",Fi="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Hi="["+Fi+"]",Pn="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\u1ab0-\\u1aff\\u1dc0-\\u1dff]",Be="["+ge+"]",Bi="["+Zi+"]",Fi="[^"+je+Fi+"\\d"+ge+Zi+tn+"]",ge="\\ud83c[\\udffb-\\udfff]",Zi="[^"+je+"]",xi="(?:\\ud83c[\\udde6-\\uddff]){2}",nn="[\\ud800-\\udbff][\\udc00-\\udfff]",tn="["+tn+"]",As="(?:"+Bi+"|"+Fi+")",Fi="(?:"+tn+"|"+Fi+")",hi="(?:['’](?:d|ll|m|re|s|t|ve))?",Nn="(?:['’](?:D|LL|M|RE|S|T|VE))?",xs="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\u1ab0-\\u1aff\\u1dc0-\\u1dff]|\\ud83c[\\udffb-\\udfff])?",Di="[\\ufe0e\\ufe0f]?",Di=Di+xs+("(?:\\u200d(?:"+[Zi,xi,nn].join("|")+")"+Di+xs+")*"),xs="(?:"+[Be,xi,nn].join("|")+")"+Di,ea=RegExp([tn+"?"+Bi+"+"+hi+"(?="+[Hi,tn,"$"].join("|")+")",Fi+"+"+Nn+"(?="+[Hi,tn+As,"$"].join("|")+")",tn+"?"+As+"+"+hi,tn+"+"+Nn,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",xs].join("|"),"g"),ia=200,Mr="__hash_undefined__",al=/^\[object (?:Float(?:32|64)|(?:Int|Uint)(?:8|16|32)|Uint8Clamped)Array\]$/,Be="(?:"+[Zi+Pn+"?",Pn,xi,nn,"["+je+"]"].join("|")+")",cs=RegExp(ge+"(?="+ge+")|"+Be+Di,"g"),ll=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,hl=/^\w*$/,Ah=46,cl=/\\(\\)?/g,Ch=RegExp(`[^.[\\]]+|\\[(?:([^"'][^[]*)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))`,"g"),Ih=/^(?:0|[1-9]\d*)$/,na=RegExp.prototype.test.bind(/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/),Mh=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ul=function(t){return cs.test(t)},Sh=function(t){return t.match(cs)||[]},kh=function(t){return t.split("")},dl=function(t){return(ul(t)?Sh:kh)(t)},Th=function(t){return t==null?[]:So(t).map(function(e){return t[e]})},So=function(t){return qi(t)?ra(t):Object.keys(Object(t))},ra=function(t,e){for(var i,n=Array.isArray(t),r=!n&&Qi(t)&&Wi(t)===Io,o=!n&&!r&&y(t),s=n||r||o,a=t.length,l=new Array(s?a:0),h=s?-1:a;++h<a;)l[h]=""+h;for(i in t)!e&&!hasOwnProperty.call(t,i)||s&&(i==="length"||$e(i,a))||l.push(i);return l},dr=function(t,e){return t===e||t!=t&&e!=e},Qi=function(t){return t!=null&&typeof t=="object"},oa=function(t){return Qi(t)&&Wi(t)==cr},gl=function(t){return Qi(t)&&Wi(t)==_r},ko=function(t){var e=t&&t.constructor;return t===(typeof e=="function"&&e.prototype||Object.prototype)},qn=function(t,e,i){var n=t[e];hasOwnProperty.call(t,e)&&dr(n,i)&&(i!==void 0||e in t)||(t[e]=i)},To=function(t,e,i){for(var n=-1,r=e.length;++n<r;){var o=e[n];qn(i,o,t[o])}return i},qi=function(t){return t!=null&&typeof t!="function"&&typeof t.length=="number"&&-1<t.length&&t.length%1==0},Hr=function(t){return typeof t=="symbol"||Qi(t)&&Wi(t)===ls},No=function(t){var e=t.length,i=new t.constructor(e);return e&&typeof t[0]=="string"&&hasOwnProperty.call(t,"index")&&(i.index=t.index,i.input=t.input),i},us=function(t,e){var i=-1,n=t.length;for(e=e||new Array(n);++i<n;)e[i]=t[i];return e},Wi=function(t){return t==null?t===void 0?Qs:il:Object.prototype.toString.call(t)},pl=function(t,e){return e=e?Ir(t.buffer):t.buffer,new t.constructor(e,t.byteOffset,t.length)},fl=function(t){return typeof t.constructor!="function"||ko(t)?{}:Object.create(Object.getPrototypeOf(t))},Nh=function(t,e){return To(t,os(t),e)};function c(r,e){var i,n,r=r.__data__;return((n=typeof(i=e))=="string"||n=="number"||n=="symbol"||n=="boolean"?i!=="__proto__":i===null)?r[typeof e=="string"?"string":"hash"]:r.map}var g=function(t,e,i){var n,r,o=t.constructor;switch(e){case hs:return Ir(t);case ss:case $s:return new o(+t);case Yr:return n=t,r=(r=i)?Ir(n.buffer):n.buffer,new n.constructor(r,n.byteOffset,n.byteLength);case qs:case nl:case rl:case cn:case ta:case Ur:case ol:case sl:case ur:return pl(t,i);case _r:return new o(t);case Wr:case as:return new o(t);case hr:return(n=new(r=t).constructor(r.source,/\w*$/.exec(r))).lastIndex=r.lastIndex,n;case cr:return new o;case ls:return Symbol.prototype.valueOf?Object(Symbol.prototype.valueOf.call(t)):{}}},y=function(t){return Qi(t)&&al.test(Wi(t))},w=function(t){var e=Object.keys(t);return Array.isArray(t)||t==null||e.push.apply(e,os(Object(t))),e},E=function(t){for(var e=[];t;)e.push.apply(e,os(t)),t=Object.getPrototypeOf(Object(t));return e},L=function(t){var e,i=[];for(e in t)i.push(e);return Array.isArray(t)||i.push.apply(i,E(t)),i},V=function(t,e,i){return t===e||(t==null||e==null||!Qi(t)&&!Qi(e)?t!=t&&e!=e:rt(t,e,V,i))},rt=function(t,e,i,n){var r=Array.isArray(t),l=Array.isArray(e),o=r?Mo:Wi(t),l=l?Mo:Wi(e),s=(o=o==Io?di:o)==di,a=(l=l==Io?di:l)==di,l=o==l;if(l&&!s){if(n=n||new Lt,r||y(t))return q(t,e,!1,i,n);var h=t,u=e,d=i,p=n;switch(o){case Yr:return h.byteLength!=u.byteLength||h.byteOffset!=u.byteOffset?!1:(h=h.buffer,u=u.buffer,Ct(h,u,d,p));case hs:return Ct(h,u,d,p);case ss:case $s:case Wr:return dr(+h,+u);case Ks:return h.name==u.name&&h.message==u.message;case hr:case as:return h==""+u;case _r:var m=ft;case cr:if(m=m||Pt,h.size!=u.size)return!1;var v=p.get(h);return v?v==u:(p.set(h,u),v=q(m(h),m(u),!0,d,p),p.delete(h),v);case ls:return Symbol.prototype.valueOf.call(h)==Symbol.prototype.valueOf.call(u)}return!1}if(r=s&&hasOwnProperty.call(t,"__wrapped__"),o=a&&hasOwnProperty.call(e,"__wrapped__"),r||o)return i(r?t.value():t,o?e.value():e,n=n||new Lt);if(!l)return!1;n=n||new Lt;var k=t,I=e,N=i,G=n,F=w(k),H=F.length;if(H!=w(I).length)return!1;for(var Y=H;Y--;)if(tt=F[Y],!hasOwnProperty.call(I,tt))return!1;if(s=G.get(k),a=G.get(I),s&&a)return s==I&&a==k;var _,K=!0;for(G.set(k,I),G.set(I,k);++Y<H;){var tt,b=k[tt=F[Y]],vt=I[tt];if(b!==vt&&!N(b,vt,G)){K=!1;break}_=_||tt=="constructor"}return K&&!_&&(s=k.constructor)!=(a=I.constructor)&&"constructor"in k&&"constructor"in I&&!(typeof s=="function"&&s instanceof s&&typeof a=="function"&&a instanceof a)&&(K=!1),G.delete(k),G.delete(I),K},q=function(t,e,i,n,r){var o=t.length;if(o!=e.length)return!1;var s=r.get(t),a=r.get(e);if(s&&a)return s==e&&a==t;var l=-1,h=!0,u=i?new he:void 0;for(r.set(t,e),r.set(e,t);++l<o&&function(){var d=t[l],p=e[l];if(u){if(!ut(e,function(m,v){if(!bt(u,v)&&(d===m||n(d,m,r)))return u.push(v)}))return h=!1,"break"}else if(d!==p&&!n(d,p,r))return h=!1,"break"}()!=="break";);return r.delete(t),r.delete(e),h},ut=function(t,e){for(var i=-1,n=t==null?0:t.length;++i<n;)if(e(t[i],i,t))return!0;return!1},bt=function(t,e){return t.has(e)},Ct=function(t,e,i,n){return!(t.byteLength!=e.byteLength||!i(new Uint8Array(t),new Uint8Array(e),n))},ft=function(t){var e=-1,i=Array(t.size);return t.forEach(function(n,r){i[++e]=[r,n]}),i},Pt=function(t){var e=-1,i=new Array(t.size);return t.forEach(function(n){i[++e]=n}),i},te=function(t,e){var i;return!Array.isArray(t)&&(!((i=typeof t)!="number"&&i!="boolean"&&t!=null&&!Hr(t))||hl.test(t)||!ll.test(t)||e!=null&&t in Object(e))},Ie=function(t){var e=[];return t.charCodeAt(0)===Ah&&e.push(""),t.replace(Ch,function(i,n,r,o){r?i=o.replace(cl,"$1"):n&&(i=n.trim()),e.push(i)}),e},ne=function(t,e){return Array.isArray(t)?t:te(t,e)?[t]:Ie(""+t)},ii=function(t,e){for(var i=0,n=(e=ne(e,t)).length;t!=null&&i<n;)t=t[pi(e[i])],i++;return i&&i==n?t:void 0};function gi(t,e){if(t!==e){var i=t!==void 0,n=t===null,r=t==t,o=Hr(t),s=e!==void 0,a=e===null,l=e==e,h=Hr(e);if(!a&&!h&&!o&&e<t||o&&s&&l&&!a&&!h||n&&s&&l||!i&&l||!r)return 1;if(!n&&!o&&!h&&t<e||h&&i&&r&&!n&&!o||a&&i&&r||!s&&r||!l)return-1}return 0}function In(t,e){var i=function(h,u){return!!(h!=null&&h.length)&&-1<h.indexOf(u)},n=!0,r=[],o=e.length;if(t.length){e.length>=ia&&(n=!(i=function(h,u){return h.has(u)}),e=new he(e));t:for(var s in t){var a=s=t[s],s=s!==0?s:0;if(n&&a==a){for(var l=o;l--;)if(e[l]===a)continue t;r.push(s)}else i(e,a)||r.push(s)}}return r}var pi=function(t){var e;return typeof t=="string"||Hr(t)?t:(e=""+t)=="0"&&1/t==-1/0?"-0":e},de=function(t,e,i,n,r,o,s,a){var l;if(e===void 0&&(e=!1),i===void 0&&(i=!1),n===void 0&&(n=!0),(l=r?s?r(t,o,s,a):r(t):l)===void 0){if(!Dt(t))return t;var o=Array.isArray(t),h=Wi(t);if(o){if(l=No(t),!e)return us(t,l)}else{var d=typeof t=="function";if(h===di||h===Io||d&&!s){if(l=i||d?{}:fl(t),!e)return i?Sr(t,To(t,Object.keys(t),l)):Nh(t,Object.assign(l,t))}else{if(d||!De[h])return s?t:{};l=g(t,h,e)}}var u,d=(a=a||new Lt).get(t);if(d)return d;a.set(t,l),gl(t)?t.forEach(function(m,v){l.set(v,de(m,e,i,n,r,v,t,a))}):oa(t)?t.forEach(function(m){l.add(de(m,e,i,n,r,m,t,a))}):y(t)||((u=o?void 0:(n?i?L:w:i?Xr:So)(t))||t).forEach(function(m,v){u&&(m=t[v=m]),qn(l,v,de(m,e,i,n,r,v,t,a))})}return l},Sr=function(t,e){return To(t,E(t),e)},Me=function(t,e){return e.length<2?t:ii(t,e.slice(0,-1))},$e=function(t,e){var i=typeof t;return!!(e=e??Number.MAX_SAFE_INTEGER)&&(i=="number"||i!="symbol"&&Ih.test(t))&&-1<t&&t%1==0&&t<e},Xr=function(t){var e,i=[];for(e in t)i.push(e);return i},sa=function(t){var e,i={};for(e in t=Object(t))i[e]=t[e];return i},Mn=function(t,e){if((e!=="constructor"||typeof t[e]!="function")&&e!="__proto__")return t[e]};function Jr(t,e){return e===void 0&&(e=!1),function(i){for(var n=[],r=arguments.length-1;0<r--;)n[r]=arguments[r+1];var o=-1,s=n.length,l=1<s?n[s-1]:void 0,a=2<s?n[2]:void 0,l=3<t.length&&typeof l=="function"?(s--,l):e?function(u,d){if(Array.isArray(u)&&!Array.isArray(d))return d}:void 0;for(a&&rs(n[0],n[1],a)&&(l=s<3?void 0:l,s=1),i=Object(i);++o<s;){var h=n[o];h&&t(i,h,o,l)}return i}}var un=function(t,e,i,n,r){t!==e&&Se(e,function(o,s){var a,l,h,u,d,p,m,v,k,I,N,G;Dt(o)?(r=r||new Lt,I=e,h=i,u=un,d=n,p=r,m=Mn(a=t,l=s),v=Mn(I,l),(k=p.get(v))||((I=(k=d?d(m,v,""+l,a,I,p):void 0)===void 0)&&(G=!(N=Array.isArray(v))&&y(v),k=v,N||G?k=Array.isArray(m)?m:Qi(m)&&qi(m)?us(m):G?pl(v,!(I=!1)):[]:ve(v)||$r(v)?$r(k=m)?k=sa(m):typeof m!="function"&&Dt(m)||(k=fl(v)):I=!1),I&&(p.set(v,k),u(k,v,h,d,p),p.delete(v))),jn(a,l,k)):(N=n?n(t[s],o,""+s,t,e,r):void 0,jn(t,s,N=N===void 0?o:N))})},jn=function(t,e,i){(i===void 0||dr(t[e],i))&&(i!==void 0||e in t)||qn(t,e,i)},gr=function(t,e){return t&&function(i,n,r){for(var o=Object(i),s=r(i),a=s.length,l=-1;a--;){var h=s[++l];if(n(o[h],h,o)===!1)break}return i}(t,e,So)},Yi=function(t,e){if(t!=null){if(!qi(t))return gr(t,e);for(var i=t.length,n=Object(t),r=-1;++r<i&&e(n[r],r,n)!==!1;);}return t},aa=Set&&1/Pt(new Set([void 0,-0]))[1]==1/0?function(t){return new Set(t)}:function(){};function Gn(t,e,i,n,r,o){return Dt(t)&&Dt(e)&&(o.set(e,t),un(t,e,void 0,Gn,o),o.delete(e)),t}function tr(a,e,i){e=e.length?e.map(function(h){return Array.isArray(h)?function(u){return ii(u,h.length===1?h[0]:h)}:h}):[function(h){return h}];var n=-1,r=-1,o=qi(a)?new Array(a.length):[],s=(Yi(a,function(h){var u=e.map(function(d){return d(h)});o[++r]={criteria:u,index:++n,value:h}}),o),a=function(h,u){for(var d=i,p=-1,m=h.criteria,v=u.criteria,k=m.length,I=d.length;++p<k;){var N=p<I?d[p]:null,G=(N&&typeof N=="function"?N:gi)(m[p],v[p]);if(G)return N&&typeof N!="function"?G*(N=="desc"?-1:1):G}return h.index-u.index},l=s.length;for(s.sort(a);l--;)s[l]=s[l].value;return s}function ml(t){return t==t&&!Dt(t)}function vl(t,e){return function(i){return i!=null&&i[t]===e&&(e!==void 0||t in Object(i))}}function yl(t,e){return t!=null&&la(t,e,kr)}function Re(t){var e=function(i){for(var n=So(i),r=n.length;r--;){var o=n[r],s=i[o];n[r]=[o,s,ml(s)]}return n}(t);return e.length===1&&e[0][2]?vl(e[0][0],e[0][1]):function(i){return i===t||function(n,r,o,s){var a,l,h=o.length,u=h;if(n==null)return!u;for(n=Object(n);h--;)if(a=o[h],a[2]?a[1]!==n[a[0]]:!(a[0]in n))return!1;for(;++h<u;){var d=(a=o[h])[0],p=n[d],m=a[1];if(a[2]){if(p===void 0&&!(d in n))return!1}else{var v=new Lt;if(!((l=l)===void 0?V(m,p,v):l))return!1}}return!0}(i,t,e)}}function ds(t){return te(t)?(i=pi(t),function(n){return n==null?void 0:n[i]}):(e=t,function(n){return ii(n,e)});var e,i}function Sn(t){var e,i;return typeof t=="function"?t:t==null?function(n){return n}:typeof t=="object"?Array.isArray(t)?(e=t[0],i=t[1],te(e)&&ml(i)?vl(pi(e),i):function(n){var r=ii(n,e);return r===void 0&&r===i?yl(n,e):V(i,r)}):Re(t):ds(t)}function er(t){var e=Sn;return arguments.length?e(t):e}var Ph=function(t,e,i,n){var r=-1,o=t==null?0:t.length;for(n&&o&&(i=t[++r]);++r<o;)i=e(i,t[r],r,t);return i},Eh=function(t,e,i,n,r){return r(t,function(o,s,a){i=n?(n=!1,o):e(i,o,s,a)}),i},bl=function(t){return Array.isArray(t)||$r(t)||!(!t||!t[Symbol.isConcatSpreadable])};function kr(t,e){return t!=null&&e in Object(t)}function la(t,e,i){for(var n=-1,r=(e=ne(e,t)).length,o=!1;++n<r;){var s=pi(e[n]);if(!(o=t!=null&&i(t,s)))break;t=t[s]}return o||++n!=r?o:!!(r=t==null?0:t.length)&&gs(r)&&$e(s,r)&&(Array.isArray(t)||$r(t))}var ir,$r=function(t){return Qi(t)&&Wi(t)=="[object Arguments]"},Po=function(t,e,i){for(var n=-1,r=e.length,o={};++n<r;){var s=e[n],a=ii(t,s);if(i(a,s)){k=N=I=v=m=p=d=u=h=l=void 0;var l=o,h=ne(s,t),u=a;if(Dt(l))for(var d=(h=ne(h,l)).length,p=d-1,m=-1,v=l;v!=null&&++m<d;){var k,I=pi(h[m]),N=u;m!=p&&(k=v[I],(N=void 0)==void 0&&(N=Dt(k)?k:$e(h[m+1])?[]:{})),qn(v,I,N),v=v[I]}}}return o},gs=function(t){return typeof t=="number"&&-1<t&&t%1==0&&t<=Number.MAX_SAFE_INTEGER},ps=function(t){return t.match(Mh)},ha=function(t){return t.match(ea)},Lh=(ir="toUpperCase",function(t){var e,i,n,r,o;return t?(e=((i=ul(t)?dl(t):void 0)||t)[0],o=i?(n=1,o=(i=i).length,r=r===void 0?o:r,(!n&&o<=r?i:i.slice(n,r)).join("")):t.slice(1),e[ir]()+o):""});function Kr(t){var e=Object.prototype.toString;return t===!0||t===!1||!!t&&typeof t=="object"&&e.call(t)===ss}function fs(t){for(var e=[],i=arguments.length-1;0<i--;)e[i]=arguments[i+1];var n=-1,r=e.length,o=2<r?e[2]:void 0;for(o&&rs(e[0],e[1],o)&&(r=1);++n<r;){var s=e[n];if(s!=null)for(var a=Object.keys(s),l=a.length,h=-1;++h<l;){var u=a[h],d=t[u];(d===void 0||dr(d,Object.prototype[u])&&!hasOwnProperty.call(t,u))&&(t[u]=s[u])}}return t}function fi(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return t.push(void 0,Gn),ze.apply(void 0,t)}function qe(t,e){for(var i=[],n=arguments.length-2;0<n--;)i[n]=arguments[n+2];var r=-1,o=typeof e=="function",s=qi(t)?new Array(t.length):[];return Yi(t,function(a){s[++r]=o?e.apply(a,i):ms.apply(void 0,[a,e].concat(i))}),s}function ms(t,o){for(var i=[],n=arguments.length-2;0<n--;)i[n]=arguments[n+2];o=ne(o,t);var r,o=(t=Me(t,o))==null?t:t[pi((r=(o=o)==null?0:o.length)?o[r-1]:void 0)];return o==null?void 0:o.apply(t,i)}function Eo(t,e,i){var n=0,r=t==null?0:t.length;if(r==0)return 0;for(var o=(e=(i=er(i,2))(e))!=e,s=e===null,a=Hr(e),l=e===void 0;n<r;){var h=Math.floor((n+r)/2),u=i(t[h]),d=u!==void 0,p=u===null,m=u==u,v=Hr(u);(o?m:l?m&&d:s?m&&d&&!p:a?m&&d&&!p&&!v:!p&&!v&&u<e)?n=h+1:r=h}return Math.min(r,4294967294)}function J(t,e){var i=-1,n=function(p,m){return!!(p!=null&&p.length)&&-1<p.indexOf(m)},r=(e=er(e,2),!0),o=t.length,s=[],a=s;if(ia<=o){var l=e?null:aa(t);if(l)return Pt(l);r=!1,n=function(p,m){return p.has(m)},a=new he}else a=e?[]:s;t:for(;++i<o;){var u=t[i],h=e?e(u):u,u=u!==0?u:0;if(r&&h==h){for(var d=a.length;d--;)if(a[d]===h)continue t;e&&a.push(h),s.push(u)}else n(a,h)||(a!==s&&a.push(h),s.push(u))}return s}function ot(t){return de(t)}function dt(t){return de(t,!0)}function pt(t){if(t!=null){if(qi(t)&&(Array.isArray(t)||typeof t=="string"||typeof t.splice=="function"||y(t)||$r(t)))return!t.length;var e,i=Wi(t);if(i=="[object Map]"||i=="[object Set]")return!t.size;if(ko(t))return!function(n){if(!ko(n))return Object.keys(n);var r,o=[];for(r in Object(n))hasOwnProperty.call(n,r)&&r!="constructor"&&o.push(r);return o}(t).length;for(e in t)if(hasOwnProperty.call(t,e))return!1}return!0}function yt(t,e){return V(t,e)}var Lt=function(t){t=this.__data__=new Gt(t),this.size=t.size},Gt=(Lt.prototype.clear=function(){this.__data__=new Gt,this.size=0},Lt.prototype.delete=function(i){var e=this.__data__,i=e.delete(i);return this.size=e.size,i},Lt.prototype.get=function(t){return this.__data__.get(t)},Lt.prototype.has=function(t){return this.__data__.has(t)},Lt.prototype.set=function(t,e){var i=this.__data__;if(i instanceof Gt){var n=i.__data__;if(n.length<ia-1)return n.push([t,e]),this.size=++i.size,this;i=this.__data__=new _t(n)}return i.set(t,e),this.size=i.size,this},function(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}),_t=(Gt.prototype.clear=function(){this.__data__=[],this.size=0},Gt.prototype.delete=function(i){var e=this.__data__,i=Co(e,i);return!(i<0)&&(i==e.length-1?e.pop():e.splice(i,1),--this.size,!0)},Gt.prototype.get=function(i){var e=this.__data__,i=Co(e,i);return i<0?void 0:e[i][1]},Gt.prototype.has=function(t){return-1<Co(this.__data__,t)},Gt.prototype.set=function(t,e){var i=this.__data__,n=Co(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this},function(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}),Vt=(_t.prototype.clear=function(){this.size=0,this.__data__={hash:new Vt,map:new Map,string:new Vt}},_t.prototype.delete=function(t){return t=c(this,t).delete(t),this.size-=t?1:0,t},_t.prototype.get=function(t){return c(this,t).get(t)},_t.prototype.has=function(t){return c(this,t).has(t)},_t.prototype.set=function(t,e){var i=c(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this},function(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}),he=(Vt.prototype.clear=function(){this.__data__=Object.create(null),this.size=0},Vt.prototype.delete=function(t){return t=this.has(t)&&delete this.__data__[t],this.size-=t?1:0,t},Vt.prototype.get=function(t){return t=this.__data__[t],t===Mr?void 0:t},Vt.prototype.has=function(t){return this.__data__[t]!==void 0},Vt.prototype.set=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=e===void 0?Mr:e,this},function(t){var e=-1,i=t==null?0:t.length;for(this.__data__=new _t;++e<i;)this.add(t[e])}),Dt=(he.prototype.add=function(t){return this.__data__.set(t,Mr),this},he.prototype.has=function(t){return this.__data__.has(t)},he.prototype.push=he.prototype.add,function(t){return!!t&&(typeof t=="object"||typeof t=="function")}),Nt=function(t){var e=Object.prototype.toString;return typeof t=="number"||!!t&&typeof t=="object"&&e.call(t)===Wr},Ft=function(t){var e=Object.prototype.toString;return typeof t=="string"||!!t&&typeof t=="object"&&e.call(t)===as},ct=Jr(function(t,e){if(ko(e)||qi(e))To(e,So(e),t);else for(var i in e)hasOwnProperty.call(e,i)&&qn(t,i,e[i])}),Bi=ct,Fi=Bi,Jt=fs,mi=fi,Rt=function(t){return typeof t=="function"},ve=function(t){if(!Qi(t)||Wi(t)!="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},kt=function(t){if(!t)return[];if(qi(t))return(Ft(t)?dl:us)(t);if(Symbol.iterator&&Symbol.iterator in Object(t)){for(var e,i=t[Symbol.iterator](),n=[];!(e=i.next()).done;)n.push(e.value);return n}var r=Wi(t);return(r==_r?ft:r==cr?Pt:Th)(t)};function Vn(t,e,i){if(typeof t!="function")throw new TypeError("Expected a function");var n,r,o,s,a,l,h=0,u=!1,d=!1,p=!0,m=!e&&e!==0&&window&&typeof window.requestAnimationFrame=="function";function v(H){var Y=n,_=r;return n=r=void 0,h=H,s=t.apply(_,Y)}function k(H,Y){return m?(window.cancelAnimationFrame(a),window.requestAnimationFrame(H)):setTimeout(H,Y)}function I(H){var Y=H-l;return l===void 0||e<=Y||Y<0||d&&o<=H-h}function N(){var H,Y=Date.now();if(I(Y))return G(Y);a=k(N,(H=(Y=Y)-h,Y=e-(Y-l),d?Math.min(Y,o-H):Y))}function G(H){return a=void 0,p&&n?v(H):(n=r=void 0,s)}function F(){for(var H=[],Y=arguments.length;Y--;)H[Y]=arguments[Y];var _=Date.now(),K=I(_);if(n=H,r=this,l=_,K){if(a===void 0)return h=_=l,a=k(N,e),u?v(_):s;if(d)return a=k(N,e),v(l)}return a===void 0&&(a=k(N,e)),s}return e=+e||0,Dt(i)&&(u=!!i.leading,d="maxWait"in i,o=d?Math.max(+i.maxWait||0,e):o,p="trailing"in i?!!i.trailing:p),F.cancel=function(){a!==void 0&&function(H){if(m)return window.cancelAnimationFrame(H);clearTimeout(H)}(a),n=l=r=a=void(h=0)},F.flush=function(){return a===void 0?s:G(Date.now())},F.pending=function(){return a!==void 0},F}function Si(t,e){return e=er(e,2),function(i,n,r){return(Array.isArray(i)?Ph:Eh)(i,n,r,arguments.length<3,Yi)}(t,function(i,n,r){return r=e(n),hasOwnProperty.call(i,r)?i[r].push(n):qn(i,r,[n]),i},{})}function vi(t,e){var i;return t==null?[]:(1<(i=(e=e===void 0?[]:e).length)&&rs(t,e[0],e[1])?e=[]:2<i&&rs(e[0],e[1],e[2])&&(e=[e[0]]),tr(t,(e=Array.isArray(e)?e:[er(e,2)]).flat(1),[]))}function Ou(t){return t!=null&&t.length?function e(i,n,r,o,s){var a=-1,l=i.length;for(r=r||bl,s=s||[];++a<l;){var h=i[a];r(h)?e(h,n-1,r,o,s):s[s.length]=h}return s}(t,1/0):[]}function Lo(t){for(var e=[],i=arguments.length-1;0<i--;)e[i]=arguments[i+1];return qi(t)?In(t,e):[]}function Dh(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=t.map(function(G){return Qi(G)&&qi(G)?G:[]});if(i.length&&i[0]===t[0]){for(var n=i,r=function(G,F){return!!(G!=null&&G.length)&&-1<G.indexOf(F)},o=function(G,F){return G.has(F)},s=n[0].length,a=n.length,l=new Array(a),h=[],u=1/0,d=a;d--;)p=n[d],u=Math.min(p.length,u),l[d]=120<=s&&120<=p.length?new he(d&&p):void 0;var p=n[0],m=-1,v=l[0];t:for(;++m<s&&h.length<u;){var k=I=p[m],I=I!==0?I:0;if(!(v?o(v,k):r(h,k))){for(d=a;--d;){var N=l[d];if(!(N?o(N,k):r(n[d],k)))continue t}v&&v.push(k),h.push(I)}}return h}return[]}function xl(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=t.flat(1);return J(i)}function Zn(t,e){if(t==null)return!1;typeof e=="string"&&(e=e.split("."));for(var i=-1,n=t;++i<e.length;){if(!n||!hasOwnProperty.call(n,e[i]))return!1;n=n[e[i]]}return!0}function Fe(t,e,i){var n=-1,r=(e=ne(e,t)).length;for(r||(r=1,t=void 0);++n<r;){var o=t==null?void 0:t[pi(e[n])];o===void 0&&(n=r,o=i),t=typeof o=="function"?o.call(t):o}return t}function ai(t){for(var e=[],i=arguments.length-1;0<i--;)e[i]=arguments[i+1];var n={};if(t!=null){var r=!1,e=e.flat(1).map(function(h){return h=ne(h,t),r=r||1<h.length,h});To(t,L(t),n),r&&(n=de(n,!0,!0,!0,function(h){return ve(h)?void 0:h}));for(var o=e.length;o--;){a=a=s=void 0;var s=n,a=e[o];a=ne(a,s),s=Me(s,a),a=a[a.length-1],s!=null&&delete s[pi(a)]}}return n}function wl(t){for(var e,i=[],n=arguments.length-1;0<n--;)i[n]=arguments[n+1];return t==null?{}:(e=t,t=i.flat(1/0),Po(e,t,function(r,o){return yl(e,o)}))}function yi(t){for(var e=[],i=arguments.length-1;0<i--;)e[i]=arguments[i+1];return e.flat(1).forEach(function(n){n=pi(n),qn(t,n,t[n].bind(t))}),t}function ca(t){return t=(""+(t=t===void 0?"":t)).replace(/['\u2019]/g,""),(e===void 0?(na(t)?ha:ps)(t)||[]:t.match(e)||[]).reduce(function(i,n,r){return n=n.toLowerCase(),i+(r?Lh(n):n)},"");var e}function Al(t){return""+(t=t===void 0?"":t)+ ++Nf}function Ui(t){return t&&t.toString().split(" ").map(function(e){return e=e.substr(0,_i.classNamePrefix.length)!==_i.classNamePrefix?_i.classNamePrefix+e:e}).join(" ")}function Ru(t){return t&&t.toString().split(" ").map(function(e){return e=e.substr(0,_i.classNamePrefix.length)===_i.classNamePrefix?e.substr(_i.classNamePrefix.length):e}).join(" ")}function ua(t,s){function i(l,h,u){for(var d=0;d<l.length;d++){var p=l[d];if(typeof p=="string"){var m=document.createTextNode(p);h.appendChild(m)}else{if(!p.hasOwnProperty("tagName"))throw new Error("json-dom-parser: missing tagName");var m=p.tagName,v=void 0,k=(p.hasOwnProperty("namespaceURI")&&(u=p.namespaceURI),v=document.createElementNS(u,m),u===o),I=k?X:P,N=p.attributes,N=(N&&I(v).attr(N),p.style);if(N&&P(v).css(N),p.hasOwnProperty("className")&&(N=p.className,k?v.className.baseVal=N:v.className=N),p.hasOwnProperty("textContent")&&(v.textContent=p.textContent),p.hasOwnProperty("selector")){if(k=p.selector,n[k])throw new Error("json-dom-parser: selector must be unique");I(n[k]=v).attr("joint-selector",k)}if(p.hasOwnProperty("groupSelector")){var G=p.groupSelector;Array.isArray(G)||(G=[G]);for(var F=0;F<G.length;F++){var H=G[F];(r[H]||(r[H]=[])).push(v)}}h.appendChild(v),N=p.children,Array.isArray(N)&&i(N,v,u)}}}var n={},r={},o=X.namespace.svg,s=s||o,a=document.createDocumentFragment();return i(t,a,s),{fragment:a,selectors:n,groupSelectors:r}}function da(t){var e=0;if(t.length!==0)for(var i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e&=e;return e}function Vi(t,e,i){for(var n,r=Array.isArray(e)?e:e.split(i||"/"),o=0,s=r.length;o<s;){if(n=r[o++],!(Object(t)===t&&n in t))return;t=t[n]}return t}function ju(t,e){return((e=typeof e!="string"&&typeof e!="number"?String(e):e)!=="constructor"||typeof t[e]!="function")&&e!=="__proto__"}function Qr(t,e,i,n){for(var r=Array.isArray(e)?e:e.split(n||"/"),o=r.length-1,s=t,a=0;a<o;a++){var l=r[a];if(!ju(s,l))return t;s=s[l]||(s[l]={})}return s[r[o]]=i,t}function Cl(t,e,i){for(var n=Array.isArray(e)?e:e.split(i||"/"),r=n.length-1,o=t,s=0;s<r;s++){var a=n[s];if(!ju(o,a)||(a=o[a],!a))return t;o=a}return delete o[n[r]],t}function Il(t,e,i){e=e||"/";var n,r={};for(n in t)if(t.hasOwnProperty(n)){var o=typeof t[n]=="object";if(o=o&&i&&i(t[n])?!1:o){var s,a=Il(t[n],e,i);for(s in a)a.hasOwnProperty(s)&&(r[n+e+s]=a[s])}else r[n]=t[n]}return r}function Ml(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return(t==="x"?e:3&e|8).toString(16)})}function qr(t){return qr.id=qr.id||1,t===void 0?"j_"+qr.id++:(t.id=t.id===void 0?"j_"+qr.id++:t.id,t.id)}function Bh(t){return t.replace(/[A-Z]/g,"-$&").toLowerCase()}function Tt(t){if(!t.normalized){var e=t.originalEvent,i=t.target,n=e&&e.changedTouches&&e.changedTouches[0];if(n)for(var r in n)t[r]===void 0&&(t[r]=n[r]);!i||(e=i.correspondingUseElement)&&(t.target=e),t.normalized=!0}return t}function Gu(t){var e=0,i=0,n=0,r=0;return"detail"in t&&(i=t.detail),"wheelDelta"in t&&(i=-t.wheelDelta/120),"wheelDeltaY"in t&&(i=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=i,i=0),n="deltaX"in t?t.deltaX:10*e,r="deltaY"in t?t.deltaY:10*i,(n||r)&&t.deltaMode&&(t.deltaMode==1?(n*=40,r*=40):(n*=800,r*=800)),t.deltaX===0&&t.deltaY!==0&&t.shiftKey&&(n=r,e=i,i=r=0),{spinX:e=n&&!e?n<1?-1:1:e,spinY:i=r&&!i?r<1?-1:1:i,deltaX:n,deltaY:r}}function Vu(t,e){return e<t?e:t<-e?-e:t}function Zu(t,e){var i=parseFloat(t);if(Number.isNaN(i))return null;var n,r={};if(r.value=i,e==null)n="[A-Za-z]*";else if(Array.isArray(e)){if(e.length===0)return null;n=e.join("|")}else Ft(e)&&(n=e);return i=n,(e=(i=new RegExp("(?:\\d+(?:\\.\\d+)*)("+i+")$").exec(t))?i[1]:null)===null?null:(r.unit=e,r)}var zh,Sl,Oh=function(t){for(var e=[],i=arguments.length-1;0<i--;)e[i]=arguments[i+1];return Qi(t)&&qi(t)?In(t,e.flat(1)):[]},Se=function(t,e){e===void 0&&(e=function(a){return a});for(var i=-1,n=Object(t),r=qi(t)?ra(t,!0):Xr(t),o=r.length;o--;){var s=r[++i];if(e(n[s],s,n)===!1)break}},Nf=0,ze=Jr(function(t,e,i,n){un(t,e,i,n)},!0),vs=((Sl=typeof window<"u"?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame:Sl)||(zh=0,Sl=function(t){var e=new Date().getTime(),i=Math.max(0,16-(e-zh)),n=setTimeout(function(){t(e+i)},i);return zh=e+i,n}),function(t,e){for(var i=[],n=arguments.length-2;0<n--;)i[n]=arguments[n+2];return Sl(e!==void 0?t.bind.apply(t,[e].concat(i)):t)}),ys=(Hi=typeof window<"u",no=(no=Hi?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame:no)||clearTimeout,Hi?no.bind(window):no),ni=function(t){return Ft(t)&&t.slice(-1)==="%"},ga=0;function Fu(t,e){if(t===null)return e.getBBox().height;switch(t.unit){case"em":return e.getBBox().height*t.value;case"px":case"":return t.value}}function Rh(t,a,i,n){i===void 0&&(i={});var r,o=a.width,s=a.height,a=(n=n===void 0?{}:n).svgDocument||X("svg").node,l=X("tspan").node,h=X("text").attr(i).append(l).node,u=document.createTextNode(""),d=(h.style.opacity=0,h.style.display="block",l.style.display="block",l.appendChild(u),a.appendChild(h),n.svgDocument||document.body.appendChild(a),n.preserveSpaces),p=n.separator||n.separator===""?n.separator:" ",m=typeof p=="string"?p:" ",v=n.eol||`
`,k=n.hyphen?new RegExp(n.hyphen):/[^\w\d\u00C0-\u1FFF\u2800-\uFFFD]/,I=n.maxLineCount,N=(Nt(I)||(I=1/0),t.split(p)),G=[],F=[];d&&X(l).attr("xml:space","preserve");for(var H=0,Y=0,_=N.length;H<_;H++){var K=N[H];if((K||d)&&typeof K=="string"){var tt=!1;if(v&&0<=K.indexOf(v)){if(1<K.length){var b=function(Z,it){for(var st=Z.split(it),lt=1,at=0,mt=st.length-1;at<mt;at++){var Mt=[];(0<at||st[0]!=="")&&Mt.push(ga),Mt.push(it),(at<mt-1||st[mt]!=="")&&Mt.push(ga),st.splice.apply(st,[lt,0].concat(Mt)),lt+=Mt.length+1}return st.filter(function(Et){return Et!==""})}(N[H],v);N.splice.apply(N,[H,1].concat(b)),H--,_=N.length;continue}if(d&&typeof N[H-1]=="string"){N.splice(H,ga,"",ga),_+=2,H--;continue}F[++Y]=d&&typeof N[H+1]!="string"?void 0:"",tt=!0}if(!tt)if(b=void 0,b=d?F[Y]!==void 0?F[Y]+m+K:K:F[Y]?F[Y]+m+K:K,u.data=b,l.getComputedTextLength()<=o)F[Y]=b,(O||r)&&(G[Y++]=!0,r=O=0);else{if(!F[Y]||O){var vt=!!O,O=K.length-1;if(vt||!O){if(!O){if(!F[Y]){F=[];break}N.splice(H,2,K+N[H+1]),_--,G[Y++]=!0,H--;continue}N[H]=K.substring(0,O);var vt=N[H+1];N[H+1]=K.substring(O)+(vt===void 0||vt===ga?"":vt)}else r?(N.splice(H,2,N[H]+N[H+1]),r=0):(-1<(vt=K.search(k))&&vt!==K.length-1&&vt!==0&&(r=vt+1,O=0),N.splice(H,1,K.substring(0,r||O),K.substring(r||O)),_++),Y&&!G[Y-1]&&Y--;d&&F[Y]===""||H--;continue}Y++,H--}var M,T=null;if(F.length>I?T=I-1:s!==void 0&&(M=M===void 0&&u.data!==""?i.lineHeight==="auto"?Fu({value:1.5,unit:"em"},h):Fu(Zu(i.lineHeight,["em","px",""]),h):M)*F.length>s&&(T=Math.floor(s/M)-1),T!==null){F.splice(T+1);var j=n.ellipsis;if(!j||T<0)break;typeof j!="string"&&(j="…");var f=F[T];if(!f&&!tt)break;var x,C,D=f.length;do if(C=f[D],x=f.substring(0,D),C?C.match(p)&&(x+=C):x+=m,x+=j,u.data=x,l.getComputedTextLength()<=o){F[T]=x;break}while(0<=--D);break}}}return n.svgDocument?a.removeChild(h):document.body.removeChild(a),F.join(v)}function jh(t){return(t=P(P.parseHTML("<div>"+t+"</div>",null,!1))).find("*").each(function(){var e=this;P.each(e.attributes,function(){var i=this.name,n=this.value;(i.startsWith("on")||n.startsWith("javascript:")||n.startsWith("data:")||n.startsWith("vbscript:"))&&P(e).removeAttr(i)})}),t.html()}function _u(t,e){var i;window.navigator.msSaveBlob?window.navigator.msSaveBlob(t,e):(t=window.URL.createObjectURL(t),(i=document.createElement("a")).href=t,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(t))}function Wu(t,e){t=Yu(t),_u(t,e)}function Yu(t){t=t.replace(/\s/g,"");for(var e=(t=decodeURIComponent(t)).indexOf(","),i=t.slice(0,e),n=i.split(":")[1].split(";")[0],t=t.slice(e+1),r=0<=i.indexOf("base64")?atob(t):unescape(encodeURIComponent(t)),o=new Uint8Array(r.length),s=0;s<r.length;s++)o[s]=r.charCodeAt(s);return new Blob([o],{type:n})}function Gh(t,e){if(!t||t.substr(0,5)==="data:")return setTimeout(function(){e(null,t)},0);function i(r,o){var s;r.status===200?(r=new Uint8Array(r.response),o(null,"data:image/"+({svg:"svg+xml"}[s=t.split(".").pop()||"png"]||s)+";base64,"+btoa(function(a){for(var l=[],h=0;h<a.length;h+=32768)l.push(String.fromCharCode.apply(null,a.subarray(h,h+32768)));return l.join("")}(r)))):o(new Error("Failed to load image "+t))}var n=new XMLHttpRequest;n.open("GET",t,!0),n.addEventListener("error",function(){e(new Error("Failed to load image "+t))}),n.responseType=window.FileReader?"blob":"arraybuffer",n.addEventListener("load",function(){var r,o,s;window.FileReader?(o=e,(r=n).status===200?((s=new FileReader).onload=function(a){a=a.target.result,o(null,a)},s.onerror=function(){o(new Error("Failed to load image "+t))},s.readAsDataURL(r.response)):o(new Error("Failed to load image "+t))):i(n,e)}),n.send()}function Do(t){if((t=P(t)).length===0)throw new Error("Element not found");var e=(t=t[0]).ownerDocument,i=t.getBoundingClientRect(),n=0,r=0;return t.ownerSVGElement&&(t=(t=X(t)).getBBox({target:t.svg()}),n=i.width-t.width,r=i.height-t.height),{x:i.left+window.pageXOffset-e.documentElement.offsetLeft+n/2,y:i.top+window.pageYOffset-e.documentElement.offsetTop+r/2,width:i.width-n,height:i.height-r}}function Uu(t,e){var i=(t=P(t)).map(function(){var n=this.parentNode,r=n.insertBefore(document.createTextNode(""),this.nextSibling);return function(){if(n===this)throw new Error("You can't sort elements if any one is a descendant of another.");n.insertBefore(this,r),n.removeChild(r)}});return Array.prototype.sort.call(t,e).each(function(n){i[n].call(this)})}function Bo(t,e){var i=P(t);Se(e,function(n,r){r=i.find(r).addBack().filter(r),Zn(n,"class")&&(r.addClass(n.class),n=ai(n,"class")),r.attr(n)})}function Hu(t){var e=window.top.document;function i(n,r){for(var o=["webkit","moz","ms","o",""],s=0;s<o.length;s++){var a=o[s],a=a?a+r:r.substr(0,1).toLowerCase()+r.substr(1);if(n[a]!==void 0)return Rt(n[a])?n[a]():n[a]}}t=t||e.body,i(e,"FullscreenElement")||i(e,"FullScreenElement")?i(e,"ExitFullscreen")||i(e,"CancelFullScreen"):i(t,"RequestFullscreen")||i(t,"RequestFullScreen")}function zo(){}var ti=function(t){var e,i,n,r;return Object(t)!==t?(r=0,{top:r=isFinite(t)?+t:r,right:r,bottom:r,left:r}):(e=i=n=r=0,isFinite(t.vertical)&&(e=n=+t.vertical),isFinite(t.horizontal)&&(i=r=+t.horizontal),{top:e=isFinite(t.top)?+t.top:e,right:i=isFinite(t.right)?+t.right:i,bottom:n=isFinite(t.bottom)?+t.bottom:n,left:r=isFinite(t.left)?+t.left:r})},Xu={linear:function(t){return t},quad:function(t){return t*t},cubic:function(t){return t*t*t},inout:function(t){var e,i;return t<=0?0:1<=t?1:(i=(e=t*t)*t,4*(t<.5?i:3*(t-e)+i-.75))},exponential:function(t){return Math.pow(2,10*(t-1))},bounce:function(t){for(var e,i=0,n=1;;i+=n,n/=2)if((7-4*i)/11<=t)return-(e=(11-6*i-11*t)/4)*e+n*n},reverse:function(t){return function(e){return 1-t(1-e)}},reflect:function(t){return function(e){return .5*(e<.5?t(2*e):2-t(2-2*e))}},clamp:function(t,e,i){return e=e||0,i=i||1,function(n){return n=t(n),n<e?e:i<n?i:n}},back:function(t){return t=t||1.70158,function(e){return e*e*((t+1)*e-t)}},elastic:function(t){return t=t||1.5,function(e){return Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)}}},Vh={number:function(t,e){var i=e-t;return function(n){return t+i*n}},object:function(t,e){var i=Object.keys(t);return function(n){for(var r,o={},s=i.length-1;s!=-1;s--)o[r=i[s]]=t[r]+(e[r]-t[r])*n;return o}},hexColor:function(i,n){var i=parseInt(i.slice(1),16),n=parseInt(n.slice(1),16),r=255&i,o=(255&n)-r,s=65280&i,a=(65280&n)-s,l=16711680&i,h=(16711680&n)-l;return function(u){return"#"+(1<<24|r+o*u&255|s+a*u&65280|l+h*u&16711680).toString(16).slice(1)}},unit:function(t,r){var n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,i=n.exec(t),n=n.exec(r),r=n[1].indexOf("."),o=0<r?n[1].length-r-1:0,s=(t=+i[1],+n[1]-t),a=i[2];return function(l){return(t+s*l).toFixed(o)+a}}},Ju={outline:function(t){var e=Number.isFinite(t.margin)?t.margin:2,i=Number.isFinite(t.width)?t.width:1;return Li('<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${outerRadius}" /><feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${innerRadius}" /><feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/><feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/><feMerge><feMergeNode in="outline"/><feMergeNode in="SourceGraphic"/></feMerge></filter>')({color:t.color||"blue",opacity:Number.isFinite(t.opacity)?t.opacity:1,outerRadius:e+i,innerRadius:e})},highlight:function(t){return Li('<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${width}"/><feComposite result="composed" in="colored" in2="morphed" operator="in"/><feGaussianBlur result="blured" in="composed" stdDeviation="${blur}"/><feBlend in="SourceGraphic" in2="blured" mode="normal"/></filter>')({color:t.color||"red",width:Number.isFinite(t.width)?t.width:1,blur:Number.isFinite(t.blur)?t.blur:0,opacity:Number.isFinite(t.opacity)?t.opacity:1})},blur:function(t){var e=Number.isFinite(t.x)?t.x:2;return Li('<filter><feGaussianBlur stdDeviation="${stdDeviation}"/></filter>')({stdDeviation:Number.isFinite(t.y)?[e,t.y]:e})},dropShadow:function(t){var e="SVGFEDropShadowElement"in window?'<filter><feDropShadow stdDeviation="${blur}" dx="${dx}" dy="${dy}" flood-color="${color}" flood-opacity="${opacity}"/></filter>':'<filter><feGaussianBlur in="SourceAlpha" stdDeviation="${blur}"/><feOffset dx="${dx}" dy="${dy}" result="offsetblur"/><feFlood flood-color="${color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="${opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';return Li(e)({dx:t.dx||0,dy:t.dy||0,opacity:Number.isFinite(t.opacity)?t.opacity:1,color:t.color||"black",blur:Number.isFinite(t.blur)?t.blur:4})},grayscale:function(t){return t=Number.isFinite(t.amount)?t.amount:1,Li('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${b} ${h} 0 0 0 0 0 1 0"/></filter>')({a:.2126+.7874*(1-t),b:.7152-.7152*(1-t),c:.0722-.0722*(1-t),d:.2126-.2126*(1-t),e:.7152+.2848*(1-t),f:.0722-.0722*(1-t),g:.2126-.2126*(1-t),h:.0722+.9278*(1-t)})},sepia:function(t){return t=Number.isFinite(t.amount)?t.amount:1,Li('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${h} ${i} 0 0 0 0 0 1 0"/></filter>')({a:.393+.607*(1-t),b:.769-.769*(1-t),c:.189-.189*(1-t),d:.349-.349*(1-t),e:.686+.314*(1-t),f:.168-.168*(1-t),g:.272-.272*(1-t),h:.534-.534*(1-t),i:.131+.869*(1-t)})},saturate:function(t){return t=Number.isFinite(t.amount)?t.amount:1,Li('<filter><feColorMatrix type="saturate" values="${amount}"/></filter>')({amount:1-t})},hueRotate:function(t){return Li('<filter><feColorMatrix type="hueRotate" values="${angle}"/></filter>')({angle:t.angle||0})},invert:function(t){return t=Number.isFinite(t.amount)?t.amount:1,Li('<filter><feComponentTransfer><feFuncR type="table" tableValues="${amount} ${amount2}"/><feFuncG type="table" tableValues="${amount} ${amount2}"/><feFuncB type="table" tableValues="${amount} ${amount2}"/></feComponentTransfer></filter>')({amount:t,amount2:1-t})},brightness:function(t){return Li('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}"/><feFuncG type="linear" slope="${amount}"/><feFuncB type="linear" slope="${amount}"/></feComponentTransfer></filter>')({amount:Number.isFinite(t.amount)?t.amount:1})},contrast:function(t){return t=Number.isFinite(t.amount)?t.amount:1,Li('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}" intercept="${amount2}"/><feFuncG type="linear" slope="${amount}" intercept="${amount2}"/><feFuncB type="linear" slope="${amount}" intercept="${amount2}"/></feComponentTransfer></filter>')({amount:t,amount2:.5-t/2})}},pa={number:function(n,e,i){i=i||{currency:["$",""],decimal:".",thousands:",",grouping:[3]};var n=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i.exec(n),r=n[1]||" ",o=n[2]||">",I=n[3]||"",s=n[4]||"",a=n[5],l=+n[6],h=n[7],k=n[8],u=n[9],d=1,p="",m="",v=!1,k=k&&+k.substring(1);switch((a||r==="0"&&o==="=")&&(a=r="0",o="=",h&&(l-=Math.floor((l-1)/4))),u){case"n":h=!0,u="g";break;case"%":d=100,m="%",u="f";break;case"p":d=100,m="%",u="r";break;case"b":case"o":case"x":case"X":s==="#"&&(p="0"+u.toLowerCase());break;case"c":case"d":v=!0,k=0;break;case"s":d=-1,u="r"}if(s==="$"&&(p=i.currency[0],m=i.currency[1]),u!="r"||k||(u="g"),k!=null&&(u=="g"?k=Math.max(1,Math.min(21,k)):u!="e"&&u!="f"||(k=Math.max(0,Math.min(20,k)))),n=a&&h,v&&e%1)return"";var I=e<0||e===0&&1/e<0?(e=-e,"-"):I,N=m,F=(d<0?(e=(F=this.prefix(e,k)).scale(e),N=F.symbol+m):e*=d,(e=this.convert(u,e,k)).lastIndexOf(".")),G=F<0?e:e.substring(0,F),F=F<0?"":i.decimal+e.substring(F+1);function H(Y){for(var _=Y.length,K=[],tt=0,b=i.grouping[0];0<_&&0<b;)K.push(Y.substring(_-=b,_+b)),b=i.grouping[tt=(tt+1)%i.grouping.length];return K.reverse().join(i.thousands)}return!a&&h&&i.grouping&&(G=H(G)),a=p.length+G.length+F.length+(n?0:I.length),l=a<l?new Array(a=l-a+1).join(r):"",I+=p,e=(G=n?H(l+G):G)+F,(o==="<"?I+e+l:o===">"?l+I+e:o==="^"?l.substring(0,a>>=1)+I+e+l.substring(a):I+(n?e:l+e))+N},string:function(t,e){for(var i,n="{",r=!1,o=[];(i=t.indexOf(n))!==-1;){if(l=t.slice(0,i),r){for(var s,a=(s=l.split(":")).shift().split("."),l=e,h=0;h<a.length;h++)l=l[a[h]];s.length&&(l=this.number(s,l))}o.push(l),t=t.slice(i+1),n=(r=!r)?"}":"{"}return o.push(t),o.join("")},convert:function(t,e,i){switch(t){case"b":return e.toString(2);case"c":return String.fromCharCode(e);case"o":return e.toString(8);case"x":return e.toString(16);case"X":return e.toString(16).toUpperCase();case"g":return e.toPrecision(i);case"e":return e.toExponential(i);case"f":return e.toFixed(i);case"r":return(e=this.round(e,this.precision(e,i))).toFixed(Math.max(0,Math.min(20,this.precision(e*(1+1e-15),i))));default:return e+""}},round:function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},precision:function(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)},prefix:function(t,e){var i=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(function(r,o){var s=Math.pow(10,3*Math.abs(8-o));return{scale:8<o?function(a){return a/s}:function(a){return a*s},symbol:r}}),n=0;return t&&(t<0&&(t*=-1),e&&(t=this.round(t,this.precision(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n<=0?n+1:n-1)/3)))),i[8+n/3]}},Li=function(t){var e=/<%= ([^ ]+) %>|\$\{ ?([^{} ]+) ?\}|\{\{([^{} ]+)\}\}/g;return function(i){return i=i||{},t.replace(e,function(n){for(var r=Array.from(arguments).slice(1,4).find(function(s){return!!s}).split("."),o=i[r.shift()];o!==void 0&&r.length;)o=o[r.shift()];return o!==void 0?o:""})}};function Zh(t){t=J(t);var e=kt(t).reduce(function(i,n){return i[n.id]=n.clone(),i},{});return kt(t).forEach(function(i){var n=e[i.id],r=(n.isLink()&&(r=n.source(),o=n.target(),r.id&&e[r.id]&&n.prop("source/id",e[r.id].id),o.id&&e[o.id]&&n.prop("target/id",e[o.id].id)),i.get("parent")),o=(r&&e[r]&&n.set("parent",e[r].id),kt(i.get("embeds")).reduce(function(s,a){return e[a]&&s.push(e[a].id),s},[]));pt(o)||n.set("embeds",o)}),e}var Tr={x:"x",y:"y",width:"w",height:"h",minimum:"s",maximum:"l",diagonal:"d"},As=Object.keys(Tr).map(function(t){return Tr[t]}).join(""),hi="[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?",Pf=/\s/g,$u=new RegExp("^("+hi+"\\*)?(["+As+"])(/"+hi+")?([-+]{1,2}"+hi+")?$","g");function Ku(t){throw new Error("Invalid calc() expression: "+t)}function Ef(i,e){var o=$u.exec(i.replace(Pf,"")),i=(o||Ku(i),$u.lastIndex=0,o[1]),n=o[2],r=o[3],o=o[4],s=e.x,a=e.y,l=e.width,h=e.height,u=0;switch(n){case Tr.width:u=l;break;case Tr.height:u=h;break;case Tr.x:u=s;break;case Tr.y:u=a;break;case Tr.minimum:u=Math.min(h,l);break;case Tr.maximum:u=Math.max(h,l);break;case Tr.diagonal:u=Math.sqrt(h*h+l*l)}return i&&(u*=parseFloat(i)),r&&(u/=parseFloat(r.slice(1))),o&&(u+=function(d){if(!d)return 0;switch(d[0]){case"+":return parseFloat(d.substr(1));case"-":return-parseFloat(d.substr(1))}return parseFloat(d)}(o)),u}function kn(t){return typeof t=="string"&&t.includes("calc")}var Qu=5;function Tn(t,e){for(var i=t,n=0;;){var r=i.indexOf("calc(",n);if(r===-1)return i;var o=r+Qu,s=1;t:for(;;){switch(i[o]){case"(":s++;break;case")":if(--s===0)break t;break;case void 0:Ku(i)}o++}var a=i.slice(r+Qu,o),a=(kn(a)&&(a=Tn(a,e)),String(Ef(a,e))),i=i.slice(0,r)+a+i.slice(o+1),n=r+a.length}}var Lf=["checked","selected","disabled","readOnly","contentEditable","value","indeterminate"].reduce(function(t,e){return t[e]=!0,t},{});function to(t,e){return function(i,n){var r=ni(i),o=(i=parseFloat(i),r&&(i/=100),{});return isFinite(i)&&(r=r||0<=i&&i<=1?i*n[e]:Math.max(i+n[e],0),o[t]=r),o}}function kl(t,e,i){return function(n,r){var o,s=ni(n),s=(n=parseFloat(n),s&&(n/=100),isFinite(n)&&(o=r[i](),o=s||0<n&&n<1?o[t]+r[e]*n:o[t]+n),Q());return s[t]=o||0,s}}function qu(t,e,i){return function(o,r){var o=o==="middle"?r[e]/2:o===i?r[e]:isFinite(o)?-1<o&&o<1?-r[e]*o:-o:ni(o)?r[e]*parseFloat(o)/100:0,s=Q();return s[t]=-(r[t]+o),s}}function td(t,e){var i="joint-shape",n=e&&e.resetOffset;return function(a,o,d){var d=P(d),l=d.data(i),a=(l&&l.value===a||(l={value:a,shape:a=t(a),shapeBBox:a.bbox()},d.data(i,l)),l.shape.clone()),d=l.shapeBBox.clone(),l=d.origin(),h=o.origin(),h=(d.x=h.x,d.y=h.y,o.maxRectScaleToFit(d,h)),u=d.width===0||o.width===0?1:h.sx,d=d.height===0||o.height===0?1:h.sy;return a.scale(u,d,l),n&&a.translate(-l.x,-l.y),a}}function ed(t){var e=td(function(i){return new At(X.normalizePathData(i))},t);return function(i,n,r){return{d:e(i,n,r).serialize()}}}function id(t){var e=td(ie,t);return function(i,n,r){return{points:e(i,n,r).serialize()}}}function Tl(t,e){var i=new Q(1,0);return function(s){var r,o,s=this[t](s);return s?(o=e.rotate?s.vector().vectorAngle(i):0,r=s.start):(r=this.path.start,o=0),o===0?{transform:"translate("+r.x+","+r.y+")"}:{transform:"translate("+r.x+","+r.y+") rotate("+o+")"}}}function nd(t){return function(e,i,n){n=X(n),n.attr(t)!==e&&n.attr(t,e)}}function bs(t,e,i){return i.text!==void 0}function fa(){return this.model.isLink()}function Fh(t){var e={},i=t.stroke,i=(typeof i=="string"&&(e.stroke=i,e.fill=i),t.strokeOpacity);return(i=(i=i===void 0?t["stroke-opacity"]:i)===void 0?t.opacity:i)!==void 0&&(e["stroke-opacity"]=i,e["fill-opacity"]=i),e}function rd(t){var e=this.paper;return"url(#"+(t.type==="pattern"?e.definePattern(t):e.defineGradient(t))+")"}function od(t,e,i){if(Ft(i)){if(!Nl[i])throw new Error('Unknown wrapper: "'+i+'"');i=Nl[i]}if(!Rt(i))throw new Error("Wrapper must be a function.");kt(e).forEach(function(n){t[n]=i(t[n])})}var sd,ad,ue={xlinkShow:{set:"xlink:show"},xlinkRole:{set:"xlink:role"},xlinkType:{set:"xlink:type"},xlinkArcrole:{set:"xlink:arcrole"},xlinkTitle:{set:"xlink:title"},xlinkActuate:{set:"xlink:actuate"},xmlSpace:{set:"xml:space"},xmlBase:{set:"xml:base"},xmlLang:{set:"xml:lang"},preserveAspectRatio:{set:"preserveAspectRatio"},requiredExtension:{set:"requiredExtension"},requiredFeatures:{set:"requiredFeatures"},systemLanguage:{set:"systemLanguage"},externalResourcesRequired:{set:"externalResourceRequired"},href:{set:nd("href")},xlinkHref:{set:nd("xlink:href")},filter:{qualify:ve,set:function(t){return"url(#"+this.paper.defineFilter(t)+")"}},fill:{qualify:ve,set:rd},stroke:{qualify:ve,set:rd},sourceMarker:{qualify:ve,set:function(t,e,i,n){return t=ct(Fh(n),t),{"marker-start":"url(#"+this.paper.defineMarker(t)+")"}}},targetMarker:{qualify:ve,set:function(t,e,i,n){return t=ct(Fh(n),{transform:"rotate(180)"},t),{"marker-end":"url(#"+this.paper.defineMarker(t)+")"}}},vertexMarker:{qualify:ve,set:function(t,e,i,n){return t=ct(Fh(n),t),{"marker-mid":"url(#"+this.paper.defineMarker(t)+")"}}},text:{qualify:function(t,e,i){return!i.textWrap||!ve(i.textWrap)},set:function(t,k,i,v){var r=P(i),o="joint-text",s=r.data(o),a=v.lineHeight,l=v.annotations,h=v.textVerticalAnchor,u=v.eol,d=v.displayEmpty,p=v.textPath,m=v.x,v=(kn(m)&&(m=Tn(m,k)),v["font-size"]||v.fontSize),k=(kn(v)&&(v=Tn(v,k)),JSON.stringify([t,a,l,h,u,d,p,m,v]));s!==void 0&&s===k||(v&&i.setAttribute("font-size",v),Dt(p)&&typeof(s=p.selector)=="string"&&(v=this.findBySelector(s)[0])instanceof SVGPathElement&&(p=ct({"xlink:href":"#"+v.id},p)),X(i).text(""+t,{lineHeight:a,annotations:l,textPath:p,x:m,textVerticalAnchor:h,eol:u,displayEmpty:d}),r.data(o,k))}},textWrap:{qualify:ve,set:function(t,e,i,n){var r,o,s={},a=t.width||0,a=(ni(a)?s.width=e.width*parseFloat(a)/100:kn(a)?s.width=Number(Tn(a,e)):t.width===null?s.width=1/0:s.width=a<=0?e.width+a:a,t.height||0),a=(ni(a)?s.height=e.height*parseFloat(a)/100:kn(a)?s.height=Number(Tn(a,e)):t.height!==null&&(s.height=a<=0?e.height+a:a),t.text);o=(a=a===void 0?n.text:a)!==void 0?(o=t.breakText||Rh,r=n["font-size"]||n.fontSize,o(""+a,s,{"font-weight":n["font-weight"]||n.fontWeight,"font-size":kn(r)?Tn(r,e):r,"font-family":n["font-family"]||n.fontFamily,lineHeight:n.lineHeight,"letter-spacing":"letter-spacing"in n?n["letter-spacing"]:n.letterSpacing},{svgDocument:this.paper.svg,ellipsis:t.ellipsis,hyphen:t.hyphen,separator:t.separator,maxLineCount:t.maxLineCount,preserveSpaces:t.preserveSpaces})):"",ue.text.set.call(this,o,e,i,n)}},title:{qualify:function(t,e){return e instanceof SVGElement},set:function(t,e,i){var n=P(i),r="joint-title",o=n.data(r);o!==void 0&&o===t||(n.data(r,t),i.tagName==="title"?i.textContent=t:(o=i.firstElementChild)&&o.tagName==="title"?o.textContent=t:((n=document.createElementNS(i.namespaceURI,"title")).textContent=t,i.insertBefore(n,o)))}},lineHeight:{qualify:bs},textVerticalAnchor:{qualify:bs},textPath:{qualify:bs},annotations:{qualify:bs},eol:{qualify:bs},displayEmpty:{qualify:bs},port:{set:function(t){return t===null||t.id===void 0?t:t.id}},style:{qualify:ve,set:function(t,e,i){P(i).css(t)}},html:{set:function(t,e,i){P(i).html(t+"")}},props:{qualify:function(t){return ve(t)},set:function(t,e,i){Object.keys(t).forEach(function(n){var r;Lf[n]&&n in i&&(r=t[n],i.tagName==="SELECT"&&Array.isArray(r)?Array.from(i.options).forEach(function(o,s){o.selected=r.includes(o.value)}):i[n]=r)})}},ref:{},refX:{position:kl("x","width","origin")},refY:{position:kl("y","height","origin")},refDx:{position:kl("x","width","corner")},refDy:{position:kl("y","height","corner")},refWidth:{set:to("width","width")},refHeight:{set:to("height","height")},refRx:{set:to("rx","width")},refRy:{set:to("ry","height")},refRInscribed:{set:(sd=to("r","width"),ad=to("r","height"),function(t,e){return(e.height>e.width?sd:ad)(t,e)})},refRCircumscribed:{set:function(t,r){var i,n=ni(t),r=(t=parseFloat(t),n&&(t/=100),Math.sqrt(r.height*r.height+r.width*r.width));return{r:i=isFinite(t)?n||0<=t&&t<=1?t*r:Math.max(t+r,0):i}}},refCx:{set:to("cx","width")},refCy:{set:to("cy","height")},xAlignment:{offset:qu("x","width","right")},yAlignment:{offset:qu("y","height","bottom")},resetOffset:{offset:function(t,e){return t?{x:-e.x,y:-e.y}:{x:0,y:0}}},refDResetOffset:{set:ed({resetOffset:!0})},refDKeepOffset:{set:ed({resetOffset:!1})},refPointsResetOffset:{set:id({resetOffset:!0})},refPointsKeepOffset:{set:id({resetOffset:!1})},connection:{qualify:fa,set:function(o){var e,i,n,r,o=o.stubs;return o===void 0&&(o=0),isFinite(o)&&o!==0&&(o=o<0?(this.getConnectionLength()+o)/2:o,r=this.getConnection(),i=this.getConnectionSubdivisions(),n=r.divideAtLength(o,{segmentSubdivisions:i}),r=r.divideAtLength(-o,{segmentSubdivisions:i}),n&&r&&(e=n[0].serialize()+" "+r[1].serialize())),{d:e||this.getSerializedConnection()}}},atConnectionLengthKeepGradient:{qualify:fa,set:Tl("getTangentAtLength",{rotate:!0})},atConnectionLengthIgnoreGradient:{qualify:fa,set:Tl("getTangentAtLength",{rotate:!1})},atConnectionRatioKeepGradient:{qualify:fa,set:Tl("getTangentAtRatio",{rotate:!0})},atConnectionRatioIgnoreGradient:{qualify:fa,set:Tl("getTangentAtRatio",{rotate:!1})}},Oo=(ue["xlink:href"]=ue.xlinkHref,["transform","d","points","cx","cy","x1","x2","y1","y2","x","y","dx","dy"].forEach(function(t){ue[t]={qualify:kn,set:function(e,i){var n={};return n[t]=Tn(e,i),n}}}),["width","height","r","rx","ry","font-size","stroke-width"].forEach(function(t){ue[t]={qualify:kn,set:function(e,i){var n={};return n[t]=Math.max(0,Tn(e,i)),n}}}),ue.refR=ue.refRInscribed,ue.refD=ue.refDResetOffset,ue.refPoints=ue.refPointsResetOffset,ue.atConnectionLength=ue.atConnectionLengthKeepGradient,ue.atConnectionRatio=ue.atConnectionRatioKeepGradient,ue.fontSize=ue["font-size"],ue.strokeWidth=ue["stroke-width"],ue.refX2=ue.refX,ue.refY2=ue.refY,ue.refWidth2=ue.refWidth,ue.refHeight2=ue.refHeight,ue["ref-x"]=ue.refX,ue["ref-y"]=ue.refY,ue["ref-dy"]=ue.refDy,ue["ref-dx"]=ue.refDx,ue["ref-width"]=ue.refWidth,ue["ref-height"]=ue.refHeight,ue["x-alignment"]=ue.xAlignment,ue["y-alignment"]=ue.yAlignment,ue),bi=R.Model.extend({constructor:function(n,e){var i,n=n||{};typeof this.preinitialize=="function"&&this.preinitialize.apply(this,arguments),this.cid=Al("c"),this.attributes={},e&&e.collection&&(this.collection=e.collection),e&&e.parse&&(n=this.parse(n,e)||{}),(i=Fe(this,"defaults"))&&(n=ze({},i,n)),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)},translate:function(t,e,i){throw new Error("Must define a translate() method.")},toJSON:function(){var t=Fe(this.constructor.prototype,"defaults").attrs||{},i=this.attributes.attrs,e={},i=(Se(i,function(n,r){var o=t[r];Se(n,function(s,a){Dt(s)&&!Array.isArray(s)?Se(s,function(l,h){o&&o[a]&&yt(o[a][h],l)||(e[r]=e[r]||{},(e[r][a]||(e[r][a]={}))[h]=l)}):o&&yt(o[a],s)||(e[r]=e[r]||{},e[r][a]=s)})}),dt(ai(this.attributes,"attrs")));return i.attrs=e,i},initialize:function(t){var e=this.getIdAttribute();t&&t[e]!==void 0||this.set(e,this.generateId(),{silent:!0}),this._transitionIds={},this._scheduledTransitionIds={},this.processPorts(),this.on("change:attrs",this.processPorts,this)},getIdAttribute:function(){return this.idAttribute||"id"},generateId:Ml,processPorts:function(){var t=this.ports,e={},i=(Se(this.get("attrs"),function(n,r){n&&n.port&&(n.port.id!==void 0?e[n.port.id]=n.port:e[n.port]={id:n.port})}),{});Se(t,function(n,r){e[r]||(i[r]=!0)}),this.graph&&!pt(i)&&(this.graph.getConnectedLinks(this,{inbound:!0}).forEach(function(n){i[n.get("target").port]&&n.remove()}),this.graph.getConnectedLinks(this,{outbound:!0}).forEach(function(n){i[n.get("source").port]&&n.remove()})),this.ports=e},remove:function(t){t===void 0&&(t={});var e=this.graph,i=this.collection;if(e){e.startBatch("remove");for(var n=this.getParentCell(),r=(n&&n.unembed(this,t),this.getEmbeddedCells()),o=0,s=r.length;o<s;o++){var a=r[o];a&&a.remove(t)}this.trigger("remove",this,e.attributes.cells,t),e.stopBatch("remove")}else i&&i.remove(this,t);return this},toFront:function(t){var e,i,n,r=this.graph;return r&&((t=Jt(t||{},{foregroundEmbeds:!0})).deep?(e=this.getEmbeddedCells({deep:!0,breadthFirst:t.breadthFirst!==!1,sortSiblings:t.foregroundEmbeds})).unshift(this):e=[this],i=t.foregroundEmbeds?e:vi(e,function(o){return o.z()}),n=r.maxZIndex()-e.length+1,((r=r.get("cells")).indexOf(i[0])!==r.length-e.length||i.some(function(o,s){return o.z()!==n+s}))&&(this.startBatch("to-front"),n+=e.length,i.forEach(function(o,s){o.set("z",n+s,t)}),this.stopBatch("to-front"))),this},toBack:function(t){var e,i,n,r=this.graph;return r&&((t=Jt(t||{},{foregroundEmbeds:!0})).deep?(e=this.getEmbeddedCells({deep:!0,breadthFirst:t.breadthFirst!==!1,sortSiblings:t.foregroundEmbeds})).unshift(this):e=[this],i=t.foregroundEmbeds?e:vi(e,function(o){return o.z()}),n=r.minZIndex(),(r.get("cells").indexOf(i[0])!==0||i.some(function(o,s){return o.z()!==n+s}))&&(this.startBatch("to-back"),n-=e.length,i.forEach(function(o,s){o.set("z",n+s,t)}),this.stopBatch("to-back"))),this},parent:function(t,e){return t===void 0?this.get("parent"):this.set("parent",t,e)},embed:function(n,e){var i=this,n=Array.isArray(n)?n:[n];if(!this.canEmbed(n))throw new Error("Recursive embedding not allowed.");if(n.some(function(r){return r.isEmbedded()&&i.id!==r.parent()}))throw new Error("Embedding of already embedded cells is not allowed.");return this._embedCells(n,e),this},unembed:function(t,e){return t=Array.isArray(t)?t:[t],this._unembedCells(t,e),this},canEmbed:function(t){var e=this;return(Array.isArray(t)?t:[t]).every(function(i){return e!==i&&!e.isEmbeddedIn(i)})},_embedCells:function(t,e){var i=this,n=(this.startBatch("embed"),ct([],this.get("embeds")));t.forEach(function(r){n[r.isLink()?"unshift":"push"](r.id),r.parent(i.id,e)}),this.set("embeds",J(n),e),this.stopBatch("embed")},_unembedCells:function(t,e){this.startBatch("unembed"),t.forEach(function(i){return i.unset("parent",e)}),this.set("embeds",Lo.apply(void 0,[this.get("embeds")].concat(t.map(function(i){return i.id}))),e),this.stopBatch("unembed")},getParentCell:function(){var t=this.parent(),e=this.graph;return t&&e&&e.getCell(t)||null},getAncestors:function(){var t=[];if(this.graph)for(var e=this.getParentCell();e;)t.push(e),e=e.getParentCell();return t},getEmbeddedCells:function(t){var e;return this.graph?(t=t||{}).deep?t.breadthFirst?this._getEmbeddedCellsBfs(t.sortSiblings):this._getEmbeddedCellsDfs(t.sortSiblings):(e=this.get("embeds"),pt(e)?[]:(e=e.map(this.graph.getCell,this.graph),t.sortSiblings?vi(e,function(i){return i.z()}):e)):[]},_getEmbeddedCellsBfs:function(t){var e=[],i=[];for(i.push(this);0<i.length;){var n=i.shift(),n=(e.push(n),n.getEmbeddedCells({sortSiblings:t}));i.push.apply(i,n)}return e.shift(),e},_getEmbeddedCellsDfs:function(t){var e=[],i=[];for(i.push(this);0<i.length;)for(var n=i.pop(),r=(e.push(n),n.getEmbeddedCells({sortSiblings:t})),o=r.length-1;0<=o;--o)i.push(r[o]);return e.shift(),e},isEmbeddedIn:function(t,e){var i=Ft(t)?t:t.id,n=this.parent();if(e=ct({deep:!0},e),this.graph&&e.deep){for(;n;){if(n===i)return!0;n=this.graph.getCell(n).parent()}return!1}return n===i},isEmbedded:function(){return!!this.parent()},clone:function(t){return(t=t||{}).deep?kt(Zh([this].concat(this.getEmbeddedCells({deep:!0})))):((t=R.Model.prototype.clone.apply(this,arguments)).set(this.getIdAttribute(),this.generateId()),t.unset("embeds"),t.unset("parent"),t)},prop:function(t,e,i){var n=Ft(t);if(n||Array.isArray(t)){if(1<arguments.length){var r=n?(m=t).split("/"):(m=t.join("/"),t.slice()),o=r[0],s=r.length,i=i||{};i.propertyPath=m,i.propertyValue=e,i.propertyPathArray=r,"rewrite"in i||(i.rewrite=!1);for(var u=p={},d=o,a=1;a<s;a++)var l=r[a],h=Number.isFinite(n?Number(l):l),u=u[d]=h?[]:{},d=l;var p=Qr(p,r,e,"/"),k=ze({},this.attributes),m=(i.rewrite&&Cl(k,m,"/"),ze(k,p));return this.set(o,m[o],i)}return Vi(this.attributes,t,"/")}var v,k=e||{},I=(k.propertyPath=null,k.propertyValue=t,k.propertyPathArray=[],"rewrite"in k||(k.rewrite=!1),{});for(v in t){var N=ze({},{changedValue:this.attributes[v]},{changedValue:t[v]}).changedValue;I[v]=N}return this.set(I,k)},removeProp:function(t,e){e=e||{};var i=Array.isArray(t)?t:t.split("/"),n=i[0];return n==="attrs"&&(e.dirty=!0),i.length===1?this.unset(t,e):(t=i.slice(1),(i=this.get(n))==null?this:(i=dt(i),Cl(i,t,"/"),this.set(n,i,e)))},attr:function(t,e,i){var n=Array.from(arguments);return n.length===0?this.get("attrs"):(Array.isArray(t)?n[0]=["attrs"].concat(t):Ft(t)?n[0]="attrs/"+t:n[0]={attrs:t},this.prop.apply(this,n))},removeAttr:function(t,e){return Array.isArray(t)?this.removeProp(["attrs"].concat(t)):this.removeProp("attrs/"+t,e)},transition:function(t,e,i,n){var r=this;n=n||"/",i=ct({duration:100,delay:10,timingFunction:Xu.linear,valueFunction:Vh.number},i);var o,s=0,a=(function(u){var d;(u=(u-=s=s||u)/i.duration)<1?this._transitionIds[t]=d=vs(a):(u=1,delete this._transitionIds[t]),u=o(i.timingFunction(u)),i.transitionId=d,this.prop(t,u,i),d||this.trigger("transition:end",this,t)}).bind(this),l=this._scheduledTransitionIds,h=setTimeout(function(u){l[t]&&(l[t]=Lo(l[t],h),l[t].length===0&&delete l[t]),r.stopPendingTransitions(t,n),o=i.valueFunction(Vi(r.attributes,t,n),e),r._transitionIds[t]=vs(u),r.trigger("transition:start",r,t)},i.delay,a);return l[t]||(l[t]=[]),l[t].push(h),h},getTransitions:function(){return xl(Object.keys(this._transitionIds),Object.keys(this._scheduledTransitionIds))},stopScheduledTransitions:function(t,e){e===void 0&&(e="/");var i,n=this._scheduledTransitionIds,r=(n===void 0&&(n={}),Object.keys(n));return t&&(i=t.split(e),r=r.filter(function(o){return yt(i,o.split(e).slice(0,i.length))})),r.forEach(function(o){n[o].forEach(function(s){return clearTimeout(s)}),delete n[o]}),this},stopPendingTransitions:function(t,e){var i,n=this,r=(e===void 0&&(e="/"),this._transitionIds),o=(r===void 0&&(r={}),Object.keys(r));t&&(i=t.split(e),o=o.filter(function(s){return yt(i,s.split(e).slice(0,i.length))})),o.forEach(function(s){var a=r[s];ys(a),delete r[s],n.trigger("transition:end",n,s)})},stopTransitions:function(t,e){return this.stopScheduledTransitions(t,e=e===void 0?"/":e),this.stopPendingTransitions(t,e),this},addTo:function(t,e){return t.addCell(this,e),this},findView:function(t){return t.findViewByModel(this)},isElement:function(){return!1},isLink:function(){return!1},startBatch:function(t,e){return this.graph&&this.graph.startBatch(t,ct({},e,{cell:this})),this},stopBatch:function(t,e){return this.graph&&this.graph.stopBatch(t,ct({},e,{cell:this})),this},getChangeFlag:function(t){var e=0;if(t)for(var i in t)t.hasOwnProperty(i)&&this.hasChanged(i)&&(e|=t[i]);return e},angle:function(){return 0},position:function(){return new Q(0,0)},z:function(){return this.get("z")||0},getPointFromConnectedLink:function(){return new Q},getBBox:function(){return new nt(0,0,0,0)},getPointRotatedAroundCenter:function(t,e,i){return e=new Q(e,i),t&&e.rotate(this.getBBox().center(),t),e},getAbsolutePointFromRelative:function(t,e){return this.getPointRotatedAroundCenter(-this.angle(),this.position().offset(t,e))},getRelativePointFromAbsolute:function(t,e){return this.getPointRotatedAroundCenter(this.angle(),t,e).difference(this.position())}},{getAttributeDefinition:function(t){var e=this.attributes,i=Oo;return e&&e[t]||i[t]},define:function(t,e,i,n){return i=ct({defaults:mi({type:t},e,this.prototype.defaults)},i),e=this.extend(i,n),typeof joint<"u"&&Zn(joint,"shapes")&&Qr(joint.shapes,t,e,"."),e}}),Nl={cells:function(t){return function(){var e=Array.from(arguments),n=e.length,i=0<n&&e[0]||[],n=1<n&&e[n-1]||{};return Array.isArray(i)||(n instanceof bi?i=e:i instanceof bi&&(1<e.length&&e.pop(),i=e)),n instanceof bi&&(n={}),t.call(this,i,n)}}},li={TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left",TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",CENTER:"center"};function Ro(t,e){var i=new nt(t);switch(e){case void 0:throw new Error("Position required");case li.LEFT:case"leftMiddle":return i.leftMiddle();case li.RIGHT:case"rightMiddle":return i.rightMiddle();case li.TOP:case"topMiddle":return i.topMiddle();case li.BOTTOM:case"bottomMiddle":return i.bottomMiddle();case li.TOP_LEFT:case"topLeft":case"origin":return i.topLeft();case li.TOP_RIGHT:case"topRight":return i.topRight();case li.BOTTOM_LEFT:case"bottomLeft":return i.bottomLeft();case li.BOTTOM_RIGHT:case"bottomRight":case"corner":return i.bottomRight();case li.CENTER:return i.center();default:throw new Error("Unknown position: "+e)}}var ld={__proto__:null,getRectPoint:Ro,wrapWith:od,wrappers:Nl,addClassNamePrefix:Ui,removeClassNamePrefix:Ru,parseDOMJSON:ua,hashCode:da,getByPath:Vi,setByPath:Qr,unsetByPath:Cl,flattenObject:Il,uuid:Ml,guid:qr,toKebabCase:Bh,normalizeEvent:Tt,normalizeWheel:Gu,cap:Vu,nextFrame:vs,cancelFrame:ys,shapePerimeterConnectionPoint:function(t,e,i,n){var r,o,s,a;return i||(s=e.$(".scalable")[0],a=e.$(".rotatable")[0],s&&s.firstChild?i=s.firstChild:a&&a.firstChild&&(i=a.firstChild)),i?(o=X(i).findIntersection(n,t.paper.cells))||(r=X(i).getBBox({target:t.paper.cells})):o=(r=e.model.getBBox()).intersectionWithLineFromCenterToPoint(n),o||r.center()},isPercentage:ni,parseCssNumeric:Zu,breakText:Rh,sanitizeHTML:jh,downloadBlob:_u,downloadDataUri:Wu,dataUriToBlob:Yu,imageToDataUri:Gh,getElementBBox:Do,sortElements:Uu,setAttributesBySelector:Bo,normalizeSides:ti,timing:Xu,interpolate:Vh,filter:Ju,format:pa,template:Li,toggleFullScreen:Hu,isBoolean:Kr,isObject:Dt,isNumber:Nt,isString:Ft,mixin:Bi,deepMixin:Fi,supplement:fs,defaults:Jt,deepSupplement:fi,defaultsDeep:mi,assign:ct,invoke:qe,invokeProperty:ms,sortedIndex:Eo,uniq:J,clone:ot,cloneDeep:dt,isEmpty:pt,isEqual:yt,isFunction:Rt,isPlainObject:ve,toArray:kt,debounce:Vn,groupBy:Si,sortBy:vi,flattenDeep:Ou,without:Lo,difference:Oh,intersection:Dh,union:xl,has:Zn,result:Fe,omit:ai,pick:wl,bindAll:yi,forIn:Se,camelCase:ca,uniqueId:Al,merge:ze,noop:zo,cloneCells:Zh,svg:function(r){for(var e=[],i=arguments.length-1;0<i--;)e[i]=arguments[i+1];var n=[],r=(r.forEach(function(a,l){n.push(a),l in e&&n.push(e[l])}),n.join("")),o=new DOMParser,r="<svg>"+r.trim()+"</svg>";if(o.parseFromString(r.replace(/@/g,""),"application/xml").getElementsByTagName("parsererror")[0])throw new Error("Invalid SVG markup");var o=o.parseFromString(r,"text/html").querySelector("svg"),s=[];return Array.from(o.children).forEach(function(a){s.push(function l(h){var u={},d=h.tagName,p=h.attributes,m=h.namespaceURI,v=h.style;h=h.childNodes,u.namespaceURI=m,u.tagName=m===X.namespace.xhtml?d.toLowerCase():d;for(var k={},I=v.length;I--;){var N=v[I];k[N]=v.getPropertyValue(N)}u.style=k,m=p.getNamedItem("@selector"),m&&(u.selector=m.value,p.removeNamedItem("@selector")),d=p.getNamedItem("@group-selector"),d&&(m=d.value.split(","),u.groupSelector=m.map(function(H){return H.trim()}),p.removeNamedItem("@group-selector")),d=p.getNamedItem("class"),d&&(u.className=d.value);var G=[];h.forEach(function(H){switch(H.nodeType){case Node.TEXT_NODE:var Y=H.data.replace(/\s\s+/g," ");Y.trim()&&G.push(Y);break;case Node.ELEMENT_NODE:G.push(l(H))}}),G.length&&(u.children=G);var F={};return Array.from(p).forEach(function(_){var Y=_.name,_=_.value;F[Y]=_}),0<Object.keys(F).length&&(u.attributes=F),u}(a))}),s}};function hd(t,e,i){return t=t.toJSON(),t.angle=e||0,Jt({},i,t)}function ma(t,e,i,n){return t.map(function(r,o,s){return o=this.pointAt((o+.5)/s.length),(r.dx||r.dy)&&o.offset(r.dx||0,r.dy||0),hd(o.round(),0,_h(n,r))},Xn(e,i))}function cd(t,e,i,n){var r=e.center(),o=e.width/e.height,s=e.topMiddle(),a=We.fromRect(e);return t.map(function(l,h,u){return h=i+n(h,u.length),u=s.clone().rotate(r,-h).scale(o,1,r),h=l.compensateRotation?-a.tangentTheta(u):0,(l.dx||l.dy)&&u.offset(l.dx||0,l.dy||0),l.dr&&u.move(r,l.dr),hd(u.round(),h,_h(e,l))})}function _h(t,r){var i=r.x,n=r.y,r=r.angle;return ni(i)?i=parseFloat(i)/100*t.width:kn(i)&&(i=Number(Tn(i,t))),ni(n)?n=parseFloat(n)/100*t.height:kn(n)&&(n=Number(Tn(n,t))),{x:i,y:n,angle:r}}function Wh(t,e){return t=_h(t,e),e=t.x,t=t.y,new Q(e||0,t||0)}var ud={__proto__:null,absolute:function(t,e){return t.map(function(i){var n=Wh(e,i).round().toJSON();return n.angle=i.angle||0,n})},fn:function(t,e,i){return i.fn(t,e,i)},line:function(t,e,i){return ma(t,Wh(e,i.start||e.origin()),Wh(e,i.end||e.corner()),e)},left:function(t,e,i){return ma(t,e.origin(),e.bottomLeft(),e)},right:function(t,e,i){return ma(t,e.topRight(),e.corner(),e)},top:function(t,e,i){return ma(t,e.origin(),e.topRight(),e)},bottom:function(t,e,i){return ma(t,e.bottomLeft(),e.corner(),e)},ellipseSpread:function(t,e,i){var n=i.startAngle||0,r=i.step||360/t.length;return cd(t,e,n,function(o){return o*r})},ellipse:function(t,e,i){var n=i.startAngle||0,r=i.step||20;return cd(t,e,n,function(o,s){return(o+.5-s/2)*r})}};function eo(t,e){return mi({},t,e,{x:0,y:0,angle:0,attrs:{}})}function dd(t){var e=t.center(),i=e.theta(t.origin()),n=e.theta(t.bottomLeft()),r=e.theta(t.corner());return[i,e.theta(t.topRight()),r,n]}function gd(l,m,i,n){n=Jt({},n,{offset:15});var r,o,s,a,l=m.center().theta(l),h=n.offset,u=0,m=dd(m),d=m[0],v=m[1],p=m[2],m=m[3],v=(l<v||p<l?(s=".3em",r=h,o=0,a="start"):l<d?(r=0,o=-h,s=i?(u=-90,a="start",".3em"):(a="middle","0")):l<m?(s=".3em",r=-h,o=0,a="end"):(r=0,o=h,s=i?(u=90,a="start",".3em"):(a="middle",".6em")),Math.round);return eo(n,{x:v(r),y:v(o),angle:u,attrs:{labelText:{y:s,textAnchor:a}}})}function pd(l,m,i,n){n=Jt({},n,{offset:15});var r,o,s,a,l=m.center().theta(l),h=n.offset,u=0,m=dd(m),d=m[0],v=m[1],p=m[2],m=m[3],v=(l<v||p<l?(s=".3em",r=-h,o=0,a="end"):l<d?(r=0,o=h,s=i?(u=90,a="start",".3em"):(a="middle",".6em")):l<m?(s=".3em",r=h,o=0,a="start"):(r=0,o=-h,s=i?(u=-90,a="start",".3em"):(a="middle","0")),Math.round);return eo(n,{x:v(r),y:v(o),angle:u,attrs:{labelText:{y:s,textAnchor:a}}})}function fd(s,e,i){i=Jt({},i,{offset:20});var n,o=se(0,0),a=-s.theta(o),r=a,o=s.clone().move(o,i.offset).difference(s).round(),s=".3em",a=((90+a)%180==0?(n=e?"end":"middle",e||a!=-270||(s="0em")):-270<a&&a<-90?(n="start",r=a-180):n="end",Math.round);return eo(i,{x:a(o.x),y:a(o.y),angle:e?r:0,attrs:{labelText:{y:s,textAnchor:n}}})}function md(t){t=dt(t)||{},this.ports=[],this.groups={},this.portLayoutNamespace=ud,this.portLabelLayoutNamespace=yd,this._init(t)}function Yh(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];this.callbackArguments=t}var vd,yd={__proto__:null,manual:function(t,e,i){return eo(i)},left:function(t,e,i){return eo(i,{x:-15,attrs:{labelText:{y:".3em",textAnchor:"end"}}})},right:function(t,e,i){return eo(i,{x:15,attrs:{labelText:{y:".3em",textAnchor:"start"}}})},top:function(t,e,i){return eo(i,{y:-15,attrs:{labelText:{y:"0",textAnchor:"middle"}}})},bottom:function(t,e,i){return eo(i,{y:15,attrs:{labelText:{y:".6em",textAnchor:"middle"}}})},outsideOriented:function(t,e,i){return gd(t,e,!0,i)},outside:function(t,e,i){return gd(t,e,!1,i)},insideOriented:function(t,e,i){return pd(t,e,!0,i)},inside:function(t,e,i){return pd(t,e,!1,i)},radial:function(t,e,i){return fd(t.difference(e.center()),!1,i)},radialOriented:function(t,e,i){return fd(t.difference(e.center()),!0,i)}},tn=(md.prototype={getPorts:function(){return this.ports},getGroup:function(t){return this.groups[t]||{}},getPortsByGroup:function(t){return this.ports.filter(function(e){return e.group===t})},getGroupPortsMetrics:function(i,e){var n=this.getGroup(i),i=this.getPortsByGroup(i),n=n.position||{},s=n.name,o=this.portLayoutNamespace,n=(o[s]||(s="left"),n.args||{}),r=i.map(function(a){return a&&a.position&&a.position.args}),o=o[s](r,e,n),s={ports:i,result:[]};return kt(o).reduce((function(a,l,h){return h=a.ports[h],a.result.push({portId:h.id,portTransformation:l,labelTransformation:this._getPortLabelLayout(h,Q(l),e),portAttrs:h.attrs,portSize:h.size,labelSize:h.label.size}),a}).bind(this),s),s.result},_getPortLabelLayout:function(t,e,i){var n=this.portLabelLayoutNamespace,r=t.label.position.name||"left";return n[r]?n[r](e,i,t.label.position.args):null},_init:function(t){if(Dt(t.groups))for(var e=Object.keys(t.groups),i=0,n=e.length;i<n;i++){var r=e[i];this.groups[r]=this._evaluateGroup(t.groups[r])}for(var o=kt(t.items),s=0,a=o.length;s<a;s++)this.ports.push(this._evaluatePort(o[s]))},_evaluateGroup:function(t){return ze(t,{position:this._getPosition(t.position,!0),label:this._getLabel(t,!0)})},_evaluatePort:function(i){var e=ct({},i),i=this.getGroup(i.group);return e.markup=e.markup||i.markup,e.attrs=ze({},i.attrs,e.attrs),e.position=this._createPositionNode(i,e),e.label=ze({},i.label,this._getLabel(e)),e.z=this._getZIndex(i,e),e.size=ct({},i.size,e.size),e},_getZIndex:function(t,e){return Nt(e.z)?e.z:Nt(t.z)||t.z==="auto"?t.z:"auto"},_createPositionNode:function(t,e){return ze({name:"left",args:{}},t.position,{args:e.args})},_getPosition:function(t,r){var i,n={},r=(Rt(t)?(i="fn",n.fn=t):Ft(t)?i=t:t===void 0?i=r?"left":null:Array.isArray(t)?(i="absolute",n.x=t[0],n.y=t[1]):Dt(t)&&(i=t.name,ct(n,t.args)),{args:n});return i&&(r.name=i),r},_getLabel:function(i,e){var i=i.label||{},n=i;return n.position=this._getPosition(i.position,e),n}},{_initializePorts:function(){this._createPortData(),this.on("change:ports",function(){this._processRemovedPort(),this._createPortData()},this)},_processRemovedPort:function(){var i=this.get("ports")||{},t={},i=(kt(i.items).forEach(function(n){t[n.id]=!0}),this.previous("ports")||{}),e={},i=(kt(i.items).forEach(function(n){t[n.id]||(e[n.id]=!0)}),this.graph);i&&!pt(e)&&(i.getConnectedLinks(this,{inbound:!0}).forEach(function(n){e[n.get("target").port]&&n.remove()}),i.getConnectedLinks(this,{outbound:!0}).forEach(function(n){e[n.get("source").port]&&n.remove()}))},hasPorts:function(){var t=this.prop("ports/items");return Array.isArray(t)&&0<t.length},hasPort:function(t){return this.getPortIndex(t)!==-1},getPorts:function(){return dt(this.prop("ports/items"))||[]},getGroupPorts:function(t){var e=kt(this.prop(["ports","items"])).filter(function(i){return i.group===t});return dt(e)},getPort:function(t){return dt(kt(this.prop("ports/items")).find(function(e){return e.id&&e.id===t}))},getPortsPositions:function(t){return this._portSettingsData.getGroupPortsMetrics(t,nt(this.size())).reduce(function(e,i){var n=i.portTransformation;return e[i.portId]={x:n.x,y:n.y,angle:n.angle},e},{})},getPortIndex:function(t){var e=Dt(t)?t.id:t;return this._isValidPortId(e)?kt(this.prop("ports/items")).findIndex(function(i){return i.id===e}):-1},addPort:function(t,e){if(!Dt(t)||Array.isArray(t))throw new Error("Element: addPort requires an object.");var i=ct([],this.prop("ports/items"));return i.push(t),this.prop("ports/items",i,e),this},insertPort:function(t,e,i){if(t=typeof t=="number"?t:this.getPortIndex(t),!Dt(e)||Array.isArray(e))throw new Error("dia.Element: insertPort requires an object.");var n=ct([],this.prop("ports/items"));return n.splice(t,0,e),this.prop("ports/items",n,i),this},portProp:function(t,e,i,n){var r=this.getPortIndex(t);if(r===-1)throw new Error("Element: unable to find port with id "+t);return t=Array.prototype.slice.call(arguments,1),Array.isArray(e)?t[0]=["ports","items",r].concat(e):Ft(e)?t[0]=["ports/items/",r,"/",e].join(""):(t=["ports/items/"+r],ve(e)&&(t.push(e),t.push(i))),this.prop.apply(this,t)},_validatePorts:function(){var e=this.get("ports")||{},t=[],e=kt((e||{}).items);return e.forEach(function(i){typeof i!="object"&&t.push("Element: invalid port ",i),this._isValidPortId(i.id)||(i.id=this.generatePortId())},this),J(e,"id").length!==e.length&&t.push("Element: found id duplicities in ports."),t},generatePortId:function(){return this.generateId()},_isValidPortId:function(t){return t!=null&&!Dt(t)},addPorts:function(t,e){return t.length&&this.prop("ports/items",ct([],this.prop("ports/items")).concat(t),e),this},removePort:function(r,n){var i,n=n||{},r=this.getPortIndex(r);return r!==-1&&((i=ct([],this.prop(["ports","items"]))).splice(r,1),n.rewrite=!0,this.startBatch("port-remove"),this.prop(["ports","items"],i,n),this.stopBatch("port-remove")),this},removePorts:function(t,e){var i;if(Array.isArray(t)){if(i=e||{},t.length===0)return this.this;var n=ct([],this.prop(["ports","items"])).filter(function(r){return!t.some(function(o){return o=Dt(o)?o.id:o,r.id===o})})}else i=t||{},n=[];return this.startBatch("port-remove"),i.rewrite=!0,this.prop(["ports","items"],n,i),this.stopBatch("port-remove"),this},_createPortData:function(){var t,e=this._validatePorts();if(0<e.length)throw this.set("ports",this.previous("ports")),new Error(e.join(" "));this._portSettingsData&&(t=this._portSettingsData.getPorts()),this._portSettingsData=new md(this.get("ports"));var i,n=this._portSettingsData.getPorts();t&&(e=n.filter(function(r){if(!t.find(function(o){return o.id===r.id}))return r}),0<(i=t.filter(function(r){if(!n.find(function(o){return o.id===r.id}))return r})).length&&this.trigger("ports:remove",this,i),0<e.length&&this.trigger("ports:add",this,e))}}),Nn={portContainerMarkup:"g",portMarkup:[{tagName:"circle",selector:"circle",attributes:{r:10,fill:"#FFFFFF",stroke:"#000000"}}],portLabelMarkup:[{tagName:"text",selector:"text",attributes:{fill:"#000000"}}],_portElementsCache:null,_initializePorts:function(){this._cleanPortsCache()},_refreshPorts:function(){this._removePorts(),this._cleanPortsCache(),this._renderPorts()},_cleanPortsCache:function(){this._portElementsCache={}},_renderPorts:function(){for(var t=[],e=this._getContainerElement(),i=0,n=e.node.childNodes.length;i<n;i++)t.push(e.node.childNodes[i]);for(var r=Si(this.model._portSettingsData.getPorts(),"z"),o=(kt(r.auto).forEach(function(h){h=this._getPortElement(h),e.append(h),t.push(h)},this),Object.keys(r)),s=0;s<o.length;s++){var a,l=o[s];l!=="auto"&&(a=parseInt(l,10),this._appendPorts(r[l],a,t))}this._updatePorts()},_getContainerElement:function(){return this.rotatableNode||this.vel},_appendPorts:function(r,e,i){var n=this._getContainerElement(),r=kt(r).map(this._getPortElement,this);i[e]||e<0?X(i[Math.max(e,0)]).before(r):n.append(r)},_getPortElement:function(t){return this._portElementsCache[t.id]?this._portElementsCache[t.id].portElement:this._createPortElement(t)},findPortNode:function(r,e){var i,n,r=this._portElementsCache[r];return r?e?(i=r.portElement.node,n=r.portSelectors,(e=this.findBySelector(e,i,n)[0])===void 0?null:e):r.portContentElement.node:null},_updatePorts:function(){this._updatePortGroup(void 0),Object.keys(this.model._portSettingsData.groups).forEach(this._updatePortGroup,this)},_removePorts:function(){qe(this._portElementsCache,"portElement.remove")},_createPortElement:function(t){var e,i,n,r,o=X(this.portContainerMarkup).addClass("joint-port"),d=this._getPortMarkup(t);if(Array.isArray(d)?(n=1<(n=(a=this.parseDOMJSON(d,o.node)).fragment).childNodes.length?X("g").append(n):X(n.firstChild),r=a.selectors):(n=X(d),Array.isArray(n)&&(n=X("g").append(n))),!n)throw new Error("ElementView: Invalid port markup.");n.attr({port:t.id,"port-group":t.group});var s,a=this._getPortLabelMarkup(t.label);if(Array.isArray(a)?(u=(d=this.parseDOMJSON(a,o.node)).fragment,d=d.selectors,0<(h=u.childNodes.length)&&(i=d,e=h===1?X(u.firstChild):X("g").append(u))):(e=X(a),Array.isArray(e)&&(e=X("g").append(e))),r&&i){for(var l in i)if(r[l]&&l!==this.selector)throw new Error("ElementView: selectors within port must be unique.");s=ct({},r,i)}else s=r||i||{};var h,u,d="labelText";return"portRoot"in s||(s.portRoot=n.node),e&&(h=e.node,"labelRoot"in s||(s.labelRoot=h),d in s||(u=e.tagName()==="TEXT"?h:Array.from(h.querySelectorAll("text")),s[d]=u,(i=i||{})[d]=u)),o.append(n.addClass("joint-port-body")),e&&o.append(e.addClass("joint-port-label")),this._portElementsCache[t.id]={portElement:o,portLabelElement:e,portSelectors:s,portLabelSelectors:i,portContentElement:n,portContentSelectors:r},o},_updatePortGroup:function(t){for(var e=nt(this.model.size()),i=this.model._portSettingsData.getGroupPortsMetrics(t,e),n=0,r=i.length;n<r;n++){var o=i[n],s=o.portId,s=this._portElementsCache[s]||{},a=o.portTransformation,l=o.labelTransformation;l&&s.portLabelElement&&(this.updateDOMSubtreeAttributes(s.portLabelElement.node,l.attrs,{rootBBox:new nt(o.labelSize),selectors:s.portLabelSelectors}),this.applyPortTransform(s.portLabelElement,l,-a.angle||0)),this.updateDOMSubtreeAttributes(s.portElement.node,o.portAttrs,{rootBBox:new nt(o.portSize),selectors:s.portSelectors}),this.applyPortTransform(s.portElement,a)}},applyPortTransform:function(t,e,i){i=X.createSVGMatrix().rotate(i||0).translate(e.x||0,e.y||0).rotate(e.angle||0),t.transform(i,{absolute:!0})},_getPortMarkup:function(t){return t.markup||this.model.get("portMarkup")||this.model.portMarkup||this.portMarkup},_getPortLabelMarkup:function(t){return t.markup||this.model.get("portLabelMarkup")||this.model.portLabelMarkup||this.portLabelMarkup}},Kt=bi.extend({defaults:{position:{x:0,y:0},size:{width:1,height:1},angle:0},initialize:function(){this._initializePorts(),bi.prototype.initialize.apply(this,arguments)},_initializePorts:function(){},_refreshPorts:function(){},isElement:function(){return!0},position:function(t,e,i){var n,r=Nt(e),o=(i=(r?i:t)||{}).parentRelative,s=i.deep,a=i.restrictedArea;if(o){if(!this.graph)throw new Error("Element must be part of a graph.");var l=this.getParentCell();l&&!l.isLink()&&(n=l.get("position"))}return r?(n&&(t+=n.x,e+=n.y),s||a?(r=(l=this.get("position")).x,s=l.y,this.translate(t-r,e-s,i)):this.set("position",{x:t,y:e},i),this):(a=Q(this.get("position")),o?a.difference(n):a)},translate:function(t,e,i){var n,r,o,s,a;return e=e||0,(t=t||0)===0&&e===0||((i=i||{}).translateBy=i.translateBy||this.id,n=this.get("position")||{x:0,y:0},(s=i.restrictedArea)&&i.translateBy===this.id&&(e=typeof s=="function"?(t=(r=s.call(this,n.x+t,n.y+e,i)).x-n.x,r.y-n.y):(r=this.getBBox({deep:!0}),o=n.x-r.x,a=n.y-r.y,o=Math.max(s.x+o,Math.min(s.x+s.width+o-r.width,n.x+t)),s=Math.max(s.y+a,Math.min(s.y+s.height+a-r.height,n.y+e)),t=o-n.x,s-n.y)),a={x:n.x+t,y:n.y+e},i.tx=t,i.ty=e,i.transition?(Dt(i.transition)||(i.transition={}),this.transition("position",a,ct({},i.transition,{valueFunction:Vh.object})),qe(this.getEmbeddedCells(),"translate",t,e,i)):(this.startBatch("translate",i),this.set("position",a,i),qe(this.getEmbeddedCells(),"translate",t,e,i),this.stopBatch("translate",i))),this},size:function(t,e,i){var n=this.get("size");return t===void 0?{width:n.width,height:n.height}:(Dt(t)&&(i=e,e=(Nt(t.height)?t:n).height,t=(Nt(t.width)?t:n).width),this.resize(t,e,i))},resize:function(t,e,i){if(this.startBatch("resize",i=i||{}),i.direction){var n=this.get("size");switch(i.direction){case"left":case"right":e=n.height;break;case"top":case"bottom":t=n.width}var r=Xe(this.get("angle")||0),o=this.getBBox();if(r)var h={"top-right":0,right:0,"top-left":1,top:1,"bottom-left":2,left:2,"bottom-right":3,bottom:3}[i.direction],s=o[["bottomLeft","corner","topRight","origin"][h=i.absolute?(h+Math.floor((r+45)/90))%4:h]](),s=Q(s).rotate(o.center(),-r),a=Math.sqrt(t*t+e*e)/2,l=h*Math.PI/2,h=(l=(l+=Math.atan(h%2==0?e/t:t/e))-Qe(r),Q.fromPolar(a,l,s)),u=Q(h).offset(t/-2,e/-2);else switch(u=o.topLeft(),i.direction){case"top":case"top-right":u.offset(0,o.height-e);break;case"left":case"bottom-left":u.offset(o.width-t,0);break;case"top-left":u.offset(o.width-t,o.height-e)}this.set("size",{width:t,height:e},i),this.position(u.x,u.y,i)}else this.set("size",{width:t,height:e},i);return this.stopBatch("resize",i),this},scale:function(t,e,i,n){return t=this.getBBox().scale(t,e,i),this.startBatch("scale",n),this.position(t.x,t.y,n),this.resize(t.width,t.height,n),this.stopBatch("scale"),this},fitEmbeds:function(t){return this.fitToChildren(t)},fitToChildren:function(t){t===void 0&&(t={});var e;if(this.graph)return(e=this.getEmbeddedCells().filter(function(i){return i.isElement()})).length!==0&&(this.startBatch("fit-embeds",t),t.deep&&qe(e,"fitToChildren",t),this._fitToElements(Object.assign({elements:e},t)),this.stopBatch("fit-embeds")),this;throw new Error("Element must be part of a graph.")},fitParent:function(t){t===void 0&&(t={});var e,i;if(this.graph)return t.deep&&t.terminator&&(t.terminator===this||t.terminator===this.id)||(e=this.getParentCell())&&e.isElement()&&(i=e.getEmbeddedCells().filter(function(n){return n.isElement()})).length!==0&&(this.startBatch("fit-parent",t),e._fitToElements(Object.assign({elements:i},t)),t.deep&&e.fitParent(t),this.stopBatch("fit-parent")),this;throw new Error("Element must be part of a graph.")},_fitToElements:function(t){var e=this.graph.getCellsBBox((t=t===void 0?{}:t).elements);if(e){var i=t.expandOnly,n=t.shrinkOnly;if(!i||!n){var u=e.x,r=e.y,o=e.width,e=e.height,h=ti(t.padding),s=h.left,a=h.right,l=h.top,h=h.bottom,u=new nt(u-=s,r-=l,o+=s+a,e+=h+l);if(i)u=this.getBBox().union(u);else if(n){if(r=this.getBBox().intersect(u),!r)return;u=r}this.set({position:{x:u.x,y:u.y},size:{width:u.width,height:u.height}},t)}}},rotate:function(t,e,i,n){var r,o,s,a;return i?(a=this.getBBox().center(),r=this.get("size"),o=this.get("position"),a.rotate(i,this.get("angle")-t),s=a.x-r.width/2-o.x,a=a.y-r.height/2-o.y,this.startBatch("rotate",{angle:t,absolute:e,origin:i}),this.position(o.x+s,o.y+a,n),this.rotate(t,e,null,n),this.stopBatch("rotate")):this.set("angle",e?t:(this.get("angle")+t)%360,n),this},angle:function(){return Xe(this.get("angle")||0)},getBBox:function(t){var e,i=this.graph,n=this.attributes,r=(t=t===void 0?{}:t).deep,o=t.rotate;return r&&i?((r=this.getEmbeddedCells({deep:!0,breadthFirst:!0})).push(this),i.getCellsBBox(r,t)):((i=n.angle)===void 0&&(i=0),t=(r=n.position).x,r=r.y,e=(n=n.size).width,n=n.height,t=new nt(t,r,e,n),o&&t.rotateAroundCenter(i),t)},getPointFromConnectedLink:function(r,e){var i=this.getBBox(),n=i.center(),r=r.get(e);return r&&(e=r.port)&&this.hasPort(e)?(r=this.portProp(e,["group"]),r=this.getPortsPositions(r),r=new Q(r[e]).offset(i.origin()),(e=this.angle())&&r.rotate(n,-e),r):n}}),Nr=(ct(Kt.prototype,tn),{}),ke=R.View.extend({options:{},theme:null,themeClassNamePrefix:Ui("theme-"),requireSetThemeOverride:!1,defaultTheme:_i.defaultTheme,children:null,childNodes:null,DETACHABLE:!0,UPDATE_PRIORITY:2,FLAG_INSERT:1<<30,FLAG_REMOVE:1<<29,FLAG_INIT:1<<28,constructor:function(t){this.requireSetThemeOverride=t&&!!t.theme,this.options=ct({},this.options,t),R.View.call(this,t)},initialize:function(){(Nr[this.cid]=this).setTheme(this.options.theme||this.defaultTheme),this.init()},unmount:function(){(this.svgElement?this.vel:this.$el).remove()},isMounted:function(){return this.el.parentNode!==null},renderChildren:function(t){var e,i;return(t=t||Fe(this,"children"))&&(e=this.svgElement,i=X.namespace[e?"svg":"xhtml"],t=ua(t,i),(e?this.vel:this.$el).empty().append(t.fragment),this.childNodes=t.selectors),this},findAttribute:function(t,e){for(var i=e;i&&i.nodeType===1;){var n=i.getAttribute(t);if(n)return n;if(i===this.el)return null;i=i.parentNode}return null},_ensureElement:function(){var t,e,i;this.el?this.setElement(Fe(this,"el")):(t=Fe(this,"tagName"),e=ct({},Fe(this,"attributes")),i=ct({},Fe(this,"style")),this.id&&(e.id=Fe(this,"id")),this.setElement(this._createElement(t)),this._setAttributes(e),this._setStyle(i)),this._ensureElClassName()},_setAttributes:function(t){(this.svgElement?this.vel:this.$el).attr(t)},_setStyle:function(t){this.$el.css(t)},_createElement:function(t){return this.svgElement?document.createElementNS(X.namespace.svg,t):document.createElement(t)},_setElement:function(t){this.$el=t instanceof R.$?t:R.$(t),this.el=this.$el[0],this.svgElement&&(this.vel=X(this.el))},_ensureElClassName:function(){var t,e=Fe(this,"className");e&&(t=Ui(e),(this.svgElement?this.vel:this.$el).removeClass(e).addClass(t))},init:function(){},onRender:function(){},confirmUpdate:function(){return 0},setTheme:function(t,e){return e=e||{},this.theme&&this.requireSetThemeOverride&&!e.override||(this.removeThemeClassName(),this.addThemeClassName(t),this.onSetTheme(this.theme,t),this.theme=t),this},addThemeClassName:function(t){return(t=t||this.theme)&&(t=this.themeClassNamePrefix+t,(this.svgElement?this.vel:this.$el).addClass(t)),this},removeThemeClassName:function(t){return t=t||this.theme,t=this.themeClassNamePrefix+t,(this.svgElement?this.vel:this.$el).removeClass(t),this},onSetTheme:function(t,e){},remove:function(){return this.onRemove(),this.undelegateDocumentEvents(),Nr[this.cid]=null,R.View.prototype.remove.apply(this,arguments),this},onRemove:function(){},getEventNamespace:function(){return".joint-event-ns-"+this.cid},delegateElementEvents:function(t,e,i){if(e){i=i||{};var n,r=this.getEventNamespace();for(n in e){var o=e[n];(o=typeof o!="function"?this[o]:o)&&P(t).on(n+r,i,o.bind(this))}}return this},undelegateElementEvents:function(t){return P(t).off(this.getEventNamespace()),this},delegateDocumentEvents:function(t,e){return t=t||Fe(this,"documentEvents"),this.delegateElementEvents(document,t,e)},undelegateDocumentEvents:function(){return this.undelegateElementEvents(document)},eventData:function(t,e){var i,n;if(t)return i=t.data,n="__"+this.cid+"__",e===void 0?i&&i[n]||{}:((i=i||(t.data={}))[n]||(i[n]={}),ct(i[n],e),this);throw new Error("eventData(): event object required.")},stopPropagation:function(t){return this.eventData(t,{propagationStopped:!0}),this},isPropagationStopped:function(t){return!!this.eventData(t).propagationStopped}},{extend:function(){var e=Array.from(arguments),t=e[0]&&ct({},e[0])||{},e=e[1]&&ct({},e[1])||{},i=t.render||this.prototype&&this.prototype.render||null;return t.render=function(){return typeof i=="function"&&i.apply(this,arguments),this.render.__render__===i&&this.onRender(),this},t.render.__render__=i,R.View.extend.call(this,t,e)}}),xs=(!P.event||"dbltap"in P.event.special||(vd=_i.doubleTapInterval,P.event.special.dbltap={bindType:"touchend",delegateType:"touchend",handle:function(t){for(var e=[],i=arguments.length-1;0<i--;)e[i]=arguments[i+1];var n=t.handleObj,r=t.target,r=P.data(r),o=new Date().getTime(),s="lastTouch"in r?o-r.lastTouch:0;s<vd&&30<s?(r.lastTouch=null,t.type=n.origType,(s=n.handler).call.apply(s,[this,t].concat(e))):r.lastTouch=o}}),Yh.prototype.listenTo=function(t,e){for(var i=this,n=[],r=arguments.length-2;0<r--;)n[r]=arguments[r+2];var o,s,a,l=this.callbackArguments;X.isObject(e)?((o=n[0])===void 0&&(o=null),Object.entries(e).forEach(function(d){var u=d[0],d=d[1];typeof d=="function"&&((o||0<l.length)&&(d=d.bind.apply(d,[o].concat(l))),R.Events.listenTo.call(i,t,u,d))})):typeof e=="string"&&typeof n[0]=="function"&&(s=n[0],((a=(a=n[1])===void 0?null:a)||0<l.length)&&(s=s.bind.apply(s,[a].concat(l))),R.Events.listenTo.call(this,t,e,s))},Yh.prototype.stopListening=function(){R.Events.stopListening.call(this)},{__proto__:null,views:Nr,View:ke,Listener:Yh});function va(t){return t?Array.isArray(t)?t:[t]:[]}var Fn=ke.extend({tagName:"g",svgElement:!0,className:"highlight",HIGHLIGHT_FLAG:1,UPDATE_PRIORITY:3,DETACHABLE:!1,UPDATABLE:!0,MOUNTABLE:!0,cellView:null,nodeSelector:null,node:null,updateRequested:!1,postponedUpdate:!1,transformGroup:null,detachedTransformGroup:null,requestUpdate:function(t,e){var i=t.paper;this.cellView=t,this.nodeSelector=e,i&&(this.updateRequested=!0,i.requestViewUpdate(this,this.HIGHLIGHT_FLAG,this.UPDATE_PRIORITY))},confirmUpdate:function(){this.updateRequested=!1;var t=this.cellView,e=this.nodeSelector;return t.isMounted()?(this.update(t,e),this.mount(),this.transform()):this.postponedUpdate=!0,0},findNode:function(t,e){var i,n,r,o,s;return typeof(e=e===void 0?null:e)=="string"?s=t.findBySelector(e)[0]:ve(e)?(i=t.model.isLink(),(n=e.label)===void 0&&(n=null),r=e.port,o=e.selector,s=i&&n!==null?t.findLabelNode(n,o):!i&&r?t.findPortNode(r,o):t.findBySelector(o)[0]):!e||(s=X.toNode(e))instanceof SVGElement||(s=null),s||null},getNodeMatrix:function(t,e){var i=this.options.layer,n=t.rotatableNode,r=t.getNodeMatrix(e);return n?i?n.contains(e)?r:t.getRootRotateMatrix().inverse().multiply(r):t.getNodeRotateMatrix(e).multiply(r):r},mount:function(){var t,e=this.MOUNTABLE,i=this.cellView,n=this.el,r=this.options,o=this.transformGroup,s=this.detachedTransformGroup,a=this.postponedUpdate,l=this.nodeSelector;e&&!o&&(a?(this.update(i,l),this.transform()):(e=i.vel,o=i.paper,(a=r.layer)?(s?(t=s,this.detachedTransformGroup=null):t=X("g").addClass("highlight-transform").append(n),this.transformGroup=t,o.getLayerView(a).insertSortedNode(t.node,r.z)):n.parentNode&&!n.nextSibling||e.append(n)))},unmount:function(){var t=this.MOUNTABLE,e=this.transformGroup,i=this.vel;t&&(e?(this.transformGroup=null,this.detachedTransformGroup=e):i).remove()},transform:function(){var t=this.transformGroup,e=this.cellView,i=this.updateRequested;!t||e.model.isLink()||i||(i=e.getRootTranslateMatrix(),e=e.getRootRotateMatrix(),i=i.multiply(e),t.attr("transform",X.matrixToTransformString(i)))},update:function(){var t=this.node,e=this.cellView,i=this.nodeSelector,n=this.updateRequested,r=this.id;n||(this.postponedUpdate=!1,n=this.node=this.findNode(e,i),t&&this.unhighlight(e,t),n?(this.highlight(e,n),this.mount()):(this.unmount(),e.notify("cell:highlight:invalid",r,this)))},onRemove:function(){var t=this.node,e=this.cellView,i=this.id,n=this.constructor;t&&this.unhighlight(e,t),this.unmount(),n._removeRef(e,i)},highlight:function(t,e){},unhighlight:function(t,e){},listenToUpdateAttributes:function(t){var e=Fe(this,"UPDATE_ATTRIBUTES");Array.isArray(e)&&e.length!==0&&this.listenTo(t.model,"change",this.onCellAttributeChange)},onCellAttributeChange:function(){var t,e=this.cellView;e&&(t=e.model,e=e.paper,Fe(this,"UPDATE_ATTRIBUTES").some(function(i){return t.hasChanged(i)})&&e.requestViewUpdate(this,this.HIGHLIGHT_FLAG,this.UPDATE_PRIORITY))}},{_views:{},highlight:function(t,e,i){var n=this.uniqueId(e,i);this.add(t,e,n,i)},unhighlight:function(t,e,i){e=this.uniqueId(e,i),this.remove(t,e)},get:function(i,e){var i=i.cid,n=this._views[i];if((e=e===void 0?null:e)===null){var r=[];if(n)for(var o in n)o=n[o],o instanceof this&&r.push(o);return r}return n&&e in n&&(i=n[e],i instanceof this)?i:null},add:function(t,e,i,n){var r;if(n===void 0&&(n={}),i)return(r=Fn.get(t,i))&&r.remove(),(r=new this(n)).id=i,this._addRef(t,i,r),r.requestUpdate(t,e),r.listenToUpdateAttributes(t),r;throw new Error("dia.HighlighterView: An ID required.")},_addRef:function(n,e,i){var n=n.cid,r=this._views;(r[n]||(r[n]={}))[e]=i},_removeRef:function(i,e){var i=i.cid,n=this._views,r=n[i];if(r){for(var o in e&&delete r[e],r)return;delete n[i]}},remove:function(t,e){va(this.get(t,e=e===void 0?null:e)).forEach(function(i){i.remove()})},removeAll:function(t,e){e===void 0&&(e=null);var i,n=this._views;for(i in n)for(var r in n[i]){var o=n[i][r];o.cellView.paper===t&&o instanceof this&&(e===null||r===e)&&o.remove()}},update:function(t,e,i){i===void 0&&(i=!1),va(this.get(t,e=e===void 0?null:e)).forEach(function(n){(i||n.UPDATABLE)&&n.update()})},transform:function(t,e){va(this.get(t,e=e===void 0?null:e)).forEach(function(i){i.UPDATABLE&&i.transform()})},unmount:function(t,e){va(this.get(t,e=e===void 0?null:e)).forEach(function(i){return i.unmount()})},mount:function(t,e){va(this.get(t,e=e===void 0?null:e)).forEach(function(i){return i.mount()})},uniqueId:function(t,e){return e===void 0&&(e=""),X.ensureId(t)+JSON.stringify(e)}}),ws={DEFAULT:"default",EMBEDDING:"embedding",CONNECTING:"connecting",MAGNET_AVAILABILITY:"magnetAvailability",ELEMENT_AVAILABILITY:"elementAvailability"},ye=ke.extend({tagName:"g",svgElement:!0,selector:"root",metrics:null,className:function(){var t=["cell"],e=this.model.get("type");return e&&e.toLowerCase().split(".").forEach(function(i,n,r){t.push("type-"+r.slice(0,n+1).join("-"))}),t.join(" ")},_presentationAttributes:null,_flags:null,setFlags:function(){var t,e={},i={},n=0,r=Fe(this,"presentationAttributes");for(t in r)if(r.hasOwnProperty(t))for(var o=r[t],s=0,a=(o=Array.isArray(o)?o:[o]).length;s<a;s++){var l,h=(h=e[l=o[s]])||(e[l]=1<<n++);i[t]|=h}var u=Fe(this,"initFlag");for(s=0,a=(u=Array.isArray(u)?u:[u]).length;s<a;s++)e[l=u[s]]||(e[l]=1<<n++);if(25<n)throw new Error("dia.CellView: Maximum number of flags exceeded.");this._flags=e,this._presentationAttributes=i},hasFlag:function(t,e){return t&this.getFlag(e)},removeFlag:function(t,e){return t^t&this.getFlag(e)},getFlag:function(t){var e=this._flags;if(!e)return 0;var i=0;if(Array.isArray(t))for(var n=0,r=t.length;n<r;n++)i|=e[t[n]];else i|=e[t];return i},attributes:function(){var t=this.model;return{"model-id":t.id,"data-type":t.attributes.type}},constructor:function(t){t.id=t.id||qr(this),ke.call(this,t)},initialize:function(){this.setFlags(),ke.prototype.initialize.apply(this,arguments),this.cleanNodesCache(),this.$el.data("view",this),this.startListening()},startListening:function(){this.listenTo(this.model,"change",this.onAttributesChange)},onAttributesChange:function(t,e){t=t.getChangeFlag(this._presentationAttributes),!e.updateHandled&&t&&(e.dirty&&this.hasFlag(t,"UPDATE")&&(t|=this.getFlag("RENDER")),e.tool&&(e.async=!1),this.requestUpdate(t,e))},requestUpdate:function(t,e){var i=this.paper;i&&0<t&&i.requestViewUpdate(this,t,this.UPDATE_PRIORITY,e)},parseDOMJSON:function(n,e){var i,n=ua(n),r=n.selectors,o=n.groupSelectors;for(i in o){if(r[i])throw new Error("dia.CellView: ambiguous group selector");r[i]=o[i]}if(e){var s=this.selector;if(r[s])throw new Error("dia.CellView: ambiguous root selector.");r[s]=e}return{fragment:n.fragment,selectors:r}},can:function(t){var e=Rt(this.options.interactive)?this.options.interactive(this):this.options.interactive;return Dt(e)&&e[t]!==!1||Kr(e)&&e!==!1},findBySelector:function(t,e,i){return e=e||this.el,i=i||this.selectors,!t||t==="."?[e]:i&&(i=i[t],i)?Array.isArray(i)?i:[i]:_i.useCSSSelectors?P(e).find(t).toArray():[]},notify:function(t){var e;this.paper&&(e=Array.prototype.slice.call(arguments,1),this.trigger.apply(this,[t].concat(e)),this.paper.trigger.apply(this.paper,[t,this].concat(e)))},getBBox:function(t){return t=t&&t.useModelGeometry?(t=this.model).getBBox().bbox(t.angle()):this.getNodeBBox(this.el),this.paper.localToPaperRect(t)},getNodeBBox:function(n){var e=this.getNodeBoundingRect(n),i=this.getRootTranslateMatrix().multiply(this.getNodeRotateMatrix(n)),n=this.getNodeMatrix(n);return X.transformRect(e,i.multiply(n))},getNodeRotateMatrix:function(t){return!this.rotatableNode||this.rotatableNode.contains(t)?this.getRootRotateMatrix():X.createSVGMatrix()},getNodeUnrotatedBBox:function(i){var e=this.getNodeBoundingRect(i),i=this.getNodeMatrix(i),n=this.getRootTranslateMatrix();return X.transformRect(e,n.multiply(i))},getRootTranslateMatrix:function(){var t=this.model.position();return X.createSVGMatrix().translate(t.x,t.y)},getRootRotateMatrix:function(){var t,e=X.createSVGMatrix(),i=this.model,n=i.angle();return n&&(t=(i=i.getBBox()).width/2,i=i.height/2,e=e.translate(t,i).rotate(n).translate(-t,-i)),e},_notifyHighlight:function(t,e,i){i===void 0&&(i={});var n,r=this.el,o=typeof e=="string"?(o=this.findBySelector(e)[0])===void 0?r:o:(o=this.$(e)[0])===void 0?r:o;if(i.partial=o!==r,i.type===void 0){switch(!0){case i.embedding:n=ws.EMBEDDING;break;case i.connecting:n=ws.CONNECTING;break;case i.magnetAvailability:n=ws.MAGNET_AVAILABILITY;break;case i.elementAvailability:n=ws.ELEMENT_AVAILABILITY;break;default:n=ws.DEFAULT}i.type=n}return this.notify(t,o,i),this},highlight:function(t,e){return this._notifyHighlight("cell:highlight",t,e)},unhighlight:function(t,e){return this._notifyHighlight("cell:unhighlight",t,e=e===void 0?{}:e)},findMagnet:function(t){var e=this.el,i=(i=this.$(t)[0])||e;do{var n=i.getAttribute("magnet"),r=i===e;if((n||r)&&n!=="false")return i;if(r)return}while(i=i.parentNode)},findProxyNode:function(t,e){return e=(t=t||this.el).getAttribute(e+"-selector"),e&&(e=this.findBySelector(e)[0],e)?e:t},getSelector:function(t,e){var i,n;return t===this.el?typeof e=="string"?"> "+e:n:(t&&(i=X(t).index()+1,n=t.tagName+":nth-child("+i+")",e&&(n+=" > "+e),n=this.getSelector(t.parentNode,n)),n)},addLinkFromMagnet:function(t,e,i){var n=this.paper,r=n.model,o=n.getDefaultLink(this,t);return o.set({source:this.getLinkEnd(t,e,i,o,"source"),target:{x:e,y:i}}).addTo(r,{async:!1,ui:!0}),o.findView(n)},getLinkEnd:function(t){for(var e=[],i=arguments.length-1;0<i--;)e[i]=arguments[i+1];var n=this.model,s=n.id,r=this.findAttribute("port",t),o=t.getAttribute("joint-selector"),s={id:s};return o!=null&&(s.magnet=o),r!=null?n.hasPort(s.port=r)||o||(s.selector=this.getSelector(t)):o==null&&this.el!==t&&(s.selector=this.getSelector(t)),this.customizeLinkEnd.apply(this,[s,t].concat(e))},customizeLinkEnd:function(t,e,i,n,r,o){var s=this.paper,a=s.options.connectionStrategy;return typeof a=="function"&&(a=a.call(s,t,this,e,new Q(i,n),r,o,s),a)?a:t},getMagnetFromLinkEnd:function(t){var e=this.el,i=t.port,n=t.magnet,r=this.model,r=i!=null&&r.isElement()&&r.hasPort(i)?this.findPortNode(i,n)||e:(n=n||t.selector,this.findBySelector(n=n||i==null?n:'[port="'+i+'"]',e,this.selectors)[0]);return this.findProxyNode(r,"magnet")},dragLinkStart:function(t,e,i,n){this.model.startBatch("add-link"),e=this.addLinkFromMagnet(e,i,n),e.notifyPointerdown(t,i,n),e.eventData(t,e.startArrowheadMove("target",{whenNotAllowed:"remove"})),this.eventData(t,{linkView:e})},dragLink:function(t,e,i){var n=this.eventData(t),r=n.linkView;if(r)r.pointermove(t,e,i);else{var r=this.paper,o=r.options.magnetThreshold,s=this.getEventTarget(t),n=n.targetMagnet;if(o==="onleave"){if(n===s||X(n).contains(s))return}else if(r.eventData(t).mousemoved<=o)return;this.dragLinkStart(t,n,e,i)}},dragLinkEnd:function(t,e,i){var n=this.eventData(t).linkView;n&&(n.pointerup(t,e,i),this.model.stopBatch("add-link"))},getAttributeDefinition:function(t){return this.model.constructor.getAttributeDefinition(t)},setNodeAttributes:function(t,e){pt(e)||(t instanceof SVGElement?X:P)(t).attr(e)},processNodeAttributes:function(t,e){var i,n,r,o,s,a,l,h,u,d=[];for(i in e)e.hasOwnProperty(i)&&(n=e[i],!(r=this.getAttributeDefinition(i))||Rt(r.qualify)&&!r.qualify.call(this,n,t,e,this)?(a=a||{})[Bh(i)]=n:(Ft(r.set)&&((a=a||{})[r.set]=n),n!==null&&d.push(i,r)));for(o=0,s=d.length;o<s;o+=2)n=e[i=d[o]],Rt((r=d[o+1]).set)&&((l=l||{})[i]=n),Rt(r.position)&&((h=h||{})[i]=n),Rt(r.offset)&&((u=u||{})[i]=n);return{raw:e,normal:a,set:l,position:h,offset:u}},updateRelativeAttributes:function(t,e,i,n){n=n||{};var r,o=e.raw||{},s=e.normal||{},a=e.set,l=e.position,h=e.offset;for(r in a){var u=a[r],d=this.getAttributeDefinition(r).set.call(this,u,i.clone(),t,o,this);Dt(d)?ct(s,d):d!==void 0&&(s[r]=d)}if(t instanceof HTMLElement)this.setNodeAttributes(t,s);else{var p,m,v,e=s.transform,k=X.transformStringToMatrix(e),I=Q(k.e,k.f),N=(e&&(s=ai(s,"transform"),k.e=k.f=0),(l||h)&&(m=(n=this.getNodeScale(t,n.scalableNode)).sx,v=n.sy),!1);for(r in l)u=l[r],(p=this.getAttributeDefinition(r).position.call(this,u,i.clone(),t,o,this))&&(I.offset(Q(p).scale(m,v)),N=N||!0);this.setNodeAttributes(t,s);var G=!1;if(h&&(n=this.getNodeBoundingRect(t),0<n.width&&0<n.height)){var F=X.transformRect(n,k).scale(1/m,1/v);for(r in h)u=h[r],(p=this.getAttributeDefinition(r).offset.call(this,u,F,t,o,this))&&(I.offset(Q(p).scale(m,v)),G=G||!0)}(e!==void 0||N||G)&&(I.round(1),k.e=I.x,k.f=I.y,t.setAttribute("transform",X.matrixToTransformString(k)))}},getNodeScale:function(t,e){var i;return e=e&&e.contains(t)?(i=1/(t=e.scale()).sx,1/t.sy):i=1,{sx:i,sy:e}},cleanNodesCache:function(){this.metrics={}},nodeCache:function(t){var e=this.metrics;return e?e[t=X.ensureId(t)]||(e[t]={}):{}},getNodeData:function(t){return t=this.nodeCache(t),t.data||(t.data={}),t.data},getNodeBoundingRect:function(t){var e=this.nodeCache(t);return e.boundingRect===void 0&&(e.boundingRect=X(t).getBBox()),new nt(e.boundingRect)},getNodeMatrix:function(t){var e,i,n=this.nodeCache(t);return n.magnetMatrix===void 0&&(i=this.rotatableNode,e=this.el,i=i&&i.contains(t)?i:e,n.magnetMatrix=X(t).getTransformToElement(i)),X.createSVGMatrix(n.magnetMatrix)},getNodeShape:function(t){var e=this.nodeCache(t);return e.geometryShape===void 0&&(e.geometryShape=X(t).toGeometryShape()),e.geometryShape.clone()},isNodeConnection:function(t){return this.model.isLink()&&(!t||t===this.el)},findNodesAttributes:function(t,e,i,n){var r,o,s={},a=[];for(o in t)if(t.hasOwnProperty(o)&&(r=t[o],ve(r)))for(var l=i[o]=this.findBySelector(o,e,n),h=0,u=l.length;h<u;h++){var d,p,m=l[h],v=X.ensureId(m),k=n&&n[o]===m,I=s[v];I?(I.array||(a.push(v),I.array=!0,I.attributes=[I.attributes],I.selectedLength=[I.selectedLength]),d=I.attributes,I=I.selectedLength,k?(d.unshift(r),I.unshift(-1)):(p=Eo(I,u),d.splice(p,0,r),I.splice(p,0,u))):s[v]={attributes:r,selectedLength:k?-1:u,node:m,array:!1}}for(h=0,u=a.length;h<u;h++)(r=s[v=a[h]]).attributes=ze.apply(void 0,[{}].concat(r.attributes.reverse()));return s},getEventTarget:function(t,e){var i=t.target,n=t.type,r=t.clientX,o=(r===void 0&&(r=0),t.clientY);return o===void 0&&(o=0),(e=e===void 0?{}:e).fromPoint||n==="touchmove"||n==="touchend"||"pointerId"in t&&i.hasPointerCapture(t.pointerId)?document.elementFromPoint(r,o):i},updateDOMSubtreeAttributes:function(t,e,i){(i=i||{}).rootBBox||(i.rootBBox=nt()),i.selectors||(i.selectors=this.selectors);var n,r,o={},s={},a=[],l=[],h=i.roAttributes,u=this.findNodesAttributes(h||e,t,o,i.selectors),d=h?this.findNodesAttributes(e,t,o,i.selectors):u;for(r in u)if(m=(p=u[r]).attributes,G=p.node,(n=this.processNodeAttributes(G,m)).set||n.position||n.offset){var p=d[r]&&d[r].attributes,m=(p&&m.ref===void 0?p:m).ref;if(m){if(!(N=(o[m]||this.findBySelector(m,t,i.selectors))[0]))throw new Error('dia.CellView: "'+m+'" reference does not exist.')}else N=null;I={node:G,refNode:N,processedAttributes:n,allAttributes:p},N?-1<(m=l.findIndex(function(Y){return Y.refNode===G}))?l.splice(m,0,I):l.push(I):a.push(I)}else this.setNodeAttributes(G,n.normal);a.push.apply(a,l);for(var v=0,k=a.length;v<k;v++){var I,N,G=(I=a[v]).node,F=(N=I.refNode)?X.ensureId(N):"",H=(H=s[F])||(s[F]=N?X(N).getBBox({target:function(Y,_){var K=Y;do if(K.contains(_))return K;while(K=K.parentNode,K);return null}(G,N)}):i.rootBBox);h?(n=this.processNodeAttributes(G,I.allAttributes),this.mergeProcessedAttributes(n,I.processedAttributes)):n=I.processedAttributes,this.updateRelativeAttributes(G,n,H,i)}},mergeProcessedAttributes:function(t,e){t.set||(t.set={}),t.position||(t.position={}),t.offset||(t.offset={}),ct(t.set,e.set),ct(t.position,e.position),ct(t.offset,e.offset);var i=t.normal&&t.normal.transform;i!==void 0&&e.normal&&(e.normal.transform=i),t.normal=e.normal},onMount:function(t){t||(this.mountTools(),Fn.mount(this))},onDetach:function(){this.unmountTools(),Fn.unmount(this)},onRemove:function(){this.removeTools(),this.removeHighlighters()},_toolsView:null,hasTools:function(t){var e=this._toolsView;return!!e&&(!t||e.getName()===t)},addTools:function(t){return this.removeTools(),t&&((this._toolsView=t).configure({relatedView:this}),t.listenTo(this.paper,"tools:event",this.onToolEvent.bind(this))),this},unmountTools:function(){var t=this._toolsView;return t&&t.unmount(),this},mountTools:function(){var t=this._toolsView;return t&&!t.isMounted()&&t.mount(),this},updateTools:function(t){var e=this._toolsView;return e&&e.update(t),this},removeTools:function(){var t=this._toolsView;return t&&(t.remove(),this._toolsView=null),this},hideTools:function(){var t=this._toolsView;return t&&t.hide(),this},showTools:function(){var t=this._toolsView;return t&&t.show(),this},onToolEvent:function(t){switch(t){case"remove":this.removeTools();break;case"hide":this.hideTools();break;case"show":this.showTools()}},removeHighlighters:function(){Fn.remove(this)},updateHighlighters:function(t){Fn.update(this,null,t=t===void 0?!1:t)},transformHighlighters:function(){Fn.transform(this)},preventDefaultInteraction:function(t){this.eventData(t,{defaultInteractionPrevented:!0})},isDefaultInteractionPrevented:function(t){return t=this.eventData(t).defaultInteractionPrevented,t=t===void 0?!1:t},pointerdblclick:function(t,e,i){this.notify("cell:pointerdblclick",t,e,i)},pointerclick:function(t,e,i){this.notify("cell:pointerclick",t,e,i)},contextmenu:function(t,e,i){this.notify("cell:contextmenu",t,e,i)},pointerdown:function(t,e,i){var n=this.model,r=n.graph;r&&(n.startBatch("pointer"),this.eventData(t,{graph:r})),this.notify("cell:pointerdown",t,e,i)},pointermove:function(t,e,i){this.notify("cell:pointermove",t,e,i)},pointerup:function(t,e,i){var n=this.eventData(t).graph;this.notify("cell:pointerup",t,e,i),n&&n.stopBatch("pointer",{cell:this.model})},mouseover:function(t){this.notify("cell:mouseover",t)},mouseout:function(t){this.notify("cell:mouseout",t)},mouseenter:function(t){this.notify("cell:mouseenter",t)},mouseleave:function(t){this.notify("cell:mouseleave",t)},mousewheel:function(t,e,i,n){this.notify("cell:mousewheel",t,e,i,n)},onevent:function(t,e,i,n){this.notify(e,t,i,n)},onmagnet:function(){},magnetpointerdblclick:function(){},magnetcontextmenu:function(){},checkMouseleave:function(t){var e=this.paper,n=this.model,i=(e.isAsync()&&(n.isLink()&&((i=n.getSourceElement())&&(i=e.findViewByModel(i))&&(e.dumpView(i),e.checkViewVisibility(i)),(i=n.getTargetElement())&&(n=e.findViewByModel(i))&&(e.dumpView(n),e.checkViewVisibility(n))),e.dumpView(this),e.checkViewVisibility(this)),this.getEventTarget(t,{fromPoint:!0})),n=e.findView(i);n!==this&&(this.mouseleave(t),n&&n.mouseenter(t))},setInteractivity:function(t){this.options.interactive=t}},{Flags:{TOOLS:"TOOLS"},Highlighting:ws,addPresentationAttributes:function(t){return ze({},Fe(this.prototype,"presentationAttributes"),t,function(e,i){if(e&&i)return typeof e=="string"&&(e=[e]),typeof i=="string"&&(i=[i]),Array.isArray(e)&&Array.isArray(i)?J(e.concat(i)):void 0})}});function Uh(t,e,i,n){i===void 0&&(i=[]);var r=(n=n===void 0?{}:n).cornerType,o=n.cornerRadius,s=(o===void 0&&(o=10),n.cornerPreserveAspectRatio),a=(s===void 0&&(s=!1),n.precision);if(a===void 0&&(a=1),(n=n.raw)===void 0&&(n=!1),Df.indexOf(r=r===void 0?Cs.POINT:r)===-1)throw new Error("Invalid `cornerType` provided to `straight` connector.");if(r!==Cs.POINT&&o){(_=new At).appendSegment(At.createSegment("M",t));for(var l=i.length,h=0;h<l;h++){var u=new Q(i[h]),d=i[h-1]||t,p=i[h+1]||e,m=v||u.distance(d)/2,v=u.distance(p)/2,k=void 0,I=void 0,N=(s?k=I=-Math.min(o,m,v):(k=-Math.min(o,m),I=-Math.min(o,v)),u.clone().move(d,k).round(a)),G=u.clone().move(p,I).round(a);switch(_.appendSegment(At.createSegment("L",N)),r){case Cs.CUBIC:var F=new Q(.3333333333333333*N.x+.6666666666666666*u.x,.6666666666666666*u.y+.3333333333333333*N.y),H=new Q(1/3*G.x+2/3*u.x,2/3*u.y+1/3*G.y);_.appendSegment(At.createSegment("C",F,H,G));break;case Cs.LINE:_.appendSegment(At.createSegment("L",G));break;case Cs.GAP:_.appendSegment(At.createSegment("M",G))}}_.appendSegment(At.createSegment("L",e))}else var Y=[t].concat(i).concat([e]),Y=new ie(Y),_=new At(Y);return n?_:_.serialize()}var Te={TOOLS:ye.Flags.TOOLS,UPDATE:"UPDATE",TRANSLATE:"TRANSLATE",RESIZE:"RESIZE",PORTS:"PORTS",ROTATE:"ROTATE",RENDER:"RENDER"},Hh="move",Xh="magnet",ee=ye.extend({_removePorts:function(){},_renderPorts:function(){},className:function(){var t=ye.prototype.className.apply(this).split(" ");return t.push("element"),t.join(" ")},initialize:function(){ye.prototype.initialize.apply(this,arguments),this._initializePorts()},presentationAttributes:{attrs:[Te.UPDATE],position:[Te.TRANSLATE,Te.TOOLS],size:[Te.RESIZE,Te.PORTS,Te.TOOLS],angle:[Te.ROTATE,Te.TOOLS],markup:[Te.RENDER],ports:[Te.PORTS]},initFlag:[Te.RENDER],UPDATE_PRIORITY:0,confirmUpdate:function(t,e){var i,n=_i.useCSSSelectors,r=(this.hasFlag(t,Te.PORTS)&&(this._removePorts(),this._cleanPortsCache()),!1);return this.hasFlag(t,Te.RENDER)?(this.render(),this.updateTools(e),this.updateHighlighters(!0),r=!0,t=this.removeFlag(t,[Te.RENDER,Te.UPDATE,Te.RESIZE,Te.TRANSLATE,Te.ROTATE,Te.PORTS,Te.TOOLS])):(i=!1,this.hasFlag(t,Te.RESIZE)&&(this.resize(e),i=!0,t=this.removeFlag(t,[Te.RESIZE,Te.UPDATE]),n&&(t=this.removeFlag(t,Te.PORTS))),this.hasFlag(t,Te.UPDATE)&&(this.update(this.model,null,e),t=this.removeFlag(t,Te.UPDATE),i=!0,n&&(t=this.removeFlag(t,Te.PORTS))),this.hasFlag(t,Te.TRANSLATE)&&(this.translate(),t=this.removeFlag(t,Te.TRANSLATE),r=!0),this.hasFlag(t,Te.ROTATE)&&(this.rotate(),t=this.removeFlag(t,Te.ROTATE),r=!0),this.hasFlag(t,Te.PORTS)&&(this._renderPorts(),i=!0,t=this.removeFlag(t,Te.PORTS)),i&&this.updateHighlighters(!1)),r&&this.transformHighlighters(),this.hasFlag(t,Te.TOOLS)&&(this.updateTools(e),t=this.removeFlag(t,Te.TOOLS)),t},_initializePorts:function(){},update:function(t,e){this.cleanNodesCache();var i=_i.useCSSSelectors,n=(i&&this._removePorts(),this.model),r=n.attr();this.updateDOMSubtreeAttributes(this.el,r,{rootBBox:new nt(n.size()),selectors:this.selectors,scalableNode:this.scalableNode,rotatableNode:this.rotatableNode,roAttributes:e===r?null:e}),i&&this._renderPorts()},rotatableSelector:"rotatable",scalableSelector:"scalable",scalableNode:null,rotatableNode:null,renderMarkup:function(){var t=this.model,t=t.get("markup")||t.markup;if(!t)throw new Error("dia.ElementView: markup required");if(Array.isArray(t))return this.renderJSONMarkup(t);if(typeof t=="string")return this.renderStringMarkup(t);throw new Error("dia.ElementView: invalid markup")},renderJSONMarkup:function(e){var e=this.parseDOMJSON(e,this.el),i=this.selectors=e.selectors;this.rotatableNode=X(i[this.rotatableSelector])||null,this.scalableNode=X(i[this.scalableSelector])||null,this.vel.append(e.fragment)},renderStringMarkup:function(t){var e=this.vel;e.append(X(t)),this.rotatableNode=e.findOne(".rotatable"),this.scalableNode=e.findOne(".scalable"),(this.selectors={})[this.selector]=this.el},render:function(){return this.vel.empty(),this.renderMarkup(),this.scalableNode&&this.update(),this.resize(),this.rotatableNode?(this.rotate(),this.translate()):this.updateTransformation(),_i.useCSSSelectors||this._renderPorts(),this},resize:function(t){if(this.scalableNode)return this.sgResize(t);this.model.attributes.angle&&this.rotate(),this.update()},translate:function(){if(this.rotatableNode)return this.rgTranslate();this.updateTransformation()},rotate:function(){this.rotatableNode?(this.rgRotate(),this.update()):this.updateTransformation()},updateTransformation:function(){var t=this.getTranslateString(),e=this.getRotateString();e&&(t+=" "+e),this.vel.attr("transform",t)},getTranslateString:function(){var t=this.model.attributes.position;return"translate("+t.x+","+t.y+")"},getRotateString:function(){var t=this.model.attributes,e=t.angle;return e?"rotate("+e+","+(e=t.size).width/2+","+e.height/2+")":null},rgRotate:function(){this.rotatableNode.attr("transform",this.getRotateString())},rgTranslate:function(){this.vel.attr("transform",this.getTranslateString())},sgResize:function(t){var e=this.model,i=e.angle(),n=e.size(),r=this.scalableNode,s=!1,s=(0<r.node.getElementsByTagName("path").length&&(s=!0),r.getBBox({recursive:s})),o=n.width/(s.width||1),s=n.height/(s.height||1),o=(r.attr("transform","scale("+o+","+s+")"),this.rotatableNode),s=o&&o.attr("transform");s&&(o.attr("transform",s+" rotate("+-i+","+n.width/2+","+n.height/2+")"),o=r.getBBox({target:this.paper.cells}),e.set("position",{x:o.x,y:o.y},ct({updateHandled:!0},t)),this.translate(),this.rotate()),this.update()},prepareEmbedding:function(t){var e=(t=t===void 0?{}:t).model||this.model,i=(t.paper||this.paper).model,n=t.initialZIndices={},s=e.getEmbeddedCells({deep:!0}),r=i.getConnectedLinks(e,{deep:!0,includeEnclosed:!0}),o=([e].concat(s,r).forEach(function(a){return n[a.id]=a.attributes.z}),e.startBatch("to-front"),e.toFront({deep:!0,ui:!0}),i.getElements().reduce(function(a,l){return Math.max(a,l.attributes.z||0)},0)),s=(r.forEach(function(a){a.attributes.z<=o&&a.set("z",o+1,{ui:!0})}),e.stopBatch("to-front"),e.parent());s?(i.getCell(s).unembed(e,{ui:!0}),t.initialParentId=s):t.initialParentId=null},processEmbedding:function(t,e,i,n){var r=(t=t===void 0?{}:t).model||this.model,o=t.paper||this.paper,s=o.model,a=o.options,l=a.findParentBy,h=a.frontParentOnly,u=a.validateEmbedding,d=Rt(l)?kt(l.call(s,this,e,i,n)):l==="pointer"?kt(s.findModelsFromPoint({x:i,y:n})):s.findModelsUnderElement(r,{searchBy:l});d=d.filter(function(I){return I instanceof bi&&r.id!==I.id&&!I.isEmbeddedIn(r)}),h&&(d=d.slice(-1));for(var p=null,m=t.candidateEmbedView,v=d.length-1;0<=v;v--){var k=d[v];if(m&&m.model.id==k.id){p=m;break}if(k=k.findView(o),!Rt(u)||u.call(o,this,k)){p=k;break}}p&&p!=m&&(this.clearEmbedding(t),t.candidateEmbedView=p.highlight(p.findProxyNode(null,"container"),{embedding:!0})),!p&&m&&this.clearEmbedding(t)},clearEmbedding:function(t){var e=(t=t||{}).candidateEmbedView;e&&(e.unhighlight(e.findProxyNode(null,"container"),{embedding:!0}),t.candidateEmbedView=null)},finalizeEmbedding:function(t){var e=(t=t===void 0?{}:t).candidateEmbedView,i=t.model||this.model,n=t.paper||this.paper;if(e)e.model.embed(i,{ui:!0}),e.unhighlight(e.findProxyNode(null,"container"),{embedding:!0}),t.candidateEmbedView=null;else if(e=n.options.validateUnembedding,t.initialParentId&&typeof e=="function"&&!e.call(n,this))return void this._disallowUnembed(t);n.model.getConnectedLinks(i,{deep:!0}).forEach(function(r){r.reparent({ui:!0})})},_disallowUnembed:function(t){var e=t.model,i=t.whenNotAllowed,n=e||this.model,r=(t.paper||this.paper).model;switch(i=i===void 0?"revert":i){case"remove":n.remove({ui:!0});break;case"revert":var o=t.initialParentId,s=t.initialPosition,a=t.initialZIndices,l=(s&&(l=s.x,s=s.y,n.position(l,s,{deep:!0,ui:!0})),a&&Object.keys(a).forEach(function(h){var u=r.getCell(h);u&&u.set("z",a[h],{ui:!0})}),r.getCell(o));l&&l.embed(n,{ui:!0})}},getDelegatedView:function(){for(var t=this,e=t.model,i=t.paper;t&&!e.isLink();){if(!e.isEmbedded()||t.can("stopDelegation"))return t;e=e.getParentCell(),t=i.findViewByModel(e)}return null},findProxyNode:function(t,e){if(e=(t=t||this.el).getAttribute(e+"-selector"),e){var i=this.findAttribute("port",t);if(i){if(i=this.findPortNode(i,e),i)return i}else if(i=this.findBySelector(e)[0],i)return i}return t},notifyPointerdown:function(t,e,i){ye.prototype.pointerdown.call(this,t,e,i),this.notify("element:pointerdown",t,e,i)},notifyPointermove:function(t,e,i){ye.prototype.pointermove.call(this,t,e,i),this.notify("element:pointermove",t,e,i)},notifyPointerup:function(t,e,i){this.notify("element:pointerup",t,e,i),ye.prototype.pointerup.call(this,t,e,i)},pointerdblclick:function(t,e,i){ye.prototype.pointerdblclick.apply(this,arguments),this.notify("element:pointerdblclick",t,e,i)},pointerclick:function(t,e,i){ye.prototype.pointerclick.apply(this,arguments),this.notify("element:pointerclick",t,e,i)},contextmenu:function(t,e,i){ye.prototype.contextmenu.apply(this,arguments),this.notify("element:contextmenu",t,e,i)},pointerdown:function(t,e,i){this.notifyPointerdown(t,e,i),this.dragStart(t,e,i)},pointermove:function(t,e,i){var n=this.eventData(t),r=n.targetMagnet,o=n.action,s=n.delegatedView;switch(r&&this.magnetpointermove(t,r,e,i),o){case Xh:this.dragMagnet(t,e,i);break;case Hh:(s||this).drag(t,e,i);default:n.preventPointerEvents||this.notifyPointermove(t,e,i)}this.eventData(t,n)},pointerup:function(t,e,i){var n=this.eventData(t),r=n.targetMagnet,o=n.action,s=n.delegatedView;switch(r&&this.magnetpointerup(t,r,e,i),o){case Xh:this.dragMagnetEnd(t,e,i);break;case Hh:(s||this).dragEnd(t,e,i);default:n.preventPointerEvents||this.notifyPointerup(t,e,i)}r&&this.magnetpointerclick(t,r,e,i),this.checkMouseleave(t)},mouseover:function(t){ye.prototype.mouseover.apply(this,arguments),this.notify("element:mouseover",t)},mouseout:function(t){ye.prototype.mouseout.apply(this,arguments),this.notify("element:mouseout",t)},mouseenter:function(t){ye.prototype.mouseenter.apply(this,arguments),this.notify("element:mouseenter",t)},mouseleave:function(t){ye.prototype.mouseleave.apply(this,arguments),this.notify("element:mouseleave",t)},mousewheel:function(t,e,i,n){ye.prototype.mousewheel.apply(this,arguments),this.notify("element:mousewheel",t,e,i,n)},onmagnet:function(t,e,i){var n=t.currentTarget;this.magnetpointerdown(t,n,e,i),this.eventData(t,{targetMagnet:n}),this.dragMagnetStart(t,e,i)},magnetpointerdown:function(t,e,i,n){this.notify("element:magnet:pointerdown",t,e,i,n)},magnetpointermove:function(t,e,i,n){this.notify("element:magnet:pointermove",t,e,i,n)},magnetpointerup:function(t,e,i,n){this.notify("element:magnet:pointerup",t,e,i,n)},magnetpointerdblclick:function(t,e,i,n){this.notify("element:magnet:pointerdblclick",t,e,i,n)},magnetcontextmenu:function(t,e,i,n){this.notify("element:magnet:contextmenu",t,e,i,n)},dragStart:function(t,e,i){var n,r;this.isDefaultInteractionPrevented(t)||(n=this.getDelegatedView())&&n.can("elementMove")&&(this.eventData(t,{action:Hh,delegatedView:n}),r=n.model.position(),n.eventData(t,{initialPosition:r,pointerOffset:r.difference(e,i),restrictedArea:this.paper.getRestrictedArea(n,e,i)}))},dragMagnetStart:function(t,e,i){var n,r=this.paper,o=t.isPropagationStopped();o&&this.eventData(t,{preventPointerEvents:!0}),!this.isDefaultInteractionPrevented(t)&&this.can("addLinkFromMagnet")&&((n=this.eventData(t).targetMagnet)===void 0&&(n=t.currentTarget),t.stopPropagation(),r.options.validateMagnet.call(r,this,n,t)?(r.options.magnetThreshold<=0&&this.dragLinkStart(t,n,e,i),this.eventData(t,{action:Xh})):o?this.dragStart(t,e,i):this.pointerdown(t,e,i))},drag:function(t,e,i){var n=this.paper,r=n.options.gridSize,o=this.model,s=this.eventData(t),u=s.pointerOffset,a=s.restrictedArea,l=s.embedding,h=Ce(e+u.x,r),u=Ce(i+u.y,r);o.position(h,u,{restrictedArea:a,deep:!0,ui:!0}),n.options.embeddingMode&&(l||(this.prepareEmbedding(s),l=!0),this.processEmbedding(s,t,e,i)),this.eventData(t,{embedding:l})},dragMagnet:function(t,e,i){this.dragLink(t,e,i)},dragEnd:function(t,e,i){t=this.eventData(t),t.embedding&&this.finalizeEmbedding(t)},dragMagnetEnd:function(t,e,i){this.dragLinkEnd(t,e,i)},magnetpointerclick:function(t,e,i,n){var r=this.paper;r.eventData(t).mousemoved>r.options.clickThreshold||this.notify("element:magnet:pointerclick",t,e,i,n)}},{Flags:Te}),_n=(ct(ee.prototype,Nn),{_results:{},_tests:{svgforeignobject:function(){return!!document.createElementNS&&/SVGForeignObject/.test({}.toString.call(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")))}},addTest:function(t,e){return this._tests[t]=e},test:function(t){var e=this._tests[t];if(!e)throw new Error('Test not defined ("'+t+'"). Use `joint.env.addTest(name, fn) to add a new test.`');var i=this._results[t];if(i===void 0){try{i=e()}catch{i=!1}this._results[t]=i}return i}}),Ae=Kt.define("basic.Generic",{attrs:{".":{fill:"#ffffff",stroke:"none"}}}),Zi=Ae.define("basic.Rect",{attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:100,height:60},text:{fill:"#000000",text:"","font-size":14,"ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><rect/></g><text/></g>'}),Pn=ee.extend({presentationAttributes:ee.addPresentationAttributes({attrs:["SCALE"]}),confirmUpdate:function(){var t=ee.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"SCALE")&&(this.resize(),t=this.removeFlag(t,"SCALE")),t}}),xi=Ae.define("basic.Text",{attrs:{text:{"font-size":18,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><text/></g></g>'}),nn=Ae.define("basic.Circle",{size:{width:60,height:60},attrs:{circle:{fill:"#ffffff",stroke:"#000000",r:30,cx:30,cy:30},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><circle/></g><text/></g>'}),je=Ae.define("basic.Ellipse",{size:{width:60,height:40},attrs:{ellipse:{fill:"#ffffff",stroke:"#000000",rx:30,ry:20,cx:30,cy:20},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><ellipse/></g><text/></g>'}),ge=Ae.define("basic.Polygon",{size:{width:60,height:40},attrs:{polygon:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>'}),Be=Ae.define("basic.Polyline",{size:{width:60,height:40},attrs:{polyline:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><polyline/></g><text/></g>'}),Di=Ae.define("basic.Image",{attrs:{text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><image/></g><text/></g>'}),Hi=Ae.define("basic.Path",{size:{width:60,height:60},attrs:{path:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle",ref:"path","ref-x":.5,"ref-dy":10,fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}},{markup:'<g class="rotatable"><g class="scalable"><path/></g><text/></g>'}),no=Hi.define("basic.Rhombus",{attrs:{path:{d:"M 30 0 L 60 30 30 60 0 30 z"},text:{"ref-y":.5,"ref-dy":null,"y-alignment":"middle"}}}),Pl=_n.test("svgforeignobject"),Pr=Ae.define("basic.TextBlock",{attrs:{rect:{fill:"#ffffff",stroke:"#000000",width:80,height:100},text:{fill:"#000000","font-size":14,"font-family":"Arial, helvetica, sans-serif"},".content":{text:"","ref-x":.5,"ref-y":.5,"y-alignment":"middle","x-alignment":"middle"}},content:""},{markup:['<g class="rotatable">','<g class="scalable"><rect/></g>',Pl?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>',"</g>"].join(""),initialize:function(){this.listenTo(this,"change:size",this.updateSize),this.listenTo(this,"change:content",this.updateContent),this.updateSize(this,this.get("size")),this.updateContent(this,this.get("content")),Ae.prototype.initialize.apply(this,arguments)},updateSize:function(t,e){this.attr({".fobj":ct({},e),div:{style:ct({},e)}})},updateContent:function(t,e){Pl?this.attr({".content":{html:jh(e)}}):this.attr({".content":{text:e}})},setForeignObjectSize:function(){this.updateSize.apply(this,arguments)},setDivContent:function(){this.updateContent.apply(this,arguments)}}),io=ee.extend({presentationAttributes:Pl?ee.prototype.presentationAttributes:ee.addPresentationAttributes({content:["CONTENT"],size:["CONTENT"]}),initFlag:["RENDER","CONTENT"],confirmUpdate:function(){var t=ee.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"CONTENT")&&(this.updateContent(this.model),t=this.removeFlag(t,"CONTENT")),t},update:function(t,e){var i,n=this.model;Pl?ee.prototype.update.call(this,n,e):(i=ai(e||n.get("attrs"),".content"),ee.prototype.update.call(this,n,i),e&&!Zn(e,".content")||this.updateContent(n,e))},updateContent:function(t,n){var n=ze({},(n||t.get("attrs"))[".content"]),n=ai(n,"text"),i=Rh(t.get("content"),t.get("size"),n,{svgDocument:this.paper.svg}),n=Qr({},".content",n,"/");n[".content"].text=i,ee.prototype.update.call(this,t,n)}}),As={__proto__:null,Generic:Ae,Rect:Zi,TextView:Pn,Text:xi,Circle:nn,Ellipse:je,Polygon:ge,Polyline:Be,Image:Di,Path:Hi,Rhombus:no,TextBlock:Pr,TextBlockView:io},Ke=bi.extend({markup:['<path class="connection" stroke="black" d="M 0 0 0 0"/>','<path class="marker-source" fill="black" stroke="black" d="M 0 0 0 0"/>','<path class="marker-target" fill="black" stroke="black" d="M 0 0 0 0"/>','<path class="connection-wrap" d="M 0 0 0 0"/>','<g class="labels"/>','<g class="marker-vertices"/>','<g class="marker-arrowheads"/>','<g class="link-tools"/>'].join(""),toolMarkup:['<g class="link-tool">','<g class="tool-remove" event="remove">','<circle r="11" />','<path transform="scale(.8) translate(-16, -16)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z" />',"<title>Remove link.</title>","</g>",'<g class="tool-options" event="link:options">','<circle r="11" transform="translate(25)"/>','<path fill="white" transform="scale(.55) translate(29, -16)" d="M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z"/>',"<title>Link options.</title>","</g>","</g>"].join(""),doubleToolMarkup:void 0,vertexMarkup:['<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">','<circle class="marker-vertex" idx="<%= idx %>" r="10" />','<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>','<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',"<title>Remove vertex.</title>","</path>","</g>"].join(""),arrowheadMarkup:['<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">','<path class="marker-arrowhead" end="<%= end %>" d="M 26 0 L 0 13 L 26 26 z" />',"</g>"].join(""),defaultLabel:void 0,labelMarkup:void 0,_builtins:{defaultLabel:{markup:[{tagName:"rect",selector:"rect"},{tagName:"text",selector:"text"}],attrs:{text:{fill:"#000000",fontSize:14,textAnchor:"middle",yAlignment:"middle",pointerEvents:"none"},rect:{ref:"text",fill:"#ffffff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}}},defaults:{type:"link",source:{},target:{}},isLink:function(){return!0},disconnect:function(t){return this.set({source:{x:0,y:0},target:{x:0,y:0}},t)},source:function(t,e,i){var n;return t===void 0?ot(this.get("source")):t instanceof bi?((n=ot(e)||{}).id=t.id,this.set("source",n,i)):ve(t)?this.set("source",n=t,e):((n=ot(e)||{}).x=t.x,n.y=t.y,this.set("source",n,i))},target:function(t,e,i){var n;return t===void 0?ot(this.get("target")):t instanceof bi?((n=ot(e)||{}).id=t.id,this.set("target",n,i)):ve(t)?this.set("target",n=t,e):((n=ot(e)||{}).x=t.x,n.y=t.y,this.set("target",n,i))},router:function(t,e,i){var n;return t===void 0?(n=this.get("router"))?typeof n=="object"?ot(n):n:this.get("manhattan")?{name:"orthogonal"}:null:this.set("router",(n=typeof t=="object"||typeof t=="function")?t:{name:t,args:e},n?e:i)},connector:function(t,e,i){var n;return t===void 0?(n=this.get("connector"))?typeof n=="object"?ot(n):n:this.get("smooth")?{name:"smooth"}:null:this.set("connector",(n=typeof t=="object"||typeof t=="function")?t:{name:t,args:e},n?e:i)},label:function(t,e,i){var n=this.labels();return(t=isFinite(t)&&t!==null?0|t:0)<0&&(t=n.length+t),arguments.length<=1?this.prop(["labels",t]):this.prop(["labels",t],e,i)},labels:function(t,e){return arguments.length===0?(t=this.get("labels"),Array.isArray(t)?t.slice():[]):(Array.isArray(t)||(t=[]),this.set("labels",t,e))},hasLabels:function(){var t=this.attributes.labels;return Array.isArray(t)&&0<t.length},insertLabel:function(t,e,i){var n,r;if(e)return r=(n=this.labels()).length,t=isFinite(t)&&t!==null?0|t:r,n.splice(t=t<0?r+t+1:t,0,e),this.labels(n,i);throw new Error("dia.Link: no label provided")},appendLabel:function(t,e){return this.insertLabel(-1,t,e)},removeLabel:function(t,e){var i=this.labels();return t=isFinite(t)&&t!==null?0|t:-1,i.splice(t,1),this.labels(i,e)},vertex:function(t,e,i){var n=this.vertices();return(t=isFinite(t)&&t!==null?0|t:0)<0&&(t=n.length+t),arguments.length<=1?this.prop(["vertices",t]):(n=this._normalizeVertex(e),this.prop(["vertices",t],n,i))},vertices:function(t,e){if(arguments.length===0)return t=this.get("vertices"),Array.isArray(t)?t.slice():[];Array.isArray(t)||(t=[]);for(var i=[],n=0;n<t.length;n++){var r=t[n],r=this._normalizeVertex(r);i.push(r)}return this.set("vertices",i,e)},insertVertex:function(t,e,i){var n,r;if(e)return r=(n=this.vertices()).length,(t=isFinite(t)&&t!==null?0|t:r)<0&&(t=r+t+1),r=this._normalizeVertex(e),n.splice(t,0,r),this.vertices(n,i);throw new Error("dia.Link: no vertex provided")},removeVertex:function(t,e){var i=this.vertices();return t=isFinite(t)&&t!==null?0|t:-1,i.splice(t,1),this.vertices(i,e)},_normalizeVertex:function(t){return ve(t)?t:{x:t.x,y:t.y}},translate:function(t,e,i){return(i=i||{}).translateBy=i.translateBy||this.id,i.tx=t,i.ty=e,this.applyToPoints(function(n){return{x:(n.x||0)+t,y:(n.y||0)+e}},i)},scale:function(t,e,i,n){return this.applyToPoints(function(r){return Q(r).scale(t,e,i).toJSON()},n)},applyToPoints:function(t,e){var i,n,r;if(Rt(t))return i={},r=(n=this.attributes).source,n=n.target,r.id||(i.source=t(r)),n.id||(i.target=t(n)),0<(r=this.vertices()).length&&(i.vertices=r.map(t)),this.set(i,e);throw new TypeError("dia.Link: applyToPoints expects its first parameter to be a function.")},getSourcePoint:function(){var t=this.getSourceCell();return t?t.getPointFromConnectedLink(this,"source"):new Q(this.source())},getTargetPoint:function(){var t=this.getTargetCell();return t?t.getPointFromConnectedLink(this,"target"):new Q(this.target())},getPointFromConnectedLink:function(){return this.getPolyline().pointAt(.5)},getPolyline:function(){var t=[this.getSourcePoint()].concat(this.vertices().map(Q),[this.getTargetPoint()]);return new ie(t)},getBBox:function(){return this.getPolyline().bbox()},reparent:function(t){var e,i,n,r;return this.graph&&(i=this.getSourceElement(),n=this.getTargetElement(),r=this.getParentCell(),i&&n&&(e=i===n||i.isEmbeddedIn(n)?n:n.isEmbeddedIn(i)?i:this.graph.getCommonAncestor(i,n)),!r||e&&e.id===r.id||r.unembed(this,t),e&&e.embed(this,t)),e},hasLoop:function(t){t=t||{};var i=this.attributes,e=i.source,i=i.target,e=e.id,i=i.id;return!(!e||!i)&&(!(e=e===i)&&t.deep&&this.graph&&(i=this.getSourceCell(),t=this.getTargetCell(),e=i.isEmbeddedIn(t)||t.isEmbeddedIn(i)),e)},getSourceCell:function(){var t=this.graph,e=this.attributes.source;return e&&e.id&&t&&t.getCell(e.id)||null},getSourceElement:function(){var t=this,e={};do if(e[t.id])return null;while(e[t.id]=!0,(t=t.getSourceCell())&&t.isLink());return t},getTargetCell:function(){var t=this.graph,e=this.attributes.target;return e&&e.id&&t&&t.getCell(e.id)||null},getTargetElement:function(){var t=this,e={};do if(e[t.id])return null;while(e[t.id]=!0,(t=t.getTargetCell())&&t.isLink());return t},getRelationshipAncestor:function(){var t;return this.graph&&(t=[this,this.getSourceElement(),this.getTargetElement()].filter(function(e){return!!e}),t=this.graph.getCommonAncestor.apply(this.graph,t)),t||null},isRelationshipEmbeddedIn:function(e){var e=Ft(e)||Nt(e)?e:e.id,i=this.getRelationshipAncestor();return!!i&&(i.id===e||i.isEmbeddedIn(e))},_getDefaultLabel:function(){var t=this.get("defaultLabel")||this.defaultLabel||{},e={};return e.markup=t.markup||this.get("labelMarkup")||this.labelMarkup,e.position=t.position,e.attrs=t.attrs,e.size=t.size,e}},{endsEqual:function(t,e){var i=t.port===e.port||!t.port&&!e.port;return t.id===e.id&&i}}),hi=Kt.define("standard.Rectangle",{attrs:{body:{refWidth:"100%",refHeight:"100%",strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}]}),Bi=Kt.define("standard.Circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}]}),Fi=Kt.define("standard.Ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"ellipse",selector:"body"},{tagName:"text",selector:"label"}]}),tn=Kt.define("standard.Path",{attrs:{body:{refD:"M 0 0 L 10 0 10 10 0 10 Z",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}]}),Nn=Kt.define("standard.Polygon",{attrs:{body:{refPoints:"0 0 10 0 10 10 0 10",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"text",selector:"label"}]}),Zi=Kt.define("standard.Polyline",{attrs:{body:{refPoints:"0 0 10 0 10 10 0 10 0 0",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"polyline",selector:"body"},{tagName:"text",selector:"label"}]}),Pn=Kt.define("standard.Image",{attrs:{image:{refWidth:"100%",refHeight:"100%"},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]}),xi=Kt.define("standard.BorderedImage",{attrs:{border:{refWidth:"100%",refHeight:"100%",stroke:"#333333",strokeWidth:2},background:{refWidth:-1,refHeight:-1,x:.5,y:.5,fill:"#FFFFFF"},image:{refWidth:-1,refHeight:-1,x:.5,y:.5},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"background",attributes:{stroke:"none"}},{tagName:"image",selector:"image"},{tagName:"rect",selector:"border",attributes:{fill:"none"}},{tagName:"text",selector:"label"}]}),je=Kt.define("standard.EmbeddedImage",{attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#333333",fill:"#FFFFFF",strokeWidth:2},image:{refWidth:"30%",refHeight:-20,x:10,y:10,preserveAspectRatio:"xMidYMin"},label:{textVerticalAnchor:"top",textAnchor:"left",refX:"30%",refX2:20,refY:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]}),ge=Kt.define("standard.InscribedImage",{attrs:{border:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",stroke:"#333333",strokeWidth:2},background:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",fill:"#FFFFFF"},image:{refWidth:"68%",refHeight:"68%",refX:"16%",refY:"16%",preserveAspectRatio:"xMidYMid"},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"ellipse",selector:"background"},{tagName:"image",selector:"image"},{tagName:"ellipse",selector:"border",attributes:{fill:"none"}},{tagName:"text",selector:"label"}]}),Be=Kt.define("standard.HeaderedRectangle",{attrs:{body:{refWidth:"100%",refHeight:"100%",strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},header:{refWidth:"100%",height:30,strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},headerText:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:15,fontSize:16,fill:"#333333"},bodyText:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",refY2:15,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerText"},{tagName:"text",selector:"bodyText"}]}),Di=Kt.define("standard.Cylinder",{attrs:{body:{lateralArea:10,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},top:{refCx:"50%",cy:10,refRx:"50%",ry:10,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},label:{textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"100%",refY2:15,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"path",selector:"body"},{tagName:"ellipse",selector:"top"},{tagName:"text",selector:"label"}],topRy:function(t,e){var i;return t===void 0?this.attr("body/lateralArea"):(i=ni(t),this.attr({body:{lateralArea:t},top:i?{refCy:t,refRy:t,cy:null,ry:null}:{refCy:null,refRy:null,cy:t,ry:t}},e))}},{attributes:{lateralArea:{set:function(a,n){var s=ni(a),i=(s&&(a=parseFloat(a)/100),n.x),d=n.y,l=n.width,n=n.height,u=s?n*a:a,o=X.KAPPA,r=o*(l/2),o=o*(s?n*a:a),s=i+l/2,a=i+l,l=d+u,h=l-u,u=d+n-u,d=d+n;return{d:["M",i,l,"L",i,u,"C",i,u+o,s-r,d,s,d,"C",s+r,d,a,u+o,a,u,"L",a,l,"C",a,l-o,s+r,h,s,h,"C",s-r,h,i,l-o,i,l,"Z"].join(" ")}}}}}),Hi=_n.test("svgforeignobject")?{tagName:"foreignObject",selector:"foreignObject",attributes:{overflow:"hidden"},children:[{tagName:"div",namespaceURI:"http://www.w3.org/1999/xhtml",selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attributes:{"text-anchor":"middle"}},no={__proto__:null,Rectangle:hi,Circle:Bi,Ellipse:Fi,Path:tn,Polygon:Nn,Polyline:Zi,Image:Pn,BorderedImage:xi,EmbeddedImage:je,InscribedImage:ge,HeaderedRectangle:Be,Cylinder:Di,TextBlock:Kt.define("standard.TextBlock",{attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#333333",fill:"#ffffff",strokeWidth:2},foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}}},{markup:[{tagName:"rect",selector:"body"},Hi]},{attributes:{text:{set:function(t,e,i,n){var r,o;if(!(i instanceof HTMLElement))return n=n.style||{},r={text:t,width:-5,height:"100%"},o=ct({textVerticalAnchor:"middle"},n),Oo.textWrap.set.call(this,r,e,i,o),{fill:n.color||null};i.textContent=t},position:function(t,e,i){if(i instanceof SVGElement)return e.center()}}}}),Link:Ke.define("standard.Link",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",targetMarker:{type:"path",d:"M 10 -5 0 0 10 5 z"}},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),DoubleLink:Ke.define("standard.DoubleLink",{attrs:{line:{connection:!0,stroke:"#DDDDDD",strokeWidth:4,strokeLinejoin:"round",targetMarker:{type:"path",stroke:"#000000",d:"M 10 -3 10 -10 -2 0 10 10 10 3"}},outline:{connection:!0,stroke:"#000000",strokeWidth:6,strokeLinejoin:"round"}}},{markup:[{tagName:"path",selector:"outline",attributes:{fill:"none",cursor:"pointer"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),ShadowLink:Ke.define("standard.ShadowLink",{attrs:{line:{connection:!0,stroke:"#FF0000",strokeWidth:20,strokeLinejoin:"round",targetMarker:{type:"path",stroke:"none",d:"M 0 -10 -10 0 0 10 z"},sourceMarker:{type:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z"}},shadow:{connection:!0,refX:3,refY:6,stroke:"#000000",strokeOpacity:.2,strokeWidth:20,strokeLinejoin:"round",targetMarker:{type:"path",d:"M 0 -10 -10 0 0 10 z",stroke:"none"},sourceMarker:{type:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z"}}}},{markup:[{tagName:"path",selector:"shadow",attributes:{fill:"none","pointer-events":"none"}},{tagName:"path",selector:"line",attributes:{fill:"none",cursor:"pointer"}}]})},hi=Ae.define("devs.Model",{inPorts:[],outPorts:[],size:{width:80,height:80},attrs:{".":{magnet:!1},".label":{text:"Model","ref-x":.5,"ref-y":10,"font-size":18,"text-anchor":"middle",fill:"#000"},".body":{"ref-width":"100%","ref-height":"100%",stroke:"#000"}},ports:{groups:{in:{position:{name:"left"},attrs:{".port-label":{fill:"#000"},".port-body":{fill:"#fff",stroke:"#000",r:10,magnet:!0}},label:{position:{name:"left",args:{y:10}}}},out:{position:{name:"right"},attrs:{".port-label":{fill:"#000"},".port-body":{fill:"#fff",stroke:"#000",r:10,magnet:!0}},label:{position:{name:"right",args:{y:10}}}}}}},{markup:'<g class="rotatable"><rect class="body"/><text class="label"/></g>',portMarkup:'<circle class="port-body"/>',portLabelMarkup:'<text class="port-label"/>',initialize:function(){Ae.prototype.initialize.apply(this,arguments),this.on("change:inPorts change:outPorts",this.updatePortItems,this),this.updatePortItems()},updatePortItems:function(t,e,i){var n=J(this.get("inPorts")),r=Oh(J(this.get("outPorts")),n),n=this.createPortItems("in",n),r=this.createPortItems("out",r);this.prop("ports/items",n.concat(r),ct({rewrite:!0},i))},createPortItem:function(t,e){return{id:e,group:t,attrs:{".port-label":{text:e}}}},createPortItems:function(t,e){return kt(e).map(this.createPortItem.bind(this,t))},_addGroupPort:function(t,e,i){var n=this.get(e);return this.set(e,Array.isArray(n)?n.concat(t):[t],i)},addOutPort:function(t,e){return this._addGroupPort(t,"outPorts",e)},addInPort:function(t,e){return this._addGroupPort(t,"inPorts",e)},_removeGroupPort:function(t,e,i){return this.set(e,Lo(this.get(e),t),i)},removeOutPort:function(t,e){return this._removeGroupPort(t,"outPorts",e)},removeInPort:function(t,e){return this._removeGroupPort(t,"inPorts",e)},_changeGroup:function(t,e,i){return this.prop("ports/groups/"+t,Dt(e)?e:{},i)},changeInGroup:function(t,e){return this._changeGroup("in",t,e)},changeOutGroup:function(t,e){return this._changeGroup("out",t,e)}}),Bi=hi.define("devs.Atomic",{size:{width:80,height:80},attrs:{".label":{text:"Atomic"}}}),Fi=hi.define("devs.Coupled",{size:{width:200,height:300},attrs:{".label":{text:"Coupled"}}}),tn={__proto__:null,Model:hi,Atomic:Bi,Coupled:Fi,Link:Ke.define("devs.Link",{attrs:{".connection":{"stroke-width":2}}})},Nn=Ae.define("logic.Gate",{size:{width:80,height:40},attrs:{".":{magnet:!1},".body":{width:100,height:50},circle:{r:7,stroke:"black",fill:"transparent","stroke-width":2}}},{operation:function(){return!0}}),Zi=Nn.define("logic.IO",{size:{width:60,height:30},attrs:{".body":{fill:"white",stroke:"black","stroke-width":2},".wire":{ref:".body","ref-y":.5,stroke:"black"},text:{fill:"black",ref:".body","ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle","font-weight":"bold","font-variant":"small-caps","text-transform":"capitalize","font-size":"14px"}}},{markup:'<g class="rotatable"><g class="scalable"><rect class="body"/></g><path class="wire"/><circle/><text/></g>'}),Pn=Zi.define("logic.Input",{attrs:{".wire":{"ref-dx":0,d:"M 0 0 L 23 0"},circle:{ref:".body","ref-dx":30,"ref-y":.5,magnet:!0,class:"output",port:"out"},text:{text:"input"}}}),xi=Zi.define("logic.Output",{attrs:{".wire":{"ref-x":0,d:"M 0 0 L -23 0"},circle:{ref:".body","ref-x":-30,"ref-y":.5,magnet:"passive",class:"input",port:"in"},text:{text:"output"}}}),je=Nn.define("logic.Gate11",{attrs:{".input":{ref:".body","ref-x":-2,"ref-y":.5,magnet:"passive",port:"in"},".output":{ref:".body","ref-dx":2,"ref-y":.5,magnet:!0,port:"out"}}},{markup:'<g class="rotatable"><g class="scalable"><image class="body"/></g><circle class="input"/><circle class="output"/></g>'}),ge=Nn.define("logic.Gate21",{attrs:{".input1":{ref:".body","ref-x":-2,"ref-y":.3,magnet:"passive",port:"in1"},".input2":{ref:".body","ref-x":-2,"ref-y":.7,magnet:"passive",port:"in2"},".output":{ref:".body","ref-dx":2,"ref-y":.5,magnet:!0,port:"out"}}},{markup:'<g class="rotatable"><g class="scalable"><image class="body"/></g><circle class="input input1"/><circle  class="input input2"/><circle class="output"/></g>'}),Be=je.define("logic.Repeater",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzIuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICA8L2c+Cjwvc3ZnPgo="}}},{operation:function(t){return t}}),Di=je.define("logic.Not",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzkuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDI2NzEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzYiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA4MCwyNSBBIDQsNCAwIDEgMSA3MiwyNSBBIDQsNCAwIDEgMSA4MCwyNSB6IgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEsMCkiIC8+CiAgPC9nPgo8L3N2Zz4K"}}},{operation:function(t){return!t}}),Hi=ge.define("logic.Or",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik9SIEFOU0kuc3ZnIgogICBpbmtzY2FwZTpvdXRwdXRfZXh0ZW5zaW9uPSJvcmcuaW5rc2NhcGUub3V0cHV0LnN2Zy5pbmtzY2FwZSI+CiAgPGRlZnMKICAgICBpZD0iZGVmczQiPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTAgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjcxNCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iMSA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMC41IDogMC4zMzMzMzMzMyA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODA2IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODE5IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjM3Mi4wNDcyNCA6IDM1MC43ODczOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI3NDQuMDk0NDggOiA1MjYuMTgxMDkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzc3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49Ijc1IDogNDAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTUwIDogNjAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDYwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTMyNzUiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNTAgOiAzMy4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTAwIDogNTAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTU1MzMiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzIgOiAyMS4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNjQgOiAzMiA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMzIgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjU1NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDE2LjY2NjY2NyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDI1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAyNSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iNCIKICAgICBpbmtzY2FwZTpjeD0iMTEzLjAwMDM5IgogICAgIGlua3NjYXBlOmN5PSIxMi44OTM3MzEiCiAgICAgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9InB4IgogICAgIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImcyNTYwIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTpncmlkLWJib3g9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1wb2ludHM9InRydWUiCiAgICAgZ3JpZHRvbGVyYW5jZT0iMTAwMDAiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxMzk5IgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9Ijg3NCIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iMzciCiAgICAgaW5rc2NhcGU6d2luZG93LXk9Ii00IgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Im0gNzAsMjUgYyAyMCwwIDI1LDAgMjUsMCIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMSwxNSA1LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzIsMzUgNSwzNSIKICAgICAgIGlkPSJwYXRoMzk0NCIgLz4KICAgIDxnCiAgICAgICBpZD0iZzI1NjAiCiAgICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2LjUsLTM5LjUpIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICA8L2c+Cjwvc3ZnPgo="}}},{operation:function(t,e){return t||e}}),hi=ge.define("logic.And",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IkFORCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI4IgogICAgIGlua3NjYXBlOmN4PSI1Ni42OTgzNDgiCiAgICAgaW5rc2NhcGU6Y3k9IjI1LjMyNjg5OSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZvbnQtc2l6ZTptZWRpdW07Zm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDt0ZXh0LWluZGVudDowO3RleHQtYWxpZ246c3RhcnQ7dGV4dC1kZWNvcmF0aW9uOm5vbmU7bGluZS1oZWlnaHQ6bm9ybWFsO2xldHRlci1zcGFjaW5nOm5vcm1hbDt3b3JkLXNwYWNpbmc6bm9ybWFsO3RleHQtdHJhbnNmb3JtOm5vbmU7ZGlyZWN0aW9uOmx0cjtibG9jay1wcm9ncmVzc2lvbjp0Yjt3cml0aW5nLW1vZGU6bHItdGI7dGV4dC1hbmNob3I6c3RhcnQ7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDozO21hcmtlcjpub25lO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGU7Zm9udC1mYW1pbHk6Qml0c3RyZWFtIFZlcmEgU2FuczstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOkJpdHN0cmVhbSBWZXJhIFNhbnMiCiAgICAgICBkPSJNIDMwLDUgTCAzMCw2LjQyODU3MTQgTCAzMCw0My41NzE0MjkgTCAzMCw0NSBMIDMxLjQyODU3MSw0NSBMIDUwLjQ3NjE5LDQ1IEMgNjEuNzQ0MDk4LDQ1IDcwLjQ3NjE5LDM1Ljk5OTk1NSA3MC40NzYxOSwyNSBDIDcwLjQ3NjE5LDE0LjAwMDA0NSA2MS43NDQwOTksNS4wMDAwMDAyIDUwLjQ3NjE5LDUgQyA1MC40NzYxOSw1IDUwLjQ3NjE5LDUgMzEuNDI4NTcxLDUgTCAzMCw1IHogTSAzMi44NTcxNDMsNy44NTcxNDI5IEMgNDAuODM0MjY0LDcuODU3MTQyOSA0NS45MTgzNjgsNy44NTcxNDI5IDQ4LjA5NTIzOCw3Ljg1NzE0MjkgQyA0OS4yODU3MTQsNy44NTcxNDI5IDQ5Ljg4MDk1Miw3Ljg1NzE0MjkgNTAuMTc4NTcxLDcuODU3MTQyOSBDIDUwLjMyNzM4MSw3Ljg1NzE0MjkgNTAuNDA5MjI3LDcuODU3MTQyOSA1MC40NDY0MjksNy44NTcxNDI5IEMgNTAuNDY1MDI5LDcuODU3MTQyOSA1MC40NzE1NDMsNy44NTcxNDI5IDUwLjQ3NjE5LDcuODU3MTQyOSBDIDYwLjIzNjg1Myw3Ljg1NzE0MyA2Ny4xNDI4NTcsMTUuNDk3MDk4IDY3LjE0Mjg1NywyNSBDIDY3LjE0Mjg1NywzNC41MDI5MDIgNTkuNzYwNjYyLDQyLjE0Mjg1NyA1MCw0Mi4xNDI4NTcgTCAzMi44NTcxNDMsNDIuMTQyODU3IEwgMzIuODU3MTQzLDcuODU3MTQyOSB6IgogICAgICAgaWQ9InBhdGgyODg0IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2NjY2NzY2NjY3Nzc3NzY2NjIiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},{operation:function(t,e){return t&&e}}),Bi=ge.define("logic.Nor",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjEiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjY3NzY0NCIKICAgICBpbmtzY2FwZTpjeT0iMjIuMTAyMzQ0IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjM3IgogICAgIGlua3NjYXBlOndpbmRvdy15PSItNCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc5LDI1IEMgOTksMjUgOTUsMjUgOTUsMjUiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHNvZGlwb2RpOnR5cGU9ImFyYyIKICAgICAgICAgc3R5bGU9ImZpbGw6bm9uZTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgICBpZD0icGF0aDI2MDQiCiAgICAgICAgIHNvZGlwb2RpOmN4PSI3NSIKICAgICAgICAgc29kaXBvZGk6Y3k9IjI1IgogICAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgICAgc29kaXBvZGk6cnk9IjQiCiAgICAgICAgIGQ9Ik0gNzksMjUgQSA0LDQgMCAxIDEgNzEsMjUgQSA0LDQgMCAxIDEgNzksMjUgeiIKICAgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI2LjUsMzkuNSkiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"}}},{operation:function(t,e){return!(t||e)}}),Fi=ge.define("logic.Nand",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5BTkQgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iMTYiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjI4MzMwNyIKICAgICBpbmtzY2FwZTpjeT0iMTYuNDQyODQzIgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzksMjUgQyA5MS44LDI1IDk1LDI1IDk1LDI1IgogICAgICAgaWQ9InBhdGgzMDU5IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMxLDE1IDUsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMiwzNSA1LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmb250LXNpemU6bWVkaXVtO2ZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7dGV4dC1pbmRlbnQ6MDt0ZXh0LWFsaWduOnN0YXJ0O3RleHQtZGVjb3JhdGlvbjpub25lO2xpbmUtaGVpZ2h0Om5vcm1hbDtsZXR0ZXItc3BhY2luZzpub3JtYWw7d29yZC1zcGFjaW5nOm5vcm1hbDt0ZXh0LXRyYW5zZm9ybTpub25lO2RpcmVjdGlvbjpsdHI7YmxvY2stcHJvZ3Jlc3Npb246dGI7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOnN0YXJ0O2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MzttYXJrZXI6bm9uZTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlO2ZvbnQtZmFtaWx5OkJpdHN0cmVhbSBWZXJhIFNhbnM7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpCaXRzdHJlYW0gVmVyYSBTYW5zIgogICAgICAgZD0iTSAzMCw1IEwgMzAsNi40Mjg1NzE0IEwgMzAsNDMuNTcxNDI5IEwgMzAsNDUgTCAzMS40Mjg1NzEsNDUgTCA1MC40NzYxOSw0NSBDIDYxLjc0NDA5OCw0NSA3MC40NzYxOSwzNS45OTk5NTUgNzAuNDc2MTksMjUgQyA3MC40NzYxOSwxNC4wMDAwNDUgNjEuNzQ0MDk5LDUuMDAwMDAwMiA1MC40NzYxOSw1IEMgNTAuNDc2MTksNSA1MC40NzYxOSw1IDMxLjQyODU3MSw1IEwgMzAsNSB6IE0gMzIuODU3MTQzLDcuODU3MTQyOSBDIDQwLjgzNDI2NCw3Ljg1NzE0MjkgNDUuOTE4MzY4LDcuODU3MTQyOSA0OC4wOTUyMzgsNy44NTcxNDI5IEMgNDkuMjg1NzE0LDcuODU3MTQyOSA0OS44ODA5NTIsNy44NTcxNDI5IDUwLjE3ODU3MSw3Ljg1NzE0MjkgQyA1MC4zMjczODEsNy44NTcxNDI5IDUwLjQwOTIyNyw3Ljg1NzE0MjkgNTAuNDQ2NDI5LDcuODU3MTQyOSBDIDUwLjQ2NTAyOSw3Ljg1NzE0MjkgNTAuNDcxNTQzLDcuODU3MTQyOSA1MC40NzYxOSw3Ljg1NzE0MjkgQyA2MC4yMzY4NTMsNy44NTcxNDMgNjcuMTQyODU3LDE1LjQ5NzA5OCA2Ny4xNDI4NTcsMjUgQyA2Ny4xNDI4NTcsMzQuNTAyOTAyIDU5Ljc2MDY2Miw0Mi4xNDI4NTcgNTAsNDIuMTQyODU3IEwgMzIuODU3MTQzLDQyLjE0Mjg1NyBMIDMyLjg1NzE0Myw3Ljg1NzE0MjkgeiIKICAgICAgIGlkPSJwYXRoMjg4NCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2Njc2NjY2Nzc3Nzc2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDQwMDgiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},{operation:function(t,e){return!(t&&e)}}),Jh=ge.define("logic.Xor",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhPUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjUuNjU2ODU0MiIKICAgICBpbmtzY2FwZTpjeD0iMjUuOTM4MTE2IgogICAgIGlua3NjYXBlOmN5PSIxNy4yMzAwNSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzAuMzg1NzE3LDE1IEwgNC45OTk5OTk4LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5NzY7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEuMzYyMDkxLDM1IEwgNC45OTk5OTk4LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPGcKICAgICAgIGlkPSJnMjU2MCIKICAgICAgIGlua3NjYXBlOmxhYmVsPSJMYXllciAxIgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjYuNSwtMzkuNSkiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDM1MTYiCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi4yNSw4MS41MDAwMDUgQyAtMy44NDczNzQsODQuMTQ0NDA1IC00LjUsODQuNTAwMDA1IC00LjUsODQuNTAwMDA1IEwgLTguMTU2MjUsODQuNTAwMDA1IEwgLTYuMTU2MjUsODIuMDYyNTA1IEMgLTYuMTU2MjUsODIuMDYyNTA1IC0wLjUsNzUuMDYyNDUxIC0wLjUsNjQuNSBDIC0wLjUsNTMuOTM3NTQ5IC02LjE1NjI1LDQ2LjkzNzUgLTYuMTU2MjUsNDYuOTM3NSBMIC04LjE1NjI1LDQ0LjUgTCAtNC41LDQ0LjUgQyAtMy43MTg3NSw0NS40Mzc1IC0zLjA3ODEyNSw0Ni4xNTYyNSAtMi4yODEyNSw0Ny41IEMgLTAuNDA4NTMxLDUwLjU5OTgxNSAyLjUsNTYuNTI2NjQ2IDIuNSw2NC41IEMgMi41LDcyLjQ1MDY1IC0wLjM5NjY5Nyw3OC4zNzk0MjUgLTIuMjUsODEuNTAwMDA1IHoiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY3NjY2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"}}},{operation:function(t,e){return(!t||e)&&(t||!e)}}),$h=ge.define("logic.Xnor",{attrs:{image:{"xlink:href":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhOT1IgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNTU3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTYuNjY2NjY3IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDI1IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI0IgogICAgIGlua3NjYXBlOmN4PSI5NS43MjM2NiIKICAgICBpbmtzY2FwZTpjeT0iLTI2Ljc3NTAyMyIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyLjAwMDAwMDI0O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc4LjMzMzMzMiwyNSBDIDkxLjY2NjY2NiwyNSA5NSwyNSA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMC4zODU3MTcsMTUgTCA0Ljk5OTk5OTgsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk3NjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMS4zNjIwOTEsMzUgTCA0Ljk5OTk5OTgsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIGlkPSJwYXRoMzUxNiIKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjI1LDgxLjUwMDAwNSBDIC0zLjg0NzM3NCw4NC4xNDQ0MDUgLTQuNSw4NC41MDAwMDUgLTQuNSw4NC41MDAwMDUgTCAtOC4xNTYyNSw4NC41MDAwMDUgTCAtNi4xNTYyNSw4Mi4wNjI1MDUgQyAtNi4xNTYyNSw4Mi4wNjI1MDUgLTAuNSw3NS4wNjI0NTEgLTAuNSw2NC41IEMgLTAuNSw1My45Mzc1NDkgLTYuMTU2MjUsNDYuOTM3NSAtNi4xNTYyNSw0Ni45Mzc1IEwgLTguMTU2MjUsNDQuNSBMIC00LjUsNDQuNSBDIC0zLjcxODc1LDQ1LjQzNzUgLTMuMDc4MTI1LDQ2LjE1NjI1IC0yLjI4MTI1LDQ3LjUgQyAtMC40MDg1MzEsNTAuNTk5ODE1IDIuNSw1Ni41MjY2NDYgMi41LDY0LjUgQyAyLjUsNzIuNDUwNjUgLTAuMzk2Njk3LDc4LjM3OTQyNSAtMi4yNSw4MS41MDAwMDUgeiIKICAgICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2Njc2NjY2NzYyIgLz4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDM1NTEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg=="}}},{operation:function(t,e){return(!t||!e)&&(t||e)}}),Nn={__proto__:null,Gate:Nn,IO:Zi,Input:Pn,Output:xi,Gate11:je,Gate21:ge,Repeater:Be,Not:Di,Or:Hi,And:hi,Nor:Bi,Nand:Fi,Xor:Jh,Xnor:$h,Wire:Ke.define("logic.Wire",{attrs:{".connection":{"stroke-width":2},".marker-vertex":{r:7}},router:{name:"orthogonal"},connector:{name:"rounded",args:{radius:10}}},{arrowheadMarkup:['<g class="marker-arrowhead-group marker-arrowhead-group-<%= end %>">','<circle class="marker-arrowhead" end="<%= end %>" r="7"/>',"</g>"].join(""),vertexMarkup:['<g class="marker-vertex-group" transform="translate(<%= x %>, <%= y %>)">','<circle class="marker-vertex" idx="<%= idx %>" r="10" />','<g class="marker-vertex-remove-group">','<path class="marker-vertex-remove-area" idx="<%= idx %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>','<path class="marker-vertex-remove" idx="<%= idx %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">',"<title>Remove vertex.</title>","</path>","</g>","</g>"].join("")})},Zi={__proto__:null,KingWhite:Ae.define("chess.KingWhite",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;"><path      d="M 22.5,11.63 L 22.5,6"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path      d="M 20,8 L 25,8"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path      d="M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25"      style="fill:#ffffff; stroke:#000000; stroke-linecap:butt; stroke-linejoin:miter;" />    <path      d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z "      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 11.5,30 C 17,27 27,27 32.5,30"      style="fill:none; stroke:#000000;" />    <path      d="M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5"      style="fill:none; stroke:#000000;" />    <path      d="M 11.5,37 C 17,34 27,34 32.5,37"      style="fill:none; stroke:#000000;" />  </g></g></g>'}),KingBlack:Ae.define("chess.KingBlack",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path       d="M 22.5,11.63 L 22.5,6"       style="fill:none; stroke:#000000; stroke-linejoin:miter;"       id="path6570" />    <path       d="M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25"       style="fill:#000000;fill-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;" />    <path       d="M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z "       style="fill:#000000; stroke:#000000;" />    <path       d="M 20,8 L 25,8"       style="fill:none; stroke:#000000; stroke-linejoin:miter;" />    <path       d="M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.51,26.6 L 22.5,24.5 C 20,18 9.906,14 6.997,19.85 C 4.5,25.5 11.85,28.85 11.85,28.85"       style="fill:none; stroke:#ffffff;" />    <path       d="M 11.5,30 C 17,27 27,27 32.5,30 M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5 M 11.5,37 C 17,34 27,34 32.5,37"       style="fill:none; stroke:#ffffff;" />  </g></g></g>'}),QueenWhite:Ae.define("chess.QueenWhite",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(-1,-1)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(15.5,-5.5)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(32,-1)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(7,-4.5)" />    <path      d="M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z"      transform="translate(24,-4)" />    <path      d="M 9,26 C 17.5,24.5 30,24.5 36,26 L 38,14 L 31,25 L 31,11 L 25.5,24.5 L 22.5,9.5 L 19.5,24.5 L 14,10.5 L 14,25 L 7,14 L 9,26 z "      style="stroke-linecap:butt;" />    <path      d="M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z "      style="stroke-linecap:butt;" />    <path      d="M 11.5,30 C 15,29 30,29 33.5,30"      style="fill:none;" />    <path      d="M 12,33.5 C 18,32.5 27,32.5 33,33.5"      style="fill:none;" />  </g></g></g>'}),QueenBlack:Ae.define("chess.QueenBlack",{size:{width:42,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#000000; stroke:none;">      <circle cx="6"    cy="12" r="2.75" />      <circle cx="14"   cy="9"  r="2.75" />      <circle cx="22.5" cy="8"  r="2.75" />      <circle cx="31"   cy="9"  r="2.75" />      <circle cx="39"   cy="12" r="2.75" />    </g>    <path       d="M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z"       style="stroke-linecap:butt; stroke:#000000;" />    <path       d="M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z"       style="stroke-linecap:butt;" />    <path       d="M 11,38.5 A 35,35 1 0 0 34,38.5"       style="fill:none; stroke:#000000; stroke-linecap:butt;" />    <path       d="M 11,29 A 35,35 1 0 1 34,29"       style="fill:none; stroke:#ffffff;" />    <path       d="M 12.5,31.5 L 32.5,31.5"       style="fill:none; stroke:#ffffff;" />    <path       d="M 11.5,34.5 A 35,35 1 0 0 33.5,34.5"       style="fill:none; stroke:#ffffff;" />    <path       d="M 10.5,37.5 A 35,35 1 0 0 34.5,37.5"       style="fill:none; stroke:#ffffff;" />  </g></g></g>'}),RookWhite:Ae.define("chess.RookWhite",{size:{width:32,height:34}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z "      style="stroke-linecap:butt;" />    <path      d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z "      style="stroke-linecap:butt;" />    <path      d="M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14"      style="stroke-linecap:butt;" />    <path      d="M 34,14 L 31,17 L 14,17 L 11,14" />    <path      d="M 31,17 L 31,29.5 L 14,29.5 L 14,17"      style="stroke-linecap:butt; stroke-linejoin:miter;" />    <path      d="M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5" />    <path      d="M 11,14 L 34,14"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />  </g></g></g>'}),RookBlack:Ae.define("chess.RookBlack",{size:{width:32,height:34}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z "      style="stroke-linecap:butt;" />    <path      d="M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z "      style="stroke-linecap:butt;" />    <path      d="M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z "      style="stroke-linecap:butt;" />    <path      d="M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z "      style="stroke-linecap:butt;stroke-linejoin:miter;" />    <path      d="M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z "      style="stroke-linecap:butt;" />    <path      d="M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z "      style="stroke-linecap:butt;" />    <path      d="M 12,35.5 L 33,35.5 L 33,35.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 13,31.5 L 32,31.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 14,29.5 L 31,29.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 14,16.5 L 31,16.5"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />    <path      d="M 11,14 L 34,14"      style="fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;" />  </g></g></g>'}),BishopWhite:Ae.define("chess.BishopWhite",{size:{width:38,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#ffffff; stroke:#000000; stroke-linecap:butt;">       <path        d="M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z" />      <path        d="M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z" />      <path        d="M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z" />    </g>    <path      d="M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18"      style="fill:none; stroke:#000000; stroke-linejoin:miter;" />  </g></g></g>'}),BishopBlack:Ae.define("chess.BishopBlack",{size:{width:38,height:38}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <g style="fill:#000000; stroke:#000000; stroke-linecap:butt;">       <path        d="M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z" />      <path        d="M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z" />      <path        d="M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z" />    </g>    <path       d="M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18"       style="fill:none; stroke:#ffffff; stroke-linejoin:miter;" />  </g></g></g>'}),KnightWhite:Ae.define("chess.KnightWhite",{size:{width:38,height:37}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18"      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10"      style="fill:#ffffff; stroke:#000000;" />    <path      d="M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z"      style="fill:#000000; stroke:#000000;" />    <path      d="M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z"      transform="matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)"      style="fill:#000000; stroke:#000000;" />  </g></g></g>'}),KnightBlack:Ae.define("chess.KnightBlack",{size:{width:38,height:37}},{markup:'<g class="rotatable"><g class="scalable"><g style="opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;">    <path      d="M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18"      style="fill:#000000; stroke:#000000;" />    <path      d="M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10"      style="fill:#000000; stroke:#000000;" />    <path      d="M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z"      style="fill:#ffffff; stroke:#ffffff;" />    <path      d="M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z"      transform="matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)"      style="fill:#ffffff; stroke:#ffffff;" />    <path      d="M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z "      style="fill:#ffffff; stroke:none;" />  </g></g></g>'}),PawnWhite:Ae.define("chess.PawnWhite",{size:{width:28,height:33}},{markup:'<g class="rotatable"><g class="scalable"><path d="M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z "  style="opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;" /></g></g>'}),PawnBlack:Ae.define("chess.PawnBlack",{size:{width:28,height:33}},{markup:'<g class="rotatable"><g class="scalable"><path d="M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z "  style="opacity:1; fill:#000000; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;" /></g></g>'})},Pn=Kt.define("erd.Entity",{size:{width:150,height:60},attrs:{".outer":{fill:"#2ECC71",stroke:"#27AE60","stroke-width":2,points:"100,0 100,60 0,60 0,0"},".inner":{fill:"#2ECC71",stroke:"#27AE60","stroke-width":2,points:"95,5 95,55 5,55 5,5",display:"none"},text:{text:"Entity","font-family":"Arial","font-size":14,"ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>'}),xi=Pn.define("erd.WeakEntity",{attrs:{".inner":{display:"auto"},text:{text:"Weak Entity"}}}),je=Kt.define("erd.Relationship",{size:{width:80,height:80},attrs:{".outer":{fill:"#3498DB",stroke:"#2980B9","stroke-width":2,points:"40,0 80,40 40,80 0,40"},".inner":{fill:"#3498DB",stroke:"#2980B9","stroke-width":2,points:"40,5 75,40 40,75 5,40",display:"none"},text:{text:"Relationship","font-family":"Arial","font-size":12,"ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon class="outer"/><polygon class="inner"/></g><text/></g>'}),ge=je.define("erd.IdentifyingRelationship",{attrs:{".inner":{display:"auto"},text:{text:"Identifying"}}}),Be=Kt.define("erd.Attribute",{size:{width:100,height:50},attrs:{ellipse:{transform:"translate(50, 25)"},".outer":{stroke:"#D35400","stroke-width":2,cx:0,cy:0,rx:50,ry:25,fill:"#E67E22"},".inner":{stroke:"#D35400","stroke-width":2,cx:0,cy:0,rx:45,ry:20,fill:"#E67E22",display:"none"},text:{"font-family":"Arial","font-size":14,"ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><ellipse class="outer"/><ellipse class="inner"/></g><text/></g>'}),Di=Be.define("erd.Multivalued",{attrs:{".inner":{display:"block"},text:{text:"multivalued"}}}),Hi=Be.define("erd.Derived",{attrs:{".outer":{"stroke-dasharray":"3,5"},text:{text:"derived"}}}),hi=Be.define("erd.Key",{attrs:{ellipse:{"stroke-width":4},text:{text:"key","font-weight":"800","text-decoration":"underline"}}}),Bi=Be.define("erd.Normal",{attrs:{text:{text:"Normal"}}}),Fi={__proto__:null,Entity:Pn,WeakEntity:xi,Relationship:je,IdentifyingRelationship:ge,Attribute:Be,Multivalued:Di,Derived:Hi,Key:hi,Normal:Bi,ISA:Kt.define("erd.ISA",{type:"erd.ISA",size:{width:100,height:50},attrs:{polygon:{points:"0,0 50,50 100,0",fill:"#F1C40F",stroke:"#F39C12","stroke-width":2},text:{text:"ISA","font-size":18,"ref-x":.5,"ref-y":.3,"y-alignment":"middle","text-anchor":"middle"}}},{markup:'<g class="rotatable"><g class="scalable"><polygon/></g><text/></g>'}),Line:Ke.define("erd.Line",{},{cardinality:function(t){this.set("labels",[{position:-20,attrs:{text:{dy:-8,text:t}}}])}})},Jh={__proto__:null,State:nn.define("fsa.State",{attrs:{circle:{"stroke-width":3},text:{"font-weight":"800"}}}),StartState:Kt.define("fsa.StartState",{size:{width:20,height:20},attrs:{circle:{transform:"translate(10, 10)",r:10,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><circle/></g></g>'}),EndState:Kt.define("fsa.EndState",{size:{width:20,height:20},attrs:{".outer":{transform:"translate(10, 10)",r:10,fill:"#ffffff",stroke:"#000000"},".inner":{transform:"translate(10, 10)",r:6,fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><circle class="outer"/><circle class="inner"/></g></g>'}),Arrow:Ke.define("fsa.Arrow",{attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z"}},smooth:!0})},$h={__proto__:null,Member:Kt.define("org.Member",{size:{width:180,height:70},attrs:{rect:{width:170,height:60},".card":{fill:"#FFFFFF",stroke:"#000000","stroke-width":2,"pointer-events":"visiblePainted",rx:10,ry:10},image:{width:48,height:48,ref:".card","ref-x":10,"ref-y":5},".rank":{"text-decoration":"underline",ref:".card","ref-x":.9,"ref-y":.2,"font-family":"Courier New","font-size":14,"text-anchor":"end"},".name":{"font-weight":"800",ref:".card","ref-x":.9,"ref-y":.6,"font-family":"Courier New","font-size":14,"text-anchor":"end"}}},{markup:'<g class="rotatable"><g class="scalable"><rect class="card"/><image/></g><text class="rank"/><text class="name"/></g>'}),Arrow:Ke.define("org.Arrow",{source:{selector:".card"},target:{selector:".card"},attrs:{".connection":{stroke:"#585858","stroke-width":3}},z:-1})},Pn={__proto__:null,Place:Ae.define("pn.Place",{size:{width:50,height:50},attrs:{".root":{r:25,fill:"#ffffff",stroke:"#000000",transform:"translate(25, 25)"},".label":{"text-anchor":"middle","ref-x":.5,"ref-y":-20,ref:".root",fill:"#000000","font-size":12},".tokens > circle":{fill:"#000000",r:5},".tokens.one > circle":{transform:"translate(25, 25)"},".tokens.two > circle:nth-child(1)":{transform:"translate(19, 25)"},".tokens.two > circle:nth-child(2)":{transform:"translate(31, 25)"},".tokens.three > circle:nth-child(1)":{transform:"translate(18, 29)"},".tokens.three > circle:nth-child(2)":{transform:"translate(25, 19)"},".tokens.three > circle:nth-child(3)":{transform:"translate(32, 29)"},".tokens.alot > text":{transform:"translate(25, 18)","text-anchor":"middle",fill:"#000000"}}},{markup:'<g class="rotatable"><g class="scalable"><circle class="root"/><g class="tokens" /></g><text class="label"/></g>'}),PlaceView:ee.extend({presentationAttributes:ee.addPresentationAttributes({tokens:["TOKENS"]}),initFlag:ee.prototype.initFlag.concat(["TOKENS"]),confirmUpdate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=(i=ee.prototype.confirmUpdate).call.apply(i,[this].concat(t));return this.hasFlag(i,"TOKENS")&&(this.renderTokens(),this.update(),i=this.removeFlag(i,"TOKENS")),i},renderTokens:function(){var t=this.vel.findOne(".tokens").empty(),e=(["one","two","three","alot"].forEach(function(i){t.removeClass(i)}),this.model.get("tokens"));if(e)switch(e){case 1:t.addClass("one"),t.append(X("circle"));break;case 2:t.addClass("two"),t.append([X("circle"),X("circle")]);break;case 3:t.addClass("three"),t.append([X("circle"),X("circle"),X("circle")]);break;default:t.addClass("alot"),t.append(X("text").text(e+""))}}}),Transition:Ae.define("pn.Transition",{size:{width:12,height:50},attrs:{rect:{width:12,height:50,fill:"#000000",stroke:"#000000"},".label":{"text-anchor":"middle","ref-x":.5,"ref-y":-20,ref:"rect",fill:"#000000","font-size":12}}},{markup:'<g class="rotatable"><g class="scalable"><rect class="root"/></g></g><text class="label"/>'}),Link:Ke.define("pn.Link",{attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z"}}})},xi=Ae.define("uml.Class",{attrs:{rect:{width:200},".uml-class-name-rect":{stroke:"black","stroke-width":2,fill:"#3498db"},".uml-class-attrs-rect":{stroke:"black","stroke-width":2,fill:"#2980b9"},".uml-class-methods-rect":{stroke:"black","stroke-width":2,fill:"#2980b9"},".uml-class-name-text":{ref:".uml-class-name-rect","ref-y":.5,"ref-x":.5,"text-anchor":"middle","y-alignment":"middle","font-weight":"bold",fill:"black","font-size":12,"font-family":"Times New Roman"},".uml-class-attrs-text":{ref:".uml-class-attrs-rect","ref-y":5,"ref-x":5,fill:"black","font-size":12,"font-family":"Times New Roman"},".uml-class-methods-text":{ref:".uml-class-methods-rect","ref-y":5,"ref-x":5,fill:"black","font-size":12,"font-family":"Times New Roman"}},name:[],attributes:[],methods:[]},{markup:['<g class="rotatable">','<g class="scalable">','<rect class="uml-class-name-rect"/><rect class="uml-class-attrs-rect"/><rect class="uml-class-methods-rect"/>',"</g>",'<text class="uml-class-name-text"/><text class="uml-class-attrs-text"/><text class="uml-class-methods-text"/>',"</g>"].join(""),initialize:function(){this.on("change:name change:attributes change:methods",function(){this.updateRectangles(),this.trigger("uml-update")},this),this.updateRectangles(),Ae.prototype.initialize.apply(this,arguments)},getClassName:function(){return this.get("name")},updateRectangles:function(){var t=this.get("attrs"),e=[{type:"name",text:this.getClassName()},{type:"attrs",text:this.get("attributes")},{type:"methods",text:this.get("methods")}],i=0;e.forEach(function(n){var r=Array.isArray(n.text)?n.text:[n.text],o=20*r.length+20;t[".uml-class-"+n.type+"-text"].text=r.join(`
`),t[".uml-class-"+n.type+"-rect"].height=o,t[".uml-class-"+n.type+"-rect"].transform="translate(0,"+i+")",i+=o})}}),je=ee.extend({initialize:function(){ee.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"uml-update",function(){this.update(),this.resize()})}}),ge=xi.define("uml.Abstract",{attrs:{".uml-class-name-rect":{fill:"#e74c3c"},".uml-class-attrs-rect":{fill:"#c0392b"},".uml-class-methods-rect":{fill:"#c0392b"}}},{getClassName:function(){return["<<Abstract>>",this.get("name")]}}),Be=je,Di=xi.define("uml.Interface",{attrs:{".uml-class-name-rect":{fill:"#f1c40f"},".uml-class-attrs-rect":{fill:"#f39c12"},".uml-class-methods-rect":{fill:"#f39c12"}}},{getClassName:function(){return["<<Interface>>",this.get("name")]}}),Hi={__proto__:null,Class:xi,ClassView:je,Abstract:ge,AbstractView:Be,Interface:Di,InterfaceView:je,Generalization:Ke.define("uml.Generalization",{attrs:{".marker-target":{d:"M 20 0 L 0 10 L 20 20 z",fill:"white"}}}),Implementation:Ke.define("uml.Implementation",{attrs:{".marker-target":{d:"M 20 0 L 0 10 L 20 20 z",fill:"white"},".connection":{"stroke-dasharray":"3,3"}}}),Aggregation:Ke.define("uml.Aggregation",{attrs:{".marker-target":{d:"M 40 10 L 20 20 L 0 10 L 20 0 z",fill:"white"}}}),Composition:Ke.define("uml.Composition",{attrs:{".marker-target":{d:"M 40 10 L 20 20 L 0 10 L 20 0 z",fill:"black"}}}),Association:Ke.define("uml.Association"),State:Ae.define("uml.State",{attrs:{".uml-state-body":{width:200,height:200,rx:10,ry:10,fill:"#ecf0f1",stroke:"#bdc3c7","stroke-width":3},".uml-state-separator":{stroke:"#bdc3c7","stroke-width":2},".uml-state-name":{ref:".uml-state-body","ref-x":.5,"ref-y":5,"text-anchor":"middle",fill:"#000000","font-family":"Courier New","font-size":14},".uml-state-events":{ref:".uml-state-separator","ref-x":5,"ref-y":5,fill:"#000000","font-family":"Courier New","font-size":14}},name:"State",events:[]},{markup:['<g class="rotatable">','<g class="scalable">','<rect class="uml-state-body"/>',"</g>",'<path class="uml-state-separator"/>','<text class="uml-state-name"/>','<text class="uml-state-events"/>',"</g>"].join(""),initialize:function(){this.on({"change:name":this.updateName,"change:events":this.updateEvents,"change:size":this.updatePath},this),this.updateName(),this.updateEvents(),this.updatePath(),Ae.prototype.initialize.apply(this,arguments)},updateName:function(){this.attr(".uml-state-name/text",this.get("name"))},updateEvents:function(){this.attr(".uml-state-events/text",this.get("events").join(`
`))},updatePath:function(){var t="M 0 20 L "+this.get("size").width+" 20";this.attr(".uml-state-separator/d",t,{silent:!0})}}),StartState:nn.define("uml.StartState",{type:"uml.StartState",attrs:{circle:{fill:"#34495e",stroke:"#2c3e50","stroke-width":2,rx:1}}}),EndState:Ae.define("uml.EndState",{size:{width:20,height:20},attrs:{"circle.outer":{transform:"translate(10, 10)",r:10,fill:"#ffffff",stroke:"#2c3e50"},"circle.inner":{transform:"translate(10, 10)",r:6,fill:"#34495e"}}},{markup:'<g class="rotatable"><g class="scalable"><circle class="outer"/><circle class="inner"/></g></g>'}),Transition:Ke.define("uml.Transition",{attrs:{".marker-target":{d:"M 10 0 L 0 5 L 10 10 z",fill:"#34495e",stroke:"#2c3e50"},".connection":{stroke:"#2c3e50"}}})},Cs={POINT:"point",CUBIC:"cubic",LINE:"line",GAP:"gap"},Df=Object.values(Cs),bd=["arc","gap","cubic"],xd=1,Bf=["smooth"],El=1/3,Ll=2/3;function wd(r,s){var i,n=r.x,r=r.y,o=s.x,s=s.y;return o<n&&(i=n,n=o,o=i,i=r,r=s,s=i),s<r&&(i=n,n=o,o=i,i=r,r=s,s=i),[new Q(n,r),new Q(o,s)]}function Kh(t,e,i){var n=[].concat(t,i,e);return n.reduce(function(r,o,s){var a=n[s+1];return a!=null&&(r[s]=Xn(o,a)),r},[])}function zf(t){var e,i=t.paper,n=i._jumpOverUpdateList;n==null&&(n=i._jumpOverUpdateList=[],(e=i.model).on("batch:stop",function(){if(!this.hasActiveBatch())for(var r=i._jumpOverUpdateList,o=0;o<r.length;o++){var s=r[o],a=s.getFlag(s.constructor.Flags.CONNECTOR);s.requestUpdate(a)}}),e.on("reset",function(){n=i._jumpOverUpdateList=[]})),n.indexOf(t)<0&&(n.push(t),t.listenToOnce(t.model,"change:connector remove",function(){n.splice(n.indexOf(t),1)}))}function Ad(t,e){return Xn(t,e).squaredLength()}function Cd(t,e,i,n){var r=new At,o=At.createSegment("M",t[0].start);return r.appendSegment(o),kt(t).forEach(function(s,a){var l,h,u,d,p,m,v;s.isJump?i==="arc"?(p=-90,h=s.start.difference(s.end),+(h.x<0||h.x===0&&h.y<0)&&(p+=180),u=s.midpoint(),d=new Ot(u,s.end).rotate(u,p),m=(l=new Ot(s.start,u)).pointAt(2/3).rotate(s.start,p),v=d.pointAt(1/3).rotate(d.end,-p),o=At.createSegment("C",m,v,d.end),r.appendSegment(o),l=new Ot(u,s.end),m=d.pointAt(1/3).rotate(d.end,p),v=l.pointAt(1/3).rotate(s.end,-p),o=At.createSegment("C",m,v,s.end),r.appendSegment(o)):i==="gap"?(o=At.createSegment("M",s.end),r.appendSegment(o)):i==="cubic"&&(p=s.start.theta(s.end),u=.6*e,d=1.35*e,h=s.start.difference(s.end),+(h.x<0||h.x===0&&h.y<0)&&(d*=-1),m=Q(s.start.x+u,s.start.y+d).rotate(s.start,p),v=Q(s.end.x-u,s.end.y+d).rotate(s.end,p),o=At.createSegment("C",m,v,s.end),r.appendSegment(o)):(l=t[a+1],n==0||!l||l.isJump?(o=At.createSegment("L",s.end),r.appendSegment(o)):(h=n,u=r,d=s.end,p=s.start,m=l.end,v=d.distance(p)/2,a=d.distance(m)/2,v=-Math.min(h,v),h=-Math.min(h,a),a=d.clone().move(p,v).round(),p=d.clone().move(m,h).round(),v=new Q(El*a.x+Ll*d.x,Ll*d.y+El*a.y),m=new Q(El*p.x+Ll*d.x,Ll*d.y+El*p.y),h=At.createSegment("L",a),u.appendSegment(h),h=At.createSegment("C",v,m,p),u.appendSegment(h)))}),r}function Id(t,e,i,o){var r=(o=o===void 0?{}:o).radius,o=o.raw;return Uh(t,e,i=i===void 0?[]:i,{cornerType:"cubic",cornerRadius:r=r===void 0?10:r,precision:0,raw:o})}function Qh(t,e,i,h,r){i===void 0&&(i=[]),h===void 0&&(h={});var o=!!h.raw,s=h.direction,a=(s===void 0&&(s=Wn.AUTO),h.precision),l=(a===void 0&&(a=3),{coeff:h.distanceCoefficient||.6,angleTangentCoefficient:h.angleTangentCoefficient||80,tau:h.tension||.5,sourceTangent:h.sourceTangent?new Q(h.sourceTangent):null,targetTangent:h.targetTangent?new Q(h.targetTangent):null,rotate:!!h.rotate}),h=(typeof h.sourceDirection=="string"?l.sourceDirection=h.sourceDirection:typeof h.sourceDirection=="number"?l.sourceDirection=new Q(1,0).rotate(null,h.sourceDirection):l.sourceDirection=h.sourceDirection?new Q(h.sourceDirection).normalize():null,typeof h.targetDirection=="string"?l.targetDirection=h.targetDirection:typeof h.targetDirection=="number"?l.targetDirection=new Q(1,0).rotate(null,h.targetDirection):l.targetDirection=h.targetDirection?new Q(h.targetDirection).normalize():null,[t].concat(i,[e]).map(function(u){return new Q(u)}));return e=l.sourceTangent||(t=function(u,d,p,m){if(m.sourceDirection)switch(m.sourceDirection){case en.UP:return new Q(0,-1);case en.DOWN:return new Q(0,1);case en.LEFT:return new Q(-1,0);case en.RIGHT:return new Q(1,0);case en.AUTO:return Md(u,d,m);case en.CLOSEST_POINT:return kd(0,d);case en.OUTWARDS:return Nd(u,d);default:return m.sourceDirection}switch(p){case Wn.HORIZONTAL:return function(v,k,I){var N,G=v.sourceBBox;{var F;v=v.sourceView?(N=v.sourceView.model.angle(),I.rotate&&N?(v=v.sourceView.getNodeUnrotatedBBox(v.sourceView.el),(F=k[0].clone()).rotate(G.center(),N),v.sideNearestToPoint(F)):G.sideNearestToPoint(k[0])):G.x>k[1].x?"right":"left"}return F=new Q(v==="left"?-1:1,0),I.rotate&&N&&F.rotate(null,-N),F}(u,d,m);case Wn.VERTICAL:return function(v,k,I){var N,G=v.sourceBBox;{var F;v=v.sourceView?(N=v.sourceView.model.angle(),I.rotate&&N?(v=v.sourceView.getNodeUnrotatedBBox(v.sourceView.el),(F=k[0].clone()).rotate(G.center(),N),v.sideNearestToPoint(F)):G.sideNearestToPoint(k[0])):G.y>k[1].y?"bottom":"top"}return F=new Q(0,v==="top"?-1:1),I.rotate&&N&&F.rotate(null,-N),F}(u,d,m);case Wn.CLOSEST_POINT:return kd(0,d);case Wn.OUTWARDS:return Nd(u,d);default:return Wn.AUTO,Md(u,d,m)}}(r,h,s,l),i=h[0].distance(h[1])*l.coeff,(e=qh(t,h[1].difference(h[0]).normalize()))>Math.PI/4?(e=i+(e-Math.PI/4)*l.angleTangentCoefficient,t.clone().scale(e,e)):t.clone().scale(i,i)),s=l.targetTangent||(t=function(u,d,p,m){if(m.targetDirection)switch(m.targetDirection){case en.UP:return new Q(0,-1);case en.DOWN:return new Q(0,1);case en.LEFT:return new Q(-1,0);case en.RIGHT:return new Q(1,0);case en.AUTO:return Sd(u,d,m);case en.CLOSEST_POINT:return Td(0,d);case en.OUTWARDS:return Pd(u,d);default:return m.targetDirection}switch(p){case Wn.HORIZONTAL:return function(v,k,I){var N,G=v.targetBBox;{var F;v=v.targetView?(N=v.targetView.model.angle(),I.rotate&&N?(v=v.targetView.getNodeUnrotatedBBox(v.targetView.el),(F=k[k.length-1].clone()).rotate(G.center(),N),v.sideNearestToPoint(F)):G.sideNearestToPoint(k[k.length-1])):G.x>k[k.length-2].x?"left":"right"}return F=new Q(v==="left"?-1:1,0),I.rotate&&N&&F.rotate(null,-N),F}(u,d,m);case Wn.VERTICAL:return function(v,k,I){var N,G=v.targetBBox;{var F;v=v.targetView?(N=v.targetView.model.angle(),I.rotate&&N?(v=v.targetView.getNodeUnrotatedBBox(v.targetView.el),(F=k[k.length-1].clone()).rotate(G.center(),N),v.sideNearestToPoint(F)):G.sideNearestToPoint(k[k.length-1])):G.y>k[k.length-2].y?"top":"bottom"}return F=new Q(0,v==="top"?-1:1),I.rotate&&N&&F.rotate(null,-N),F}(u,d,m);case Wn.CLOSEST_POINT:return Td(0,d);case Wn.OUTWARDS:return Pd(u,d);default:return Wn.AUTO,Sd(u,d,m)}}(r,h,s,l),r=h[(i=h.length-1)-1].distance(h[i])*l.coeff,(s=qh(t,h[i-1].difference(h[i]).normalize()))>Math.PI/4?(i=r+(s-Math.PI/4)*l.angleTangentCoefficient,t.clone().scale(i,i)):t.clone().scale(r,r)),i=function(u,d,p,m){for(var v=m.tau,k=m.coeff,I=[],N=[],G=[],F=u.length-1,H=0;H<F;H++)I[H]=u[H].distance(u[H+1]);N[0]=d,N[F]=p;for(var Y=1;Y<F;Y++){var tt=void 0,O=void 0,tt=(tt=Y===1?u[Y-1].clone().offset(N[Y-1].x,N[Y-1].y):u[Y-1].clone(),O=Y===F-1?u[Y+1].clone().offset(N[Y+1].x,N[Y+1].y):u[Y+1].clone(),tt.difference(u[Y]).normalize()),O=O.difference(u[Y]).normalize(),b=qh(tt,O),_=(Math.PI-b)/2,K=void 0,tt=Ed(tt,O),vt=void 0,tt=(vt=Ed(u[Y].difference(u[Y+1]),u[Y].difference(u[Y-1])),tt<0&&(_=-_),b<Math.PI/2&&(_<0&&vt<0||0<_&&0<vt)&&(_-=Math.PI),function(f,Z){var C=Math.cos(Z),Z=Math.sin(Z),D=C*f.x-Z*f.y,Z=Z*f.x+C*f.y;f.x=D,f.y=Z}(K=O.clone(),_),K.clone()),b=K.clone(),vt=I[Y-1]*k,O=I[Y]*k;tt.scale(vt,vt),b.scale(O,O),N[Y]=[tt,b]}for(var M=0;M<F;M++){var T=void 0,j=void 0;T=M===0?u[M+1].difference(N[M].x/v,N[M].y/v):u[M+1].difference(N[M][1].x/v,N[M][1].y/v),j=M===F-1?u[M].clone().offset(N[M+1].x/v,N[M+1].y/v):u[M].difference(N[M+1][0].x/v,N[M+1][0].y/v),G[M]=[T,u[M],u[M+1],j]}return G}(h,e,s,l).map(function(u){return u=u,d=(d=l).tau,(p=new Q).x=u[1].x+(u[2].x-u[0].x)/(6*d),p.y=u[1].y+(u[2].y-u[0].y)/(6*d),(m=new Q).x=u[2].x+(u[3].x-u[1].x)/(6*d),m.y=u[2].y+(u[3].y-u[1].y)/(6*d),new $t(u[1],p,m,u[2]);var d,p,m}),t=new At(i).round(a),o?t:t.serialize()}var Wn={AUTO:"auto",HORIZONTAL:"horizontal",VERTICAL:"vertical",CLOSEST_POINT:"closest-point",OUTWARDS:"outwards"},en={UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right",AUTO:"auto",CLOSEST_POINT:"closest-point",OUTWARDS:"outwards"};function Md(t,e,i){var n,r,o,s=t.sourceBBox;switch(t.sourceView?(r=t.sourceView.model.angle(),i.rotate&&r?(t=t.sourceView.getNodeUnrotatedBBox(t.sourceView.el),(n=e[0].clone()).rotate(s.center(),r),t.sideNearestToPoint(n)):s.sideNearestToPoint(e[0])):s.sideNearestToPoint(e[1])){case"top":o=new Q(0,-1);break;case"bottom":o=new Q(0,1);break;case"right":o=new Q(1,0);break;case"left":o=new Q(-1,0)}return i.rotate&&r&&o.rotate(null,-r),o}function Sd(t,e,i){var n,r,o,s=t.targetBBox;switch(t.targetView?(r=t.targetView.model.angle(),i.rotate&&r?(t=t.targetView.getNodeUnrotatedBBox(t.targetView.el),(n=e[e.length-1].clone()).rotate(s.center(),r),t.sideNearestToPoint(n)):s.sideNearestToPoint(e[e.length-1])):s.sideNearestToPoint(e[e.length-2])){case"top":o=new Q(0,-1);break;case"bottom":o=new Q(0,1);break;case"right":o=new Q(1,0);break;case"left":o=new Q(-1,0)}return i.rotate&&r&&o.rotate(null,-r),o}function kd(t,e){return e[1].difference(e[0]).normalize()}function Td(t,e){var i=e.length-1;return e[i-1].difference(e[i]).normalize()}function Nd(t,e){return t=t.sourceBBox.center(),e[0].difference(t).normalize()}function Pd(t,e){return t=t.targetBBox.center(),e[e.length-1].difference(t).normalize()}function qh(t,e){return t=t.dot(e)/(t.magnitude()*e.magnitude()),1<(t=t<-1?-1:t)&&(t=1),Math.acos(t)}function Ed(t,e){return t.x*e.y-t.y*e.x}Qh.Directions=Wn,Qh.TangentDirections=en;var Ld={__proto__:null,straight:Uh,jumpover:function(t,e,i,I){zf(this);var r,o,s,a,l,h,u=I.raw,d=I.size||5,p=I.jump&&(""+I.jump).toLowerCase(),m=I.radius||0,v=I.ignoreConnectors||Bf,k=(bd.indexOf(p)===-1&&(p=bd[0]),this.paper),I=k.model.getLinks();return I.length===1?Cd(Kh(t,e,i),d,p,m):(r=this.model,o=I.indexOf(r),s=k.options.defaultConnector||{},I=(a=I.filter(function(N,G){return N=N.get("connector")||s,!kt(v).includes(N.name)&&(!(o<G)||N.name!=="jumpover")})).map(function(N){return k.findViewByModel(N)}),l=Kh(t,e,i),h=I.map(function(N){return N==null?[]:N===this?l:Kh(N.sourcePoint,N.targetPoint,N.route)},this),t=Cd(l.reduce(function(N,G){var F,H,Y,_=a.reduce(function(K,tt,b){var vt;return tt!==r&&(-1<(b=(tt=h[b].slice()).findIndex(function(O){return O=O,M=wd((M=G).start,M.end),T=(j=M[0]).x,j=j.y,f=(M=M[1]).x,M=M.y,O=wd(O.start,O.end),x=(C=O[0]).x,C=C.y,D=(O=O[1]).x,O=O.y,T<=D&&x<=f&&j<=O&&C<=M;var M,T,j,f,x,C,D}))&&G.containsPoint(tt[b].end)&&tt.splice(b+1,1),vt=G,b=kt(tt).reduce(function(O,M){return M=vt.intersection(M),M&&O.push(M),O},[]),K.push.apply(K,b)),K},[]).sort(function(K,tt){return Ad(G.start,K)-Ad(G.start,tt)});return 0<_.length?N.push.apply(N,(F=G,Y=d,(H=_).reduce(function(K,tt,b){if(tt.skip!==!0){var vt=K.pop()||F,O=se(tt).move(vt.start,-Y),tt=se(tt).move(vt.start,+Y),b=H[b+1];if(b!=null){var M=tt.distance(b);M<=Y&&(tt=b.move(vt.start,M),b.skip=!0)}else if(O.distance(vt.end)<2*Y+xd)return K.push(vt),K;tt.distance(vt.start)<2*Y+xd?K.push(vt):((M=Xn(O,tt)).isJump=!0,K.push(Xn(vt.start,O),M,Xn(tt,vt.end)))}return K},[]))):N.push(G),N},[]),d,p,m),u?t:t.serialize())},normal:function(t,e,i,n){return n=(n=n===void 0?{}:n).raw,Uh(t,e,i=i===void 0?[]:i,{cornerType:"point",raw:n})},rounded:Id,smooth:function(t,e,i,s){var r,o,s=s&&s.raw;return i&&i.length!==0?(i=[t].concat(i).concat([e]),i=$t.throughPoints(i),r=new At(i)):(r=new At,i=At.createSegment("M",t),r.appendSegment(i),i=Math.abs(t.x-e.x)>=Math.abs(t.y-e.y)?(o=(t.x+e.x)/2,At.createSegment("C",o,t.y,o,e.y,e.x,e.y)):(o=(t.y+e.y)/2,At.createSegment("C",t.x,o,e.x,o,e.x,e.y)),r.appendSegment(i)),s?r:r.serialize()},curve:Qh},hi=Fn.extend({tagName:"path",className:"highlight-stroke",attributes:{"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"},options:{padding:3,rx:0,ry:0,useFirstSubpath:!1,attrs:{"stroke-width":3,stroke:"#FEB663"}},getPathData:function(t,e){var i=this.options,n=i.useFirstSubpath;try{var r,o=X(e);s=o.convertToPathData().trim(),o.tagName()!=="PATH"||!n||0<(r=s.search(/.M/i)+1)&&(s=s.substr(0,r))}catch{var o=t.getNodeBoundingRect(e),s=X.rectToPath(ct({},i,o.toJSON()))}return s},highlightConnection:function(t){this.vel.attr("d",t.getSerializedConnection())},highlightNode:function(t,e){var i,n,r,o=this.vel,a=this.options,s=a.padding,a=a.layer,l=this.getNodeMatrix(t,e);s&&(a||e!==t.el||o.remove(),i=(a=t.getNodeBoundingRect(e)).x+a.width/2,n=a.y+a.height/2,a=X.transformRect(a,l),r=Math.max(a.width,1),a=Math.max(a.height,1),a=X.createSVGMatrix({a:r=(r+s)/r,b:0,c:0,d:s=(a+s)/a,e:i-r*i,f:n-s*n}),l=l.multiply(a)),o.attr({d:this.getPathData(t,e),transform:X.matrixToTransformString(l)})},highlight:function(t,e){var i=this.vel,n=this.options;i.attr(n.attrs),t.isNodeConnection(e)?this.highlightConnection(t):this.highlightNode(t,e)}}),Bi=Fn.extend({tagName:"rect",className:"highlight-mask",attributes:{"pointer-events":"none"},options:{padding:3,maskClip:20,deep:!1,attrs:{stroke:"#FEB663","stroke-width":3,"stroke-linecap":"butt","stroke-linejoin":"miter"}},VISIBLE:"white",INVISIBLE:"black",MASK_ROOT_ATTRIBUTE_BLACKLIST:["marker-start","marker-end","marker-mid","transform","stroke-dasharray","class"],MASK_CHILD_ATTRIBUTE_BLACKLIST:["stroke","fill","stroke-width","stroke-opacity","stroke-dasharray","fill-opacity","marker-start","marker-end","marker-mid","class"],MASK_REPLACE_TAGS:["FOREIGNOBJECT","IMAGE","USE","TEXT","TSPAN","TEXTPATH"],MASK_REMOVE_TAGS:["TEXT","TSPAN","TEXTPATH"],transformMaskChild:function(t,e){var i,n,r=this.MASK_CHILD_ATTRIBUTE_BLACKLIST,o=this.MASK_REPLACE_TAGS,s=this.MASK_REMOVE_TAGS,a=e.tagName();return!X.isSVGGraphicsElement(e)||s.includes(a)?(e.remove(),!1):o.includes(a)?((s=t.vel.findOne("#"+e.id))&&(o=s.node,a=t.getNodeBoundingRect(o),t.model.isElement()&&(a=X.transformRect(a,t.getNodeMatrix(o))),t=X("rect",a.toJSON()),a=(o=a.center()).x,o=o.y,i=(s=s.rotate()).angle,(n=s.cx)===void 0&&(n=a),(a=s.cy)===void 0&&(a=o),i&&t.rotate(i,n,a),e.parent().append(t)),e.remove(),!1):(r.forEach(function(l){l==="fill"&&e.attr("fill")==="none"||e.removeAttr(l)}),!0)},transformMaskRoot:function(t,e){this.MASK_ROOT_ATTRIBUTE_BLACKLIST.forEach(function(i){e.removeAttr(i)})},getMaskShape:function(t,e){var i=this,r=this.options,n=this.MASK_REPLACE_TAGS,r=r.deep,o=e.tagName();if(o==="G"){if(!r)return null;for(var s=e.clone(),a=function(u){return i.transformMaskChild(t,u)},l=s.children();0<l.length;){var h=l.shift();a(h)&&l.push.apply(l,h.children())}}else{if(n.includes(o))return null;s=e.clone()}return this.transformMaskRoot(t,s),s},getMaskId:function(){return"highlight-mask-"+this.cid},getMask:function(t,e){var i=this.VISIBLE,n=this.INVISIBLE,r=this.options,a=r.padding,r=r.attrs,l="stroke-width"in r?r["stroke-width"]:1,o=e.attr("fill")!=="none",s=parseFloat(e.attr("stroke-width")),s=(s=isNaN(s)?1:s)+2*a,a=s+2*l,l=this.getMaskShape(t,e);return l||((t=t.getNodeBoundingRect(e.node)).inflate(t.width?0:.5,t.height?0:.5),l=X("rect",t.toJSON())),l.attr(r),X("mask",{id:this.getMaskId()}).append([l.clone().attr({fill:o?i:"none",stroke:i,"stroke-width":a}),l.clone().attr({fill:o?n:"none",stroke:n,"stroke-width":s})])},removeMask:function(t){var e=t.svg.getElementById(this.getMaskId());e&&t.defs.removeChild(e)},addMask:function(t,e){t.defs.appendChild(e.node)},highlight:function(t,e){var r=this.options,i=this.vel,o=r.padding,n=r.attrs,s=r.maskClip,r=(s===void 0&&(s=20),r.layer),n="stroke"in n?n.stroke:"#000000",r=(r||e!==t.el||i.remove(),t.getNodeBoundingRect(e).inflate(o+s)),o=this.getNodeMatrix(t,e),s=this.getMask(t,X(e));this.addMask(t.paper,s),i.attr(r.toJSON()),i.attr({transform:X.matrixToTransformString(o),mask:"url(#"+s.id+")",fill:n})},unhighlight:function(t){this.removeMask(t.paper)}}),xi=Fn.extend({UPDATABLE:!1,MOUNTABLE:!1,opacityClassName:Ui("highlight-opacity"),highlight:function(t,e){X(e).addClass(this.opacityClassName)},unhighlight:function(t,e){X(e).removeClass(this.opacityClassName)}}),ge=Ui("highlighted"),Be=Fn.extend({UPDATABLE:!1,MOUNTABLE:!1,options:{className:ge},highlight:function(t,e){X(e).addClass(this.options.className)},unhighlight:function(t,e){X(e).removeClass(this.options.className)}},{className:ge}),tc={ROW:"row",COLUMN:"column"},Di={__proto__:null,stroke:hi,mask:Bi,opacity:xi,addClass:Be,list:Fn.extend({tagName:"g",MOUNTABLE:!0,UPDATE_ATTRIBUTES:function(){return[this.options.attribute]},_prevItems:null,highlight:function(n,e){var i=this,n=n.model,v=this.options,r=v.attribute,m=v.size,o=(m===void 0&&(m=20),v.gap),v=(o===void 0&&(o=5),v.direction);if(v===void 0&&(v=tc.ROW),!r)throw new Error("List: attribute is required");var s,a=typeof m=="number"?{width:m,height:m}:m,l=v===tc.ROW,h=l?a.width:a.height,u=n.get(r),d=(Array.isArray(u)||(u=[]),this._prevItems||[]),p=u.map(function(k,I){return yt(d[I],u[I])}),v=(d.length===u.length&&!p.some(function(k){return!k})||(s=this.vel.children(),m=u.map(function(k,I){var N=I in s?s[I].node:null;if(p[I])return N;if(k=i.createListItem(k,a,N),!k)return null;if(!(k instanceof SVGElement))throw new Error("List: item must be an SVGElement");return k.dataset.index=I,k.dataset.attribute=r,N=I*(h+o),k.setAttribute("transform",l?"translate("+N+", 0)":"translate(0, "+N+")"),k}),this.vel.empty().append(m),this._prevItems=u),u.length),m=v===0?0:v*h+(v-1)*o,v=l?{width:m,height:a.height}:{width:a.width,height:m};this.position(n,v)},position:function(r,e){var i=this.vel,n=this.options,l=n.margin;l===void 0&&(l=5),(n=n.position)===void 0&&(n="top-left");var r=r.size(),h=r.width,r=r.height,l=ti(l),o=l.left,s=l.right,a=l.top,l=l.bottom,h=Ro(new nt(o,a,h-(o+s),r-(a+l)),n),u=h.x,d=h.y;switch(n){case li.CENTER:case li.TOP:case li.BOTTOM:u-=e.width/2;break;case li.RIGHT:case li.BOTTOM_RIGHT:case li.TOP_RIGHT:u-=e.width}switch(n){case li.CENTER:case li.RIGHT:case li.LEFT:d-=e.height/2;break;case li.BOTTOM:case li.BOTTOM_RIGHT:case li.BOTTOM_LEFT:d-=e.height}i.attr("transform","translate("+u+", "+d+")")}},{Directions:tc,Positions:li})};function Dl(t,e,i){var n,r;return ve(i)&&(n=i.x,r=i.y,isFinite(r)&&(e=(r=new Ot(e,t).parallel(r)).start,t=r.end),i=n),!isFinite(i)||(r=t.distance(e),i===0&&0<r)?t:t.move(e,-Math.min(i,r-1))}function ec(t){return t=t.getAttribute("stroke-width"),t!==null&&parseFloat(t)||0}function Dd(t,e,i,n){return e=e.getNodeBBox(i),n.stroke&&e.inflate(ec(i)/2),i=t.intersect(e),Dl(i?t.start.chooseClosest(i):t.end,t.start,n.offset)}var ic="segmentSubdivisons",nc="shapeBBox";je={__proto__:null,anchor:function(t,e,i,n){var r=n.offset,o=n.alignOffset;return(n=n.align)&&function(s,a,l){l===void 0&&(l=0);var h,u,d,p,m=s.start,v=s.end;switch(a){case"left":h="x",u=v,d=m,p=-1;break;case"right":h="x",u=m,d=v,p=1;break;case"top":h="y",u=v,d=m,p=-1;break;case"bottom":h="y",u=m,d=v,p=1;break;default:return}m[h]<v[h]?u[h]=d[h]:d[h]=u[h],isFinite(l)&&(u[h]+=p*l,d[h]+=p*l)}(t,n,o),Dl(t.end,t.start,r)},bbox:Dd,rectangle:function(t,e,i,n){var r,o=e.model.angle();return o===0?Dd(t,e,i,n):(e=e.getNodeUnrotatedBBox(i),n.stroke&&e.inflate(ec(i)/2),i=e.center(),Dl((e=(r=t.clone().rotate(i,o)).setLength(1e6).intersect(e))?r.start.chooseClosest(e).rotate(i,-o):t.end,t.start,n.offset))},boundary:function(t,d,a,n){var o=n.selector,r=t.end,o=typeof o=="string"?d.findBySelector(o)[0]:o===!1?a:Array.isArray(o)?Vi(a,o):function(p){if(!p)return null;var m=p;do{var v=m.tagName;if(typeof v!="string")return null;if((v=v.toUpperCase())==="G")m=m.firstElementChild;else{if(v!=="TITLE")break;m=m.nextElementSibling}}while(m);return m}(a);if(!X.isSVGGraphicsElement(o)){if(o===a||!X.isSVGGraphicsElement(a))return r;o=a}var s,a=d.getNodeShape(o),l=d.getNodeMatrix(o),h=d.getRootTranslateMatrix(),u=d.getRootRotateMatrix(),u=(h=h.multiply(u).multiply(l)).inverse(),u=(l=X.transformLine(t,u)).start.clone(),d=d.getNodeData(o);return n.insideout===!1&&(d[nc]||(d[nc]=a.bbox()),d[nc].containsPoint(u))?r:(a instanceof At&&(s=n.precision||2,d[ic]||(d[ic]=a.getSegmentSubdivisions({precision:s})),s={precision:s,segmentSubdivisions:d[ic]}),n.extrapolate===!0&&l.setLength(1e6),(d=l.intersect(a,s))?X.isArray(d)&&(d=u.chooseClosest(d)):n.sticky===!0&&(d=a instanceof nt?a.pointNearestToPoint(u):a instanceof We?a.intersectionWithLineFromCenterToPoint(u):a.closestPoint(u,s)),l=d?X.transformPoint(d,h):r,a=n.offset||0,n.stroke&&(a+=ec(o)/2),Dl(l,t.start,a))}};function Bd(t,e){return e===0?"0%":Math.round(t/e*100*1e3)/1e3+"%"}function zd(t){return function(e,i,n,r){return(i.isNodeConnection(n)?Rf:Of)(t,e,i,n,r)}}function Of(t,e,s,o,r){var a=s.model.angle(),o=s.getNodeUnrotatedBBox(o),s=s.model.getBBox().center(),s=(r.rotate(s,a),r.x-o.x),a=r.y-o.y;return t&&(s=Bd(s,o.width),a=Bd(a,o.height)),e.anchor={name:"topLeft",args:{dx:s,dy:a,rotate:!0}},e}function Rf(t,e,i,n,r){return i=i.getConnection(),i&&(r=i.closestPointLength(r),t?(t=i.length(),e.anchor={name:"connectionRatio",args:{ratio:r/t}}):e.anchor={name:"connectionLength",args:{length:r}}),e}var nn=zd(!1),Od=zd(!0),ge={__proto__:null,useDefaults:zo,pinAbsolute:nn,pinRelative:Od},jf={N:"S",S:"N",E:"W",W:"E"},Gf={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function Bl(t,e,i){var n=new Q(t.x,e.y);return n=i.containsPoint(n)?new Q(e.x,t.y):n}function rc(t,e){return t[e==="W"||e==="E"?"width":"height"]}function dn(t,e){return t.x===e.x?t.y>e.y?"N":"S":t.y===e.y?t.x>e.x?"W":"E":null}function zl(t){return new nt(t.x,t.y,0,0)}function Ol(t){return t=ti(t.padding||t.elementPadding||20),{x:-t.left,y:-t.top,width:t.left+t.right,height:t.top+t.bottom}}function Rd(t,e){return t.sourceBBox.clone().moveAndExpand(Ol(e))}function jd(t,e){return t.targetBBox.clone().moveAndExpand(Ol(e))}function Gd(o,e,i){var n=new Q(o.x,e.y),r=new Q(e.x,o.y),a=dn(o,n),o=dn(o,r),s=jf[i],a=a===i||a!==s&&(o===s||o!==i)?n:r;return{points:[a],direction:dn(a,e)}}function Rl(t,e,i){return t=Bl(t,e,i),{points:[t],direction:dn(t,e)}}function oc(h,e,s,a,d){var o={},s=s.union(a).inflate(1),a=s.center().distance(e)>s.center().distance(h),l=a?e:h,h=a?h:e,u=d?(u=Q.fromPolar(s.width+s.height,Gf[d],l),s.pointNearestToPoint(u).move(u,-1)):s.pointNearestToPoint(l).move(l,1),d=Bl(u,h,s);return u.round().equals(d.round())?(d=Q.fromPolar(s.width+s.height,Qe(u.theta(l))+Math.PI/2,h),l=Bl(u,d=s.pointNearestToPoint(d).move(h,1).round(),s),o.points=a?[d,l,u]:[u,l,d]):o.points=a?[d,u]:[u,d],o.direction=dn(a?u:d,e),o}function sc(t,e,s){var n,r,a=Rd(s,e),l=jd(s,e),o=(n=e,(o=s).sourceAnchor||Rd(o,n).center()),s=(n=e,(s=s).targetAnchor||jd(s,n).center()),a=a.union(zl(o)),l=l.union(zl(s));(t=kt(t).map(Q)).unshift(o),t.push(s);for(var h,u,d,p,m,v,k=[],I=0,N=t.length-1;I<N;I++){var G,F=null,H=t[I],Y=t[I+1],_=!!dn(H,Y);I===0?I+1===N?a.intersect(l.clone().inflate(1))?F=oc(H,Y,a,l):_||(u=a,v=m=p=void 0,m=Rl(G=Y,h=H,d=l),v=m.points[0],u.containsPoint(v)&&(p=(m=Rl(h,G,u)).points[0],d.containsPoint(p)&&(p=new Q(h).move(p,-rc(u,dn(h,p))/2),d=new Q(G).move(v,-rc(d,dn(G,v))/2),d=Gd(v=new Ot(p,d).midpoint(),G,(p=Rl(h,v,u)).direction),m.points=[p.points[0],d.points[0]],m.direction=d.direction)),F=m):a.containsPoint(Y)?F=oc(H,Y,a,zl(Y).moveAndExpand(Ol(e))):_||(F=Rl(H,Y,a)):I+1===N?(G=_&&dn(Y,H)===r,l.containsPoint(H)||G?F=oc(H,Y,zl(H).moveAndExpand(Ol(e)),l,r):_||(F=function(K,tt,b,vt){var O,M={},T=[new Q(K.x,tt.y),new Q(tt.x,K.y)],j=T.filter(function(x){return!b.containsPoint(x)}),f=j.filter(function(x){return dn(x,K)!==vt});return 0<f.length?(O=(O=f.filter(function(x){return dn(K,x)===vt}).pop())||f[0],M.points=[O],M.direction=dn(O,tt)):(O=Oh(T,j)[0],T=Bl(f=new Q(tt).move(O,-rc(b,vt)/2),K,b),M.points=[T,f],M.direction=dn(f,tt)),M}(H,Y,l,r))):_||(F=Gd(H,Y,r)),r=F?(Array.prototype.push.apply(k,F.points),F.direction):dn(H,Y),I+1<N&&k.push(Y)}return k}var Vd={step:10,maximumLoops:2e3,precision:1,maxAllowedDirectionChange:90,perpendicular:!0,excludeEnds:[],excludeTypes:["basic.Text"],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost:function(){return this.step},directions:function(){var t=this.step,e=this.cost();return[{offsetX:t,offsetY:0,cost:e},{offsetX:-t,offsetY:0,cost:e},{offsetX:0,offsetY:t,cost:e},{offsetX:0,offsetY:-t,cost:e}]},penalties:function(){return{0:0,45:this.step/2,90:this.step/2}},paddingBox:function(){var t=this.step;return{x:-t,y:-t,width:2*t,height:2*t}},isPointObstacle:null,fallbackRouter:function(t,e,i){if(Rt(sc))return sc(t,ct({},Vd,e),i);throw new Error("Manhattan requires the orthogonal router as default fallback.")},fallbackRoute:function(t,e,i){return null},draggingRoute:null};function ac(t){this.map={},this.options=t,this.mapGridSize=100}function jo(){this.items=[],this.hash={},this.values={},this.OPEN=1,this.CLOSE=2}function Zd(t,e){return e&&e.paddingBox?t.sourceBBox.clone().moveAndExpand(e.paddingBox):t.sourceBBox.clone()}function Fd(t,e){return e&&e.paddingBox?t.targetBBox.clone().moveAndExpand(e.paddingBox):t.targetBBox.clone()}function _d(t,e){return t.sourceAnchor||Zd(t,e).center()}function lc(t,h,a,l,r){var o,s,a=360/a,l=t.theta((h=h,o=l,r=(r=r).step,s=h.x-t.x,h=h.y-t.y,s/=l.x,h/=l.y,o=s*r,s=h*r,new Q(t.x+o,t.y+s))),h=Xe(l+a/2);return a*Math.floor(h/a)}function Wd(t,e){return t=Math.abs(t-e),180<t?360-t:t}function Yd(t,e){var i;return t?(t=Math.abs(t),(i=Math.round(t/e))?e+(t-i*e)/i:t):e}function ya(t,e){return t.round(e)}function jl(t,e,i){return ya((t=t.clone(),n=(e=e).source,r=Ce(t.x-n.x,e.x)+n.x,t=Ce(t.y-n.y,e.y)+n.y,new Q(r,t)),i);var n,r}function ba(t){return t.clone().toString()}function hc(t){return new Q(t.x===0?0:Math.abs(t.x)/t.x,t.y===0?0:Math.abs(t.y)/t.y)}function Ud(t,e){for(var i=1/0,n=0,r=e.length;n<r;n++){var o=t.manhattanDistance(e[n]);o<i&&(i=o)}return i}function Hd(t,e,u,n,l){var o=l.precision,s=l.directionMap,a=t.difference(e.center()),l=Dt(s)?Object.keys(s):[],h=kt(u),u=l.reduce(function(d,p){if(h.includes(p)){for(var m,p=s[p],v=new Q(t.x+p.x*(Math.abs(a.x)+e.width),t.y+p.y*(Math.abs(a.y)+e.height)),k=new Ot(t,v).intersect(e)||[],I=k.length,N=null,G=0;G<I;G++){var F=k[G],H=t.squaredDistance(F);(m===void 0||m<H)&&(m=H,N=F)}N&&(v=jl(N,n,o),e.containsPoint(v)&&(v=jl(v.offset(p.x*n.x,p.y*n.y),n,o)),d.push(v))}return d},[]);return e.containsPoint(t)||u.push(jl(t,n,o)),u}function Vf(t,e,i,n){var r,o,s,a,l,h,u,d=n.precision,p=t instanceof nt?ya(_d(this,n).clone(),d):ya(t.clone(),d),m=e instanceof nt?ya((r=n,((m=this).targetAnchor||Fd(m,r).center()).clone()),d):ya(e.clone(),d),v=(r=n.step,s=m,{source:(o=p).clone(),x:Yd(s.x-o.x,r),y:Yd(s.y-o.y,r)}),k=t instanceof nt?Hd(a=p,t,n.startDirections,v,n):[a=p],I=e instanceof nt?Hd(l=m,e,n.endDirections,v,n):[l=m];if(k=k.filter(function(Pe){return!i(Pe)}),I=I.filter(function(Pe){return!i(Pe)}),0<k.length&&0<I.length){for(var N=new jo,G={},F={},H={},Y=0,_=k.length;Y<_;Y++){var K=k[Y],tt=ba(K);N.add(tt,Ud(K,I)),G[tt]=K,H[tt]=0}for(var b=n.previousDirectionAngle,vt=b===void 0,O=n.directions,M=(h=v,u=n.step,kt(n.directions).forEach(function(Pe){Pe.gridOffsetX=Pe.offsetX/u*h.x,Pe.gridOffsetY=Pe.offsetY/u*h.y}),O.length),T=kt(I).reduce(function(Pe,oi){return oi=ba(oi),Pe.push(oi),Pe},[]),j=n.maximumLoops;!N.isEmpty()&&0<j;){var f=N.pop(),x=G[f],C=F[f],D=H[f],Z=C===void 0,it=x.equals(a),st=Z?vt?it?null:lc(a,x,M,v,n):b:lc(C,x,M,v,n),lt=k.length===I.length;if(lt){for(var at=0;at<k.length;at++)if(!k[at].equals(I[at])){lt=!1;break}}if(!(Z&&lt)&&0<=T.indexOf(f)){n.previousDirectionAngle=st;for(var mt=F,Mt=G,C=x,Z=a,f=l,Et=[],Zt=hc(f.difference(C)),xt=ba(C),Bt=mt[xt];Bt;){var ce,me=hc((ce=Mt[xt]).difference(Bt));me.equals(Zt)||(Et.unshift(ce),Zt=me),Bt=mt[xt=ba(Bt)]}return hc((f=Mt[xt]).difference(Z)).equals(Zt)||Et.unshift(f),Et}for(Y=0;Y<M;Y++){var Ut,be=(Ut=O[Y]).angle,xe=Wd(st,be);if(vt&&it||!(xe>n.maxAllowedDirectionChange)){var Ht=jl(x.clone().offset(Ut.gridOffsetX,Ut.gridOffsetY),v,d),pe=ba(Ht);if(!N.isClose(pe)&&!i(Ht)){if(0<=T.indexOf(pe)){var Ne=Ht.equals(l);if(!Ne&&Wd(be,lc(Ht,l,M,v,n))>n.maxAllowedDirectionChange)continue}Ne=D+Ut.cost+(it?0:n.penalties[xe]),(!N.isOpen(pe)||Ne<H[pe])&&(G[pe]=Ht,F[pe]=x,N.add(pe,(H[pe]=Ne)+Ud(Ht,I)))}}}j--}}return n.fallbackRoute.call(this,a,l,n)}function Zf(t,e,i){(n=e).directions=Fe(n,"directions"),n.penalties=Fe(n,"penalties"),n.paddingBox=Fe(n,"paddingBox"),n.padding=Fe(n,"padding"),n.padding&&(r=ti(n.padding),n.paddingBox={x:-r.left,y:-r.top,width:r.left+r.right,height:r.top+r.bottom}),kt(n.directions).forEach(function(H){var Y=new Q(0,0),_=new Q(H.offsetX,H.offsetY);H.angle=Xe(Y.theta(_))}),i.options.perpendicular=!!e.perpendicular;for(var n,r,o,s=Zd(i,e),a=Fd(i,e),l=_d(i,e),h=typeof e.isPointObstacle=="function"?e.isPointObstacle:((o=new ac(e)).build(i.paper.model,i.model),function(H){return!o.isPointAccessible(H)}),u=kt(t).map(Q),d=[],p=l,m=0,v=u.length;m<=v;m++){var k,I,N=null,G=k||s;if((k=u[m])||(k=a,i.model.get("source").id&&i.model.get("target").id||!Rt(e.draggingRoute)||(F=G===s?l:G,I=k.origin(),N=e.draggingRoute.call(i,F,I,e))),(N=N||Vf.call(i,G,k,h,e))===null)return e.fallbackRouter(t,e,i);var F=N[0];F&&F.equals(p)&&N.shift(),p=N[N.length-1]||p,Array.prototype.push.apply(d,N)}return d}ac.prototype.build=function(t,e){var i=this.options,n=kt(i.excludeEnds).reduce(function(a,h){var h=e.get(h);return h&&(h=t.getCell(h.id))&&a.push(h),a},[]),r=[],o=t.getCell(e.get("source").id),o=(o&&(r=xl(r,o.getAncestors().map(function(a){return a.id}))),t.getCell(e.get("target").id)),s=(o&&(r=xl(r,o.getAncestors().map(function(a){return a.id}))),this.mapGridSize);return t.getElements().reduce(function(a,l){var h=kt(i.excludeTypes).includes(l.get("type")),u=n.find(function(G){return G.id===l.id}),d=r.includes(l.id);if(!(h||u||d))for(var p=l.getBBox().moveAndExpand(i.paddingBox),m=p.origin().snapToGrid(s),v=p.corner().snapToGrid(s),k=m.x;k<=v.x;k+=s)for(var I=m.y;I<=v.y;I+=s){var N=k+"@"+I;a[N]=a[N]||[],a[N].push(p)}return a},this.map),this},ac.prototype.isPointAccessible=function(t){var e=t.clone().snapToGrid(this.mapGridSize).toString();return kt(this.map[e]).every(function(i){return!i.containsPoint(t)})},jo.prototype.add=function(t,e){this.hash[t]?this.items.splice(this.items.indexOf(t),1):this.hash[t]=this.OPEN,this.values[t]=e,e=Eo(this.items,t,(function(i){return this.values[i]}).bind(this)),this.items.splice(e,0,t)},jo.prototype.remove=function(t){this.hash[t]=this.CLOSE},jo.prototype.isOpen=function(t){return this.hash[t]===this.OPEN},jo.prototype.isClose=function(t){return this.hash[t]===this.CLOSE},jo.prototype.isEmpty=function(){return this.items.length===0},jo.prototype.pop=function(){var t=this.items.shift();return this.remove(t),t};function cc(t,e,i){return Zf(t,ct({},Vd,e),i)}var Ff={maxAllowedDirectionChange:45,diagonalCost:function(){var t=this.step;return Math.ceil(Math.sqrt(t*t<<1))},directions:function(){var t=this.step,e=this.cost(),i=this.diagonalCost();return[{offsetX:t,offsetY:0,cost:e},{offsetX:t,offsetY:t,cost:i},{offsetX:0,offsetY:t,cost:e},{offsetX:-t,offsetY:t,cost:i},{offsetX:-t,offsetY:0,cost:e},{offsetX:-t,offsetY:-t,cost:i},{offsetX:0,offsetY:-t,cost:e},{offsetX:t,offsetY:-t,cost:i}]},fallbackRoute:function(a,e,i){var r=a.theta(e),n=[],l={x:e.x,y:a.y},o={x:a.x,y:e.y},s=(90<r%180&&(s=l,l=o,o=s),r%90<45?l:o),l=new Ot(a,s),o=90*Math.ceil(r/90),r=Q.fromPolar(l.squaredLength(),Qe(135+o),s),o=new Ot(e,r),s=l.intersection(o),r=s||e,l=s?r:a,o=360/i.directions.length,s=l.theta(e),a=Xe(s+o/2),l=o*Math.floor(a/o);return i.previousDirectionAngle=l,r&&n.push(r.round()),n.push(e),n}},zt={AUTO:"auto",LEFT:"left",RIGHT:"right",TOP:"top",BOTTOM:"bottom",ANCHOR_SIDE:"anchor-side",MAGNET_SIDE:"magnet-side"},Xd=[zt.LEFT,zt.RIGHT,zt.TOP,zt.BOTTOM],pr={},_f=(pr[zt.LEFT]=zt.RIGHT,pr[zt.RIGHT]=zt.LEFT,pr[zt.TOP]=zt.BOTTOM,pr[zt.BOTTOM]=zt.TOP,[zt.TOP,zt.BOTTOM]),Gl={0:zt.RIGHT,180:zt.LEFT,270:zt.TOP,90:zt.BOTTOM};function xa(t){return t.angle()}function Vl(t){return new ie(t).simplify({threshold:1}).points}function Zl(a,m){var i=a.point,n=a.x0,r=a.y0,o=a.view,s=a.bbox,a=a.direction,l=m.point,h=m.x0,u=m.y0,d=m.view,p=m.bbox,m=m.direction;return[o?o.model.isLink()?Jd(l,i,o):a===zt.ANCHOR_SIDE?s.sideNearestToPoint(i):a===zt.MAGNET_SIDE?o.model.getBBox().sideNearestToPoint(i):a:(s=new nt(n,r,0,0),Xd.includes(a)?a:s.sideNearestToPoint(l)),d?d.model.isLink()?Jd(i,l,d):m===zt.ANCHOR_SIDE?p.sideNearestToPoint(l):m===zt.MAGNET_SIDE?d.model.getBBox().sideNearestToPoint(l):m:(o=new nt(h,u,0,0),Xd.includes(m)?m:o.sideNearestToPoint(i))]}function Wf(t,e,i){var n,r,o,s,a,l,h,u,d,p,m,v,k,I,N,G,F,H,Y,_;switch(Zl(t,e)[0]){case zt.TOP:return k=e,I=i,N=(v=t).x0,G=v.y0,F=v.width,H=v.height,Y=v.point,v=v.margin,H=G+H,_=N-v,N=N+F+v,F=G-v,v=Y.x,Y=k.x0,k=k.y0,Y===v&&k<G?zt.BOTTOM:Y<v&&k<F?zt.RIGHT:v<Y&&k<F?zt.LEFT:Y<_&&G<=k||N<Y&&G<=k||!(_<=Y&&Y<=v&&H<k||Y<=N&&v<=Y&&H<k)?zt.TOP:I.point.x<Y?zt.RIGHT:zt.LEFT;case zt.RIGHT:return F=e,G=i,N=(_=t).y0,v=_.x0,H=_.width,k=_.height,I=_.point,_=_.margin,Y=(H=v+H)+_,m=N-_,N=N+k+_,k=I.x,_=I.y,I=F.x0,F=F.y0,k<I&&F===_?zt.LEFT:Y<=I&&F<_?zt.BOTTOM:Y<=I&&_<F?zt.TOP:I<=H&&F<=m||I<=H&&N<=F||!(I<v&&m<=F&&F<=_||I<v&&F<=N&&_<=F)?zt.RIGHT:G.point.y<F?zt.BOTTOM:zt.TOP;case zt.BOTTOM:return m=e,s=i,a=(o=t).x0,l=o.y0,h=o.width,u=o.height,d=o.point,o=o.margin,p=a-o,a=a+h+o,h=(u=l+u)+o,o=d.x,d=m.x0,m=m.y0,d===o&&u<m?zt.TOP:d<o&&h<m?zt.RIGHT:o<d&&h<m?zt.LEFT:d<p&&m<=u||a<d&&m<=u||!(p<=d&&d<=o&&m<l||d<=a&&o<=d&&m<l)?zt.BOTTOM:s.point.x<d?zt.RIGHT:zt.LEFT;case zt.LEFT:return h=e,u=i,a=(p=t).y0,o=p.x0,l=p.width,s=p.height,d=p.point,p=p.margin,l=o+l,n=o-p,r=a-p,a=a+s+p,s=d.x,p=d.y,d=h.x0,h=h.y0,d<s&&h===p?zt.RIGHT:d<=n&&h<p?zt.BOTTOM:d<=n&&p<h?zt.TOP:o<=d&&h<=r||o<=d&&a<=h||!(l<d&&r<=h&&h<=p||l<d&&h<=a&&p<=h)?zt.LEFT:u.point.y<h?zt.BOTTOM:zt.TOP}}function Jd(t,e,i){if(i=i.getTangentAtLength(i.getClosestPointLength(e)),i=90*Math.round(xa(i)/90),i%180==0&&t.y===e.y)return t.x<e.x?zt.LEFT:zt.RIGHT;if(t.x===e.x)return t.y<e.y?zt.TOP:zt.BOTTOM;switch(i){case 0:case 180:case 360:return t.y<e.y?zt.TOP:zt.BOTTOM;case 90:case 270:return t.x<e.x?zt.LEFT:zt.RIGHT}}function $d(t,e,i,n,a,d,s){n===zt.AUTO&&(n=a?zt.MAGNET_SIDE:zt.ANCHOR_SIDE);var a=t&&t.model.isElement(),d=a?nt.fromRectUnion(i,t.model.getBBox()):d,l=d.x,h=d.y,u=d.width,d=d.height;return{point:e,x0:l,y0:h,view:t,bbox:i,width:u=u===void 0?0:u,height:d=d===void 0?0:d,direction:n,margin:a?s:0}}function uc(i){var e=i.x,i=i.y,n=new Q(e,i);return{point:n,x0:n.x,y0:n.y,view:null,bbox:new nt(e,i,0,0),width:0,height:0,direction:null,margin:0}}function Kd(t,e,i){var n=e.point.clone(),r=e.x0,o=e.y0,s=e.width,a=e.height;switch(t){case"left":n.x=r-i;break;case"right":n.x=r+s+i;break;case"top":n.y=o-i;break;case"bottom":n.y=o+a+i}return n}function ro(Y,H){var vt=Y.point,i=Y.x0,n=Y.y0,d=Y.view,O=Y.width,_=Y.height,r=Y.margin,K=H.point,C=H.x0,o=H.y0,tt=H.width,b=H.height,s=H.margin,a=C+tt,l=o+b,h=i+O,u=n+_,d=d&&d.model.isElement(),p=i-r,m=h+r,v=n-r,k=u+r,I=C-s,N=a+s,G=o-s,F=l+s,Y=Zl(Y,H),H=Y[0],Y=Y[1],vt=Kd(H,{point:vt,x0:i,y0:n,width:O,height:_},r),O=Kd(Y,{point:K,x0:C,y0:o,width:tt,height:b},s),_=vt.x,K=vt.y,tt=O.x,b=O.y,vt=(o+l)/2,O=((i+h)/2<(C+a)/2?h+C:a+i)/2,M=((n+u)/2<vt?u+o:l+n)/2;if(H==="left"&&Y==="right")return p<=N?(T=M,h<=C&&(v<=l&&b<K?T=Math.min(G,v):o<=k&&K<=b&&(T=Math.max(F,k))),[{x:_,y:K},{x:_,y:T},{x:tt,y:T},{x:tt,y:b}]):[{x:T=(_+tt)/2,y:K},{x:T,y:b}];if(H==="right"&&Y==="left")return I<=m?(T=M,a<_&&(v<=l&&b<K?T=Math.min(G,v):o<=k&&K<=b&&(T=Math.max(F,k))),[{x:_,y:K},{x:_,y:T},{x:tt,y:T},{x:tt,y:b}]):[{x:T=(_+tt)/2,y:K},{x:T,y:b}];if(H==="top"&&Y==="bottom")return K<b?(T=O,(j=K)<o&&(p<=a&&tt<_?T=Math.min(I,p):C<=m&&_<=tt&&(T=Math.max(N,m))),[{x:_,y:j},{x:T,y:j},{x:T,y:b},{x:tt,y:b}]):[{x:_,y:j=(K+b)/2},{x:tt,y:j}];if(H==="bottom"&&Y==="top")return b<K-r?(T=O,l<(j=K)&&(p<=a&&tt<_?T=Math.min(I,p):C<=m&&_<=tt&&(T=Math.max(N,m))),[{x:_,y:j},{x:T,y:j},{x:T,y:b},{x:tt,y:b}]):[{x:_,y:j=(K+b)/2},{x:tt,y:j}];if(H==="top"&&Y==="top"){var T=Math.min((u+o)/2,b),j=Math.min((n+l)/2,K);if(b<K){if(N<=_||_<=I)return[{x:_,y:Math.min(K,b)},{x:tt,y:Math.min(K,b)}];x=_<tt?Math.min(_,I):Math.max(_,N)}else{if(m<=tt||tt<=p)return[{x:_,y:Math.min(K,b)},{x:tt,y:Math.min(K,b)}];x=_<=tt?Math.max(tt,m):Math.min(tt,p)}return[{x:_,y:j},{x,y:j},{x,y:T},{x:tt,y:T}]}if(H!=="bottom"||Y!=="bottom")return H==="left"&&Y==="left"?(j=Math.min((h+C)/2,tt),[{x:x=Math.min((i+a)/2,_),y:K},{x,y:T=_<tt?b<=K?Math.min(v,b):Math.max(k,b):K<=b?Math.min(G,K):Math.max(F,K)},{x:j,y:T},{x:j,y:b}]):H==="right"&&Y==="right"?(x=Math.max((i+a)/2,tt),[{x:T=Math.max((h+C)/2,_),y:K},{x:T,y:j=tt<_?b<=K?Math.min(v,b):Math.max(k,b):K<=b?Math.min(G,K):Math.max(F,K)},{x,y:j},{x,y:b}]):H==="top"&&Y==="right"?b<K?_<tt?[{x:_,y:T=(vt<(T=M)||!d)&&M<F&&_<C?G:M},{x:tt,y:T},{x:tt,y:b}]:[{x:_,y:b}]:(j=Math.max(O,N),tt<_&&n<b&&b<u?[{x:_,y:K},{x:j,y:K},{x:j,y:b}]:p<j&&n<b||h<C?[{x:_,y:x=Math.min(n-r,o-s)},{x:T=Math.max(h+r,a+s),y:x},{x:T,y:b}]:[{x:_,y:K},{x:Math.max(j,tt),y:K},{x:Math.max(j,tt),y:b}]):H==="top"&&Y==="left"?b<K?tt<_?[{x:_,y:r=(vt<(r=M)||!d)&&M<F&&a<_?G:M},{x:tt,y:r},{x:tt,y:b}]:[{x:_,y:b}]:(s=Math.min(I,O),!(_<tt&&b<=u)&&s<m&&K<l?[{x:_,y:x=Math.min(v,G)},{x:T=Math.min(p,I),y:x},{x:T,y:b}]:[{x:_,y:K},{x:s,y:K},{x:s,y:b}]):H==="bottom"&&Y==="right"?K<b?_<tt?[{x:_,y:j=((j=M)<vt||!d)&&G<M&&_<C?F:M},{x:tt,y:j},{x:tt,y:b}]:[{x:_,y:b}]:i<tt?[{x:_,y:r=Math.max(k,F)},{x:x=Math.max(m,N),y:r},{x,y:b}]:[{x:_,y:K},{x:O,y:K},{x:O,y:b}]:H==="bottom"&&Y==="left"?K<b?tt<_?[{x:_,y:T=((T=M)<vt||!d)&&G<M&&a<_?F:M},{x:tt,y:T},{x:tt,y:b}]:[{x:_,y:b}]:tt<h?[{x:_,y:s=Math.max(k,F)},{x:j=Math.min(p,I),y:s},{x:j,y:b}]:[{x:_,y:K},{x:O,y:K},{x:O,y:b}]:H==="left"&&Y==="bottom"?tt<=_&&F<=K?[{x:tt,y:K}]:a<=_&&K<b?[{x:O,y:K},{x:O,y:b},{x:tt,y:b}]:tt<h&&l<=n?[{x:_,y:K},{x:_,y:M},{x:tt,y:M}]:[{x:r=Math.min(I,_),y:K},{x:r,y:x=Math.max(k,F)},{x:tt,y:x}]:H!=="left"||Y!=="top"?H==="right"&&Y==="top"?_<=tt&&K<G?[{x:tt,y:K}]:h<C&&b<K?[{x:O,y:K},{x:O,y:b},{x:tt,y:b}]:tt<_&&u<o?[{x:_,y:K},{x:_,y:M},{x:tt,y:M}]:[{x:vt=Math.max(m,N),y:K},{x:vt,y:d=Math.min(v,G)},{x:tt,y:d}]:H==="right"&&Y==="bottom"?_<=tt&&F<=K?[{x:tt,y:K}]:_<=I&&K<b?[{x:O,y:K},{x:O,y:b},{x:tt,y:b}]:i<tt&&l<n?[{x:_,y:K},{x:_,y:M},{x:tt,y:M}]:[{x:T=Math.max(N,_),y:K},{x:T,y:s=Math.max(k,F)},{x:tt,y:s}]:void 0:tt<_&&K<G?[{x:tt,y:K}]:a<=_&&b<K?[{x:O,y:K},{x:O,y:b},{x:tt,y:b}]:tt<=h&&K<b?[{x:_,y:K},{x:_,y:M},{x:tt,y:M}]:[{x:j=b<K?Math.min(p,I):p,y:K},{x:j,y:r=Math.min(v,G)},{x:tt,y:r}];var f,x=Math.max((n+l)/2,b),C=Math.max((u+o)/2,K);if(K<b){if(N<=_||_<=I)return[{x:_,y:Math.max(K,b)},{x:tt,y:Math.max(K,b)}];f=_<tt?Math.min(_,I):Math.max(_,N)}else{if(m<=tt||tt<=p)return[{x:_,y:Math.max(K,b)},{x:tt,y:Math.max(K,b)}];f=_<=tt?Math.max(tt,m):Math.min(tt,p)}return[{x:_,y:C},{x:f,y:C},{x:f,y:x},{x:tt,y:x}]}function Qd(t,r,i){var o=r.sourceDirection,s=(o===void 0&&(o=zt.AUTO),r.targetDirection),n=(s===void 0&&(s=zt.AUTO),r.margin||20),r=r.useVertices||!1,h=!!i.model.source().port,o=$d(i.sourceView,i.sourceAnchor,i.sourceBBox,o,h,i.sourceAnchor,n),h=!!i.model.target().port,s=$d(i.targetView,i.targetAnchor,i.targetBBox,s,h,i.targetAnchor,n),a=[];if(!r||t.length===0)return Vl(ro(o,s));var l=t.map(uc),h=l[0];o.view&&o.view.model.isElement()&&o.view.model.getBBox().inflate(n).containsPoint(h.point)?(r=i=Zl(o,h)[0],(t=uc(o.point)).margin=n,t.direction=i,h.direction=r,a.push.apply(a,ro(t,h).concat([h.point]))):(i=Wf(o,h,l[1]||s),h.direction=i,a.push.apply(a,ro(o,h).concat([h.point])));for(var u=0;u<l.length-1;u++){var d,p,m=l[u],v=l[u+1],k=xa(new Ot(m.point,v.point));k%90==0?(d=pr[p=Gl[k]],p!==m.direction?(a.push(m.point,v.point),v.direction=d):(d=p=0,(k=Xe(k-90))===90?d=-n:k===180?p=-n:k===270?d=n:k===0&&(p=n),k={x:m.point.x+p,y:m.point.y+d},p={x:v.point.x+p,y:v.point.y+d},d=new Ot(v.point,p),v.direction=Gl[xa(d)],a.push(m.point,k,p,v.point))):(k=(d=dc(m,v))[0],p=d[1],m.direction=k,v.direction=p,a.push.apply(a,ro(m,v).concat([v.point])))}return r=l[l.length-1],s.view&&s.view.model.isElement()?s.view.model.getBBox().inflate(n).containsPoint(r.point)?(t=dc(r,s)[0],i=uc(s.point),o=Zl(r,s)[1],i.margin=n,i.direction=o,r.direction=t,a.push.apply(a,ro(r,i))):(h=Vl(a),o=new Ot(h[h.length-2],r.point),t=Gl[Math.round(xa(o))],r.direction=t,o=(h=Vl((i=ro(r,s)).concat([s.point])))[0],h=h[1],o=new Ot(o,h),h=Math.round(xa(o)),(o=Gl[h])!==t&&t===pr[o]&&(r.margin=n,i=ro(r,s)),a.push.apply(a,i)):(h=dc(r,s)[0],r.direction=h,a.push.apply(a,ro(r,s))),Vl(a)}function dc(t,e){var i,n=t.direction,r=_f.includes(n),o=t.direction,s=e.direction;return r?(r=t.point.y>e.point.y,i=e.point.x-t.point.x,n===zt.BOTTOM?(o=r?pr[n]:0<=i?zt.RIGHT:zt.LEFT,0<i?s=r?zt.LEFT:zt.TOP:i<0&&(s=r?zt.RIGHT:zt.TOP)):(o=r?0<=i?zt.RIGHT:zt.LEFT:pr[n],0<i?s=r?zt.BOTTOM:zt.LEFT:i<0&&(s=r?zt.BOTTOM:zt.RIGHT))):(i=t.point.x>e.point.x,r=e.point.y-t.point.y,n===zt.RIGHT?(o=i?pr[n]:0<=r?zt.BOTTOM:zt.TOP,0<r?s=i?zt.TOP:zt.LEFT:r<0&&(s=i?zt.BOTTOM:zt.LEFT)):(o=i?0<=r?zt.BOTTOM:zt.TOP:pr[n],0<r?s=i?zt.RIGHT:zt.TOP:r<0&&(s=i?zt.RIGHT:zt.BOTTOM))),[o,s]}Qd.Directions=zt;var qd={__proto__:null,normal:function(t,e,i){return t},oneSide:function(t,a,h){var n,r,o,s=a.side||"bottom",a=ti(a.padding||40),l=h.sourceBBox,h=h.targetBBox,u=l.center(),d=h.center();switch(s){case"bottom":o=1,n="y",r="height";break;case"top":o=-1,n="y",r="height";break;case"left":o=-1,n="x",r="width";break;case"right":o=1,n="x",r="width";break;default:throw new Error("Router: invalid side")}return u[n]+=o*(l[r]/2+a[s]),d[n]+=o*(h[r]/2+a[s]),0<o*(u[n]-d[n])?d[n]=u[n]:u[n]=d[n],[u].concat(t,d)},orthogonal:sc,manhattan:cc,metro:function(t,e,i){if(Rt(cc))return cc(t,ct({},Ff,e),i);throw new Error("Metro requires the manhattan router.")},rightAngle:Qd};function wa(t){return function(e,i,n,r){var o;return n instanceof Element?(o=(o=this.paper.findView(n))?o.isNodeConnection(n)?tg(o,"fixedAt"in r?r.fixedAt:"50%"):o.getNodeBBox(n).center():new Q,t.call(this,e,i,o,r)):t.apply(this,arguments)}}function tg(t,e){var i=parseFloat(e);return ni(e)?t.getPointAtRatio(i/100):t.getPointAtLength(i)}var hi=wa(function(t,e,i,n){var a=t.getConnection(),r=t.getConnectionSubdivisions(),o=new Ot(i.clone().offset(0,1e6),i.clone().offset(0,-1e6)),s=new Ot(i.clone().offset(1e6,0),i.clone().offset(-1e6,0)),o=o.intersect(a,{segmentSubdivisions:r}),s=s.intersect(a,{segmentSubdivisions:r}),a=[];return o&&Array.prototype.push.apply(a,o),s&&Array.prototype.push.apply(a,s),0<a.length?i.chooseClosest(a):"fallbackAt"in n?tg(t,n.fallbackAt):eg(t,e,i,n)}),eg=wa(function(t,e,i,n){return(t=t.getClosestPoint(i))||new Q}),Bi={__proto__:null,resolveRef:wa,connectionRatio:function(t,e,i,n){return n="ratio"in n?n.ratio:.5,t.getPointAtRatio(n)},connectionLength:function(t,e,i,n){return n="length"in n?n.length:20,t.getPointAtLength(n)},connectionPerpendicular:hi,connectionClosest:eg};function Er(t){return function(e,s,n,r){var o=!!r.rotate,s=o?e.getNodeUnrotatedBBox(s):e.getNodeBBox(s),a=s[t](),l=r.dx,h=(l&&(h=ni(l),l=parseFloat(l),isFinite(l)&&(h&&(l=l/100*s.width),a.x+=l)),r.dy);return h&&(l=ni(h),h=parseFloat(h),isFinite(h)&&(l&&(h=h/100*s.height),a.y+=h)),o?a.rotate(e.model.getBBox().center(),-e.model.angle()):a}}var xi={__proto__:null,center:Er("center"),top:Er("topMiddle"),bottom:Er("bottomMiddle"),left:Er("leftMiddle"),right:Er("rightMiddle"),topLeft:Er("origin"),topRight:Er("topRight"),bottomLeft:Er("bottomLeft"),bottomRight:Er("corner"),perpendicular:wa(function(l,s,i,h){var r,o=l.model.angle(),s=(l=l.getNodeBBox(s)).center(),a=l.origin(),l=l.corner(),h=h.padding;return isFinite(h)||(h=0),a.y+h<=i.y&&i.y<=l.y-h?(r=i.y-s.y,s.x+=o===0||o===180?0:r/Math.tan(Qe(o)),s.y+=r):a.x+h<=i.x&&i.x<=l.x-h&&(r=i.x-s.x,s.y+=o===90||o===270?0:r*Math.tan(Qe(o)),s.x+=r),s}),midSide:wa(function(h,e,i,n){var r,o,s,a,l=!!n.rotate,h=(l?(r=h.getNodeUnrotatedBBox(e),s=h.model.getBBox().center(),o=h.model.angle()):r=h.getNodeBBox(e),n.padding);switch(isFinite(h)&&r.inflate(h),l&&i.rotate(s,o),r.sideNearestToPoint(i)){case"left":a=r.leftMiddle();break;case"right":a=r.rightMiddle();break;case"top":a=r.topMiddle();break;case"bottom":a=r.bottomMiddle()}return l?a.rotate(s,-o):a}),modelCenter:function(t,e,i,n,r){return t.model.getPointFromConnectedLink(this.model,r).offset(n.dx,n.dy)}},Yf=R.Collection.extend({initialize:function(t,e){e.cellNamespace?this.cellNamespace=e.cellNamespace:this.cellNamespace=typeof joint<"u"&&Zn(joint,"shapes")?joint.shapes:null,this.graph=e.graph},model:function(t,e){var i=e.collection,n=i.cellNamespace,n=new(t.type==="link"?Ke:Vi(n,t.type,".")||Kt)(t,e);return e.dry||(n.graph=i.graph),n},comparator:function(t){return t.get("z")||0}}),wi=R.Model.extend({initialize:function(t,e){e=new Yf([],{model:(e=e||{}).cellModel,cellNamespace:e.cellNamespace,graph:this}),R.Model.prototype.set.call(this,"cells",e),e.on("all",this.trigger,this),this.on("change:z",this._sortOnChangeZ,this),this._out={},this._in={},this._nodes={},this._edges={},this._batches={},e.on("add",this._restructureOnAdd,this),e.on("remove",this._restructureOnRemove,this),e.on("reset",this._restructureOnReset,this),e.on("change:source",this._restructureOnChangeSource,this),e.on("change:target",this._restructureOnChangeTarget,this),e.on("remove",this._removeCell,this)},_sortOnChangeZ:function(){this.get("cells").sort()},_restructureOnAdd:function(t){var e,i;t.isLink()?(this._edges[t.id]=!0,e=(i=t.attributes).source,i=i.target,e.id&&((this._out[e.id]||(this._out[e.id]={}))[t.id]=!0),i.id&&((this._in[i.id]||(this._in[i.id]={}))[t.id]=!0)):this._nodes[t.id]=!0},_restructureOnRemove:function(t){var e,i;t.isLink()?(delete this._edges[t.id],e=(i=t.attributes).source,i=i.target,e.id&&this._out[e.id]&&this._out[e.id][t.id]&&delete this._out[e.id][t.id],i.id&&this._in[i.id]&&this._in[i.id][t.id]&&delete this._in[i.id][t.id]):delete this._nodes[t.id]},_restructureOnReset:function(t){t=t.models,this._out={},this._in={},this._nodes={},this._edges={},t.forEach(this._restructureOnAdd,this)},_restructureOnChangeSource:function(t){var e=t.previous("source"),e=(e.id&&this._out[e.id]&&delete this._out[e.id][t.id],t.attributes.source);e.id&&((this._out[e.id]||(this._out[e.id]={}))[t.id]=!0)},_restructureOnChangeTarget:function(t){var e=t.previous("target"),e=(e.id&&this._in[e.id]&&delete this._in[e.id][t.id],t.get("target"));e.id&&((this._in[e.id]||(this._in[e.id]={}))[t.id]=!0)},getOutboundEdges:function(t){return this._out&&this._out[t]||{}},getInboundEdges:function(t){return this._in&&this._in[t]||{}},toJSON:function(){var t=R.Model.prototype.toJSON.apply(this,arguments);return t.cells=this.get("cells").toJSON(),t},fromJSON:function(t,e){if(t.cells)return this.set(t,e);throw new Error("Graph JSON must contain cells array.")},set:function(t,e,i){var n;return typeof t=="object"?(n=t,i=e):(n={})[t]=e,n.hasOwnProperty("cells")&&(this.resetCells(n.cells,i),n=ai(n,"cells")),R.Model.prototype.set.call(this,n,i)},clear:function(t){t=ct({},t,{clear:!0});var e=this.get("cells");if(e.length!==0){this.startBatch("clear",t);for(var i=e.sortBy(function(n){return n.isLink()?1:2});i.shift().remove(t),0<i.length;);this.stopBatch("clear")}return this},_prepareCell:function(t,e){var i;if(t instanceof R.Model?(i=t.attributes,t.graph||e&&e.dry||(t.graph=this)):i=t,Ft(i.type))return t;throw new TypeError("dia.Graph: cell type must be a string.")},minZIndex:function(){var t=this.get("cells").first();return t&&t.get("z")||0},maxZIndex:function(){var t=this.get("cells").last();return t&&t.get("z")||0},addCell:function(t,e){return Array.isArray(t)?this.addCells(t,e):(t instanceof R.Model?t.has("z")||t.set("z",this.maxZIndex()+1):t.z===void 0&&(t.z=this.maxZIndex()+1),this.get("cells").add(this._prepareCell(t,e),e||{}),this)},addCells:function(t,e){return t.length!==0&&(t=Ou(t),e.maxPosition=e.position=t.length-1,this.startBatch("add",e),t.forEach(function(i){this.addCell(i,e),e.position--},this),this.stopBatch("add",e)),this},resetCells:function(t,e){return t=kt(t).map(function(i){return this._prepareCell(i,e)},this),this.get("cells").reset(t,e),this},removeCells:function(t,e){return t.length&&(this.startBatch("remove"),qe(t,"remove",e),this.stopBatch("remove")),this},_removeCell:function(t,e,i){(i=i||{}).clear||(i.disconnectLinks?this.disconnectLinks(t,i):this.removeLinks(t,i)),this.get("cells").remove(t,{silent:!0}),t.graph===this&&(t.graph=null)},getCell:function(t){return this.get("cells").get(t)},getCells:function(){return this.get("cells").toArray()},getElements:function(){return this.get("cells").filter(function(t){return t.isElement()})},getLinks:function(){return this.get("cells").filter(function(t){return t.isLink()})},getFirstCell:function(){return this.get("cells").first()},getLastCell:function(){return this.get("cells").last()},getConnectedLinks:function(t,e){var i,n=(e=e||{}).indirect,r=e.inbound,o=e.outbound,s=(r===void 0&&o===void 0&&(r=o=!0),[]),a={};function l(u,d){Se(u.getOutboundEdges(d.id),(function(p,m){var v;a[m]||(v=u.getCell(m),s.push(v),a[m]=!0,n&&(r&&h(u,v),o&&l(u,v)))}).bind(u)),n&&d.isLink()&&(d=d.getTargetCell())&&d.isLink()&&(a[d.id]||(s.push(d),l(u,d)))}function h(u,d){Se(u.getInboundEdges(d.id),(function(p,m){var v;a[m]||(v=u.getCell(m),s.push(v),a[m]=!0,n&&(r&&h(u,v),o&&l(u,v)))}).bind(u)),n&&d.isLink()&&(d=d.getSourceCell())&&d.isLink()&&(a[d.id]||(s.push(d),h(u,d)))}return o&&l(this,t),r&&h(this,t),e.deep&&(t=t.getEmbeddedCells({deep:!0}),i={},t.forEach(function(u){u.isElement()&&(i[u.id]=!0)}),t.forEach(function(u){u.isLink()||(o&&Se(this.getOutboundEdges(u.id),(function(d,p){var m,v;a[p]||(m=(v=this.getCell(p).attributes).source,v=v.target,m=m.id,v=v.id,!e.includeEnclosed&&m&&i[m]&&v&&i[v]||(s.push(this.getCell(p)),a[p]=!0))}).bind(this)),r&&Se(this.getInboundEdges(u.id),(function(d,p){var m,v;a[p]||(m=(v=this.getCell(p).attributes).source,v=v.target,m=m.id,v=v.id,!e.includeEnclosed&&m&&i[m]&&v&&i[v]||(s.push(this.getCell(p)),a[p]=!0))}).bind(this)))},this)),s},getNeighbors:function(t,e){var i,n=(e=e||{}).inbound,r=e.outbound,o=(n===void 0&&r===void 0&&(n=r=!0),this.getConnectedLinks(t,e).reduce((function(s,d){var l,u=d.attributes,h=u.source,u=u.target,d=d.hasLoop(e);return n&&Zn(h,"id")&&!s[h.id]&&(l=this.getCell(h.id)).isElement()&&(d||!(!l||l===t||e.deep&&l.isEmbeddedIn(t)))&&(s[h.id]=l),r&&Zn(u,"id")&&!s[u.id]&&(h=this.getCell(u.id)).isElement()&&(d||!(!h||h===t||e.deep&&h.isEmbeddedIn(t)))&&(s[u.id]=h),s}).bind(this),{}));return t.isLink()&&(n&&(i=t.getSourceCell())&&i.isElement()&&!o[i.id]&&(o[i.id]=i),r&&(i=t.getTargetCell())&&i.isElement()&&!o[i.id]&&(o[i.id]=i)),kt(o)},getCommonAncestor:function(){var t=(t=Array.from(arguments).map(function(i){for(var n=[],r=i.get("parent");r;)n.push(r),r=this.getCell(r).get("parent");return n},this)).sort(function(i,n){return i.length-n.length}),e=kt(t.shift()).find(function(i){return t.every(function(n){return n.includes(i)})});return this.getCell(e)},getSuccessors:function(t,e){var i=[];return this.search(t,function(n){n!==t&&i.push(n)},ct({},e=e||{},{outbound:!0})),i},cloneCells:Zh,cloneSubgraph:function(t,e){return t=this.getSubgraph(t,e),this.cloneCells(t)},getSubgraph:function(t,e){e=e||{};var i=[],n={},r=[],o=[];return kt(t).forEach(function(s){n[s.id]||(i.push(s),((n[s.id]=s).isLink()?o:r).push(s)),e.deep&&s.getEmbeddedCells({deep:!0}).forEach(function(a){n[a.id]||(i.push(a),((n[a.id]=a).isLink()?o:r).push(a))})}),o.forEach(function(l){var l=l.attributes,a=l.source,l=l.target;a.id&&!n[a.id]&&(a=this.getCell(a.id),i.push(a),n[a.id]=a,r.push(a)),l.id&&!n[l.id]&&(a=this.getCell(l.id),i.push(this.getCell(l.id)),n[a.id]=a,r.push(a))},this),r.forEach(function(s){this.getConnectedLinks(s,e).forEach(function(a){var h=a.attributes,l=h.source,h=h.target;!n[a.id]&&l.id&&n[l.id]&&h.id&&n[h.id]&&(i.push(a),n[a.id]=a)})},this),i},getPredecessors:function(t,e){var i=[];return this.search(t,function(n){n!==t&&i.push(n)},ct({},e=e||{},{inbound:!0})),i},search:function(t,e,i){(i=i||{}).breadthFirst?this.bfs(t,e,i):this.dfs(t,e,i)},bfs:function(t,e,i){i===void 0&&(i={});var n={},r={},o=[];for(o.push(t),r[t.id]=0;0<o.length;){var s=o.shift();if(!n[s.id]&&!(n[s.id]=!0)!==e.call(this,s,r[s.id]))for(var a=this.getNeighbors(s,i),l=0,h=a.length;l<h;l++){var u=a[l];r[u.id]=r[s.id]+1,o.push(u)}}},dfs:function(t,e,i){i===void 0&&(i={});var n={},r={},o=[];for(o.push(t),r[t.id]=0;0<o.length;){var s=o.pop();if(!n[s.id]&&!(n[s.id]=!0)!==e.call(this,s,r[s.id]))for(var a=this.getNeighbors(s,i),l=o.length,h=0,u=a.length;h<u;h++){var d=a[h];r[d.id]=r[s.id]+1,o.splice(l,0,d)}}},getSources:function(){var t=[];return Se(this._nodes,(function(e,i){this._in[i]&&!pt(this._in[i])||t.push(this.getCell(i))}).bind(this)),t},getSinks:function(){var t=[];return Se(this._nodes,(function(e,i){this._out[i]&&!pt(this._out[i])||t.push(this.getCell(i))}).bind(this)),t},isSource:function(t){return!this._in[t.id]||pt(this._in[t.id])},isSink:function(t){return!this._out[t.id]||pt(this._out[t.id])},isSuccessor:function(t,e){var i=!1;return this.search(t,function(n){if(n===e&&n!==t)return!(i=!0)},{outbound:!0}),i},isPredecessor:function(t,e){var i=!1;return this.search(t,function(n){if(n===e&&n!==t)return!(i=!0)},{inbound:!0}),i},isNeighbor:function(t,e,i){var n=(i=i||{}).inbound,r=i.outbound,o=(n===void 0&&r===void 0&&(n=r=!0),!1);return this.getConnectedLinks(t,i).forEach(function(l){var l=l.attributes,a=l.source,l=l.target;return n&&Zn(a,"id")&&a.id===e.id||r&&Zn(l,"id")&&l.id===e.id?!(o=!0):void 0}),o},disconnectLinks:function(t,e){this.getConnectedLinks(t).forEach(function(i){i.set(i.attributes.source.id===t.id?"source":"target",{x:0,y:0},e)})},removeLinks:function(t,e){qe(this.getConnectedLinks(t),"remove",e)},findModelsFromPoint:function(t){return this.getElements().filter(function(e){return e.getBBox({rotate:!0}).containsPoint(t)})},findModelsInArea:function(n,e){e===void 0&&(e={});var i=new nt(n),n=e.strict,r=(n=n===void 0?!1:n)?"containsRect":"intersect";return this.getElements().filter(function(o){return i[r](o.getBBox({rotate:!0}))})},findModelsUnderElement:function(t,i){var i=(i=i===void 0?{}:i).searchBy,n=(i===void 0&&(i="bbox"),t.getBBox().rotateAroundCenter(t.angle()));return(i==="bbox"?this.findModelsInArea(n):this.findModelsFromPoint(Ro(n,i))).filter(function(r){return t.id!==r.id&&!r.isEmbeddedIn(t)})},getBBox:function(){return this.getCellsBBox(this.getCells())},getCellsBBox:function(t,e){var i=(e=e===void 0?{}:e).rotate;return i===void 0&&(i=!0),kt(t).reduce(function(n,r){return r=r.getBBox({rotate:i}),r?n?n.union(r):r:n},null)},translate:function(t,e,i){var n=this.getCells().filter(function(r){return!r.isEmbedded()});return qe(n,"translate",t,e,i),this},resize:function(t,e,i){return this.resizeCells(t,e,this.getCells(),i)},resizeCells:function(t,e,i,n){var r=this.getCellsBBox(i);return r&&(t=Math.max(t/r.width,0),e=Math.max(e/r.height,0),qe(i,"scale",t,e,r.origin(),n)),this},startBatch:function(t,e){return e=e||{},this._batches[t]=(this._batches[t]||0)+1,this.trigger("batch:start",ct({},e,{batchName:t}))},stopBatch:function(t,e){return e=e||{},this._batches[t]=(this._batches[t]||0)-1,this.trigger("batch:stop",ct({},e,{batchName:t}))},hasActiveBatch:function(i){var e=this._batches,i=arguments.length===0?Object.keys(e):Array.isArray(i)?i:[i];return i.some(function(n){return 0<e[n]})}},{validations:{multiLinks:function(t,e){var i=e.attributes,n=i.source,r=i.target;return!(n.id&&r.id&&(i=e.getSourceCell(),i&&1<t.getConnectedLinks(i,{outbound:!0}).filter(function(a){var a=a.attributes,s=a.source,a=a.target;return s&&s.id===n.id&&(!s.port||s.port===n.port)&&a&&a.id===r.id&&(!a.port||a.port===r.port)}).length))},linkPinning:function(t,n){var n=n.attributes,i=n.source,n=n.target;return i.id&&n.id}}}),En=(od(wi.prototype,["resetCells","addCells","removeCells"],Nl.cells),{CELLS:"cells",BACK:"back",FRONT:"front",TOOLS:"tools",LABELS:"labels"}),ig=ke.extend({tagName:"g",svgElement:!0,pivotNodes:null,defaultTheme:null,options:{name:""},className:function(){return Ui(this.options.name+"-layer")},init:function(){this.pivotNodes={}},insertSortedNode:function(t,e){this.el.insertBefore(t,this.insertPivot(e))},insertNode:function(t){var e=this.el;t.parentNode!==e&&e.appendChild(t)},insertPivot:function(t){var e=this.el,i=this.pivotNodes,n=i[t=(t=+t)||0];if(!n){var r,n=i[t]=document.createComment("z-index:"+(t+1)),o=-1/0;for(r in i)(r=+r)<t&&o<r&&(o=r);o!==-1/0?(i=i[o],e.insertBefore(n,i.nextSibling)):e.insertBefore(n,e.firstChild)}return n},removePivots:function(){var t,e=this.el,i=this.pivotNodes;for(t in i)e.removeChild(i[t]);this.pivotNodes={}}}),ae={TOOLS:ye.Flags.TOOLS,RENDER:"RENDER",UPDATE:"UPDATE",LEGACY_TOOLS:"LEGACY_TOOLS",LABELS:"LABELS",VERTICES:"VERTICES",SOURCE:"SOURCE",TARGET:"TARGET",CONNECTOR:"CONNECTOR"},Is=ye.extend({className:function(){var t=ye.prototype.className.apply(this).split(" ");return t.push("link"),t.join(" ")},options:{shortLinkLength:105,doubleLinkTools:!1,longLinkLength:155,linkToolsOffset:40,doubleLinkToolsOffset:65,sampleInterval:50},_labelCache:null,_labelSelectors:null,_markerCache:null,_V:null,_dragData:null,metrics:null,decimalsRounding:2,initialize:function(){ye.prototype.initialize.apply(this,arguments),this._labelCache={},this._labelSelectors={},this._markerCache={},this._V={},this.cleanNodesCache()},presentationAttributes:{markup:[ae.RENDER],attrs:[ae.UPDATE],router:[ae.UPDATE],connector:[ae.CONNECTOR],smooth:[ae.UPDATE],manhattan:[ae.UPDATE],toolMarkup:[ae.LEGACY_TOOLS],labels:[ae.LABELS],labelMarkup:[ae.LABELS],vertices:[ae.VERTICES,ae.UPDATE],vertexMarkup:[ae.VERTICES],source:[ae.SOURCE,ae.UPDATE],target:[ae.TARGET,ae.UPDATE]},initFlag:[ae.RENDER,ae.SOURCE,ae.TARGET,ae.TOOLS],UPDATE_PRIORITY:1,confirmUpdate:function(t,e){if(e=e||{},this.hasFlag(t,ae.SOURCE)){if(!this.updateEndProperties("source"))return t;t=this.removeFlag(t,ae.SOURCE)}if(this.hasFlag(t,ae.TARGET)){if(!this.updateEndProperties("target"))return t;t=this.removeFlag(t,ae.TARGET)}var i=this.paper,n=this.sourceView,r=this.targetView;if(!i||!(n&&!i.isViewMounted(n)||r&&!i.isViewMounted(r))){if(this.hasFlag(t,ae.RENDER))return this.render(),this.updateHighlighters(!0),this.updateTools(e),t=this.removeFlag(t,[ae.RENDER,ae.UPDATE,ae.VERTICES,ae.LABELS,ae.TOOLS,ae.LEGACY_TOOLS,ae.CONNECTOR]);var n=!1,i=(this.hasFlag(t,ae.VERTICES)&&(this.renderVertexMarkers(),t=this.removeFlag(t,ae.VERTICES)),this.model),r=i.attributes,o=this.hasFlag(t,ae.LABELS),s=this.hasFlag(t,ae.LEGACY_TOOLS),r=(o&&(this.onLabelsChange(i,r.labels,e),t=this.removeFlag(t,ae.LABELS),n=!0),s&&(this.renderTools(),t=this.removeFlag(t,ae.LEGACY_TOOLS)),this.hasFlag(t,ae.UPDATE)),a=this.hasFlag(t,ae.CONNECTOR);(r||a)&&(r?e.translateBy&&i.isRelationshipEmbeddedIn(e.translateBy)?this.translate(e.tx,e.ty):this.update():(this.updatePath(),this.updateDOM()),this.updateTools(e),t=this.removeFlag(t,[ae.UPDATE,ae.TOOLS,ae.CONNECTOR]),n=!(s=o=!1)),o&&this.updateLabelPositions(),s&&this.updateToolsPosition(),n&&this.updateHighlighters(),this.hasFlag(t,ae.TOOLS)&&(this.updateTools(e),t=this.removeFlag(t,ae.TOOLS))}return t},requestConnectionUpdate:function(t){this.requestUpdate(this.getFlag(ae.UPDATE),t)},isLabelsRenderRequired:function(t){t===void 0&&(t={});var e=this.model.previous("labels");if(e&&"propertyPathArray"in t&&"propertyValue"in t){var i=t.propertyPathArray||[],n=i.length;if(1<n&&e[i[1]]){if(n===2)return"markup"in Object(t.propertyValue);if(i[2]!=="markup")return!1}}return!0},onLabelsChange:function(t,e,i){this.isLabelsRenderRequired(i)?this.renderLabels():this.updateLabels()},render:function(){return this.vel.empty(),this.unmountLabels(),this._V={},this.renderMarkup(),this.renderLabels(),this.update(),this},renderMarkup:function(){var t=this.model,t=t.get("markup")||t.markup;if(!t)throw new Error("dia.LinkView: markup required");if(Array.isArray(t))return this.renderJSONMarkup(t);if(typeof t=="string")return this.renderStringMarkup(t);throw new Error("dia.LinkView: invalid markup")},renderJSONMarkup:function(t){t=this.parseDOMJSON(t,this.el),this.selectors=t.selectors,this.vel.append(t.fragment)},renderStringMarkup:function(t){for(var e=X(t),i=(Array.isArray(e)||(e=[e]),this._V),n=0,r=e.length;n<r;n++){var o=e[n],s=o.attr("class");s&&(s=Ru(s),i[P.camelCase(s)]=o)}this.renderTools(),this.renderVertexMarkers(),this.renderArrowheadMarkers(),this.vel.append(e)},_getLabelMarkup:function(t){if(t){if(Array.isArray(t))return this.parseDOMJSON(t,null);if(typeof t=="string")return this._getLabelStringMarkup(t);throw new Error("dia.linkView: invalid label markup")}},_getLabelStringMarkup:function(t){var e=X(t),i=document.createDocumentFragment();if(Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var o=e[n].node;i.appendChild(o)}else i.appendChild(e.node);return{fragment:i,selectors:{}}},_normalizeLabelMarkup:function(t){if(t){var e,i=t.fragment;if(t.fragment instanceof DocumentFragment&&t.fragment.hasChildNodes())return(i=1<(e=i.childNodes).length||e[0].nodeName.toUpperCase()!=="G"?X("g").append(i):X(e[0])).addClass("label"),{node:i.node,selectors:t.selectors};throw new Error("dia.LinkView: invalid label markup.")}},renderLabels:function(){var t=this._V,e=t.labels,i=this._labelCache={},n=this._labelSelectors={},r=this.model,o=r.attributes.labels||[],s=o.length;if(s===0)e&&e.remove();else{e?e.empty():(e=t.labels=X("g").addClass("labels"),this.options.labelsLayer&&(e.addClass(Ui(Fe(this,"className"))),e.attr("model-id",r.id)));for(var a=0;a<s;a++){var l,h=o[a],h=this._normalizeLabelMarkup(this._getLabelMarkup(h.markup)),u=(h=(h?(l=h.node,h):(h=r._builtins.defaultLabel,h=this._normalizeLabelMarkup(this._getLabelMarkup(h.markup)),u=r._getDefaultLabel(),l=(u=this._normalizeLabelMarkup(this._getLabelMarkup(u.markup))||h).node,u)).selectors,l.setAttribute("label-idx",a),e.append(l),i[a]=l,this.selector);if(h[u])throw new Error("dia.LinkView: ambiguous label root selector.");h[u]=l,n[a]=h}e.parent()||this.mountLabels(),this.updateLabels()}return this},mountLabels:function(){var t=this.el,e=this.paper,i=this.model,r=this._V,n=this.options,r=r.labels;r&&i.hasLabels()&&(r=r.node,n.labelsLayer?e.getLayerView(n.labelsLayer).insertSortedNode(r,i.get("z")):r.parentNode!==t&&t.appendChild(r))},unmountLabels:function(){var t=this.options,e=this._V;!e||(e=e.labels)&&t.labelsLayer&&e.remove()},findLabelNode:function(t,e){var i=this._labelCache[t];return!i||(t=this._labelSelectors[t],(e=this.findBySelector(e,i,t)[0])===void 0)?null:e},_mergeLabelAttrs:function(t,e,i,n){return e===null?null:e===void 0?i===null?null:i===void 0?t?void 0:n:t?i:ze({},n,i):t?ze({},i,e):ze({},n,i,e)},_mergeLabelSize:function(t,e){return t===null?null:t===void 0?e===null?null:e===void 0?void 0:e:ze({},e,t)},updateLabels:function(){if(this._V.labels)for(var n=this.model,t=n.get("labels")||[],e=this.can("labelMove"),i=n._builtins.defaultLabel.attrs,n=n._getDefaultLabel(),r=n.markup,o=n.attrs,s=n.size,a=0,l=t.length;a<l;a++){var h=this._labelCache[a],u=(h.setAttribute("cursor",e?"move":"default"),this._labelSelectors[a]),d=t[a],p=d.markup,m=d.attrs,d=d.size,p=this._mergeLabelAttrs(p||r,m,o,i),m=this._mergeLabelSize(d,s);this.updateDOMSubtreeAttributes(h,p,{rootBBox:new nt(m),selectors:u})}return this},renderTools:function(){var t,e,i;return this._V.linkTools&&(t=P(this._V.linkTools.node).empty(),i=Li(this.model.get("toolMarkup")||this.model.toolMarkup),e=X(i()),t.append(e.node),this._toolCache=e,this.options.doubleLinkTools&&(i=this.model.get("doubleToolMarkup")||this.model.doubleToolMarkup?(i=Li(this.model.get("doubleToolMarkup")||this.model.doubleToolMarkup),X(i())):e.clone(),t.append(i.node),this._tool2Cache=i)),this},renderVertexMarkers:function(){var t,e;return this._V.markerVertices&&(t=P(this._V.markerVertices.node).empty(),e=Li(this.model.get("vertexMarkup")||this.model.vertexMarkup),this.model.vertices().forEach(function(i,n){t.append(X(e(ct({idx:n},i))).node)})),this},renderArrowheadMarkers:function(){var t,e;return this._V.markerArrowheads&&((t=P(this._V.markerArrowheads.node)).empty(),e=Li(this.model.get("arrowheadMarkup")||this.model.arrowheadMarkup),this._V.sourceArrowhead=X(e({end:"source"})),this._V.targetArrowhead=X(e({end:"target"})),t.append(this._V.sourceArrowhead.node,this._V.targetArrowhead.node)),this},removeRedundantLinearVertices:function(t){var e=this.model,n=e.vertices(),n=[this.sourceAnchor].concat(n,[this.targetAnchor]),i=n.length,n=new ie(n),n=(n.simplify({threshold:.001}),n.points.map(function(o){return o.toJSON()})),r=n.length;return i===r?0:(e.vertices(n.slice(1,r-1),t),i-r)},updateDefaultConnectionPath:function(){var t=this._V;t.connection&&t.connection.attr("d",this.getSerializedConnection()),t.connectionWrap&&t.connectionWrap.attr("d",this.getSerializedConnection()),t.markerSource&&t.markerTarget&&this._translateAndAutoOrientArrows(t.markerSource,t.markerTarget)},getEndView:function(t){switch(t){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error("dia.LinkView: type parameter required.")}},getEndAnchor:function(t){switch(t){case"source":return new Q(this.sourceAnchor);case"target":return new Q(this.targetAnchor);default:throw new Error("dia.LinkView: type parameter required.")}},getEndConnectionPoint:function(t){switch(t){case"source":return new Q(this.sourcePoint);case"target":return new Q(this.targetPoint);default:throw new Error("dia.LinkView: type parameter required.")}},getEndMagnet:function(t){switch(t){case"source":var e=this.sourceView;if(e)return this.sourceMagnet||e.el;break;case"target":if(e=this.targetView,e)return this.targetMagnet||e.el;break;default:throw new Error("dia.LinkView: type parameter required.")}},update:function(){return this.updateRoute(),this.updatePath(),this.updateDOM(),this},translate:function(t,e){t===void 0&&(t=0),e===void 0&&(e=0);var i=this.route,n=this.path;i&&n&&((i=new ie(i)).translate(t,e),this.route=i.points,this._translateConnectionPoints(t,e),n.translate(t,e),this.updateDOM())},updateDOM:function(){var t=this.el,e=this.model,i=this.selectors;this.cleanNodesCache(),this.updateDOMSubtreeAttributes(t,e.attr(),{selectors:i}),this.updateDefaultConnectionPath(),this.updateLabelPositions(),this.updateToolsPosition(),this.updateArrowheadMarkers(),this.options.perpendicular=null},updateRoute:function(){var i=this.model.vertices(),e=this.findAnchors(i),t=this.sourceAnchor=e.source,e=this.targetAnchor=e.target,i=this.findRoute(i),i=(this.route=i,this.findConnectionPoints(i,t,e));this.sourcePoint=i.source,this.targetPoint=i.target},updatePath:function(){var n=this.route,t=this.sourcePoint,e=this.targetPoint,i=this.findMarkerPoints(n,t,e),n=this.findPath(n,i.source||t,i.target||e);this.path=n},findMarkerPoints:function(s,e,i){var n,r,o=s[0],s=s[s.length-1],a=this._markerCache;return this._V.markerSource&&(a.sourceBBox=a.sourceBBox||this._V.markerSource.getBBox(),n=Q(e).move(o||i,a.sourceBBox.width*this._V.markerSource.scale().sx*-1).round()),this._V.markerTarget&&(a.targetBBox=a.targetBBox||this._V.markerTarget.getBBox(),r=Q(i).move(s||e,a.targetBBox.width*this._V.markerTarget.scale().sx*-1).round()),a.sourcePoint=n||e.clone(),a.targetPoint=r||i.clone(),{source:n,target:r}},findAnchorsOrdered:function(t,h,i,n){var r=this.model,u=r.get(t),r=r.get(i),l=this.getEndView(t),o=this.getEndView(i),s=this.getEndMagnet(t),a=this.getEndMagnet(i),l=l?(h=h?new Q(h):o?a:new Q(r),this.getAnchor(u.anchor,l,s,h,t)):new Q(u),h=o?(s=new Q(n||l),this.getAnchor(r.anchor,o,a,s,i)):new Q(r),u={};return u[t]=l,u[i]=h,u},findAnchors:function(n){var e=this.model,i=n[0],n=n[n.length-1];return e.target().priority&&!e.source().priority?this.findAnchorsOrdered("target",n,"source",i):this.findAnchorsOrdered("source",i,"target",n)},findConnectionPoints:function(o,e,i){var n,r=o[0],o=o[o.length-1],a=this.model,s=a.get("source"),a=a.get("target"),l=this.sourceView,h=this.targetView,u=this.paper.options;return{source:l&&!l.isNodeConnection(this.sourceMagnet)?(n=this.sourceMagnet||l.el,s=s.connectionPoint||u.defaultConnectionPoint,r=new Ot(r||i,e),this.getConnectionPoint(s,l,n,r,"source")):e,target:h&&!h.isNodeConnection(this.targetMagnet)?(s=this.targetMagnet||h.el,l=a.connectionPoint||u.defaultConnectionPoint,n=new Ot(o||e,i),this.getConnectionPoint(l,h,s,n,"target")):i}},getAnchor:function(t,e,i,n,r){var o=e.isNodeConnection(i),s=this.paper.options;if(!(t=t||(o?s.defaultLinkAnchor:s.perpendicularLinks||this.options.perpendicular?{name:"perpendicular"}:s.defaultAnchor)))throw new Error("Anchor required.");if(typeof t=="function")a=t;else{var a,l=t.name;if(typeof(a=s[o?"linkAnchorNamespace":"anchorNamespace"][l])!="function")throw new Error("Unknown anchor: "+l)}return s=a.call(this,e,i,n,t.args||{},r,this),s?s.round(this.decimalsRounding):new Q},getConnectionPoint:function(t,e,i,n,r){var o=n.end,s=this.paper.options;if(typeof s.linkConnectionPoint=="function"){var a=i===e.el?void 0:i;if(a=s.linkConnectionPoint(this,e,a,n.start,r))return a}if(!t)return o;if(typeof t=="function")l=t;else{var l,h=t.name;if(typeof(l=s.connectionPointNamespace[h])!="function")throw new Error("Unknown connection point: "+h)}return(a=l.call(this,n,e,i,t.args||{},r,this))?a.round(this.decimalsRounding):o},_translateConnectionPoints:function(t,e){var i=this._markerCache;i.sourcePoint.offset(t,e),i.targetPoint.offset(t,e),this.sourcePoint.offset(t,e),this.targetPoint.offset(t,e),this.sourceAnchor.offset(t,e),this.targetAnchor.offset(t,e)},_getDefaultLabelPositionProperty:function(){var e=this.model,t=e._builtins.defaultLabel.position,e=e._getDefaultLabel(),e=this._normalizeLabelPosition(e.position);return ze({},t,e)},_normalizeLabelPosition:function(t){return typeof t=="number"?{distance:t,offset:null,angle:0,args:null}:t},_mergeLabelPositionProperty:function(t,e){return t===null?null:t===void 0?e===null?null:e:ze({},e,t)},updateLabelPositions:function(){if(this._V.labels&&this.path){var t=this.model.get("labels")||[];if(t.length)for(var e=this._getDefaultLabelPositionProperty(),i=0,n=t.length;i<n;i++){var r,o=this._labelCache[i];o&&(r=t[i],r=this._normalizeLabelPosition(r.position),r=this._mergeLabelPositionProperty(r,e),r=this._getLabelTransformationMatrix(r),o.setAttribute("transform",X.matrixToTransformString(r)),this._cleanLabelMatrices(i))}}return this},_cleanLabelMatrices:function(t){var e=this.metrics,i=this._labelSelectors[t];if(i)for(var n in i)n=i[n].id,n&&n in e&&delete e[n].magnetMatrix},updateToolsPosition:function(){var t,e,i,n;return this._V.linkTools&&(t="",i=this.options.linkToolsOffset,e=this.getConnectionLength(),Number.isNaN(e)||(e<this.options.shortLinkLength&&(t="scale(.5)",i/=2),n=this.getPointAtLength(i),this._toolCache.attr("transform","translate("+n.x+", "+n.y+") "+t),this.options.doubleLinkTools&&e>=this.options.longLinkLength?(i=this.options.doubleLinkToolsOffset||i,n=this.getPointAtLength(e-i),this._tool2Cache.attr("transform","translate("+n.x+", "+n.y+") "+t),this._tool2Cache.attr("display","inline")):this.options.doubleLinkTools&&this._tool2Cache.attr("display","none"))),this},updateArrowheadMarkers:function(){var t;return this._V.markerArrowheads&&P.css(this._V.markerArrowheads.node,"display")!=="none"&&(t=this.getConnectionLength()<this.options.shortLinkLength?.5:1,this._V.sourceArrowhead.scale(t),this._V.targetArrowhead.scale(t),this._translateAndAutoOrientArrows(this._V.sourceArrowhead,this._V.targetArrowhead)),this},updateEndProperties:function(t){var n=this.model,e=this.paper,i=t+"View",n=n.get(t),n=n&&n.id;if(n){if(!(n=e.getModelById(n)))throw new Error("LinkView: invalid "+t+" cell.");if(!(n=n.findView(e)))return!1;this[i]=n}else this[i]=null;return this.updateEndMagnet(t),!0},updateEndMagnet:function(t){var e=t+"Magnet",i=this.getEndView(t);i?((t=i.getMagnetFromLinkEnd(this.model.get(t)))===i.el&&(t=null),this[e]=t):this[e]=null},_translateAndAutoOrientArrows:function(t,e){var i=kt(this.route);t&&t.translateAndAutoOrient(this.sourcePoint,i[0]||this.targetPoint,this.paper.cells),e&&e.translateAndAutoOrient(this.targetPoint,i[i.length-1]||this.sourcePoint,this.paper.cells)},_getLabelPositionProperty:function(t){return this.model.label(t).position||{}},_getLabelPositionAngle:function(t){return this._getLabelPositionProperty(t).angle||0},_getLabelPositionArgs:function(t){return this._getLabelPositionProperty(t).args},_getDefaultLabelPositionArgs:function(){return(this.model._getDefaultLabel().position||{}).args},_mergeLabelPositionArgs:function(t,e){return t===null?null:t===void 0?e===null?null:e:ze({},e,t)},addLabel:function(a,l,h,u){var r,o,s=0,a=typeof a!="number"?(r=a.x,o=a.y,typeof l=="number"?(s=l,h):l):(r=a,o=l,typeof h=="number"?(s=h,u):h),l=this._getDefaultLabelPositionArgs(),u=a,h=this._mergeLabelPositionArgs(u,l),u={position:this.getLabelPosition(r,o,s,h)};return this.model.insertLabel(-1,u,a),-1},addVertex:function(r,s,a){var o=typeof r!="number",n=o?r.x:r,r=o?r.y:s,o=o?s:a,s={x:n,y:r},a=this.getVertexIndex(n,r);return this.model.insertVertex(a,s,o),a},sendToken:function(t,o,i){var n,r,o=Dt(o)?(s=o.duration,l=o.direction==="reverse",o.connection):(s=o,l=!1,null),s=s||1e3,a={dur:s+"ms",repeatCount:1,calcMode:"linear",fill:"freeze"},l=(l&&(a.keyPoints="1;0",a.keyTimes="0;1"),X(t));if(!((o=typeof o=="string"?this.findBySelector(o,this.el,this.selectors)[0]:(t=this._V).connection?t.connection.node:this.el.querySelector("path"))instanceof SVGPathElement))throw new Error("dia.LinkView: token animation requires a valid connection path.");l.appendTo(this.paper.cells).animateAlongPath(a,o),setTimeout((n=l,r=i,function(){n.remove(),typeof r=="function"&&r()}),s)},findRoute:function(t){t=t||[];var e=this.paper.options.routerNamespace||qd,i=this.model.router(),n=this.paper.options.defaultRouter;if(!i){if(!n)return t.map(Q);i=n}if(n=Rt(i)?i:e[i.name],Rt(n))return e=i.args||{},n.call(this,t,e,this)||t.map(Q);throw new Error('dia.LinkView: unknown router: "'+i.name+'".')},findPath:function(t,e,i){var n=this.paper.options.connectorNamespace||Ld,r=this.model.connector(),o=this.paper.options.defaultConnector,o=Rt(r=r||o||{})?r:n[r.name];if(Rt(o))return(n=ot(r.args||{})).raw=!0,typeof(o=o.call(this,e,i,t,n,this))=="string"?new At(X.normalizePathData(o)):o;throw new Error('dia.LinkView: unknown connector: "'+r.name+'".')},getConnection:function(){var t=this.path;return t?t.clone():null},getSerializedConnection:function(){var t,e=this.path;return e?(t=this.metrics).hasOwnProperty("data")?t.data:(e=e.serialize(),t.data=e):null},getConnectionSubdivisions:function(){var t,e=this.path;return e?(t=this.metrics).hasOwnProperty("segmentSubdivisions")?t.segmentSubdivisions:(e=e.getSegmentSubdivisions(),t.segmentSubdivisions=e):null},getConnectionLength:function(){var t,e=this.path;return e?(t=this.metrics).hasOwnProperty("length")?t.length:(e=e.length({segmentSubdivisions:this.getConnectionSubdivisions()}),t.length=e):0},getPointAtLength:function(t){var e=this.path;return e?e.pointAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getPointAtRatio:function(t){var e=this.path;return e?(ni(t)&&(t=parseFloat(t)/100),e.pointAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()})):null},getTangentAtLength:function(t){var e=this.path;return e?e.tangentAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getTangentAtRatio:function(t){var e=this.path;return e?e.tangentAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPoint:function(t){var e=this.path;return e?e.closestPoint(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPointLength:function(t){var e=this.path;return e?e.closestPointLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPointRatio:function(t){var e=this.path;return e?e.closestPointNormalizedLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getLabelPosition:function(d,p,a,h){var r,o={},s=0,h=typeof a=="number"?(s=a,h):a,a=(h&&(o.args=h),!(h&&h.absoluteDistance)),l=h&&h.absoluteDistance&&h.reverseDistance,h=h&&h.absoluteOffset,u=this.path,m={segmentSubdivisions:this.getConnectionSubdivisions()},d=new Q(d,p),p=u.closestPointT(d,m),m=u.lengthAtT(p,m);return a&&(m=m/this.getConnectionLength()||0),l&&(m=-1*(this.getConnectionLength()-m)||1),o.distance=m,m=(r=h?r:u.tangentAtT(p))?r.pointOffset(d):(a=u.pointAtT(p),{x:(l=d.difference(a)).x,y:l.y}),o.offset=m,o.angle=s,o},_getLabelTransformationMatrix:function(o){var e=0,a={};if(typeof o=="number")u=o;else{if(typeof o.distance!="number")throw new Error("dia.LinkView: invalid label position distance.");a=o.args||{},u=o.distance,e=o.angle||0}var i,d=0<u&&u<=1,n=0,r={x:0,y:0},o=(o.offset&&(typeof(o=o.offset)=="number"&&(n=o),o.x&&(r.x=o.x),o.y&&(r.y=o.y)),r.x!==0||r.y!==0||n===0),s=a.keepGradient,a=a.ensureLegibility,l=this.path,h={segmentSubdivisions:this.getConnectionSubdivisions()},d=d?u*this.getConnectionLength():u,u=l.tangentAtLength(d,h),d=e;return u?(o?(i=u.start.clone()).offset(r):((h=u.clone()).rotate(u.start,-90),h.setLength(n),i=h.end),s&&(d=u.angle()+e,a&&(d=Xe((d+90)%180-90)))):(i=l.start.clone(),o&&i.offset(r)),X.createSVGMatrix().translate(i.x,i.y).rotate(d)},getLabelCoordinates:function(t){return t=this._getLabelTransformationMatrix(t),new Q(t.e,t.f)},getVertexIndex:function(t,e){for(var i=this.model.vertices(),n=this.getClosestPointLength(new Q(t,e)),r=0,o=i.length;r<o;r++){var s=i[r];if(n<this.getClosestPointLength(s))break}return r},notifyPointerdown:function(t,e,i){ye.prototype.pointerdown.call(this,t,e,i),this.notify("link:pointerdown",t,e,i)},notifyPointermove:function(t,e,i){ye.prototype.pointermove.call(this,t,e,i),this.notify("link:pointermove",t,e,i)},notifyPointerup:function(t,e,i){this.notify("link:pointerup",t,e,i),ye.prototype.pointerup.call(this,t,e,i)},pointerdblclick:function(t,e,i){ye.prototype.pointerdblclick.apply(this,arguments),this.notify("link:pointerdblclick",t,e,i)},pointerclick:function(t,e,i){ye.prototype.pointerclick.apply(this,arguments),this.notify("link:pointerclick",t,e,i)},contextmenu:function(t,e,i){ye.prototype.contextmenu.apply(this,arguments),this.notify("link:contextmenu",t,e,i)},pointerdown:function(t,e,i){switch(this.notifyPointerdown(t,e,i),t.target.getAttribute("class")){case"marker-vertex":return void this.dragVertexStart(t,e,i);case"marker-vertex-remove":case"marker-vertex-remove-area":return void this.dragVertexRemoveStart(t,e,i);case"marker-arrowhead":return void this.dragArrowheadStart(t,e,i);case"connection":case"connection-wrap":return void this.dragConnectionStart(t,e,i);case"marker-source":case"marker-target":return}this.dragStart(t,e,i)},pointermove:function(t,e,i){var n=this._dragData;switch(n&&this.eventData(t,n),this.eventData(t).action){case"vertex-move":this.dragVertex(t,e,i);break;case"label-move":this.dragLabel(t,e,i);break;case"arrowhead-move":this.dragArrowhead(t,e,i);break;case"move":this.drag(t,e,i)}n&&ct(n,this.eventData(t)),this.notifyPointermove(t,e,i)},pointerup:function(t,e,i){var n=this._dragData;switch(n&&(this.eventData(t,n),this._dragData=null),this.eventData(t).action){case"vertex-move":this.dragVertexEnd(t,e,i);break;case"label-move":this.dragLabelEnd(t,e,i);break;case"arrowhead-move":this.dragArrowheadEnd(t,e,i);break;case"move":this.dragEnd(t,e,i)}this.notifyPointerup(t,e,i),this.checkMouseleave(t)},mouseover:function(t){ye.prototype.mouseover.apply(this,arguments),this.notify("link:mouseover",t)},mouseout:function(t){ye.prototype.mouseout.apply(this,arguments),this.notify("link:mouseout",t)},mouseenter:function(t){ye.prototype.mouseenter.apply(this,arguments),this.notify("link:mouseenter",t)},mouseleave:function(t){ye.prototype.mouseleave.apply(this,arguments),this.notify("link:mouseleave",t)},mousewheel:function(t,e,i,n){ye.prototype.mousewheel.apply(this,arguments),this.notify("link:mousewheel",t,e,i,n)},onevent:function(t,e,i,n){if(X(t.target).findParentByClass("link-tool",this.el)){if(t.stopPropagation(),this.can("useLinkTools")){if(e==="remove")return void this.model.remove({ui:!0});this.notify(e,t,i,n)}this.notifyPointerdown(t,i,n),this.paper.delegateDragEvents(this,t.data)}else ye.prototype.onevent.apply(this,arguments)},onlabel:function(t,e,i){this.notifyPointerdown(t,e,i),this.dragLabelStart(t,e,i),this.eventData(t).stopPropagation&&t.stopPropagation()},dragConnectionStart:function(t,e,i){this.can("vertexAdd")&&(e=this.addVertex({x:e,y:i},{ui:!0}),this.eventData(t,{action:"vertex-move",vertexIdx:e}))},dragLabelStart:function(t,e,i){if(this.can("labelMove")){if(this.isDefaultInteractionPrevented(t))return;var n=t.currentTarget,n=parseInt(n.getAttribute("label-idx"),10),o=this._getDefaultLabelPositionProperty(),r=this._normalizeLabelPosition(this._getLabelPositionProperty(n)),r=this._mergeLabelPositionProperty(r,o),o=this.getLabelCoordinates(r),r=o.x-e,e=o.y-i,o=this._getLabelPositionAngle(n),i=this._getLabelPositionArgs(n),s=this._getDefaultLabelPositionArgs(),i=this._mergeLabelPositionArgs(i,s);this.eventData(t,{action:"label-move",labelIdx:n,dx:r,dy:e,positionAngle:o,positionArgs:i,stopPropagation:!0})}else this.eventData(t,{stopPropagation:!0});this.paper.delegateDragEvents(this,t.data)},dragVertexStart:function(t,e,i){var n;this.can("vertexMove")&&(n=t.target,n=parseInt(n.getAttribute("idx"),10),this.eventData(t,{action:"vertex-move",vertexIdx:n}))},dragVertexRemoveStart:function(t,e,i){this.can("vertexRemove")&&(t=t.target,t=parseInt(t.getAttribute("idx"),10),this.model.removeVertex(t))},dragArrowheadStart:function(t,e,i){var n;this.can("arrowheadMove")&&(n=t.target.getAttribute("end"),n=this.startArrowheadMove(n,{ignoreBackwardsCompatibility:!0}),this.eventData(t,n))},dragStart:function(t,e,i){this.isDefaultInteractionPrevented(t)||this.can("linkMove")&&this.eventData(t,{action:"move",dx:e,dy:i})},dragLabel:function(t,r,o){var n=this.eventData(t),r={position:this.getLabelPosition(r+n.dx,o+n.dy,n.positionAngle,n.positionArgs)},o=(this.paper.options.snapLabels&&delete r.position.offset,{ui:!0});this.paper.isAsync()&&t.type==="touchmove"&&(o.async=!1),this.model.label(n.labelIdx,r,o)},dragVertex:function(t,e,i){t=this.eventData(t),this.model.vertex(t.vertexIdx,{x:e,y:i},{ui:!0})},dragArrowhead:function(t,e,i){this.paper.options.snapLinks?!this._snapArrowhead(t,e,i)&&this.paper.options.snapLinksSelf&&this._snapArrowheadSelf(t,e,i):this.paper.options.snapLinksSelf?this._snapArrowheadSelf(t,e,i):this._connectArrowhead(this.getEventTarget(t),e,i,this.eventData(t))},drag:function(t,e,i){var n=this.eventData(t);this.model.translate(e-n.dx,i-n.dy,{ui:!0}),this.eventData(t,{dx:e,dy:i})},dragLabelEnd:function(){},dragVertexEnd:function(){},dragArrowheadEnd:function(t,e,i){var n=this.eventData(t),r=this.paper;r.options.snapLinks?this._snapArrowheadEnd(n):this._connectArrowheadEnd(n,e,i),r.linkAllowed(this)?(this._finishEmbedding(n),this._notifyConnectEvent(n,t)):this._disallow(n),this._afterArrowheadMove(n)},dragEnd:function(){},_disallow:function(t){t.whenNotAllowed==="remove"?this.model.remove({ui:!0}):this.model.set(t.arrowhead,t.initialEnd,{ui:!0})},_finishEmbedding:function(t){this.paper.options.embeddingMode&&this.model.reparent()&&(t.z=null)},_notifyConnectEvent:function(t,e){var i,n=t.arrowhead,r=t.initialEnd,o=this.model.prop(n);o&&!Ke.endsEqual(r,o)&&(i=this.paper,r.id&&this.notify("link:disconnect",e,i.findViewByModel(r.id),t.initialMagnet,n),o.id&&this.notify("link:connect",e,i.findViewByModel(o.id),t.magnetUnderPointer,n))},_snapToPoints:function(t,e,i){for(var n=null,r=1/0,o=null,s=1/0,a=t.x,l=t.y,h=0;h<e.length;h++){var u=Math.abs(e[h].x-t.x),u=(u<r&&(r=u,n=e[h]),Math.abs(e[h].y-t.y));u<s&&(s=u,o=e[h])}return{x:a=r<i?n.x:a,y:l=s<i?o.y:l}},_snapArrowheadSelf:function(t,a,i){var n=this.paper,s=this.model,r=n.options.snapLinksSelf,o=this.eventData(t),r=r.radius||20,o=this.getEndAnchor(o.arrowhead==="source"?"target":"source"),s=s.vertices(),o=[o].concat(s),s=this._snapToPoints({x:a,y:i},o,r),a=n.localToClientPoint(s);this._connectArrowhead(document.elementFromPoint(a.x,a.y),s.x,s.y,this.eventData(t))},_snapArrowhead:function(t,e,i){var n=this.paper,r=n.options,p=r.snapLinks,r=r.connectionStrategy,o=this.eventData(t),s=!1,p=p.radius||50,p=n.findViewsInArea({x:e-p,y:i-p,width:2*p,height:2*p}),a=o.closestView||null,l=o.closestMagnet||null,h=o.magnetProxy||null,u=(o.closestView=o.closestMagnet=o.magnetProxy=null,Number.MAX_VALUE),d=new Q(e,i),p=(p.forEach(function(F){var H=[];F.el.getAttribute("magnet")!=="false"&&H.push({bbox:F.model.getBBox(),magnet:F.el}),F.$("[magnet]").toArray().forEach(function(Y){H.push({bbox:F.getNodeBBox(Y),magnet:Y})}),H.forEach(function(K){var _=K.magnet,K=K.bbox.center().squaredDistance(d);K<u&&(l===_||n.options.validateConnection.apply(n,o.validateConnectionArgs(F,F.el===_?null:_)))&&(u=K,o.closestView=F,o.closestMagnet=_)})},this),null),m=o.closestView,v=o.closestMagnet,k=(v&&(p=o.magnetProxy=m.findProxyNode(v,"highlighter")),o.arrowhead),I=l!==v;if(a&&I&&a.unhighlight(h,{connecting:!0,snapping:!0}),m){var h=o.prevEnd,N=o.prevX,G=o.prevY;if(o.prevX=e,o.prevY=i,s=!0,!I&&(typeof r!="function"||N===e&&G===i)||(N=m.getLinkEnd(v,e,i,this.model,k),!I&&yt(h,N)))return s;o.prevEnd=N,I&&m.highlight(p,{connecting:!0,snapping:!0})}else N={x:e,y:i};return this.model.set(k,N||{x:e,y:i},{ui:!0}),a&&this.notify("link:snap:disconnect",t,a,l,k),m&&this.notify("link:snap:connect",t,m,v,k),s},_snapArrowheadEnd:function(t){var e=t.closestView,i=t.closestMagnet;e&&i&&(e.unhighlight(t.magnetProxy,{connecting:!0,snapping:!0}),t.magnetUnderPointer=e.findMagnet(i)),t.closestView=t.closestMagnet=null},_connectArrowhead:function(t,e,i,n){var r,o,s,a=this.paper,l=this.model;n.eventTarget!==t&&(n.magnetProxy&&n.viewUnderPointer.unhighlight(n.magnetProxy,{connecting:!0}),(r=n.viewUnderPointer=a.findView(t))&&(o=n.magnetUnderPointer=r.findMagnet(t),s=n.magnetProxy=r.findProxyNode(o,"highlighter"),o&&this.paper.options.validateConnection.apply(a,n.validateConnectionArgs(r,o)))?s&&r.highlight(s,{connecting:!0}):(n.magnetUnderPointer=null,n.magnetProxy=null)),n.eventTarget=t,l.set(n.arrowhead,{x:e,y:i},{ui:!0})},_connectArrowheadEnd:function(a,e,i){var n=this.model,r=(a=a===void 0?{}:a).viewUnderPointer,o=a.magnetUnderPointer,s=a.magnetProxy,a=a.arrowhead;o&&s&&r&&(r.unhighlight(s,{connecting:!0}),s=r.getLinkEnd(o,e,i,n,a),n.set(a,s,{ui:!0}))},_beforeArrowheadMove:function(t){t.z=this.model.get("z"),this.model.toFront();var e=this.el.style;t.pointerEvents=e.pointerEvents,e.pointerEvents="none",this.paper.options.markAvailable&&this._markAvailableMagnets(t)},_afterArrowheadMove:function(t){t.z!==null&&(this.model.set("z",t.z,{ui:!0}),t.z=null),this.el.style.pointerEvents=t.pointerEvents,this.paper.options.markAvailable&&this._unmarkAvailableMagnets(t)},_createValidateConnectionArgs:function(o){var e,i=[],n=(i[4]=o,i[5]=this,0),r=0,o=o==="source"?(n=2,"target"):(r=2,"source"),o=this.model.get(o);return o.id&&((o=(e=i[n]=this.paper.findViewByModel(o.id)).getMagnetFromLinkEnd(o))===e.el&&(o=void 0),i[n+1]=o),function(s,a){return i[r]=s,i[r+1]=s.el===a?void 0:a,i}},_markAvailableMagnets:function(t){function e(d,p){var m=d.paper;return m.options.validateConnection.apply(m,this.validateConnectionArgs(d,p))}var i=this.paper,n=i.model.getCells();t.marked={};for(var r=0,o=n.length;r<o;r++){var s=n[r].findView(i);if(s){var a=Array.prototype.slice.call(s.el.querySelectorAll("[magnet]")),l=(s.el.getAttribute("magnet")!=="false"&&a.push(s.el),a.filter(e.bind(t,s)));if(0<l.length){for(var h=0,u=l.length;h<u;h++)s.highlight(l[h],{magnetAvailability:!0});s.highlight(null,{elementAvailability:!0}),t.marked[s.model.id]=l}}}},_unmarkAvailableMagnets:function(t){for(var e=Object.keys(t.marked),i=0,n=e.length;i<n;i++){var r=e[i],o=t.marked[r],s=this.paper.findViewByModel(r);if(s){for(var a=0,l=o.length;a<l;a++)s.unhighlight(o[a],{magnetAvailability:!0});s.unhighlight(null,{elementAvailability:!0})}}t.marked=null},startArrowheadMove:function(t,e){return t={action:"arrowhead-move",arrowhead:t,whenNotAllowed:(e=e||{}).whenNotAllowed||"revert",initialMagnet:this[t+"Magnet"]||(this[t+"View"]?this[t+"View"].el:null),initialEnd:ot(this.model.get(t)),validateConnectionArgs:this._createValidateConnectionArgs(t)},this._beforeArrowheadMove(t),e.ignoreBackwardsCompatibility!==!0&&(this._dragData=t),t},onMount:function(){ye.prototype.onMount.apply(this,arguments),this.mountLabels()},onDetach:function(){ye.prototype.onDetach.apply(this,arguments),this.unmountLabels()},onRemove:function(){ye.prototype.onRemove.apply(this,arguments),this.unmountLabels()}},{Flags:ae}),Aa=(Object.defineProperty(Is.prototype,"sourceBBox",{enumerable:!0,get:function(){var t,e=this.sourceView;return e?(t=this.sourceMagnet,e.isNodeConnection(t)?new nt(this.sourceAnchor):e.getNodeBBox(t||e.el)):(t=this.model.source(),new nt(t.x,t.y))}}),Object.defineProperty(Is.prototype,"targetBBox",{enumerable:!0,get:function(){var t,e=this.targetView;return e?(t=this.targetMagnet,e.isNodeConnection(t)?new nt(this.targetAnchor):e.getNodeBBox(t||e.el)):(t=this.model.target(),new nt(t.x,t.y))}}),{NONE:"sorting-none",APPROX:"sorting-approximate",EXACT:"sorting-exact"}),Fl=9007199254740991,Be=ye.Highlighting,Ca={},Uf=(Ca[Be.DEFAULT]={name:"stroke",options:{padding:3}},Ca[Be.MAGNET_AVAILABILITY]={name:"addClass",options:{className:"available-magnet"}},Ca[Be.ELEMENT_AVAILABILITY]={name:"addClass",options:{className:"available-cell"}},[{name:En.BACK},{name:En.CELLS},{name:En.LABELS},{name:En.FRONT},{name:En.TOOLS}]),ki=ke.extend({className:"paper",options:{width:800,height:600,origin:{x:0,y:0},gridSize:1,drawGrid:!1,drawGridSize:null,background:!1,perpendicularLinks:!1,elementView:ee,linkView:Is,snapLabels:!1,snapLinks:!1,snapLinksSelf:!1,labelsLayer:!1,multiLinks:!0,guard:function(t,e){return!1},highlighting:Ca,preventContextMenu:!0,preventDefaultBlankAction:!0,preventDefaultViewAction:!0,restrictTranslate:!1,markAvailable:!1,defaultLink:new Ke,defaultConnector:{name:"normal"},defaultRouter:{name:"normal"},defaultAnchor:{name:"center"},defaultLinkAnchor:{name:"connectionRatio"},defaultConnectionPoint:{name:"bbox"},connectionStrategy:null,validateMagnet:function(t,e,i){return e.getAttribute("magnet")!=="passive"},validateConnection:function(t,e,i,n,r,o){return(r==="target"?i:t)instanceof ee},embeddingMode:!1,validateEmbedding:function(t,e){return!0},validateUnembedding:function(t){return!0},findParentBy:"bbox",frontParentOnly:!0,interactive:{labelMove:!1},linkPinning:!0,allowLink:null,clickThreshold:0,moveThreshold:0,magnetThreshold:0,sorting:Aa.EXACT,frozen:!1,autoFreeze:!1,onViewUpdate:function(t,e,i,n,r){e&(t.FLAG_INSERT|t.FLAG_REMOVE)||n.mounting||n.isolate||r.requestConnectedLinksUpdate(t,i,n)},onViewPostponed:function(t,e,i){return i.forcePostponedViewUpdate(t,e)},beforeRender:null,afterRender:null,viewport:null,cellViewNamespace:null,routerNamespace:null,connectorNamespace:null,highlighterNamespace:Di,anchorNamespace:xi,linkAnchorNamespace:Bi,connectionPointNamespace:je,overflow:!1},events:{dblclick:"pointerdblclick",dbltap:"pointerdblclick",contextmenu:"contextmenu",mousedown:"pointerdown",touchstart:"pointerdown",mouseover:"mouseover",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",wheel:"mousewheel","mouseenter .joint-cell":"mouseenter","mouseleave .joint-cell":"mouseleave","mouseenter .joint-tools":"mouseenter","mouseleave .joint-tools":"mouseleave","dblclick .joint-cell [magnet]":"magnetpointerdblclick","contextmenu .joint-cell [magnet]":"magnetcontextmenu","mousedown .joint-link .label":"onlabel","touchstart .joint-link .label":"onlabel","dragstart .joint-cell image":"onImageDragStart"},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup",touchcancel:"pointerup"},svg:null,viewport:null,defs:null,tools:null,$background:null,layers:null,$grid:null,$document:null,_viewportMatrix:null,_viewportTransformString:null,_updates:null,_layers:null,SORT_DELAYING_BATCHES:["add","to-front","to-back"],UPDATE_DELAYING_BATCHES:["translate"],FORM_CONTROL_TAG_NAMES:["TEXTAREA","INPUT","BUTTON","SELECT","OPTION"],GUARDED_TAG_NAMES:["SELECT"],MIN_SCALE:1e-6,init:function(){var t=this.options,e=this.el,i=(t.cellViewNamespace||(t.cellViewNamespace=typeof joint<"u"&&Zn(joint,"shapes")?joint.shapes:null),this.model=t.model||new wi);this._layers={},this.setGrid(t.drawGrid),this.cloneOptions(),this.render(),this._setDimensions(),this.startListening(),this._views={},this._mw_evt_buffer={event:null,deltas:[]},this.$document=P(e.ownerDocument),this.resetViews(i.attributes.cells.models),!this.isFrozen()&&this.isAsync()&&this.updateViewsAsync()},_resetUpdates:function(){return this._updates={id:null,priorities:[{},{},{}],unmountedCids:[],mountedCids:[],unmounted:{},mounted:{},count:0,keyFrozen:!1,freezeKey:null,sort:!1,disabled:!1,idle:!1}},startListening:function(){var t=this.model;this.listenTo(t,"add",this.onCellAdded).listenTo(t,"remove",this.onCellRemoved).listenTo(t,"change",this.onCellChange).listenTo(t,"reset",this.onGraphReset).listenTo(t,"sort",this.onGraphSort).listenTo(t,"batch:stop",this.onGraphBatchStop),this.on("cell:highlight",this.onCellHighlight).on("cell:unhighlight",this.onCellUnhighlight).on("scale translate",this.update)},onCellAdded:function(t,e,i){var n=i.position;this.isAsync()||!Nt(n)?this.renderView(t,i):(i.maxPosition===n&&this.freeze({key:"addCells"}),this.renderView(t,i),n===0&&this.unfreeze({key:"addCells"}))},onCellRemoved:function(t,e,i){t=this.findViewByModel(t),t&&this.requestViewUpdate(t,t.FLAG_REMOVE,t.UPDATE_PRIORITY,i)},onCellChange:function(t,e){t!==this.model.attributes.cells&&t.hasChanged("z")&&this.options.sorting===Aa.APPROX&&(t=this.findViewByModel(t))&&this.requestViewUpdate(t,t.FLAG_INSERT,t.UPDATE_PRIORITY,e)},onGraphReset:function(t,e){this.resetLayers(),this.resetViews(t.models,e)},onGraphSort:function(){this.model.hasActiveBatch(this.SORT_DELAYING_BATCHES)||this.sortViews()},onGraphBatchStop:function(t){var e,i,n;this.isFrozen()||(e=t&&t.batchName,i=this.model,this.isAsync()||(n=this.UPDATE_DELAYING_BATCHES).includes(e)&&!i.hasActiveBatch(n)&&this.updateViews(t),(n=this.SORT_DELAYING_BATCHES).includes(e)&&!i.hasActiveBatch(n)&&this.sortViews())},cloneOptions:function(){var t=this.options,e=t.defaultConnector,i=t.defaultRouter,n=t.defaultConnectionPoint,r=t.defaultAnchor,o=t.defaultLinkAnchor,s=t.origin,a=t.highlighting,l=t.cellViewNamespace,h=t.interactive;!l&&typeof joint<"u"&&Zn(joint,"shapes")&&(t.cellViewNamespace=joint.shapes),Rt(e)||(t.defaultConnector=dt(e)),Rt(i)||(t.defaultRouter=dt(i)),Rt(n)||(t.defaultConnectionPoint=dt(n)),Rt(r)||(t.defaultAnchor=dt(r)),Rt(o)||(t.defaultLinkAnchor=dt(o)),ve(h)&&(t.interactive=ct({},h)),ve(a)&&(t.highlighting=mi({},a,Ca)),t.origin=ct({},s)},children:function(){var t=X.namespace;return[{namespaceURI:t.xhtml,tagName:"div",className:Ui("paper-background"),selector:"background"},{namespaceURI:t.xhtml,tagName:"div",className:Ui("paper-grid"),selector:"grid"},{namespaceURI:t.svg,tagName:"svg",attributes:{width:"100%",height:"100%","xmlns:xlink":t.xlink},selector:"svg",children:[{tagName:"defs",selector:"defs"},{tagName:"g",className:Ui("layers"),selector:"layers"}]}]},hasLayerView:function(t){return t in this._layers},getLayerView:function(t){var e=this._layers;if(t in e)return e[t];throw new Error('dia.Paper: Unknown layer "'+t+'"')},getLayerNode:function(t){return this.getLayerView(t).el},render:function(){this.renderChildren();var o=this.childNodes,t=this.options,e=o.svg,i=o.defs,n=o.layers,r=o.background,o=o.grid;return e.style.overflow=t.overflow?"visible":"hidden",this.svg=e,this.defs=i,this.layers=n,this.$background=P(r),this.$grid=P(o),this.renderLayers(),X.ensureId(e),t.background&&this.drawBackground(t.background),t.drawGrid&&this.drawGrid(),this},renderLayers:function(i){var e=this,i=(i===void 0&&(i=Uf),this.removeLayers(),i.forEach(function(a){var s=a.name,a=(a.sorted,new ig({name:s}));e.layers.appendChild(a.el),e._layers[s]=a}),this.getLayerView(En.CELLS)),n=this.getLayerView(En.TOOLS),r=this.getLayerView(En.LABELS);this.tools=n.el,this.cells=this.viewport=i.el,i.vel.addClass(Ui("viewport")),r.vel.addClass(Ui("viewport"))},removeLayers:function(){var t=this._layers;Object.keys(t).forEach(function(e){t[e].remove(),delete t[e]})},resetLayers:function(){var t=this._layers;Object.keys(t).forEach(function(e){t[e].removePivots()})},update:function(){return this.options.drawGrid&&this.drawGrid(),this._background&&this.updateBackgroundImage(this._background),this},matrix:function(t){var e=this.layers;if(t===void 0)return i=e.getAttribute("transform"),(this._viewportTransformString||null)===i?t=this._viewportMatrix:(t=e.getCTM(),this._viewportMatrix=t,this._viewportTransformString=i),X.createSVGMatrix(t);t=X.createSVGMatrix(t);var i=X.matrixToTransformString(t);return e.setAttribute("transform",i),this._viewportMatrix=t,this._viewportTransformString=e.getAttribute("transform"),this},clientMatrix:function(){return X.createSVGMatrix(this.cells.getScreenCTM())},requestConnectedLinksUpdate:function(t,e,i){if(t instanceof ye)for(var n=t.model,r=this.model.getConnectedLinks(n),o=0,s=r.length;o<s;o++){var a,l=r[o],h=this.findViewByModel(l);h&&(a=["UPDATE"],l.getTargetCell()===n&&a.push("TARGET"),l.getSourceCell()===n&&a.push("SOURCE"),l=Math.max(e+1,h.UPDATE_PRIORITY),this.scheduleViewUpdate(h,h.getFlag(a),l,i))}},forcePostponedViewUpdate:function(t,e){if(t&&t instanceof ye){var i=t.model;if(!i.isElement()&&!(e&t.getFlag(["SOURCE","TARGET"]))){var e={silent:!0},n=0,r=this.findViewByModel(i.getSourceCell()),r=(r&&!this.isViewMounted(r)&&(n=this.dumpView(r,e),t.updateEndMagnet("source")),0),i=this.findViewByModel(i.getTargetCell());if(i&&!this.isViewMounted(i)&&(r=this.dumpView(i,e),t.updateEndMagnet("target")),n===0&&r===0)return!this.dumpView(t,e)}}return!1},requestViewUpdate:function(t,e,i,n){this.scheduleViewUpdate(t,e,i,n=n||{}),t=this.isAsync(),this.isFrozen()||t&&n.async!==!1||this.model.hasActiveBatch(this.UPDATE_DELAYING_BATCHES)||(e=this.updateViews(n),t&&this.notifyAfterRender(e,n))},scheduleViewUpdate:function(t,e,i,n){var r=this._updates,o=this.options,s=(r.idle&&o.autoFreeze&&(r.idle=!1,this.unfreeze()),t.FLAG_REMOVE),a=t.FLAG_INSERT,l=t.UPDATE_PRIORITY,h=t.cid,u=(u=r.priorities[i])||(r.priorities[i]={});if(l<i)for(var d=i-1;l<=d;d--){var p=r.priorities[d];p&&h in p&&(u[h]|=p[h],delete p[h])}var m=u[h]||0;(m&e)!==e&&(m||r.count++,e&s&&m&a?u[h]^=a:e&a&&m&s&&(u[h]^=s),u[h]|=e,typeof(a=o.onViewUpdate)=="function"&&a.call(this,t,e,i,n||{},this))},dumpViewUpdate:function(t){var e,i;return t?(i=this._updates,e=t.cid,i=i.priorities[t.UPDATE_PRIORITY],t=this.registerMountedView(t)|i[e],delete i[e],t):0},dumpView:function(t,e){e===void 0&&(e={});var i,n=this.dumpViewUpdate(t);return n?((i=!e.silent)&&this.notifyBeforeRender(e),n=this.updateView(t,n,e),i&&(i={updated:1,priority:t.UPDATE_PRIORITY},this.notifyAfterRender(i,e)),n):0},updateView:function(t,e,i){if(!t)return 0;var n=t.FLAG_REMOVE,r=t.FLAG_INSERT,o=t.FLAG_INIT,s=t.model;if(t instanceof ye){if(e&n)return this.removeView(s),0;e&r&&((n=!!(e&o))&&(e^=o),this.insertView(t,n),e^=r)}return e?t.confirmUpdate(e,i||{}):0},requireView:function(t,e){return t=this.findViewByModel(t),t?(this.dumpView(t,e),t):null},registerUnmountedView:function(t){var e=t.cid,i=this._updates;return e in i.unmounted?0:(t=i.unmounted[e]|=t.FLAG_INSERT,i.unmountedCids.push(e),delete i.mounted[e],t)},registerMountedView:function(e){var e=e.cid,i=this._updates;if(e in i.mounted)return 0;i.mounted[e]=!0,i.mountedCids.push(e);var n=i.unmounted[e]||0;return delete i.unmounted[e],n},isViewMounted:function(t){return!!t&&t.cid in this._updates.mounted},dumpViews:function(t){t=Jt({},t,{viewport:null}),this.checkViewport(t),this.updateViews(t)},updateViews:function(t){this.notifyBeforeRender(t);for(var e,i=0,n=0,r=Fl;n++,i+=(e=this.updateViewsBatch(t)).updated,r=Math.min(e.priority,r),!e.empty;);var o={updated:i,batches:n,priority:r};return this.notifyAfterRender(o,t),o},hasScheduledUpdates:function(){for(var t=this._updates.priorities,e=Object.keys(t),i=e.length;0<i&&i--;)for(var n in t[e[i]])return!0;return!1},updateViewsAsync:function(t,e){t=t||{},e=e||{processed:0,priority:Fl};var i=this._updates,n=this.options,r=i.id;if(r){ys(r),e.processed===0&&this.hasScheduledUpdates()&&this.notifyBeforeRender(t);var o=this.updateViewsBatch(t),s=Jt({},t,{mountBatchSize:1e3-o.mounted,unmountBatchSize:1e3-o.unmounted}),s=this.checkViewport(s),h=s.unmounted,s=s.mounted,a=e.processed,l=i.count,h=(0<o.updated?(a+=o.updated+o.unmounted,o.processed=a,e.priority=Math.min(o.priority,e.priority),o.empty&&s===0?(o.unmounted+=h,o.mounted+=s,o.priority=e.priority,this.notifyAfterRender(o,t),e.processed=0,e.priority=Fl,i.count=0):e.processed=a):i.idle||n.autoFreeze&&(this.freeze(),i.idle=!0,this.trigger("render:idle",t)),t.progress);if(l&&typeof h=="function"&&h.call(this,o.empty,a,l,o,this),i.id!==r)return}if(i.disabled)throw new Error("dia.Paper: can not unfreeze the paper after it was removed");i.id=vs(this.updateViewsAsync,this,t,e)},notifyBeforeRender:function(t){var e=(t=t===void 0?{}:t).beforeRender;typeof e!="function"&&typeof(e=this.options.beforeRender)!="function"||e.call(this,t,this)},notifyAfterRender:function(t,e){var i=(e=e===void 0?{}:e).afterRender;typeof(i=typeof i!="function"?this.options.afterRender:i)=="function"&&i.call(this,t,e,this),this.trigger("render:done",t,e)},updateViewsBatch:function(t){var e=(t=t||{}).batchSize||1/0,i=this._updates,n=0,r=0,o=0,s=0,a=Fl,l=!0,h=this.options,u=i.priorities,d=("viewport"in t?t:h).viewport,p=(typeof d!="function"&&(d=null),h.onViewPostponed),m=(typeof p!="function"&&(p=null),Object.keys(u));t:for(var v=0,k=m.length;v<k;v++){var I,N=+m[v],G=u[N];for(I in G){if(e<=n){l=!1;break t}var F=Nr[I];if(F){var H=G[I];if(!(H&F.FLAG_REMOVE)){var Y=I in i.unmounted;if(F.DETACHABLE&&d&&!d.call(this,F,!Y,this)){Y||(this.registerUnmountedView(F),this.detachView(F)),i.unmounted[I]|=H,delete G[I],o++;continue}Y&&(H|=F.FLAG_INSERT,s++),H|=this.registerMountedView(F)}Y=this.updateView(F,H,t),0<Y&&(G[I]=Y,!p||!p.call(this,F,Y,this)||G[I])?(r++,l=!1):(N<a&&(a=N),n++,delete G[I])}else delete G[I]}}return{priority:a,updated:n,postponed:r,unmounted:o,mounted:s,empty:l}},getUnmountedViews:function(){for(var t=this._updates,e=Object.keys(t.unmounted),i=e.length,n=new Array(i),r=0;r<i;r++)n[r]=Nr[e[r]];return n},getMountedViews:function(){for(var t=this._updates,e=Object.keys(t.mounted),i=e.length,n=new Array(i),r=0;r<i;r++)n[r]=Nr[e[r]];return n},checkUnmountedViews:function(t,e){for(var i=0,e=(typeof t!="function"&&(t=null),"mountBatchSize"in(e=e||{})?e.mountBatchSize:1/0),n=this._updates,r=n.unmountedCids,o=n.unmounted,s=0,a=Math.min(r.length,e);s<a;s++){var l,h=r[s];h in o&&(l=Nr[h])&&(l.DETACHABLE&&t&&!t.call(this,l,!1,this)?r.push(h):(i++,(h=this.registerMountedView(l))&&this.scheduleViewUpdate(l,h,l.UPDATE_PRIORITY,{mounting:!0})))}return r.splice(0,s),i},checkMountedViews:function(t,e){e=e||{};var i=0;if(typeof t=="function"){for(var e=("unmountBatchSize"in e)?e.unmountBatchSize:1/0,n=this._updates,r=n.mountedCids,o=n.mounted,s=0,a=Math.min(r.length,e);s<a;s++){var l,h=r[s];h in o&&(l=Nr[h])&&(!l.DETACHABLE||t.call(this,l,!0,this)?r.push(h):(i++,this.registerUnmountedView(l)&&this.detachView(l)))}r.splice(0,s)}return i},checkViewVisibility:function(t,o){var o=("viewport"in(o=o===void 0?{}:o)?o:this.options).viewport,i=(typeof o!="function"&&(o=null),this._updates),n=i.mounted,r=i.unmounted,o=!t.DETACHABLE||!o||o.call(this,t,!1,this),s=!1,a=!1;return t.cid in n&&!o&&(this.registerUnmountedView(t)&&this.detachView(t),n=i.mountedCids.indexOf(t.cid),i.mountedCids.splice(n,1),s=!0),!s&&t.cid in r&&o&&(n=i.unmountedCids.indexOf(t.cid),i.unmountedCids.splice(n,1),(r=this.registerMountedView(t))&&this.scheduleViewUpdate(t,r,t.UPDATE_PRIORITY,{mounting:!0}),a=!0),{mounted:a?1:0,unmounted:s?1:0}},checkViewport:function(i){var e,i=Jt({},i,{mountBatchSize:1/0,unmountBatchSize:1/0}),n=("viewport"in i?i:this.options).viewport,r=this.checkMountedViews(n,i);return 0<r&&(e=this._updates.unmountedCids,i.mountBatchSize=Math.min(e.length-r,i.mountBatchSize)),{mounted:this.checkUnmountedViews(n,i),unmounted:r}},freeze:function(i){var e=this._updates,i=(i=i||{}).key,n=this.options.frozen,r=e.freezeKey;if(i&&i!==r){if(n&&r)return;e.freezeKey=i,e.keyFrozen=n}this.options.frozen=!0,r=e.id,e.id=null,this.isAsync()&&r&&ys(r)},unfreeze:function(t){var e=this._updates,i=(t=t||{}).key,n=e.freezeKey;i&&n&&i!==n||(e.freezeKey=null,i&&i===n&&e.keyFrozen||(this.isAsync()?(this.freeze(),this.updateViewsAsync(t)):this.updateViews(t),this.options.frozen=e.keyFrozen=!1,e.sort&&(this.sortViews(),e.sort=!1)))},isAsync:function(){return!!this.options.async},isFrozen:function(){return!!this.options.frozen},isExactSorting:function(){return this.options.sorting===Aa.EXACT},onRemove:function(){this.freeze(),this._updates.disabled=!0,this.removeLayers(),this.removeViews()},getComputedSize:function(){var e=this.options,t=e.width,e=e.height;return{width:t=Nt(t)?t:this.el.clientWidth,height:e=Nt(e)?e:this.el.clientHeight}},setDimensions:function(o,s){var i=this.options,n=i.width,r=i.height,o=o===void 0?n:o,s=s===void 0?r:s;n===o&&r===s||(i.width=o,i.height=s,this._setDimensions(),n=this.getComputedSize(),this.trigger("resize",n.width,n.height))},_setDimensions:function(){var e=this.options,t=e.width,e=e.height;Nt(t)&&(t=Math.round(t)),Nt(e)&&(e=Math.round(e)),this.$el.css({width:t===null?"":t,height:e===null?"":e})},setOrigin:function(t,e){return this.translate(t||0,e||0)},fitToContent:function(a,r,o,s){s=Dt(a)?a:ct({gridWidth:a,gridHeight:r,padding:o},s);var a=this.getFitToContentArea(s),r=a.x,o=a.y,s=a.width,a=a.height,h=this.scale(),l=h.sx,h=h.sy;return this.setOrigin(-r*l,-o*h),this.setDimensions(s*l,a*h),new nt(r,o,s,a)},getFitToContentArea:function(m){var v=(m=m===void 0?{}:m).gridWidth||1,e=m.gridHeight||1,i=ti(m.padding||0),n=Math.max(m.minWidth||0,v),r=Math.max(m.minHeight||0,e),o=m.maxWidth||Number.MAX_VALUE,s=m.maxHeight||Number.MAX_VALUE,a=m.allowNewOrigin,l="contentArea"in m?new nt(m.contentArea):this.getContentArea(m),u=this.scale(),h=u.sx,u=u.sy,d=(l.x*=h,l.y*=u,l.width*=h,l.height*=u,Math.ceil((l.width+l.x)/v)),p=Math.ceil((l.height+l.y)/e),m=(m.allowNegativeBottomRight||(d=Math.max(d,1),p=Math.max(p,1)),d*=v,p*=e,0),v=((a==="negative"&&l.x<0||a==="positive"&&0<=l.x||a==="any")&&(m=Math.ceil(-l.x/v)*v,d+=m+=i.left),0);return(a==="negative"&&l.y<0||a==="positive"&&0<=l.y||a==="any")&&(v=Math.ceil(-l.y/e)*e,p+=v+=i.top),d+=i.right,p+=i.bottom,d=Math.max(d,n),p=Math.max(p,r),d=Math.min(d,o),p=Math.min(p,s),new nt(-m/h,-v/u,d/h,p/u)},transformToFitContent:function(t){var e,i;if(i="contentArea"in(t=t||{})?(i=t.contentArea,e=this.localToPaperRect(i),new Q(i)):(e=this.getContentBBox(t),this.paperToLocalPoint(e)),e.width&&e.height){Jt(t,{padding:0,preserveAspectRatio:!0,scaleGrid:null,minScale:0,maxScale:Number.MAX_VALUE,verticalAlign:"top",horizontalAlign:"left"});var n,u=ti(t.padding),r=t.minScaleX||t.minScale,o=t.maxScaleX||t.maxScale,s=t.minScaleY||t.minScale,a=t.maxScaleY||t.maxScale,l=(n=t.fittingBBox||(l=this.translate(),h=this.getComputedSize(),{x:l.tx,y:l.ty,width:h.width,height:h.height}),n=new nt(n).moveAndExpand({x:u.left,y:u.top,width:-u.left-u.right,height:-u.top-u.bottom}),this.scale()),h=n.width/e.width*l.sx,u=n.height/e.height*l.sy;t.preserveAspectRatio&&(h=u=Math.min(h,u)),t.scaleGrid&&(h=(m=t.scaleGrid)*Math.floor(h/m),u=m*Math.floor(u/m)),h=Math.min(o,Math.max(r,h)),u=Math.min(a,Math.max(s,u));var d=h/l.sx,p=u/l.sy,m=this.options.origin,v=n.x-i.x*h-m.x,k=n.y-i.y*u-m.y;switch(t.verticalAlign){case"middle":k+=(n.height-e.height*p)/2;break;case"bottom":k+=n.height-e.height*p}switch(t.horizontalAlign){case"middle":v+=(n.width-e.width*d)/2;break;case"right":v+=n.width-e.width*d}this.scale(h,u),this.translate(v,k)}},scaleContentToFit:function(t){this.transformToFitContent(t)},getContentArea:function(t){return t&&t.useModelGeometry?this.model.getBBox()||new nt:X(this.cells).getBBox()},getContentBBox:function(t){return this.localToPaperRect(this.getContentArea(t))},getArea:function(){return this.paperToLocalRect(this.getComputedSize())},getRestrictedArea:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=this.options.restrictTranslate,i=Rt(i)?i.apply(this,t):i===!0?this.getArea():i?new nt(i):null;return i},createViewForModel:function(t){var e,i=this.options,n=i.cellViewNamespace,r=t.get("type")+"View",n=Vi(n,r,"."),r=t.isLink()?(e=i.linkView,Is):(e=i.elementView,ee);return new(e.prototype instanceof R.View?n||e:e.call(this,t)||n||r)({model:t,interactive:i.interactive,labelsLayer:i.labelsLayer===!0?En.LABELS:i.labelsLayer})},removeView:function(n){var e,i,n=n.id,r=this._views,o=this._updates,s=r[n];return s&&(e=s.cid,i=o.mounted,o=o.unmounted,s.remove(),delete r[n],delete i[e],delete o[e]),s},renderView:function(t,e){var i,n,r=t.id,o=this._views,s=!0;return r in o&&((i=o[r]).model===t?(n=i.FLAG_INSERT,s=!1):this.removeView(t)),s&&(n=((i=o[r]=this.createViewForModel(t)).paper=this).registerUnmountedView(i)|this.FLAG_INIT|i.getFlag(Fe(i,"initFlag"))),this.requestViewUpdate(i,n,i.UPDATE_PRIORITY,e),i},onImageDragStart:function(){return!1},resetViews:function(t,e){e=e||{},t=t||[],this._resetUpdates(),this.removeViews();var i=this.options.autoFreeze?null:"reset";this.freeze({key:i});for(var n=0,r=t.length;n<r;n++)this.renderView(t[n],e);this.unfreeze({key:i}),this.sortViews()},removeViews:function(){qe(this._views,"remove"),this._views={}},sortViews:function(){this.isExactSorting()&&(this.isFrozen()?this._updates.sort=!0:this.sortViewsExact())},sortViewsExact:function(){var t=P(this.cells).children("[model-id]"),e=this.model.get("cells");Uu(t,function(i,n){return i=e.get(i.getAttribute("model-id")),n=e.get(n.getAttribute("model-id")),i=i.attributes.z||0,n=n.attributes.z||0,i===n?0:i<n?-1:1})},insertView:function(t,e){var i=this.getLayerView(En.CELLS),n=t.el,r=t.model;this.options.sorting===Aa.APPROX?i.insertSortedNode(n,r.get("z")):i.insertNode(n),t.onMount(e)},detachView:function(t){t.unmount(),t.onDetach()},scale:function(t,e,i,n){if(t===void 0)return X.matrixToScale(this.matrix());e===void 0&&(e=t),i===void 0&&(n=i=0);var r=this.translate(),o=((i||n||r.tx||r.ty)&&(o=r.tx-i*(t-1),r=r.ty-n*(e-1),this.translate(o,r)),t=Math.max(t||0,this.MIN_SCALE),e=Math.max(e||0,this.MIN_SCALE),this.matrix());return o.a=t,o.d=e,this.matrix(o),this.trigger("scale",t,e,i,n),this},rotate:function(t,e,i){var n;return t===void 0?X.matrixToRotate(this.matrix()):(e===void 0&&(e=(n=this.cells.getBBox()).width/2,i=n.height/2),n=this.matrix().translate(e,i).rotate(t).translate(-e,-i),this.matrix(n),this)},translate:function(t,e){var i,n,r;return t===void 0?X.matrixToTranslate(this.matrix()):(i=(n=this.options).origin,n=n.drawGrid,t=t||0,e=e||0,(r=this.matrix()).e===t&&r.f===e||(r.e=t,r.f=e,this.matrix(r),e=(t=this.translate()).tx,r=t.ty,i.x=e,i.y=r,this.trigger("translate",e,r),n&&this.drawGrid()),this)},findView:function(t){if(t=Ft(t)?this.cells.querySelector(t):t instanceof P?t[0]:t,t=this.findAttribute("model-id",t),t)return this._views[t]},findViewByModel:function(t){return t=Ft(t)||Nt(t)?t:t&&t.id,this._views[t]},findViewsFromPoint:function(t){return t=new Q(t),this.model.getElements().map(this.findViewByModel,this).filter(function(e){return e&&e.vel.getBBox({target:this.cells}).containsPoint(t)},this)},findViewsInArea:function(t,e){e=Jt(e||{},{strict:!1}),t=new nt(t);var i=this.model.getElements().map(this.findViewByModel,this),n=e.strict?"containsRect":"intersect";return i.filter(function(r){return r&&t[n](r.vel.getBBox({target:this.cells}))},this)},removeTools:function(){return this.dispatchToolsEvent("remove"),this},hideTools:function(){return this.dispatchToolsEvent("hide"),this},showTools:function(){return this.dispatchToolsEvent("show"),this},dispatchToolsEvent:function(t){for(var e=[],i=arguments.length-1;0<i--;)e[i]=arguments[i+1];typeof t=="string"&&this.trigger.apply(this,["tools:event",t].concat(e))},getModelById:function(t){return this.model.getCell(t)},snapToGrid:function(t,e){return this.clientToLocalPoint(t,e).snapToGrid(this.options.gridSize)},localToPaperPoint:function(t,e){return t=new Q(t,e),X.transformPoint(t,this.matrix())},localToPaperRect:function(t,e,i,n){return t=new nt(t,e,i,n),X.transformRect(t,this.matrix())},paperToLocalPoint:function(t,e){return t=new Q(t,e),X.transformPoint(t,this.matrix().inverse())},paperToLocalRect:function(t,e,i,n){return t=new nt(t,e,i,n),X.transformRect(t,this.matrix().inverse())},localToClientPoint:function(t,e){return t=new Q(t,e),X.transformPoint(t,this.clientMatrix())},localToClientRect:function(t,e,i,n){return t=new nt(t,e,i,n),X.transformRect(t,this.clientMatrix())},clientToLocalPoint:function(t,e){return t=new Q(t,e),X.transformPoint(t,this.clientMatrix().inverse())},clientToLocalRect:function(t,e,i,n){return t=new nt(t,e,i,n),X.transformRect(t,this.clientMatrix().inverse())},localToPagePoint:function(t,e){return this.localToPaperPoint(t,e).offset(this.pageOffset())},localToPageRect:function(t,e,i,n){return this.localToPaperRect(t,e,i,n).offset(this.pageOffset())},pageToLocalPoint:function(t,e){return t=new Q(t,e).difference(this.pageOffset()),this.paperToLocalPoint(t)},pageToLocalRect:function(o,e,i,n){var r=this.pageOffset(),o=new nt(o,e,i,n);return o.x-=r.x,o.y-=r.y,this.paperToLocalRect(o)},clientOffset:function(){var t=this.svg.getBoundingClientRect();return new Q(t.left,t.top)},pageOffset:function(){return this.clientOffset().offset(window.scrollX,window.scrollY)},linkAllowed:function(t){var e,i,n,r;if(t instanceof Is)return e=t.model,i=this.options,r=(n=this.model).constructor.validations,!(!i.multiLinks&&!r.multiLinks.call(this,n,e))&&!(!i.linkPinning&&!r.linkPinning.call(this,n,e))&&!(typeof i.allowLink=="function"&&!i.allowLink.call(this,t,this));throw new Error("Must provide a linkView.")},getDefaultLink:function(t,e){return Rt(this.options.defaultLink)?this.options.defaultLink.call(this,t,e):this.options.defaultLink.clone()},resolveHighlighter:function(i){var e=(i=i===void 0?{}:i).highlighter,i=i.type,r=this.options,n=r.highlighting,r=r.highlighterNamespace;if(e===void 0){if(!n||i&&(e=n[i])===!1)return!1;e=e||n.default}if(!e)return!1;if(i=(e=Ft(e)?{name:e}:e).name,n=r[i],!n)throw new Error('Unknown highlighter ("'+i+'")');if(typeof n.highlight!="function")throw new Error('Highlighter ("'+i+'") is missing required highlight() method');if(typeof n.unhighlight!="function")throw new Error('Highlighter ("'+i+'") is missing required unhighlight() method');return{highlighter:n,options:e.options||{},name:i}},onCellHighlight:function(t,e,r){var n,r=this.resolveHighlighter(r);r&&(n=r.highlighter,r=r.options,n.highlight(t,e,r))},onCellUnhighlight:function(t,e,r){var n,r=this.resolveHighlighter(r);r&&(n=r.highlighter,r=r.options,n.unhighlight(t,e,r))},pointerdblclick:function(t){t.preventDefault(),t=Tt(t);var e,i=this.findView(t.target);this.guard(t,i)||(e=this.snapToGrid(t.clientX,t.clientY),i?i.pointerdblclick(t,e.x,e.y):this.trigger("blank:pointerdblclick",t,e.x,e.y))},pointerclick:function(t){var e,i;this.eventData(t).mousemoved<=this.options.clickThreshold&&(t=Tt(t),e=this.findView(t.target),this.guard(t,e)||(i=this.snapToGrid(t.clientX,t.clientY),e?e.pointerclick(t,i.x,i.y):this.trigger("blank:pointerclick",t,i.x,i.y)))},contextmenu:function(t){this.options.preventContextMenu&&t.preventDefault(),this.contextMenuFired?this.contextMenuFired=!1:(t=Tt(t),this.contextMenuTrigger(t))},contextMenuTrigger:function(t){var e,i=this.findView(t.target);this.guard(t,i)||(e=this.snapToGrid(t.clientX,t.clientY),i?i.contextmenu(t,e.x,e.y):this.trigger("blank:contextmenu",t,e.x,e.y))},pointerdown:function(t){var e=(t=Tt(t)).target,n=t.button,i=this.findView(e),n=n===2;if(i){if(!n&&this.guard(t,i))return;var r=this.FORM_CONTROL_TAG_NAMES.includes(e.tagName),r=(this.options.preventDefaultViewAction&&!r&&t.preventDefault(),r&&i.preventDefaultInteraction(t),this.customEventTrigger(t,i));if(r){if(r.isPropagationStopped())return;t.data=r.data}if(r=e.closest("[magnet]"),r&&i.el!==r&&i.el.contains(r)){var e=Tt(P.Event(t.originalEvent,{data:t.data,currentTarget:r}));if(this.onmagnet(e),e.isDefaultPrevented()&&t.preventDefault(),e.isPropagationStopped())return n?void 0:void this.delegateDragEvents(i,e.data);t.data=e.data}}n?(this.contextMenuFired=!0,r=P.Event(t.originalEvent,{type:"contextmenu",data:t.data}),this.contextMenuTrigger(r)):(e=this.snapToGrid(t.clientX,t.clientY),i?i.pointerdown(t,e.x,e.y):(this.options.preventDefaultBlankAction&&t.preventDefault(),this.trigger("blank:pointerdown",t,e.x,e.y)),this.delegateDragEvents(i,t.data))},pointermove:function(t){var e,i,n=this.eventData(t);n.mousemoved||(n.mousemoved=0,this.undelegateEvents()),++n.mousemoved<=this.options.moveThreshold||(t=Tt(t),e=this.snapToGrid(t.clientX,t.clientY),(i=n.sourceView)?i.pointermove(t,e.x,e.y):this.trigger("blank:pointermove",t,e.x,e.y),this.eventData(t,n))},pointerup:function(t){this.undelegateDocumentEvents();var e=Tt(t),i=this.snapToGrid(e.clientX,e.clientY),n=this.eventData(t).sourceView;n?n.pointerup(e,i.x,i.y):this.trigger("blank:pointerup",e,i.x,i.y),e.isPropagationStopped()||this.pointerclick(P.Event(t.originalEvent,{type:"click",data:t.data})),this.delegateEvents()},mouseover:function(t){t=Tt(t);var e=this.findView(t.target);this.guard(t,e)||(e?e.mouseover(t):this.el!==t.target&&this.trigger("blank:mouseover",t))},mouseout:function(t){t=Tt(t);var e=this.findView(t.target);this.guard(t,e)||(e?e.mouseout(t):this.el!==t.target&&this.trigger("blank:mouseout",t))},mouseenter:function(t){var n=(t=Tt(t)).target,e=t.relatedTarget,i=t.currentTarget,n=this.findView(n);if(!this.guard(t,n)){var r=this.findView(e);if(n&&(r===n||(n.mouseenter(t),this.el.contains(e))))return;r||i===this.el&&this.trigger("paper:mouseenter",t)}},mouseleave:function(t){var n=(t=Tt(t)).target,e=t.relatedTarget,i=t.currentTarget,n=this.findView(n);if(!this.guard(t,n)){var r=this.findView(e);if(n&&(r===n||(n.mouseleave(t),this.el.contains(e))))return;r||i===this.el&&this.trigger("paper:mouseleave",t)}},_processMouseWheelEvtBuf:Vn(function(){var e=this._mw_evt_buffer,t=e.event,e=e.deltas.reduce(function(r,o){return r+Vu(o,50)},0),e=Math.pow(.995,e),n=this.clientToLocalPoint(t.clientX,t.clientY),i=n.x,n=n.y;this.trigger("paper:pinch",t,i,n,e),this._mw_evt_buffer={event:null,deltas:[]}},20,{maxWait:20}),mousewheel:function(t){t=Tt(t);var e,i,n,r,o,s=this.findView(t.target);this.guard(t,s)||(e=t.originalEvent,i=this.snapToGrid(e.clientX,e.clientY),n=(r=Gu(e)).deltaX,r=r.deltaY,o=this._events["paper:pinch"],t.ctrlKey&&o&&0<o.length?(e.preventDefault(),this._mw_evt_buffer.event=e,this._mw_evt_buffer.deltas.push(r),this._processMouseWheelEvtBuf()):(o=Math.max(-1,Math.min(1,e.wheelDelta)),s?s.mousewheel(t,i.x,i.y,o):this.trigger("blank:mousewheel",t,i.x,i.y,o),this.trigger("paper:pan",t,n,r)))},onevent:function(t){var e,i=t.currentTarget,n=i.getAttribute("event");n&&(i=this.findView(i))&&(t=Tt(t),this.guard(t,i)||(e=this.snapToGrid(t.clientX,t.clientY),i.onevent(t,n,e.x,e.y)))},magnetEvent:function(t,e){var i,n,r=t.currentTarget;r.getAttribute("magnet")&&(i=this.findView(r))&&(t=Tt(t),this.guard(t,i)||(n=this.snapToGrid(t.clientX,t.clientY),e.call(this,i,t,r,n.x,n.y)))},onmagnet:function(t){var e;t.button===2?(this.contextMenuFired=!0,this.magnetContextMenuFired=!0,e=P.Event(t.originalEvent,{type:"contextmenu",data:t.data,currentTarget:t.currentTarget}),this.magnetContextMenuTrigger(e),e.isPropagationStopped()&&t.stopPropagation()):this.magnetEvent(t,function(i,n,r,o,s){i.onmagnet(n,o,s)})},magnetpointerdblclick:function(t){this.magnetEvent(t,function(e,i,n,r,o){e.magnetpointerdblclick(i,n,r,o)})},magnetcontextmenu:function(t){this.options.preventContextMenu&&t.preventDefault(),this.magnetContextMenuFired?this.magnetContextMenuFired=!1:this.magnetContextMenuTrigger(t)},magnetContextMenuTrigger:function(t){this.magnetEvent(t,function(e,i,n,r,o){e.magnetcontextmenu(i,n,r,o)})},onlabel:function(t){var e=t.currentTarget,i=this.findView(e);if(i&&(t=Tt(t),!this.guard(t,i))){if(e=this.customEventTrigger(t,i,e),e){if(e.isPropagationStopped())return;t.data=e.data}e=this.snapToGrid(t.clientX,t.clientY),i.onlabel(t,e.x,e.y)}},getPointerArgs:function(e){var e=Tt(e),i=this.snapToGrid(e.clientX,e.clientY);return[e,i.x,i.y]},delegateDragEvents:function(t,e){this.eventData({data:e=e||{}},{sourceView:t||null,mousemoved:0}),this.delegateDocumentEvents(null,e)},guard:function(t,e){return t.type==="mousedown"&&t.button===2||!(!this.options.guard||!this.options.guard(t,e))||(t.data&&t.data.guarded!==void 0?t.data.guarded:(t=t.target,!!this.GUARDED_TAG_NAMES.includes(t.tagName)||!(e&&e.model&&e.model instanceof bi)&&this.svg!==t&&this.el!==t&&!P.contains(this.svg,t)))},setGridSize:function(t){var e=this.options;return e.gridSize=t,e.drawGrid&&!e.drawGridSize&&this.drawGrid(),this},clearGrid:function(){return this.$grid&&this.$grid.css("backgroundImage","none"),this},_getGridRefs:function(){return this._gridCache||(this._gridCache={root:X("svg",{width:"100%",height:"100%"},X("defs")),patterns:{},add:function(t,e){X(this.root.node.childNodes[0]).append(e),this.patterns[t]=e,this.root.append(X("rect",{width:"100%",height:"100%",fill:"url(#"+t+")"}))},get:function(t){return this.patterns[t]},exist:function(t){return this.patterns[t]!==void 0}}),this._gridCache},setGrid:function(t){return this.clearGrid(),this._gridCache=null,this._gridSettings=[],(Array.isArray(t)?t:[t||{}]).forEach(function(e){this._gridSettings.push.apply(this._gridSettings,this._resolveDrawGridOption(e))},this),this},_resolveDrawGridOption:function(t){var e=this.constructor.gridPatterns;if(Ft(t)&&Array.isArray(e[t]))return e[t].map(function(l){return ct({},l)});var i=t||{args:[{}]},n=Array.isArray(i),r=i.name;if((r=n||r||i.markup?r:"dot")&&Array.isArray(e[r])){var o=e[r].map(function(l){return ct({},l)}),s=Array.isArray(i.args)?i.args:[i.args||{}];Jt(s[0],ai(t,"args"));for(var a=0;a<s.length;a++)o[a]&&ct(o[a],s[a]);return o}return n?i:[i]},drawGrid:function(t){var e,i,n,r=this.options.drawGridSize||this.options.gridSize;return r<=1?this.clearGrid():(e=Array.isArray(t)?t:[t],i=this.matrix(),n=this._getGridRefs(),this._gridSettings.forEach(function(a,l){var h="pattern_"+l,a=ze(a,e[l],{sx:i.a||1,sy:i.d||1,ox:i.e||0,oy:i.f||0}),l=(a.width=r*(i.a||1)*(a.scaleFactor||1),a.height=r*(i.d||1)*(a.scaleFactor||1),n.exist(h)||n.add(h,X("pattern",{id:h,patternUnits:"userSpaceOnUse"},X(a.markup))),n.get(h)),h=(Rt(a.update)&&a.update(l.node.childNodes[0],a),a.ox%a.width),u=(h<0&&(h+=a.width),a.oy%a.height);u<0&&(u+=a.height),l.attr({x:h,y:u,width:a.width,height:a.height})}),t=new XMLSerializer().serializeToString(n.root.node),t="url(data:image/svg+xml;base64,"+btoa(t)+")",this.$grid.css("backgroundImage",t),this)},updateBackgroundImage:function(i){var e=(i=i||{}).position||"center",i=i.size||"auto auto",n=this.scale(),r=this.translate();Dt(e)&&(e=r.tx+n.sx*(e.x||0)+"px "+(r.ty+n.sy*(e.y||0))+"px"),Dt(i)&&(i=(i=new nt(i).scale(n.sx,n.sy)).width+"px "+i.height+"px"),this.$background.css({backgroundSize:i,backgroundPosition:e})},drawBackgroundImage:function(t,e){if(t instanceof HTMLImageElement){if(this._background&&this._background.id===e.id){var i,n=(e=e||{}).size,r=e.repeat||"no-repeat",o=e.opacity||1,s=Math.abs(e.quality)||1,a=this.constructor.backgroundPatterns[ca(r)];if(Rt(a)){if(t.width*=s,t.height*=s,a=a(t,e),!(a instanceof HTMLCanvasElement))throw new Error("dia.Paper: background pattern must return an HTML Canvas instance");i=a.toDataURL("image/png"),r="repeat",Dt(n)?(n.width*=a.width/t.width,n.height*=a.height/t.height):n===void 0&&(e.size={width:a.width/s,height:a.height/s})}else i=t.src,n===void 0&&(e.size={width:t.width,height:t.height});this.$background.css({opacity:o,backgroundRepeat:r,backgroundImage:"url("+i+")"}),this.updateBackgroundImage(e)}}else this.$background.css("backgroundImage","")},updateBackgroundColor:function(t){this.$el.css("backgroundColor",t||"")},drawBackground:function(t){var e;return this.updateBackgroundColor((t=t||{}).color),t.image?(t=this._background=dt(t),qr(t),(e=document.createElement("img")).onload=this.drawBackgroundImage.bind(this,e,t),e.src=t.image):(this.drawBackgroundImage(null),this._background=null),this},setInteractivity:function(t){this.options.interactive=t,qe(this._views,"setInteractivity",t)},isDefined:function(t){return!!this.svg.getElementById(t)},defineFilter:function(t){if(!Dt(t))throw new TypeError("dia.Paper: defineFilter() requires 1. argument to be an object.");var i=t.id,e=t.name,i=i||e+this.svg.id+da(JSON.stringify(t));if(!this.isDefined(i)){var n=Ju,n=n[e]&&n[e](t.args||{});if(!n)throw new Error("Non-existing filter "+e);e=ct({filterUnits:"objectBoundingBox",x:-1,y:-1,width:3,height:3},t.attrs,{id:i}),X(n,e).appendTo(this.defs)}return i},defineGradient:function(t){var e,i,n,r;if(Dt(t))return n=this.svg,e=this.defs,r=t.type,(i=t.id)===void 0&&(i=r+n.id+da(JSON.stringify(t))),n=t.stops,(t=t.attrs)===void 0&&(t={}),this.isDefined(i)||(n=kt(n).map(function(l){var s=l.offset,a=l.color,l=l.opacity;return X("stop").attr({offset:s,"stop-color":a,"stop-opacity":Number.isFinite(l)?l:1})}),(r=X(r,t,n)).id=i,r.appendTo(e)),i;throw new TypeError("dia.Paper: defineGradient() requires 1. argument to be an object.")},definePattern:function(o){if(!Dt(o))throw new TypeError("dia.Paper: definePattern() requires 1. argument to be an object.");var e,r=this.svg,i=this.defs,n=o.id,r=(n===void 0&&(n=r.id+da(JSON.stringify(o))),o.markup),o=o.attrs;if(o===void 0&&(o={}),r)return this.isDefined(n)||((e=X("pattern",{patternUnits:"userSpaceOnUse"})).id=n,e.attr(o),typeof r=="string"?e.append(X(r)):(o=ua(r).fragment,e.append(o)),e.appendTo(i)),n;throw new TypeError("dia.Paper: definePattern() requires markup.")},defineMarker:function(t){var e,i,n,r,o,s,a,l;if(Dt(t))return s=this.svg,e=this.defs,(i=t.id)===void 0&&(i=s.id+da(JSON.stringify(t))),s=t.markup,(r=t.attrs)===void 0&&(r={}),(n=t.markerUnits)===void 0&&(n="userSpaceOnUse"),this.isDefined(i)||((n=X("marker",{orient:"auto",overflow:"visible",markerUnits:n})).id=i,n.attr(r),a=s?1<(o=typeof s=="string"?(o=X(s),Array.isArray(o)?o:[o]):(r=ua(s).fragment,X(r).children())).length?X("g").append(o):o[0]:(s=t.type,X(s=s===void 0?"path":s)),l=ai(t,"type","id","markup","attrs","markerUnits"),Object.keys(l).forEach(function(h){var u=l[h],d=a.attr(h);d==null?a.attr(h,u):h==="transform"&&a.attr(h,u+" "+d)}),a.appendTo(n),n.appendTo(e)),i;throw new TypeError("dia.Paper: defineMarker() requires the first argument to be an object.")},customEventTrigger:function(t,e,i){i===void 0&&(i=e.el);var n=t.target.closest("[event]");return n&&i!==n&&e.el.contains(n)?(i=Tt(P.Event(t.originalEvent,{data:t.data,currentTarget:n})),this.onevent(i),i.isDefaultPrevented()&&t.preventDefault(),i):null}},{sorting:Aa,Layers:En,backgroundPatterns:{flipXy:function(t){var e=document.createElement("canvas"),i=t.width,n=t.height,r=(e.width=2*i,e.height=2*n,e.getContext("2d"));return r.drawImage(t,0,0,i,n),r.setTransform(-1,0,0,-1,e.width,e.height),r.drawImage(t,0,0,i,n),r.setTransform(-1,0,0,1,e.width,0),r.drawImage(t,0,0,i,n),r.setTransform(1,0,0,-1,0,e.height),r.drawImage(t,0,0,i,n),e},flipX:function(t){var e=document.createElement("canvas"),i=t.width,n=t.height,r=(e.width=2*i,e.height=n,e.getContext("2d"));return r.drawImage(t,0,0,i,n),r.translate(2*i,0),r.scale(-1,1),r.drawImage(t,0,0,i,n),e},flipY:function(t){var e=document.createElement("canvas"),i=t.width,n=t.height,r=(e.width=i,e.height=2*n,e.getContext("2d"));return r.drawImage(t,0,0,i,n),r.translate(0,2*n),r.scale(1,-1),r.drawImage(t,0,0,i,n),e},watermark:function(t,e){e=e||{};for(var i=t.width,n=t.height,r=document.createElement("canvas"),o=(r.width=3*i,r.height=3*n,r.getContext("2d")),e=Nt(e.watermarkAngle)?-e.watermarkAngle:-20,s=Qe(e),a=r.width/4,l=r.height/4,h=0;h<4;h++)for(var u=0;u<4;u++)0<(h+u)%2&&(o.setTransform(1,0,0,1,(2*h-1)*a,(2*u-1)*l),o.rotate(s),o.drawImage(t,-i/2,-n/2,i,n));return r}},gridPatterns:{dot:[{color:"#AAAAAA",thickness:1,markup:"rect",update:function(t,e){X(t).attr({width:e.thickness*e.sx,height:e.thickness*e.sy,fill:e.color})}}],fixedDot:[{color:"#AAAAAA",thickness:1,markup:"rect",update:function(t,e){var i=e.sx<=1?e.thickness*e.sx:e.thickness;X(t).attr({width:i,height:i,fill:e.color})}}],mesh:[{color:"#AAAAAA",thickness:1,markup:"path",update:function(t,e){var i=e.width,n=e.height,r=e.thickness,r=0<=i-r&&0<=n-r?["M",i,0,"H0 M0 0 V0",n].join(" "):"M 0 0 0 0";X(t).attr({d:r,stroke:e.color,"stroke-width":e.thickness})}}],doubleMesh:[{color:"#AAAAAA",thickness:1,markup:"path",update:function(t,e){var i=e.width,n=e.height,r=e.thickness,r=0<=i-r&&0<=n-r?["M",i,0,"H0 M0 0 V0",n].join(" "):"M 0 0 0 0";X(t).attr({d:r,stroke:e.color,"stroke-width":e.thickness})}},{color:"#000000",thickness:3,scaleFactor:4,markup:"path",update:function(t,e){var i=e.width,n=e.height,r=e.thickness,r=0<=i-r&&0<=n-r?["M",i,0,"H0 M0 0 V0",n].join(" "):"M 0 0 0 0";X(t).attr({d:r,stroke:e.color,"stroke-width":e.thickness})}}]}}),nr=ke.extend({name:null,tagName:"g",className:"tool",svgElement:!0,_visible:!0,init:function(){var t=this.name;t&&this.vel.attr("data-tool-name",t)},configure:function(t,e){return this.relatedView=t,this.paper=t.paper,this.parentView=e,this.simulateRelatedView(this.el),this.delegateEvents(),this},simulateRelatedView:function(t){t&&t.setAttribute("model-id",this.relatedView.model.id)},getName:function(){return this.name},show:function(){this.el.style.display="",this._visible=!0},hide:function(){this.el.style.display="none",this._visible=!1},isVisible:function(){return!!this._visible},focus:function(){var t=this.options.focusOpacity;isFinite(t)&&(this.el.style.opacity=t),this.parentView.focusTool(this)},blur:function(){this.el.style.opacity="",this.parentView.blurTool(this)},update:function(){},guard:function(t){var e=this.paper,i=this.relatedView;return!e||!i||e.guard(t,i)}}),nn=ke.extend({tagName:"g",className:"tools",svgElement:!0,tools:null,isRendered:!1,options:{tools:null,relatedView:null,name:null},configure:function(t){var e=(t=ct(this.options,t)).tools;if(Array.isArray(e)){var i=t.relatedView;if(i instanceof ye){for(var n=this.tools=[],r=0,o=e.length;r<o;r++){var s=e[r];s instanceof nr&&(s.configure(i,this),this.vel.append(s.el),n.push(s))}this.isRendered=!1,i.requestUpdate(i.getFlag("TOOLS"))}}return this},getName:function(){return this.options.name},update:function(t){t=t||{};var e=this.tools;if(e){for(var i=this.isRendered,n=0,r=e.length;n<r;n++){var o=e[n];i?t.tool!==o.cid&&o.isVisible()&&o.update():o.render()}this.isMounted()||this.mount(),i||(this.blurTool(),this.isRendered=!0)}return this},focusTool:function(t){var e=this.tools;if(e)for(var i=0,n=e.length;i<n;i++){var r=e[i];t===r?r.show():r.hide()}return this},blurTool:function(t){var e=this.tools;if(e)for(var i=0,n=e.length;i<n;i++){var r=e[i];r===t||r.isVisible()||(r.show(),r.update())}return this},hide:function(){return this.focusTool(null)},show:function(){return this.blurTool(null)},onRemove:function(){var t=this.tools;if(!t)return this;for(var e=0,i=t.length;e<i;e++)t[e].remove();this.tools=null},mount:function(){var n=this.options,t=this.el,e=n.relatedView,i=n.layer,n=(i===void 0&&(i=En.TOOLS),n.z);return e&&(i?e.paper.getLayerView(i).insertSortedNode(t,n):e.el.appendChild(t)),this}}),hi={__proto__:null,Graph:wi,attributes:Oo,LayersNames:En,PaperLayer:ig,Cell:bi,CellView:ye,Element:Kt,ElementView:ee,Link:Ke,LinkView:Is,Paper:ki,ToolView:nr,ToolsView:nn,HighlighterView:Fn},Be=ke.extend({tagName:"circle",svgElement:!0,className:"marker-vertex",events:{mousedown:"onPointerDown",touchstart:"onPointerDown",dblclick:"onDoubleClick",dbltap:"onDoubleClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},attributes:{r:6,fill:"#33334F",stroke:"#FFFFFF","stroke-width":2,cursor:"move"},position:function(r,e){var i=this.vel,n=this.options.scale,r=X.createSVGMatrix().translate(r,e);n&&(r=r.scale(n)),i.transform(r,{absolute:!0})},onPointerDown:function(t){this.options.guard(t)||(t.stopPropagation(),t.preventDefault(),this.options.paper.undelegateEvents(),this.delegateDocumentEvents(null,t.data),this.trigger("will-change",this,t))},onPointerMove:function(t){this.trigger("changing",this,t)},onDoubleClick:function(t){this.trigger("remove",this,t)},onPointerUp:function(t){this.trigger("changed",this,t),this.undelegateDocumentEvents(),this.options.paper.delegateEvents()}}),nn=nr.extend({name:"vertices",options:{handleClass:Be,snapRadius:20,redundancyRemoval:!0,vertexAdding:!0,stopPropagation:!0,scale:null},children:[{tagName:"path",selector:"connection",className:"joint-vertices-path",attributes:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"cell"}}],handles:null,events:{"mousedown .joint-vertices-path":"onPathPointerDown","touchstart .joint-vertices-path":"onPathPointerDown"},onRender:function(){return this.options.vertexAdding&&(this.renderChildren(),this.updatePath()),this.resetHandles(),this.renderHandles(),this},update:function(){return this.relatedView.model.vertices().length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.vertexAdding&&this.updatePath(),this},resetHandles:function(){var t=this.handles;if(this.handles=[],this.stopListening(),Array.isArray(t))for(var e=0,i=t.length;e<i;e++)t[e].remove()},renderHandles:function(){for(var t=this,e=this.relatedView.model.vertices(),i=0,n=e.length;i<n;i++){var r=e[i],o=new this.options.handleClass({index:i,paper:this.paper,scale:this.options.scale,guard:function(s){return t.guard(s)}});o.render(),o.position(r.x,r.y),this.simulateRelatedView(o.el),o.vel.appendTo(this.el),this.handles.push(o),this.startHandleListening(o)}},updateHandles:function(){for(var t=this.relatedView.model.vertices(),e=0,i=t.length;e<i;e++){var n=t[e],r=this.handles[e];if(!r)return;r.position(n.x,n.y)}},updatePath:function(){var t=this.childNodes.connection;t&&t.setAttribute("d",this.relatedView.getSerializedConnection())},startHandleListening:function(t){var e=this.relatedView;e.can("vertexMove")&&(this.listenTo(t,"will-change",this.onHandleWillChange),this.listenTo(t,"changing",this.onHandleChanging),this.listenTo(t,"changed",this.onHandleChanged)),e.can("vertexRemove")&&this.listenTo(t,"remove",this.onHandleRemove)},getNeighborPoints:function(t){var e=this.relatedView,n=e.model.vertices(),i=0<t?n[t-1]:e.sourceAnchor,n=t<n.length-1?n[t+1]:e.targetAnchor;return{prev:new Q(i),next:new Q(n)}},onHandleWillChange:function(t,e){this.focus();var i=this.relatedView,n=this.options;i.model.startBatch("vertex-move",{ui:!0,tool:this.cid}),n.stopPropagation||i.notifyPointerdown.apply(i,i.paper.getPointerArgs(e))},onHandleChanging:function(t,a){var i=this.options,n=this.relatedView,r=t.options.index,a=n.paper.getPointerArgs(a),o=a[0],s=a[1],a=a[2],l={x:s,y:a};this.snapVertex(l,r),n.model.vertex(r,l,{ui:!0,tool:this.cid}),t.position(l.x,l.y),i.stopPropagation||n.notifyPointermove(o,s,a)},onHandleChanged:function(t,e){var i,n,r=this.options,o=this.relatedView;r.vertexAdding&&this.updatePath(),r.redundancyRemoval&&(o.removeRedundantLinearVertices({ui:!0,tool:this.cid})&&this.render(),this.blur(),o.model.stopBatch("vertex-move",{ui:!0,tool:this.cid}),this.eventData(e).vertexAdded&&o.model.stopBatch("vertex-add",{ui:!0,tool:this.cid}),i=(e=o.paper.getPointerArgs(e))[0],n=e[1],e=e[2],r.stopPropagation||o.notifyPointerup(i,n,e),o.checkMouseleave(i))},snapVertex:function(t,e){var i,n,r=this.options.snapRadius;0<r&&(i=(e=this.getNeighborPoints(e)).prev,n=e.next,Math.abs(t.x-i.x)<r?t.x=i.x:Math.abs(t.x-n.x)<r&&(t.x=n.x),Math.abs(t.y-i.y)<r?t.y=e.prev.y:Math.abs(t.y-n.y)<r&&(t.y=n.y))},onHandleRemove:function(i,e){var i=i.options.index,n=this.relatedView;n.model.removeVertex(i,{ui:!0}),this.options.vertexAdding&&this.updatePath(),n.checkMouseleave(Tt(e))},onPathPointerDown:function(t){var e,i,n;this.guard(t)||(t.stopPropagation(),t.preventDefault(),t=Tt(t),e=this.paper.snapToGrid(t.clientX,t.clientY).toJSON(),(n=this.relatedView).model.startBatch("vertex-add",{ui:!0,tool:this.cid}),i=n.getVertexIndex(e.x,e.y),this.snapVertex(e,i),n.model.insertVertex(i,e,{ui:!0,tool:this.cid}),this.update(),n=this.handles[i],this.eventData(t,{vertexAdded:!0}),n.onPointerDown(t))},onRemove:function(){this.resetHandles()}},{VertexHandle:Be});function _l(t,e){var i=t.model;return e?i.getBBox():i.isLink()?t.getConnection().bbox():t.getNodeUnrotatedBBox(t.el)}function ng(t,e,i){return Od.call(this.paper,{},e,i,t,this.model).anchor}var Be=ke.extend({tagName:"g",svgElement:!0,className:"marker-segment",events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},children:[{tagName:"line",selector:"line",attributes:{stroke:"#33334F","stroke-width":2,fill:"none","pointer-events":"none"}},{tagName:"rect",selector:"handle",attributes:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#33334F",stroke:"#FFFFFF","stroke-width":2}}],onRender:function(){this.renderChildren()},position:function(t,e,i,n){var o=this.options.scale,r=X.createSVGMatrix().translate(t,e).rotate(i),o=(o&&(r=r.scale(o)),this.childNodes.handle),r=(o.setAttribute("transform",X.matrixToTransformString(r)),o.setAttribute("cursor",i%180==0?"row-resize":"col-resize"),n.getClosestPoint(new Q(t,e))),o=this.childNodes.line;o.setAttribute("x1",t),o.setAttribute("y1",e),o.setAttribute("x2",r.x),o.setAttribute("y2",r.y)},onPointerDown:function(t){this.options.guard(t)||(this.trigger("change:start",this,t),t.stopPropagation(),t.preventDefault(),this.options.paper.undelegateEvents(),this.delegateDocumentEvents(null,t.data))},onPointerMove:function(t){this.trigger("changing",this,t)},onPointerUp:function(t){this.undelegateDocumentEvents(),this.options.paper.delegateEvents(),this.trigger("change:end",this,t)},show:function(){this.el.style.display=""},hide:function(){this.el.style.display="none"}}),Be=nr.extend({name:"segments",precision:.5,options:{handleClass:Be,segmentLengthThreshold:40,redundancyRemoval:!0,anchor:ng,snapRadius:10,snapHandle:!0,stopPropagation:!0},handles:null,onRender:function(){this.resetHandles();var t=this.relatedView,e=t.model.vertices();e.unshift(t.sourcePoint),e.push(t.targetPoint);for(var i=0,n=e.length;i<n-1;i++){var o=e[i],r=e[i+1],o=this.renderHandle(o,r);this.simulateRelatedView(o.el),this.handles.push(o),o.options.index=i}return this},renderHandle:function(t,e){var i=this,n=new this.options.handleClass({paper:this.paper,scale:this.options.scale,guard:function(r){return i.guard(r)}});return n.render(),this.updateHandle(n,t,e),n.vel.appendTo(this.el),this.startHandleListening(n),n},update:function(){return this.render(),this},startHandleListening:function(t){this.listenTo(t,"change:start",this.onHandleChangeStart),this.listenTo(t,"changing",this.onHandleChanging),this.listenTo(t,"change:end",this.onHandleChangeEnd)},resetHandles:function(){var t=this.handles;if(this.handles=[],this.stopListening(),Array.isArray(t))for(var e=0,i=t.length;e<i;e++)t[e].remove()},shiftHandleIndexes:function(t){for(var e=this.handles,i=0,n=e.length;i<n;i++)e[i].options.index+=t},resetAnchor:function(t,e){var i=this.relatedView.model;e?i.prop([t,"anchor"],e,{rewrite:!0,ui:!0,tool:this.cid}):i.removeProp([t,"anchor"],{ui:!0,tool:this.cid})},snapHandle:function(n,e,i){var s=n.options.index,o=this.relatedView.model.vertices(),n=n.options.axis,r=o[s-2]||i.sourceAnchor,o=o[s+1]||i.targetAnchor,s=this.options.snapRadius;return Math.abs(e[n]-r[n])<s?e[n]=r[n]:Math.abs(e[n]-o[n])<s&&(e[n]=o[n]),e},onHandleChanging:function(t,s){var i=this.options,n=this.eventData(s),r=this.relatedView,a=r.paper,o=t.options.index-1,s=Tt(s),a=a.snapToGrid(s.clientX,s.clientY),l=this.snapHandle(t,a.clone(),n),h=t.options.axis,u=this.options.snapHandle?0:a[h]-l[h],d=r.model,p=dt(d.vertices()),m=this.options.anchor,G=(typeof m!="function"&&(m=null),t.options.index),F=[r.sourcePoint.clone()].concat(p,[r.targetPoint.clone()]),N=0,v=(0<=G-1&&(v=F[G-1],k=F[G],new Ot(v,k).vector().theta()%90!=0&&(p.splice(G-1,0,n.originalVertices[G-1]),N++,this.shiftHandleIndexes(1))),p[o+N]),k=p[1+o+N],N=(G+2<F.length&&(I=F[G+1],F=F[G+2],new Ot(I,F).vector().theta()%90!=0&&(I=n.originalVertices.length===1,F=n.firstHandleShifted&&!I?1:0,p.splice(G+(1+N),0,n.originalVertices[(I?0:G)-F]))),r.sourceView),I=r.sourceBBox,G=!1,F=!1,I=(v?o==0?I.containsPoint(v)?(p.shift(),this.shiftHandleIndexes(-1),G=!0):(v[h]=l[h],F=!0):v[h]=l[h]:((v=r.sourceAnchor.toJSON())[h]=l[h],I.containsPoint(v)?(v[h]=l[h],G=!0):(p.unshift(v),this.shiftHandleIndexes(1),F=n.firstHandleShifted=!0)),m&&N&&(G&&((I=n.sourceAnchor.clone())[h]=l[h],G=m.call(r,I,N,r.sourceMagnet||N.el,"source",r),this.resetAnchor("source",G)),F&&this.resetAnchor("source",n.sourceAnchorDef)),r.targetView),N=r.targetBBox,G=!1,F=!1;if(k?o==p.length-2?N.containsPoint(k)?(p.pop(),G=!0):(k[h]=l[h],F=!0):k[h]=l[h]:((k=r.targetAnchor.toJSON())[h]=l[h],N.containsPoint(k)?G=!0:(p.push(k),F=!0)),m&&I&&(G&&((o=n.targetAnchor.clone())[h]=l[h],N=m.call(r,o,I,r.targetMagnet||I.el,"target",r),this.resetAnchor("target",N)),F&&this.resetAnchor("target",n.targetAnchorDef)),p.some(function(H){return!H}))throw new Error("Segments: incompatible router in use");d.vertices(p,{ui:!0,tool:this.cid}),this.updateHandle(t,v,k,u),i.stopPropagation||r.notifyPointermove(s,a.x,a.y)},onHandleChangeStart:function(t,e){var i=this.options,n=this.handles,r=this.relatedView,o=r.model,s=r.paper,a=t.options.index;if(Array.isArray(n)){for(var l=0,h=n.length;l<h;l++)l!==a&&n[l].hide();this.focus(),this.eventData(e,{sourceAnchor:r.sourceAnchor.clone(),targetAnchor:r.targetAnchor.clone(),sourceAnchorDef:ot(o.prop(["source","anchor"])),targetAnchorDef:ot(o.prop(["target","anchor"])),originalVertices:dt(o.vertices()),firstHandleShifted:!1}),o.startBatch("segment-move",{ui:!0,tool:this.cid}),i.stopPropagation||r.notifyPointerdown.apply(r,s.getPointerArgs(e))}},onHandleChangeEnd:function(t,o){var i=this.options,n=this.relatedView,s=n.paper,r=n.model,o=(i.redundancyRemoval&&n.removeRedundantLinearVertices({ui:!0,tool:this.cid}),Tt(o)),s=s.snapToGrid(o.clientX,o.clientY);this.render(),this.blur(),r.stopBatch("segment-move",{ui:!0,tool:this.cid}),i.stopPropagation||n.notifyPointerup(o,s.x,s.y),n.checkMouseleave(o)},updateHandle:function(t,e,i,n){var r=Math.abs(e.x-i.x)<this.precision,o=Math.abs(e.y-i.y)<this.precision;!r&&!o||(o=new Ot(e,i)).length()<this.options.segmentLengthThreshold?t.hide():((e=o.midpoint())[i=r?"x":"y"]+=n||0,r=o.vector().vectorAngle(new Q(1,0)),t.position(e.x,e.y,r,this.relatedView),t.show(),t.options.axis=i)},onRemove:function(){this.resetHandles()}},{SegmentHandle:Be}),ri=nr.extend({tagName:"path",xAxisVector:new Q(1,0),events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{scale:null},onRender:function(){this.update()},update:function(){var t,e=this.ratio,i=this.relatedView,n=i.getTangentAtRatio(e),n=n?(t=n.start,n.vector().vectorAngle(this.xAxisVector)||0):(t=i.getPointAtRatio(e),0);return t&&(i=X.createSVGMatrix().translate(t.x,t.y).rotate(n),(e=this.options.scale)&&(i=i.scale(e)),this.vel.transform(i,{absolute:!0})),this},onPointerDown:function(t){this.guard(t)||(t.stopPropagation(),t.preventDefault(),(t=this.relatedView).model.startBatch("arrowhead-move",{ui:!0,tool:this.cid}),t.can("arrowheadMove")&&(t.startArrowheadMove(this.arrowheadType),this.delegateDocumentEvents(),t.paper.undelegateEvents()),this.focus(),this.el.style.pointerEvents="none")},onPointerMove:function(e){var e=Tt(e),i=this.paper.snapToGrid(e.clientX,e.clientY);this.relatedView.pointermove(e,i.x,i.y)},onPointerUp:function(n){this.undelegateDocumentEvents();var e=this.relatedView,i=e.paper,n=Tt(n),r=i.snapToGrid(n.clientX,n.clientY);e.pointerup(n,r.x,r.y),i.delegateEvents(),this.blur(),this.el.style.pointerEvents="",e.model.stopBatch("arrowhead-move",{ui:!0,tool:this.cid})}}),Go=ri.extend({name:"target-arrowhead",ratio:1,arrowheadType:"target",attributes:{d:"M -10 -8 10 0 -10 8 Z",fill:"#33334F",stroke:"#FFFFFF","stroke-width":2,cursor:"move",class:"target-arrowhead"}}),ri=ri.extend({name:"source-arrowhead",ratio:0,arrowheadType:"source",attributes:{d:"M 10 -8 -10 0 10 8 Z",fill:"#33334F",stroke:"#FFFFFF","stroke-width":2,cursor:"move",class:"source-arrowhead"}}),Da=nr.extend({name:"boundary",tagName:"rect",options:{padding:10,useModelGeometry:!1},attributes:{fill:"none",stroke:"#33334F","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"},onRender:function(){this.update()},update:function(){var t=this.relatedView,r=this.options,e=this.vel,n=r.useModelGeometry,i=r.rotate,r=ti(r.padding),n=_l(t,n).moveAndExpand({x:-r.left,y:-r.top,width:r.left+r.right,height:r.top+r.bottom}),r=t.model;return r.isElement()&&(t=r.angle())&&(i?(i=r.getBBox().center(),e.rotate(t,i.x,i.y,{absolute:!0})):n=n.bbox(t)),e.attr(n.toJSON()),this}}),Ms=nr.extend({tagName:"g",type:null,children:[{tagName:"circle",selector:"anchor",attributes:{cursor:"pointer"}},{tagName:"rect",selector:"area",attributes:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onPointerDown",touchstart:"onPointerDown",dblclick:"onPointerDblClick",dbltap:"onPointerDblClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{snap:function(t,e,i,n,r,o){return o=o.options.snapRadius,n=n==="source",(n=this.model.vertex(n?0:-1)||this.getEndAnchor(n?"target":"source"))&&(Math.abs(n.x-t.x)<o&&(t.x=n.x),Math.abs(n.y-t.y)<o&&(t.y=n.y)),t},anchor:ng,scale:null,resetAnchor:!0,customAnchorAttributes:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttributes:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,restrictArea:!0,redundancyRemoval:!0},onRender:function(){this.renderChildren(),this.toggleArea(!1),this.update()},update:function(){var t=this.type;return this.relatedView.getEndView(t)?(this.updateAnchor(),this.updateArea(),this.el.style.display=""):this.el.style.display="none",this},updateAnchor:function(){var t=this.childNodes;if(t){var e=t.anchor;if(e){var i,t=this.relatedView,o=this.type,n=t.getEndAnchor(o),r=this.options,t=t.model.prop([o,"anchor"]),o="translate("+n.x+","+n.y+")",s=(r.scale&&(o+=" scale("+r.scale+")"),e.setAttribute("transform",o),t?r.customAnchorAttributes:r.defaultAnchorAttributes);for(i in s)e.setAttribute(i,s[i])}}},updateArea:function(){var t,e,i,n,r,o,s,a=this.childNodes;!a||(a=a.area)&&(i=this.relatedView,n=this.type,e=(t=i.getEndView(n)).model,i=i.getEndMagnet(n),n=this.options.areaPadding,isFinite(n)||(n=0),t.isNodeConnection(i)?(o=0,s=(r=t.getNodeBBox(i)).center()):(r=t.getNodeUnrotatedBBox(i),o=e.angle(),s=r.center(),o&&s.rotate(e.getBBox().center(),-o)),r.inflate(n),a.setAttribute("x",-r.width/2),a.setAttribute("y",-r.height/2),a.setAttribute("width",r.width),a.setAttribute("height",r.height),a.setAttribute("transform","translate("+s.x+","+s.y+") rotate("+o+")"))},toggleArea:function(t){var e=this.childNodes;!e||(e=e.area)&&(e.style.display=t?"":"none")},onPointerDown:function(t){this.guard(t)||(t.stopPropagation(),t.preventDefault(),this.paper.undelegateEvents(),this.delegateDocumentEvents(),this.focus(),this.toggleArea(this.options.restrictArea),this.relatedView.model.startBatch("anchor-move",{ui:!0,tool:this.cid}))},resetAnchor:function(t){var e=this.type,i=this.relatedView.model;t?i.prop([e,"anchor"],t,{rewrite:!0,ui:!0,tool:this.cid}):i.removeProp([e,"anchor"],{ui:!0,tool:this.cid})},onPointerMove:function(h){var e,i,n,r=this.relatedView,o=this.type,s=r.getEndView(o),a=s.model,l=r.getEndMagnet(o),h=Tt(h),h=this.paper.clientToLocalPoint(h.clientX,h.clientY),u=this.options.snap,u=(typeof u=="function"&&(h=u.call(r,h,s,l,o,r,this),h=new Q(h)),this.options.restrictArea&&(s.isNodeConnection(l)?(u=s.getClosestPoint(h))&&(h=u):(u=s.getNodeUnrotatedBBox(l),e=a.angle(),a=a.getBBox().center(),i=h.clone().rotate(a,e),u.containsPoint(i)||(h=u.pointNearestToPoint(i).rotate(a,-e)))),this.options.anchor);typeof u=="function"&&(n=u.call(r,h,s,l,o,r)),this.resetAnchor(n),this.update()},onPointerUp:function(e){var e=Tt(e),i=(this.paper.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1),this.relatedView);this.options.redundancyRemoval&&i.removeRedundantLinearVertices({ui:!0,tool:this.cid}),i.checkMouseleave(e),i.model.stopBatch("anchor-move",{ui:!0,tool:this.cid})},onPointerDblClick:function(){var t=this.options.resetAnchor;t!==!1&&(this.resetAnchor(dt(t=t===!0?null:t)),this.update())}}),gc=Ms.extend({name:"source-anchor",type:"source"}),Ms=Ms.extend({name:"target-anchor",type:"target"}),Ln=nr.extend({name:"button",events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},options:{distance:0,offset:0,scale:null,rotate:!1},onRender:function(){this.renderChildren(this.options.markup),this.update()},update:function(){return this.position(),this},position:function(){this.vel.transform(this.getCellMatrix(),{absolute:!0})},getCellMatrix:function(){return this.relatedView.model.isLink()?this.getLinkMatrix():this.getElementMatrix()},getElementMatrix:function(){var o=this.relatedView,n=this.options,t=n.x,e=(t===void 0&&(t=0),n.y),a=(e===void 0&&(e=0),n.offset),r=(a===void 0&&(a={}),n.useModelGeometry),i=n.rotate,n=n.scale,r=_l(o,r),o=o.model.angle(),s=(i||(r=r.bbox(o)),a.x),a=(s===void 0&&(s=0),a.y),l=(a===void 0&&(a=0),ni(t)?t=parseFloat(t)/100*r.width:kn(t)&&(t=Number(Tn(t,r))),ni(e)?e=parseFloat(e)/100*r.height:kn(e)&&(e=Number(Tn(e,r))),X.createSVGMatrix().translate(r.x+r.width/2,r.y+r.height/2)),l=(l=i?l.rotate(o):l).translate(t+s-r.width/2,e+a-r.height/2);return l=n?l.scale(n):l},getLinkMatrix:function(){var t,o=this.relatedView,n=this.options,e=n.offset,r=(e===void 0&&(e=0),n.distance),i=n.rotate,n=n.scale,r=ni(r=r===void 0?0:r)?o.getTangentAtRatio(parseFloat(r)/100):o.getTangentAtLength(r),r=r?(t=r.start,r.vector().vectorAngle(new Q(1,0))||0):(t=o.getConnection().start,0),o=X.createSVGMatrix().translate(t.x,t.y).rotate(r).translate(0,e);return i||(o=o.rotate(-r)),o=n?o.scale(n):o},onPointerDown:function(t){var e;this.guard(t)||(t.stopPropagation(),t.preventDefault(),typeof(e=this.options.action)=="function"&&e.call(this.relatedView,t,this.relatedView,this))}}),Dn=Ln.extend({children:[{tagName:"circle",selector:"button",attributes:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attributes:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],options:{distance:60,offset:0,action:function(t,e,i){e.model.remove({ui:!0,tool:i.cid})}}}),Ia=Ln.extend({name:"connect",documentEvents:{mousemove:"drag",touchmove:"drag",mouseup:"dragend",touchend:"dragend",touchcancel:"dragend"},children:[{tagName:"circle",selector:"button",attributes:{r:7,fill:"#333333",cursor:"pointer"}},{tagName:"path",selector:"icon",attributes:{d:"M -4 -1 L 0 -1 L 0 -4 L 4 0 L 0 4 0 1 -4 1 z",fill:"#FFFFFF",stroke:"none","stroke-width":2,"pointer-events":"none"}}],options:{distance:80,offset:0,magnet:function(t){return t.el},action:function(t,e,i){return i.dragstart(t)}},getMagnetNode:function(){var t,e=this.options,i=this.relatedView,n=e.magnet;switch(typeof n){case"function":t=n.call(this,i,this);break;case"string":t=i.findBySelector(n)[0];break;default:t=n}if((t=t||i.el)instanceof SVGElement)return t;throw new Error("Connect: magnet must be an SVGElement")},dragstart:function(n){var e=this.paper,i=this.relatedView,n=Tt(n),o=e.clientToLocalPoint(n.clientX,n.clientY),r=o.x,o=o.y;i.dragLinkStart(n,this.getMagnetNode(),r,o),e.undelegateEvents(),this.delegateDocumentEvents(null,n.data),this.focus()},drag:function(i){var r=this.paper,e=this.relatedView,i=Tt(i),r=r.snapToGrid(i.clientX,i.clientY),n=r.x,r=r.y;e.dragLink(i,n,r)},dragend:function(n){var e=this.paper,i=this.relatedView,n=Tt(n),o=e.snapToGrid(n.clientX,n.clientY),r=o.x,o=o.y;i.dragLinkEnd(n,r,o),this.undelegateDocumentEvents(),e.delegateEvents(),this.blur(),i.checkMouseleave(n)}}),zi=Ia.extend({name:"hover-connect",defaultMarkup:[{tagName:"circle",attributes:{r:7,fill:"#333333",cursor:"pointer"}},{tagName:"path",attributes:{d:"M -4 -1 L 0 -1 L 0 -4 L 4 0 L 0 4 0 1 -4 1 z",fill:"#FFFFFF",stroke:"none","stroke-width":2}}],children:function(){var t=this.options,e=this.defaultMarkup;return[{tagName:"path",selector:"track",attributes:{fill:"none",stroke:"transparent","stroke-width":t.trackWidth||15,cursor:"pointer"}},{tagName:"g",selector:"button",attributes:{"pointer-events":"none",display:"none"},children:t.markup||e}]},events:Object.assign({mousemove:"onMousemove",mouseenter:"onMouseenter",mouseleave:"onMouseleave"},Ia.prototype.events),onRender:function(){this.renderChildren(),this.update()},trackPath:null,update:function(){var t=this.childNodes;this.trackPath=this.getTrackPath(),Ia.prototype.update.apply(this,arguments),t.track.setAttribute("d",this.trackPath.serialize())},position:function(){var t=this.el;this.childNodes.button.setAttribute("transform",X.matrixToTransformString(this.getButtonMatrix())),t.setAttribute("transform",X.matrixToTransformString(this.getTrackMatrix()))},getButtonMatrix:function(){var t,n=this.options,o=this.trackPath,e=n.offset,r=(e===void 0&&(e=0),n.distance),i=n.rotate,n=n.scale,r=ni(r=r===void 0?0:r)?o.tangentAtRatio(parseFloat(r)/100):o.tangentAtLength(r),r=r?(t=r.start,r.vector().vectorAngle(new Q(1,0))||0):(t=o.start,0),o=X.createSVGMatrix().translate(t.x,t.y).rotate(r).translate(0,e);return i||(o=o.rotate(-r)),o=n?o.scale(n):o},getTrackPath:function(){return this.relatedView.getConnection()},getTrackMatrix:function(){return X.createSVGMatrix()},getTrackRatioFromEvent:function(n){var i=this.relatedView,e=this.trackPath,i=i.paper.clientToLocalPoint(n.clientX,n.clientY),n=X.transformPoint(i,this.getTrackMatrix().inverse());return e.closestPointLength(n)},canShowButton:function(){return P._data(this.paper.el,"events")},showButton:function(){this.childNodes.button.style.display="block"},hideButton:function(){this.childNodes.button.style.display=""},onMousemove:function(t){this.trackPath&&(this.options.distance=this.getTrackRatioFromEvent(t),this.position())},onMouseenter:function(){this.canShowButton()&&this.showButton()},onMouseleave:function(){this.hideButton()}}),nn={__proto__:null,Vertices:nn,Segments:Be,TargetArrowhead:Go,SourceArrowhead:ri,Boundary:Da,SourceAnchor:gc,TargetAnchor:Ms,Button:Ln,Remove:Dn,Connect:Ia,HoverConnect:zi},Go=nr.extend({tagName:"g",children:[{tagName:"circle",selector:"handle",attributes:{cursor:"pointer","stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6}},{tagName:"rect",selector:"extras",attributes:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onPointerDown",touchstart:"onPointerDown",dblclick:"onPointerDblClick",dbltap:"onPointerDblClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{handleAttributes:null,selector:"root",padding:6,scale:null},getPosition:function(){},setPosition:function(){},resetPosition:function(){},onRender:function(){this.renderChildren(),this.toggleExtras(!1),this.update()},update:function(){var e=this.childNodes,t=e.handle,e=e.extras;if(t)return this.updateHandle(t),e&&this.updateExtras(e),this;throw new Error("Control: markup selector `handle` is required")},updateHandle:function(t){var n=this.relatedView,r=this.options,e=n.model,n=this.getPosition(n,this),e=e.getAbsolutePointFromRelative(n),i=r.handleAttributes,n=r.scale,r="translate("+e.x+","+e.y+")";if(n&&(r+=" scale("+n+")"),t.setAttribute("transform",r),i)for(var o in i)t.setAttribute(o,i[o])},updateExtras:function(t){var e=this.relatedView,i=this.options,n=this.options.selector;if(n){if(n=e.findBySelector(n)[0],!n)throw new Error("Control: invalid selector.");var i=i.padding,n=(isFinite(i)||(i=0),e.getNodeUnrotatedBBox(n)),e=e.model,r=e.angle(),o=n.center();r&&o.rotate(e.getBBox().center(),-r),n.inflate(i),t.setAttribute("x",-n.width/2),t.setAttribute("y",-n.height/2),t.setAttribute("width",n.width),t.setAttribute("height",n.height),t.setAttribute("transform","translate("+o.x+","+o.y+") rotate("+r+")")}else this.toggleExtras(!1)},toggleExtras:function(t){var e=this.childNodes.extras;e&&(e.style.display=t?"":"none")},onPointerDown:function(t){var e=this.relatedView,i=this.paper;this.guard(t)||(t.stopPropagation(),t.preventDefault(),i.undelegateEvents(),this.delegateDocumentEvents(),this.focus(),this.toggleExtras(!0),e.model.startBatch("control-move",{ui:!0,tool:this.cid}))},onPointerMove:function(n){var e=this.relatedView,r=this.paper,i=e.model,n=Tt(n),o=n.clientX,n=n.clientY,r=r.clientToLocalPoint(o,n),o=i.getRelativePointFromAbsolute(r);this.setPosition(e,o,this),this.update()},onPointerUp:function(t){var e=this.relatedView;this.paper.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleExtras(!1),e.model.stopBatch("control-move",{ui:!0,tool:this.cid})},onPointerDblClick:function(){var t=this.relatedView;this.resetPosition(t,this),this.update()}}),ri=zi.extend({getTrackPath:function(){var t=this.relatedView,i=this.options,e=i.useModelGeometry,i=i.trackPath;return kn(i=typeof(i=i===void 0?"M 0 0 H calc(w) V calc(h) H 0 Z":i)=="function"?i.call(this,t):i)&&(i=Tn(i,_l(t,e))),new At(X.normalizePathData(i))},getTrackMatrix:function(){var i=this.relatedView,t=this.options,e=t.useModelGeometry,t=t.rotate,e=_l(i,e),i=i.model.angle(),n=(t||(e=e.bbox(i)),X.createSVGMatrix().translate(e.x+e.width/2,e.y+e.height/2));return n=(n=t?n.rotate(i):n).translate(-e.width/2,-e.height/2)}}),gc={__proto__:null,Button:Ln,Remove:Dn,Connect:Ia,Boundary:Da,HoverConnect:ri,Control:Go},Ms=X,zi=Kt,Hf=ee.prototype,Ln=zi.define("standard.Record",{size:{width:100},padding:0,scrollTop:null,items:[],itemHeight:20,itemOffset:20,itemMinLabelWidth:10,itemButtonSize:10,itemIcon:{width:16,height:16,padding:2},itemOverflow:!1,itemAboveViewSelector:"root",itemBelowViewSelector:"root",attrs:{wrapper:{scrollable:!0},bodiesGroups:{fill:"transparent",stroke:"none"},labelsGroups:{fill:"#333333"},buttonsGroups:{fill:"transparent",stroke:"#333333",strokeWidth:1},forksGroups:{stroke:"#333333"},groups:{groupPosition:!0},itemBodies:{groupWidth:!0,itemHighlight:{fill:"#eeeeee"}},itemLabels:{fontSize:16,textVerticalAnchor:"middle",itemText:{textWrap:!0,ellipsis:!0},itemHighlight:{fill:"red"}}}},{markup:[],metrics:null,markupAttributes:["items","itemHeight","itemOffset","itemIcon","itemMinLabelWidth","itemButtonSize","itemOverflow","padding"],initialize:function(){Kt.prototype.initialize.apply(this,arguments),this.on("change",this.onChange,this),this.buildMarkup()},anyHasChanged:function(t){return!!Array.isArray(t)&&t.some(function(e){return this.hasChanged(e)},this)},onChange:function(t,e){e.record!==this.id&&this.hasChanged("markup")&&Ss("Markup can not be modified."),this.anyHasChanged(this.markupAttributes)&&this.buildMarkup(e)},getPadding:function(){return ti(this.attributes.padding)},buildMarkup:function(t){var e=this.metrics={},i=e.items={},n=this.attributes,r=n.itemHeight,o=n.itemOffset,s=!!n.itemOverflow,a=n.items,l=(a=Array.isArray(a)?a:[]).length,h=0,u=dt(this.markup),d=(Array.isArray(u)||Ss("Expects Prototype JSON Markup."),this.getPadding()),p=0,m=[];u.push({tagName:"g",selector:"wrapper",children:m});for(var v=0;v<l;v++){for(var k=[],I=[],N=[],G=[],F=[],H=Array.from(a[v]),Y=this.createQueue(H,0,[],null),_=0,K=0;0<Y.length;){var Z=Y.pop(),tt=Z.path,b=Z.level,vt=Z.item,Z=Z.parent,O=(b===0&&tt.splice(1,0,v),vt.id),M=b!==-1,T=vt.height||r,j=vt.icon,f=vt.items,x=!!vt.highlighted,C=!!vt.collapsed,D=Array.isArray(f)&&0<f.length,Z=(O||Ss("Item id required."),i.hasOwnProperty(O)&&Ss("Duplicated item id."),i[O]={path:tt,visible:M,parent:Z,label:vt.label,height:T,group:v,hasSubItems:D,highlighted:x,collapsed:C});D&&(Z.children=f.map(function(it){return it.id}),Array.prototype.push.apply(Y,this.createQueue(f,C||!M?-1:b+1,tt,O))),M&&(Z.x=(x=o*b)+o,Z.y=_,Z.cx=x+o/2,Z.cy=_+T/2,Z.span=vt.span||1,O&&(f=this.getItemBodyMarkup(vt,x,_,v,s&&v===0?d.left:0),k.push(f),tt=this.getItemLabelMarkup(vt,x,_,v),I.push(tt),D&&(N.push(this.getButtonMarkup(vt,x,_,v)),C||F.push(O)),j&&(G.push(this.getIconMarkup(vt,x,_,v)),Z.x+=n.itemIcon.width+n.itemIcon.padding)),K=Math.max(K,Z.x+n.itemMinLabelWidth),_+=T)}p=Math.max(K,p),h=Math.max(h,_),H=[],m.push({tagName:"g",selector:this.getSelector("group",v),groupSelector:"groups",attributes:{"record-group":v},children:H}),H.push({tagName:"g",selector:this.getSelector("bodiesGroup",v),groupSelector:"bodiesGroups",children:k},{tagName:"g",selector:this.getSelector("labelsGroup",v),groupSelector:"labelsGroups",children:I}),0<F.length&&H.push({tagName:"g",selector:this.getSelector("forksGroup",v),groupSelector:"forksGroups",children:F.map(this.getForkMarkup,this)}),0<N.length&&H.push({tagName:"g",selector:this.getSelector("buttonsGroup",v),groupSelector:"buttonsGroups",children:N}),0<G.length&&H.push({tagName:"g",selector:this.getSelector("iconsGroup",v),groupSelector:"iconsGroups",children:G})}e.padding=d,e.groupsCount=l,e.overflow=s,e.minHeight=h+d.top+d.bottom,e.minWidth=p*l+d.left+d.right,e=ct({record:this.id,dry:!0},t),this.set("markup",u,e),this.autoresize(e)},autoresize:function(t){var e=this.getMinimalSize(),n=this.attributes.size,i=n.height,n=n.width,i=this.getScrollTop()===null?e.height:i,n=Math.max(n,e.width);this.resize(n,i,t)},getMinimalSize:function(){var t=this.metrics;return{width:t.minWidth,height:t.minHeight}},removeInvalidLinks:function(t){var e=this.graph;return e?e.getConnectedLinks(this).filter(this.isLinkInvalid,this).map(function(i){return i.remove(t)}):[]},isLinkInvalid:function(t){var e=this.id,i=this.metrics.items,n=t.source(),r=n.port;return!(n.id!==e||!r||i[r]||this.hasPort(r))||(r=(n=t.target()).port,!(n.id!==e||!r||i[r]||this.hasPort(r)))},createQueue:function(t,e,i,n){var r=t.length;return Array.from({length:r},function(o,s){return s=r-s-1,{path:i.concat(["items",s]),item:t[s],level:e,parent:n}})},getGroupSelector:function(t){for(var e=Array.prototype.slice.call(arguments,1),i=[t],n=0,r=e.length;n<r;n++){var o=e[n];if(o!=null)for(var s=0,a=(o=Array.isArray(o)?o:[o]).length;s<a;s++)i.push(this.getSelector(t,o[s]))}return i},getItemLabelMarkup:function(t,l,i,n){var r=this.attributes,o=r.itemOffset,s=t.height||r.itemHeight,a=t.id,l=l+o;return t.icon&&(l+=r.itemIcon.width+2*r.itemIcon.padding),{tagName:"text",className:"record-item-label",selector:this.getSelector("itemLabel",a),groupSelector:this.getGroupSelector("itemLabels",n,t.group),attributes:{x:l,y:i+s/2,"item-id":a}}},getItemBodyMarkup:function(t,e,i,n,o){var s=0,o=(o&&(s-=o),{x:s,y:i,height:t.height||this.attributes.itemHeight,"item-id":t.id}),s=t.span;return s&&(o["item-span"]=s),{tagName:"rect",selector:this.getSelector("itemBody",t.id),groupSelector:this.getGroupSelector("itemBodies",n,t.group),className:"record-item-body",attributes:o}},getButtonMarkup:function(t,e,i){var o=this.attributes,n=o.itemButtonSize,r=o.itemOffset,o=t.height||o.itemHeight;return{tagName:"path",className:"record-item-button",attributes:{d:this.getButtonPathData(e+r/2,i+o/2,n/2,t.collapsed),"item-id":t.id,cursor:"pointer","shape-rendering":"geometricprecision"}}},getIconMarkup:function(t,e,i,n){var s=this.attributes,r=s.itemOffset,o=s.itemIcon,s=t.height||s.itemHeight;return{tagName:"image",className:"record-item-icon",selector:this.getSelector("itemIcon",t.id),groupSelector:this.getGroupSelector("itemIcons",n,t.group),attributes:{x:e+r+o.padding,y:i+(s-o.height)/2,width:o.width,height:o.height,"xlink:href":t.icon,"item-id":t.id}}},getForkMarkup:function(t){return{tagName:"path",attributes:{d:this.getForkPathData(t),fill:"none"}}},getButtonPathData:function(t,e,i,n){var r=["M",t-i,e-i,t+i,e-i,t+i,e+i,t-i,e+i,"Z","M",t-i/2,e,t+i/2,e];return n&&Array.prototype.push.apply(r,["M",t,e-i/2,t,e+i/2]),r.join(" ")},getForkPathData:function(t){var e=this.metrics.items;if(!e)return null;var i=e[t];if(!i)return null;var n=i.children;if(!n||n.length===0)return null;for(var r=this.attributes.itemButtonSize,o=[],s=0,a=n.length;s<a;s++){var l,h=(l=e[n[s]]).cx+(l.hasSubItems?-1:1)*r/2;o.push("M",i.cx,l.cy,h,l.cy)}return o.push("M",i.cx,i.cy+r/2,i.cx,l.cy),o.join(" ")},item:function(t,e,i){return t=this.getItemPathArray(t),t?e===void 0?this.prop(t):this.prop(t,e,i):null},toggleItemCollapse:function(n,e){var i,n=this.getItemPathArray(n);return n&&(n.push("collapsed"),i=!!this.prop(n),this.prop(n,!i,e)),this},toggleItemHighlight:function(n,e){var i,n=this.getItemPathArray(n);return n&&(n.push("highlighted"),i=!!this.prop(n),this.prop(n,!i,e)),this},isItemVisible:function(t){return this.getItemCacheAttribute(t,"visible")},isItemCollapsed:function(t){return this.getItemCacheAttribute(t,"collapsed")},isItemHighlighted:function(t){return this.getItemCacheAttribute(t,"highlighted")},getItemParentId:function(t){return this.getItemCacheAttribute(t,"parent")},getItemGroupIndex:function(t){return this.getItemCacheAttribute(t,"group")},getItemPathArray:function(t){return t=this.getItemCacheAttribute(t,"path"),t?t.slice():null},getItemSide:function(t){var e=this.getItemGroupIndex(t);if(e===null)return null;var i=this.metrics,n=i.groupsCount;if(1<n){if(e===0)return"left";if(e+i.items[t].span-1==n-1)return"right"}return"middle"},getItemCacheAttribute:function(t,e){return e&&(t=this.getItemCache(t))?t[e]:null},getItemCache:function(t){var e=this.metrics.items;return e&&e[t]||null},getItemBBox:function(r){var e,i,n,r=this.getItemCache(r);return r?(e=r.x,i=r.y,n=r.width,r=r.height,new nt(e,i,n,r)):null},getSelector:function(t,e){return t+"_"+e},removeItem:function(r,e){var i,n,r=this.getItemPathArray(r);return r&&(i=r.pop(),1<(n=this.prop(r).slice()).length?(n.splice(i,1),this.prop(r,n,ct({rewrite:!0},e))):2<r.length?this.removeProp(r,e):(i=r.pop(),(n=this.get("items").slice()).splice(i,1,[]),this.prop(r,n,ct({rewrite:!0},e)))),this},addNextSibling:function(t,e,i){var n=this.getItemPathArray(t);return n?(t=this.getItemParentId(t)||this.getItemGroupIndex(t),n=n[n.length-1]+1,this.addItemAtIndex(t,n,e,i)):this},addPrevSibling:function(t,e,i){var n=this.getItemPathArray(t);return n?(t=this.getItemParentId(t)||this.getItemGroupIndex(t),n=n[n.length-1],this.addItemAtIndex(t,n,e,i)):this},addItemAtIndex:function(t,a,i,n){if(!i)return this;switch(typeof t){case"number":var r=this.prop("items"),o=["items",Math.min(Math.max(t,0),r.length)];break;case"string":if(!(o=this.getItemPathArray(t)))return this;o.push("items");break;default:Ss("Requires an item id.")}var s=this.prop(o),s=Array.isArray(s)?s.slice():[],a=Math.min(Math.max(a,0),s.length);return s.splice(a,0,i),this.prop(o,s,ct({rewrite:!0},n))},toJSON:function(){var t=Kt.prototype.toJSON.apply(this,arguments);return delete t.markup,t},getItemViewSign:function(o){this.isItemVisible(o)||Ss('Item "'+o+'" does not exist or is not visible.');var e,i=this.attributes,n=this.metrics,o=n.items[o],r=o.y,o=o.height,s=this.getScrollTop();return s===null?0:(i=i.size.height,e=(n=n.padding).top,n=n.bottom,r-s<0?-1:i-e-n-(r+o-s)<0?1:0)},isItemInView:function(t){return this.getItemViewSign(t)===0},isEveryItemInView:function(){return this.getScrollTop()===null||this.metrics.minHeight<=this.size().height},clampScrollTop:function(t){var e=this.size().height,i=this.metrics.minHeight;return Number.isFinite(t)?Math.min(Math.max(t,0),Math.max(i-e,0)):null},getScrollTop:function(){return this.clampScrollTop(this.get("scrollTop"))},setScrollTop:function(n,e){var i=this.get("scrollTop"),n=this.clampScrollTop(n);i!==n&&this.set("scrollTop",n,e)}},{attributes:{itemText:{set:function(t,e,i,n){if(!ve(t))return null;var r,o,s,a,l=this.model,h=i.getAttribute("item-id"),h=l.metrics.items[h];h&&(r=h.label,s=l.metrics.padding,l=l.metrics.groupsCount,o=h.x,e=(e.width-s.left-s.right)/l*h.span-o,s=new nt(o,h.y,e,h.height),l=t.textWrap?(a="textWrap",ct({text:r},t)):(a="text",r),this.getAttributeDefinition(a).set.call(this,l,s,i,n))}},itemHighlight:{set:function(t,e,i,n){if(!ve(t))return null;var r=this.model,o=i.getAttribute("item-id");switch(r.getItemCacheAttribute(o,"highlighted")){case!0:return t;case null:case!1:return Object.keys(t).reduce(function(s,a){return!(n.hasOwnProperty(a)||n.hasOwnProperty(ca(a)))&&i.getAttribute(a)&&(s[a]=null),s},{})}}},groupWidth:{set:function(t,s,i){var n=this.model.metrics,r=n.padding,o=n.groupsCount,s=(s.width-r.left-r.right)/o,a=Number(i.getAttribute("item-span")||1);return s*=a=isFinite(a)?a:1,n.overflow&&((n=Number(this.findAttribute("record-group",i)))===0&&(s+=r.left),n+a===o&&(s+=r.right)),{width:s}}},groupPosition:{position:function(t,r,s){var s=Number(s.getAttribute("record-group")),n=this.model.metrics,o=n.groupsCount,n=n.padding,r=(r.width-n.left-n.right)/o,o=n.left+s*r,s=n.top;return new Q(o,s)}},scrollable:{set:rg(function(t,e){var i,l=this.paper,o=l.svg,l=l.defs,r=this.model,n="scroll-clip-"+this.cid,o=o.getElementById(n),o=(o?i=(o=X(o)).children()[0]:(i=X("rect"),(o=X("clipPath",{id:n},[i])).appendTo(l)),r.metrics),l=o.padding,r=o.overflow,o=l.top,s=l.bottom,a=l.left,l=l.right,h=0,u=e.width;return r||(h+=a,u-=a+l),i.attr({y:t+o,x:h,width:u,height:Math.max(e.height-o-s,0)}),{"clip-path":"url(#"+n+")"}}),position:rg(function(t){return new Q(0,-t)})}}}),Dn=Ln.define("standard.BorderedRecord",{padding:0,attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#000000",fill:"#FFFFFF"}}},{markup:[{tagName:"rect",selector:"body"}]}),ri=Ln.define("standard.HeaderedRecord",{padding:{top:30,left:0,right:0,bottom:0},itemAboveViewSelector:"header",itemBelowViewSelector:"header",attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#000000",fill:"#FFFFFF"},header:{refWidth:"100%",height:30,stroke:"#000000",fill:"transparent"},headerLabel:{refX:"50%",refY:15,textAnchor:"middle",textVerticalAnchor:"middle",fontSize:20,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerLabel"}]}),Go=Ln.prototype.markupAttributes.reduce(function(t,e){return t[e]=["UPDATE"],t},{scrollTop:["UPDATE","TOOLS"]}),zi=ee.extend({events:{"mousedown .record-item-button":"onItemButtonClick","touchstart .record-item-button":"onItemButtonClick"},presentationAttributes:ee.addPresentationAttributes(Go),getLinkEnd:function(t){for(var e=[],i=arguments.length-1;0<i--;)e[i]=arguments[i+1];var n={id:this.model.id},r=this.findAttribute("item-id",t)||this.findAttribute("port",t);return r&&(n.port=r),this.customizeLinkEnd.apply(this,[n,t].concat(e))},getMagnetFromLinkEnd:function(t){for(var e,i=t.port,n=this.model;i&&!n.isItemVisible(i);)i=n.getItemParentId(i);if(!i)return Hf.getMagnetFromLinkEnd.apply(this,arguments);switch(n.getItemViewSign(i)){case-1:e=String(n.get("itemAboveViewSelector"));break;case 1:e=String(n.get("itemBelowViewSelector"));break;default:e=n.getSelector("itemBody",i)}return this.findBySelector(e,this.el,this.selectors)[0]},onItemButtonClick:function(t){t.button!==2&&(t.stopPropagation(),t.preventDefault(),t=t.currentTarget.getAttribute("item-id"),this.model.toggleItemCollapse(t,{ui:!0}))}});function Ss(t){throw new Error("shapes.standard.Record: "+t)}function rg(t){return function(e){for(var i=[],n=arguments.length-1;0<n--;)i[n]=arguments[n+1];return e&&(e=this.model.getScrollTop())!==null?t.call.apply(t,[this,e].concat(i)):void 0}}var Go={__proto__:null,Record:Ln,BorderedRecord:Dn,HeaderedRecord:ri,RecordView:zi,BorderedRecordView:zi,HeaderedRecordView:zi},Ln=Ae.extend({markup:['<clipPath class="clip"><rect/></clipPath>','<g class="rotatable">','<g class="scalable"></g>','<g class="background"><rect/><text/></g>','<g class="axis">','<g class="y-axis"><path/><g class="ticks"></g></g>','<g class="x-axis"><path/><g class="ticks"></g></g>','<g class="markings"></g>',"</g>",'<g class="data"><g class="series"></g></g>','<g class="foreground">','<rect/><text class="caption"/><text class="subcaption"/>','<g class="legend"><g class="legend-items"></g></g>','<line class="guideline x-guideline" /><line class="guideline y-guideline" />',"</g>","</g>"].join(""),tickMarkup:'<g class="tick"><line/><text/></g>',pointMarkup:'<g class="point"><circle/><text/></g>',barMarkup:'<path class="bar"/>',markingMarkup:'<g class="marking"><rect/><text/></g>',serieMarkup:'<g><clipPath class="serie-clip"><rect/></clipPath><path/><g class="bars"></g><g class="points"></g></g>',legendItemMarkup:'<g class="legend-item"><circle/><text/></g>',defaults:fi({type:"chart.Plot",attrs:{".data path":{fill:"none",stroke:"black"},".data .bars rect":{fill:"none",stroke:"black"},".background rect":{fill:"white",stroke:"#e5e5e5",opacity:1},".background text":{fill:"black",text:"No data available.",ref:".","ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle",display:"none"},".foreground > rect":{fill:"white",stroke:"#e5e5e5",opacity:0,"pointer-events":"none"},".foreground .caption":{fill:"black",text:"",ref:".foreground > rect","ref-x":.5,"ref-y":10,"text-anchor":"middle","y-alignment":"middle","font-size":14},".foreground .subcaption":{fill:"black",text:"",ref:".foreground > rect","ref-x":.5,"ref-y":23,"text-anchor":"middle","y-alignment":"middle","font-size":10},".point":{display:"inline-block"},".point circle":{r:2,stroke:"black",fill:"black",opacity:.3},".point text":{fill:"black","font-size":8,"text-anchor":"middle",display:"none"},".axis path":{fill:"none",stroke:"black"},".axis .tick":{fill:"none",stroke:"black"},".y-axis .tick line":{fill:"none",stroke:"black",x2:2,y2:0,opacity:1},".x-axis .tick line":{fill:"none",stroke:"black",x2:0,y2:-3,opacity:1},".y-axis .tick text":{fill:"black",stroke:"none","font-size":10,"text-anchor":"end"},".x-axis .tick text":{fill:"black",stroke:"none","font-size":10,"text-anchor":"middle"},".y-axis .tick text > tspan":{dy:"-.5em",x:-5},".x-axis .tick text > tspan":{dy:".5em",x:0},".axis .markings":{fill:"black",stroke:"none","fill-opacity":1},".axis .markings text":{fill:"black","text-anchor":"end","font-size":10,dy:-5,dx:-5},".guideline":{"pointer-events":"none",display:"none"},".x-guideline":{stroke:"black",visibility:"hidden"},".y-guideline":{stroke:"black",visibility:"hidden"},".legend":{"ref-x":10,"ref-y":10},".legend-item text":{fill:"black",transform:"translate(14, 0)","font-size":11},".legend-item circle":{r:5,transform:"translate(5,5)"},".legend-item":{cursor:"pointer"},".legend-item.disabled circle":{fill:"gray"},".legend-item.disabled text":{opacity:.5}}},Ae.prototype.defaults),legendPosition:function(t,e){e=e||{},this.trigger("batch:start"),[".legend/ref-x",".legend/ref-y",".legend/ref-dx",".legend/ref-dy",".legend/x-alignment",".legend/y-alignment"].forEach(function(i){this.removeAttr(i,{silent:!0})},this),e=e.padding||10,e={n:{".legend":{"ref-x":.5,"x-alignment":-.5,"ref-y":e}},ne:{".legend":{"ref-dx":-e,"x-alignment":-.999,"ref-y":e}},e:{".legend":{"ref-dx":-e,"x-alignment":-.999,"ref-y":.5,"y-alignment":-.5}},se:{".legend":{"ref-dx":-e,"ref-dy":-e,"x-alignment":-.999,"y-alignment":-.999}},s:{".legend":{"ref-x":.5,"ref-dy":-e,"x-alignment":-.5,"y-alignment":-.999}},sw:{".legend":{"ref-x":e,"ref-dy":-e,"y-alignment":-.999}},w:{".legend":{"ref-x":e,"ref-y":.5,"y-alignment":-.5}},nw:{".legend":{"ref-x":e,"ref-y":e}},nnw:{".legend":{"ref-x":e,"ref-y":-e,"y-alignment":-.999}},nn:{".legend":{"ref-x":.5,"ref-y":-e,"x-alignment":-.5,"y-alignment":-.999}},nne:{".legend":{"ref-dx":-e,"ref-y":-e,"x-alignment":-.999,"y-alignment":-.999}},nnee:{".legend":{"ref-dx":e,"ref-y":-e,"y-alignment":-.999}},nee:{".legend":{"ref-y":e,"ref-dx":e}},ee:{".legend":{"ref-dx":e,"ref-y":.5,"y-alignment":-.5}},see:{".legend":{"ref-dx":e,"ref-dy":-e,"y-alignment":-.999}},ssee:{".legend":{"ref-dx":e,"ref-dy":e}},sse:{".legend":{"ref-dx":-e,"ref-dy":e,"x-alignment":-.999}},ss:{".legend":{"ref-x":.5,"ref-dy":e,"x-alignment":-.5}},ssw:{".legend":{"ref-x":e,"ref-dy":e}},ssww:{".legend":{"ref-x":-e,"ref-dy":e,"x-alignment":-.999}},sww:{".legend":{"ref-x":-e,"ref-dy":-e,"x-alignment":-.999,"y-alignment":-.999}},ww:{".legend":{"ref-x":-e,"ref-y":.5,"x-alignment":-.999,"y-alignment":-.5}},nww:{".legend":{"ref-x":-e,"ref-y":e,"x-alignment":-.999}},nnww:{".legend":{"ref-x":-e,"ref-y":-e,"x-alignment":-.999,"y-alignment":-.999}}},e[t]&&this.attr(e[t]),this.trigger("batch:stop")},addPoint:function(t,e,i){i=i||{};var n=this.get("series"),r=kt(n).findIndex(function(s){return s.name===e});if(r===-1)throw new Error("Serie "+e+" was not found.");var o=dt(n[r]);o.data.push(t),Number.isFinite(i.maxLen)&&o.data.length>i.maxLen&&o.data.shift(),(n=n.slice())[r]=o,this.set("series",n,i)},lastPoint:function(t){var e=kt(this.get("series")).find(function(i){return i&&i.name===t}).data;return e[e.length-1]},firstPoint:function(t){return kt(this.get("series")).find(function(e){return e&&e.name===t}).data[0]}}),Dn=ee.extend({events:{mousemove:"onMouseMove",mouseout:"onMouseOut"},presentationAttributes:ee.addPresentationAttributes({series:["UPDATE"],interpolate:["UPDATE"],padding:["UPDATE"],canvas:["UPDATE"],markings:["UPDATE"],axis:["UPDATE"]}),initialize:function(){ee.prototype.initialize.apply(this,arguments),this.on("cell:pointerdown",this.onPointerDown,this),this._disabledSeries=[]},renderMarkup:function(){ee.prototype.renderMarkup.apply(this,arguments),this.elDataClipPath=this.$(".clip")[0],this.elDataClipPathRect=this.elDataClipPath.firstChild,this.elBackgroundRect=this.$(".background rect")[0],this.elBackgroundText=this.$(".background text")[0],this.elForeground=this.$(".foreground")[0],this.elForegroundRect=this.$(".foreground rect")[0],this.elDataSeries=this.$(".data .series")[0],this.elYAxisPath=this.$(".y-axis path")[0],this.elYAxisTicks=this.$(".y-axis .ticks")[0],this.elXAxisPath=this.$(".x-axis path")[0],this.elXAxisTicks=this.$(".x-axis .ticks")[0],this.elMarkings=this.$(".axis .markings")[0],this.elXGuideline=this.$(".x-guideline")[0],this.elYGuideline=this.$(".y-guideline")[0],this.elLegend=this.$(".legend")[0],this.elLegendItems=this.$(".legend-items")[0],this.elTick=X(this.model.tickMarkup),this.elMarking=X(this.model.markingMarkup),this.elLegendItem=X(this.model.legendItemMarkup),this.elPoint=X(this.model.pointMarkup),this.elBar=X(this.model.barMarkup),this.elSerie=X(this.model.serieMarkup),this.elDataClipPath.id="clip_"+this.cid,X(this.$(".data")[0]).attr("clip-path","url(#"+this.elDataClipPath.id+")"),X(this.elMarkings).attr("clip-path","url(#"+this.elDataClipPath.id+")")},update:function(){var t=this.filterSeries(),i=(this.calculateStats(t),this.model.get("size")),e=i.width,i=i.height,r=(this.canvas=ct({x:0,y:0,width:e,height:i},this.model.get("canvas")),{top:0,right:0,bottom:0,left:0}),n=this.model.get("padding"),n=Dt(n)?ct({},r,n):n!==void 0?{top:n,right:2*n,bottom:2*n,left:n}:r,r=(this.canvas=It(this.canvas).moveAndExpand(It(n.left,n.top,-n.right,-n.bottom)),{x:0,y:0,width:e,height:i});X(this.elDataClipPathRect).attr(r),X(this.elBackgroundRect).attr(r),X(this.elForegroundRect).attr(r),this.updateAxis(),this.updateMarkings(),this.isEmpty()?P(this.elBackgroundText).show():P(this.elBackgroundText).hide(),this.updateSeries(t),this.updateLegend(),ee.prototype.update.apply(this,arguments)},calculateStats:function(a){a=a||this.model.get("series");var e=[],i=[],n={},r={},o={},a=(kt(a).forEach(function(l,h){var u,d=o[l.name||h]||(o[l.name||h]={});d.decreasingX=!0,d.decreasingY=!0,d.nonDecreasingX=!0,d.nonDecreasingY=!0,Se(l.data,function(p){d.minX=d.minX===void 0?p.x:Math.min(d.minX,p.x),d.maxX=d.maxX===void 0?p.x:Math.max(d.maxX,p.x),d.minY=d.minY===void 0?p.y:Math.min(d.minY,p.y),d.maxY=d.maxY===void 0?p.y:Math.max(d.maxY,p.y),u&&(d.decreasingX=d.decreasingX&&p.x<u.x,d.decreasingY=d.decreasingY&&p.y<u.y,d.nonDecreasingX=d.nonDecreasingX&&p.x>=u.x,d.nonDecreasingY=d.nonDecreasingY&&p.y>=u.y),e.includes(p.x)||e.push(p.x),i.includes(p.y)||i.push(p.y),(n[p.x]||(n[p.x]=[])).push({serie:l,x:p.x,y:p.y}),(r[p.y]||(r[p.y]=[])).push({serie:l,x:p.x,y:p.y}),u=p})}),this.model.get("axis")||{}),s=a["x-axis"]||{},a=a["y-axis"]||{};this.stats={minX:s.min===void 0?e.reduce(function(l,h){return h<l?h:l},1/0):s.min,maxX:s.max===void 0?e.reduce(function(l,h){return l<h?h:l},-1/0):s.max,minY:a.min===void 0?i.reduce(function(l,h){return h<l?h:l},1/0):a.min,maxY:a.max===void 0?i.reduce(function(l,h){return l<h?h:l},-1/0):a.max,bySerie:o,xValues:e,yValues:i,xMap:n,yMap:r}},isEmpty:function(){return!this.stats.xValues.length},updateSeries:function(t){var e,i,n,r,o;t=t||this.model.get("series"),this.elDataSeries.textContent="",this.isEmpty()||(e=[this.stats.minX,this.stats.maxX],i=[this.stats.minY,this.stats.maxY],n=[this.canvas.x,this.canvas.x+this.canvas.width],r=[this.canvas.y+this.canvas.height,this.canvas.y],o=this.model.get("attrs"),kt(t).forEach(function(s,a){var u=s.data,l=[],h=this.elSerie.clone().attr("class",s.name||"serie-"+a),u=(X(this.elDataSeries).append(h),Se(u,(function(v){var k=Ge.linear(e,n,v.x),I=Ge.linear(i,r,v.y);l.push({x:k,y:I}),o[".point"]&&o[".point"].display!=="none"&&this.renderPoint(v,s),s.bars&&this.renderBar(v,s)}).bind(this)),h.findOne(".serie-clip")),d=this.model.get("size"),m=this.stats.bySerie[s.name||a],p=Ge.linear(e,n,m.minX),m=Ge.linear(e,n,m.maxX);u.findOne("rect").attr(It(p,0,m-p,d.height)),s.bars||h.findOne("path").attr({d:this.seriePathData(l,s,a),"clip-path":"url(#"+u.node.id+")"})},this))},seriePathClipData:function(n,e){var i=this.model.get("size"),n=n[0];return["M",n.x,n.y,"V",i.height+10].join(" ")},renderBar:function(d,e){var h=[this.stats.minX,this.stats.maxX],o=[this.stats.minY,this.stats.maxY],i=[this.canvas.x,this.canvas.x+this.canvas.width],r=[this.canvas.y+this.canvas.height,this.canvas.y],h=Ge.linear(h,i,d.x),i=Ge.linear(o,r,d.y),n=e.bars.barWidth||.8,n=1<n?n:this.canvas.width/(this.stats.maxX-this.stats.minX)*n,r=Ge.linear(o,r,0)-i,o=(o[0]===o[1]&&(i=this.canvas.y+this.canvas.height,r=0),d["top-rx"]||e.bars["top-rx"]),s=d["top-ry"]||e.bars["top-ry"],a=d["bottom-rx"]||e.bars["bottom-rx"],l=d["bottom-ry"]||e.bars["bottom-ry"],h={left:h,middle:h-n/2,right:h-n}[e.bars.align||"middle"],u=this.elBar.clone(),d=(u.attr({"data-serie":e.name,"data-x":d.x,"data-y":d.y,d:X.rectToPath({x:h,y:i,width:n,height:r,"top-rx":o,"top-ry":s,"bottom-rx":a,"bottom-ry":l})}),e.name||"serie-"+this.model.get("series").indexOf(e));return X(this.elDataSeries).findOne("."+d+" .bars").append(u),u.node},renderPoint:function(t,e){var i=[this.stats.minX,this.stats.maxX],o=[this.stats.minY,this.stats.maxY],n=[this.canvas.x,this.canvas.x+this.canvas.width],r=[this.canvas.y+this.canvas.height,this.canvas.y],i=Ge.linear(i,n,t.x),n=Ge.linear(o,r,t.y),r=(o[0]===o[1]&&(n=this.canvas.y+this.canvas.height),this.elPoint.clone()),o=(r.attr({"data-serie":e.name,"data-x":t.x,"data-y":t.y}),r.findOne("circle").attr({cx:i,cy:n}),r.findOne("text").attr({x:i,dy:n}).text(this.pointLabel(t,e)),e.name||"serie-"+this.model.get("series").indexOf(e));return X(this.elDataSeries).findOne("."+o+" .points").append(r),r.node},seriePathData:function(t,e,i){var n,r,o=t.length,s=[this.stats.minY,this.stats.maxY];if(s[0]===s[1])for(n=0;n<o;n++)t[n].y=this.canvas.y+this.canvas.height;switch(e.interpolate===void 0?this.model.get("interpolate"):e.interpolate){case"bezier":r=new At($t.throughPoints(t));break;case"step":for((r=new At).appendSegment(At.createSegment("M",t[0].x,t[0].y)),n=1;n<o;n++)r.appendSegment(At.createSegment("L",(t[n-1].x+t[n].x)/2,t[n-1].y)),r.appendSegment(At.createSegment("L",(t[n-1].x+t[n].x)/2,t[n].y));r.appendSegment(At.createSegment("L",t[o-1].x,t[o-1].y));break;case"stepBefore":for((r=new At).appendSegment(At.createSegment("M",t[0].x,t[0].y)),n=1;n<o;n++)r.appendSegment(At.createSegment("L",t[n-1].x,t[n].y)),r.appendSegment(At.createSegment("L",t[n].x,t[n].y));break;case"stepAfter":for((r=new At).appendSegment(At.createSegment("M",t[0].x,t[0].y)),n=1;n<o;n++)r.appendSegment(At.createSegment("L",t[n].x,t[n-1].y)),r.appendSegment(At.createSegment("L",t[n].x,t[n].y));break;default:for((r=new At).appendSegment(At.createSegment("M",t[0].x,t[0].y)),n=1;n<o;n++)r.appendSegment(At.createSegment("L",t[n].x,t[n].y))}return this.fixPathForFill(r,t,e,i).serialize()},fixPathForFill:function(t,e,i,n){var r,o,s,a;return e.length===0||i.hideFillBoundaries||this.stats.bySerie[i.name||n].nonDecreasingX&&(n=t.getSegment(0),t.replaceSegment(0,At.createSegment("L",n.end.x,n.end.y)),n=i.fillPadding&&i.fillPadding.left||0,r=i.fillPadding&&i.fillPadding.right||0,o=i.fillPadding&&i.fillPadding.bottom||10,s=this.model.get("size"),a=e[0],e=e[e.length-1],t.insertSegment(0,At.createSegment("M",e.x+r,s.height+o)),t.insertSegment(1,At.createSegment("L",a.x-n,s.height+o)),t.insertSegment(2,At.createSegment("L",a.x-n,a.y)),i.showRightFillBoundary&&(t.appendSegment(At.createSegment("L",e.x+r,e.y)),t.appendSegment(At.createSegment("Z")))),t},updateAxis:function(){var t,e,i,n=this.model.get("axis"),r=this.model.get("size"),o=r.height,s=r.width;function a(h,u,d,p,m,v,k,I){for(var N=d[1]-d[0],G=h.ticks||11,F=N/(G=N==0?1:G)/I,H=d[0],Y=0;Y<G;Y++)l.call(this,h,u,d,p,m,v,k,H),H+=F}function l(h,u,d,p,G,v,k,I){var N=this.elTick.clone(),G=G.call(this,d,p,I);G>u.width||(v.call(this,N,G,u),v=k.call(this,I,d,p),N.findOne("text").text(this.tickLabel(v,h)))}X(this.elXAxisPath).attr("d",["M",0,o,"L",s,o].join(" ")),X(this.elYAxisPath).attr("d",["M",0,0,"L",0,o].join(" ")),this.elXAxisTicks.textContent="",this.elYAxisTicks.textContent="",this.isEmpty()||(s=[this.stats.minX,this.stats.maxX],o=[this.stats.minY,this.stats.maxY],t=[this.canvas.x,this.canvas.x+this.canvas.width],e=[0,this.canvas.height],i=n&&n["y-axis"]||{},n=n&&n["x-axis"]||{},(function(h,u,d,p){function m(N,G,F){N.translate(G,F.height),X(this.elXAxisTicks).append(N)}function v(N,G,F){return Ge.linear(N,G,F)}function k(N){return N}var I;h.ticks?(I=this.canvas.width/(u.width-2*this.canvas.x),a.call(this,h,u,d,p,v,m,k,I)):(I=this.stats.xValues,(function(N,G,F,H,Y,_,K,tt){tt.forEach(function(b,vt){vt%(N.tickStep||1)==0&&l.call(this,N,G,F,H,Y,_,K,b)},this)}).call(this,h,u,d,p,v,m,k,I))}).call(this,n,r,s,t),(function(h,u,d,p){var m=this.canvas.height/u.height;a.call(this,h,u,d,p,function(v,k,I){return v[0]===v[1]?this.canvas.y+this.canvas.height:Ge.linear(v,k,I)},function(v,k){v.translate(0,k),X(this.elYAxisTicks).append(v)},function(v,k,I){return v=k[1]-(v-k[0]),v+=Ge.linear(I,k,this.canvas.y)-k[0]},m)}).call(this,i,r,o,e))},tickLabel:function(t,e){var i;return Rt(e.tickFormat)?e.tickFormat(t):(i=e.tickFormat||".1f",pa.number(i,t)+(Rt(e.tickSuffix)?e.tickSuffix(t):e.tickSuffix||""))},pointLabel:function(t,e){var i;return Rt(e.pointFormat)?e.pointFormat(t):(i=e.pointFormat||".1f",pa.number(i,t.y)+(e.pointSuffix||""))},updateMarkings:function(){this.elMarkings.textContent="";var t,e,i,n,r,o,s,a=this.model.get("markings");function l(h,u){return h===void 0?u:h}a&&a.length!==0&&(t=this.model.get("size"),e=t.width,i=t.height,n=[this.stats.minX,this.stats.maxX],r=[this.stats.minY,this.stats.maxY],o=[this.canvas.x,this.canvas.x+this.canvas.width],s=[this.canvas.y,this.canvas.y+this.canvas.height],kt(a).forEach(function(h,u){var m=h.start||h.end,G=h.end||h.start,v=Math.min(l(m.x,this.stats.minX),l(G.x,this.stats.minX)),k=Math.max(l(m.x,this.stats.maxX),l(G.x,this.stats.maxX)),d=Math.min(l(m.y,this.stats.minY),l(G.y,this.stats.minY)),p=Math.max(l(m.y,this.stats.maxY),l(G.y,this.stats.maxY)),N=m.x===void 0||G.x===void 0,m=m.y===void 0||G.y===void 0,G=(N&&(o=[0,e]),m&&(s=[0,i]),Ge.linear(n,o,v)),N=Ge.linear(n,o,k),m=Ge.linear(r,s,d),v=Ge.linear(r,s,p),k=G,I=s[1]-v+s[0],N=N-G,G=v-m;if(r[0]===r[1]&&d===p){if(r[0]!==d)return;I=this.canvas.y+this.canvas.height,G=1}N=Math.max(N,1),G=Math.max(G,1),v=this.elMarking.clone(),v.findOne("rect").attr({x:k,y:I,width:N,height:G}),v.findOne("text").text(h.label||"").attr({x:k+N,y:I}),m=v.attr("class")+" "+(h.name||"marking-"+u),v.attr(ct({class:m},h.attrs)),X(this.elMarkings).append(v)},this))},updateLegend:function(){var t=this.model.get("series");this.elLegendItems.textContent="",kt(t).forEach(function(e,i){var n;Rt(e.showLegend)&&!e.showLegend(e,this.stats.bySerie[e.name||i])||e.showLegend!==!1&&(n=this.elLegendItem.clone(),this._disabledSeries.includes(e.name)&&n.addClass("disabled"),n.attr("data-serie",e.name),n.findOne("circle").attr({fill:this.getSerieColor(e.name)}),n.findOne("text").text(e.label||e.name),n.translate(0,i*(e.legendLabelLineHeight||16)),X(this.elLegendItems).append(n))},this)},getSerieColor:function(t){var e=this.model.get("attrs"),i=Object.keys(e).find(function(n){return n.includes(t)});return i?e[i].stroke||e[i].fill:"black"},hideSerie:function(t){this._disabledSeries.includes(t)||this._disabledSeries.push(t),t=this.filterSeries(),this.update(t)},showSerie:function(t){this._disabledSeries=Lo(this._disabledSeries,t),t=this.filterSeries(),this.update(t)},filterSeries:function(t){return t=t||this.model.get("series"),t=kt(t).filter(function(e){return!this._disabledSeries.includes(e.name)},this)},onPointerDown:function(t,e,i){t=P(t.target).closest(".legend-item")[0],t&&(X(t).toggleClass("disabled"),X(t).hasClass("disabled")?this.hideSerie(X(t).attr("data-serie")):this.showSerie(X(t).attr("data-serie")))},onMouseMove:function(t){this.showGuidelines(t.clientX,t.clientY,t)},onMouseOut:function(t){this.hideGuidelines(),this.trigger("mouseout",t)},showGuidelines:function(t,e,i){var n,r,s=this.model.get("angle"),o=this.model.getBBox(),s=new Q(X(this.paper.layers).toLocalPoint(t,e)).rotate(o.center(),s);It(o).containsPoint(s)&&(r=this.model.get("size"),n=s.x-o.x,s=s.y-o.y,X(this.elXGuideline).attr({x1:n,y1:0,x2:n,y2:r.height,visibility:"visible"}),X(this.elYGuideline).attr({x1:0,y1:s,x2:r.width,y2:s,visibility:"visible"}),o=Ge.linear([this.canvas.x,this.canvas.x+this.canvas.width],[this.stats.minX,this.stats.maxX],n),r=Ge.linear([this.canvas.y,this.canvas.y+this.canvas.height],[this.stats.minY,this.stats.maxY],s),n={x:o,y:this.stats.minY+this.stats.maxY-r},s={x:t,y:e},r=this.closestPoints(o),this.trigger("mouseover",n,s,r,i))},closestPoints:function(n){var i=Eo(this.stats.xValues,n),e=this.stats.xValues[i],i=this.stats.xValues[i-1],n=i===void 0||Math.abs(n-e)<Math.abs(n-i)?e:i;return this.stats.xMap[n]},hideGuidelines:function(){X(this.elXGuideline).attr("visibility","hidden"),X(this.elYGuideline).attr("visibility","hidden")}}),Wl=Ae.extend({markup:['<g class="rotatable">','<g class="scalable"></g>','<g class="background"><rect/><text/></g>','<g class="data"></g>','<g class="foreground">','<rect/><text class="caption"/><text class="subcaption"/>','<g class="legend"><g class="legend-items"></g></g>',"</g>","</g>"].join(""),sliceMarkup:'<g class="slice"/>',sliceFillMarkup:'<path class="slice-fill"/>',sliceBorderMarkup:'<path class="slice-border"/>',sliceInnerLabelMarkup:'<text class="slice-inner-label"/>',legendSerieMarkup:'<g class="legend-serie"><text/></g>',legendSliceMarkup:'<g class="legend-slice"><circle/><text/></g>',defaults:fi({type:"chart.Pie",size:{width:200,height:200},pieHole:0,serieDefaults:{startAngle:0,degree:360,label:null,showLegend:!0,labelLineHeight:6},sliceDefaults:{innerLabel:"{percentage:.0f}%",innerLabelMargin:6,legendLabel:"{label}: {value}",legendLabelLineHeight:6,legendLabelMargin:14,offset:0,onClickEffect:{type:"offset",offset:20},onHoverEffect:null},series:[],attrs:{".background > rect":{opacity:0},".background > text":{fill:"black",text:"No data available.",ref:".background > rect","ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle",display:"none"},".foreground > rect":{fill:"white",stroke:"#e5e5e5",opacity:0,"pointer-events":"none"},".foreground .caption":{fill:"black",text:"",ref:".foreground > rect","ref-x":2,"ref-y":6,"text-anchor":"start","y-alignment":"middle","font-size":14},".foreground .subcaption":{fill:"black",text:"",ref:".foreground > rect","ref-x":2,"ref-y":18,"text-anchor":"start","y-alignment":"middle","font-size":10},".data":{ref:".background","ref-x":.5,"ref-y":.5},".slice":{cursor:"pointer"},".slice > .slice-fill":{stroke:"#ffffff","stroke-width":1,"fill-opacity":1},".slice.hover > .slice-fill":{"fill-opacity":.8},".slice > .slice-border":{"stroke-width":6,"stroke-opacity":.4,"fill-opacity":1,fill:"none",display:"none"},".slice.hover > .slice-border":{display:"block"},".slice > .slice-inner-label":{"text-anchor":"middle","font-size":"12",stroke:"none","stroke-width":"0",fill:"#ffffff"},".slice > .slice-inner-label > tspan":{dy:"-.5em"},".legend":{"ref-dx":20,"ref-y":5},".legend-serie text":{fill:"grey",transform:"translate(2, 0)","font-size":13},".legend-slice":{cursor:"pointer"},".legend-slice text":{"font-weight":"normal",fill:"black","font-size":11},".legend-slice.hover text":{"font-weight":"bold"},".legend-slice circle":{r:5,transform:"translate(5,5)"}}},Ae.prototype.defaults),addSlice:function(t,e,i){i=i||{},e=e||0;var n=this.get("series"),r=(n[e]===void 0&&(n[e]={data:[]}),dt(n[e]));r.data.push(t),i=1<((n=n.slice())[e]=r).data.length?ct(i,{changedSerieIndex:e}):i,this.set("series",n,i)},editSlice:function(t,e,i,n){n=n||{},i=i||0;var r=this.get("series");if(r[i]===void 0||r[i].data[e]===void 0)throw new Error("Slice "+e+" on serie "+i+" was not found.");var o=dt(r[i]);o.data[e]=ct(o.data[e],t),(r=r.slice())[i]=o,this.set("series",r,ct(n,{changedSerieIndex:i}))}}),ri=ee.extend({events:{"mouseover .slice":"onMouseOverSlice","mouseout .slice":"onMouseOverSlice","mousemove .slice":"onMouseMoveSlice","mouseover .legend-slice":"onEventLegendItem","mouseout .legend-slice":"onEventLegendItem"},presentationAttributes:ee.addPresentationAttributes({series:["UPDATE"],serieDefaults:["UPDATE"],sliceDefaults:["UPDATE"],pieHole:["UPDATE"]}),initialize:function(){ee.prototype.initialize.apply(this,arguments),this.on("cell:pointerclick",this.onClickSlice,this),this.on("cell:pointerclick",this.onEventLegendItem,this)},renderMarkup:function(){ee.prototype.renderMarkup.apply(this,arguments),this.elBackgroundRect=this.$(".background rect")[0],this.elBackgroundText=this.$(".background text")[0],this.elForegroundRect=this.$(".foreground rect")[0],this.elLegendItems=this.$(".legend-items")[0],this.elPie=this.$(".data")[0],this.elSlice=X(this.model.sliceMarkup),this.elSliceFill=X(this.model.sliceFillMarkup),this.elSliceBorder=X(this.model.sliceBorderMarkup),this.elSliceInnerLabel=X(this.model.sliceInnerLabelMarkup),this.elLegendSerie=X(this.model.legendSerieMarkup),this.elLegendSlice=X(this.model.legendSliceMarkup)},update:function(t,e,r){var n=(r=r||{}).changedSerieIndex,r=this.calculateSeries(n),o=(n in r?P(this.elPie).find(".serie-"+n).remove():P(this.elPie).empty(),this.model.get("size"));X(this.elBackgroundRect).attr(o),X(this.elForegroundRect).attr(o),r.length?P(this.elBackgroundText).hide():P(this.elBackgroundText).show(),kt(r).forEach(function(s,a){n!==void 0&&n!==a||Se(s.data,this.updateSlice.bind(this))},this),this.updateLegend(),ee.prototype.update.apply(this,arguments)},calculateSeries:function(t){var e=dt(this.model.get("series")),i=this.model.get("serieDefaults"),n=this.model.get("sliceDefaults"),r=this.model.get("size"),r=Math.min(r.width,r.height)/2,o=this.model.get("pieHole"),s=r,a=(r-(1<o?o:r*o))/e.length;return this._series=e.map(function(l,h){var u,d,p,m;return t!==void 0&&t!==h||(u=(l=Jt(l,i)).startAngle,d=l.data.reduce(function(v,k){return v+k.value},0),p=l.degree/d||0,m=100/d,l.data=l.data.map(function(v,k){return(v=Jt(v,ai(n,"offset","onClickEffect","onHoverEffect"))).outerRadius=s,v.innerRadius=s-a,h||((v=Jt(v,wl(n,"offset","onClickEffect","onHoverEffect"))).isOuter=!0,v.offset=1<v.offset?v.offset:v.offset*v.outerRadius,v.onClickEffect.offset=1<v.onClickEffect.offset?v.onClickEffect.offset:v.onClickEffect.offset*v.outerRadius),v.serieIndex=h,v.sliceIndex=k,v.innerLabelMargin=v.innerLabelMargin<-1||1<v.innerLabelMargin?v.innerLabelMargin:v.innerLabelMargin*v.outerRadius,v.percentage=v.value*m,k=v.value*p,v.degree={angle:k,start:u,end:k+u},v.rad={angle:Qe(v.degree.angle,!0),start:Qe(v.degree.start,!0),end:Qe(v.degree.end,!0)},v.middleangle=(v.rad.start+v.rad.end)/2,u=v.degree.end,v}),s-=a),l}),this._series},updateLegend:function(){var t=this._series,e=(this.elLegendItems.textContent="",0),i=parseInt(this.model.attr(".legend-serie text/font-size"),10),n=parseInt(this.model.attr(".legend-slice text/font-size"),10);kt(t).forEach(function(r,o){var s;r.showLegend&&(r.label&&(s=this.elLegendSerie.clone(),r.name&&s.addClass(r.name),s.attr({"data-serie":o}),s.findOne("text").text(r.label),s.translate(0,e),X(this.elLegendItems).append(s),e+=i+r.labelLineHeight),Se(r.data,(function(a,l){var h=this.elLegendSlice.clone(),u=this.getSliceFillColor(l,o);a.name&&h.addClass(a.name),h.attr({"data-serie":o,"data-slice":l}),h.findOne("text").text(pa.string(a.legendLabel,a)),h.findOne("text").translate(a.legendLabelMargin),h.translate(0,e),e+=n+a.legendLabelLineHeight,Dt(u)?this.applyGradient(h.findOne("circle"),"fill",u):h.findOne("circle").attr({fill:u}),X(this.elLegendItems).append(h)}).bind(this)))},this)},applyGradient:function(n,e,i){var n=Ft(n)?this.findBySelector(n):P(n).toArray(),r=this.paper.defineGradient(i);n.forEach(function(o){X(o).attr(e,"url(#"+r+")")})},updateSlice:function(t){var e=this.elSlice.clone(),s=(X(this.elPie).append(e),this.elSliceFill.clone()),i=this.getSliceFillColor(t.sliceIndex,t.serieIndex),s=(s.attr({fill:i,d:X.createSlicePathData(t.innerRadius,t.outerRadius,t.rad.start,t.rad.end)}),e.append(s),Dt(i)&&this.applyGradient("#"+s.attr("id"),"fill",i),this.elSliceBorder.clone()),o=parseInt(this.model.attr(".slice > .slice-border/stroke-width"),10),n=se.fromPolar(t.outerRadius+o/2,-t.rad.start,se(0,0)),r=se.fromPolar(t.outerRadius+o/2,-t.rad.end,se(0,0)),n=(s.attr({stroke:i,d:this.drawArc(n,r,t.outerRadius+o/2,t.rad.start,t.rad.end)}),e.append(s),Dt(i)&&this.applyGradient("#"+s.attr("id"),"stroke",i),this.elSliceInnerLabel.clone()),r=(n.text(pa.string(t.innerLabel,t)),e.append(n),n.bbox()),o=t.outerRadius-r.width/2-t.innerLabelMargin,s=(n.translate(o*Math.cos(-t.middleangle),-o*Math.sin(-t.middleangle)),e.attr({"data-serie":t.serieIndex,"data-slice":t.sliceIndex,"data-value":t.value}),this._series[t.serieIndex].name);return s&&e.addClass(s),t.name&&e.addClass(t.name),e.addClass("serie-"+t.serieIndex+" slice-"+t.sliceIndex),t.isOuter&&(e.addClass("outer"),t.offset&&(e.addClass("clicked"),this.effectOnSlice(e,t,{type:"offset",offset:t.offset}))),e},getSliceFillColor:function(t,e){e=e||0;var i=this.model.get("attrs"),n=Object.keys(i).find(function(r){return-1<r.indexOf(".serie-"+e+".slice-"+t+" > .slice-fill")});return(n?i[n]:this._series[e].data[t]).fill},onMouseMoveSlice:function(t){var e=X(t.currentTarget),i=e.attr("data-serie"),e=e.attr("data-slice"),i=this._series[i].data[e];this.trigger(t.type,i,t)},mouseOverSlice:function(t,e){var n=X(this.$('.slice[data-serie="'+(e=e||0)+'"][data-slice="'+t+'"]')[0]),i=this._series[e].data[t],i=(n.toggleClass("hover"),i.isOuter&&!pt(i.onHoverEffect)&&this.effectOnSlice(n,i,i.onHoverEffect,!n.hasClass("hover")),X(this.$('.legend-slice[data-serie="'+e+'"][data-slice="'+t+'"]')[0])),n=(i&&i.toggleClass("hover"),Object.keys(this.model.get("attrs")).filter(function(r){return-1<r.indexOf(".slice")||-1<r.indexOf(".legend-slice")}));ee.prototype.update.call(this,this.model,wl(this.model.get("attrs"),n))},onMouseOverSlice:function(t){var e=X(t.currentTarget),i=e.attr("data-serie"),e=e.attr("data-slice"),i=(this.mouseOverSlice(e,i),this._series[i].data[e]);this.trigger(t.type,i,t)},clickSlice:function(t,e){var i=X(this.$('.slice[data-serie="'+(e=e||0)+'"][data-slice="'+t+'"]')[0]),n=this._series[e].data[t];n.isOuter&&(i.hasClass("clicked")?(i.removeClass("clicked"),this.model.get("series")[e].data[t].offset=0,this.effectOnSlice(i,n,n.onClickEffect,!0)):(i.addClass("clicked"),this.model.get("series")[e].data[t].offset=n.onClickEffect.offset,this.effectOnSlice(i,n,n.onClickEffect)))},onClickSlice:function(t){var e,i=X(P(t.target).closest(".slice.outer")[0]);i&&(e=i.attr("data-serie"),i=i.attr("data-slice"),this.clickSlice(i,e),e=this._series[e].data[i],this.trigger(t.type,e,t))},onEventLegendItem:function(t){var e=X(P(t.target).closest(".legend-slice")[0]);if(e){var i=e.attr("data-serie"),n=e.attr("data-slice");switch(t.type){case"click":this.clickSlice(n,i);break;case"mouseover":case"mouseout":this.mouseOverSlice(n,i)}}},effectOnSlice:function(t,e,i,n){switch(n=n||!1,i.type){case"enlarge":n?t.scale(1):t.scale(i.scale||1.05);break;case"offset":n?t.translate(0,0,{absolute:!0}):t.translate(i.offset*Math.cos(-e.middleangle),-i.offset*Math.sin(-e.middleangle))}},svgArcMax:2*Math.PI-1e-6,drawArc:function(t,e,i,n,a){var o=0,s=1,a=a-n;return a>Math.PI&&(o=1,a>=this.svgArcMax&&(s=o=0)),"M"+t.x+","+t.y+" A"+i+","+i+" 0 "+o+","+s+" "+e.x+","+e.y}}),zi=Wl.extend({defaults:fi({type:"chart.Knob",sliceDefaults:{legendLabel:"{value:.0f}",outer:{offsetOnClick:0}},pieHole:.7,value:0,attrs:{".legend":{"ref-x":.5,"ref-y":.5,"ref-dx":null,"x-alignment":-.5,"y-alignment":-.5},".legend-slice text":{"font-size":30},".legend-slice circle":{display:"none"},".slice-inner-label":{display:"none"},".slice-fill":{stroke:"none"}}},Wl.prototype.defaults),initialize:function(){this.set("series",this.getKnobSeries(),{silent:!0}),Wl.prototype.initialize.apply(this,arguments),this.on("change:value change:min change:max change:fill",this.updateKnob,this)},getKnobSeries:function(){var t=Array.isArray(this.get("value"))?this.get("value"):[this.get("value")],e=Array.isArray(this.get("fill"))?this.get("fill"):[this.get("fill")],i=Array.isArray(this.get("min"))?this.get("min"):[this.get("min")],n=Array.isArray(this.get("max"))?this.get("max"):[this.get("max")];return t.map(function(r,o){var s=i[o]===void 0?i[0]:i[o],a=n[o]===void 0?n[0]:n[o],l=e[o]===void 0?e[0]:e[o];return{degree:Ge.linear([s,a],[0,360],r),data:[{value:r,fill:l}],showLegend:!(0<o)}})},updateKnob:function(){this.set("series",this.getKnobSeries())}}),Ma=ri,Qt=Ae.extend({markup:['<g class="rotatable">','<g class="scalable">','<g class="background"><rect/></g>','<g class="cells"/>','<g class="foreground"/>',"</g>",'<g class="labels">','<g class="rows"/>','<g class="columns"/>',"</g>","</g>"].join(""),cellMarkup:'<rect class="cell"/>',labelMarkup:'<text class="label"/>',gridLineMarkup:'<path class="grid-line"/>',defaults:fi({type:"chart.Matrix",attrs:{".background rect":{fill:"#eeeeee"},".grid-line":{stroke:"white","stroke-width":2},".label":{fill:"black","alignment-baseline":"middle"},".labels .rows .label":{"text-anchor":"end"},".labels .columns .label":{"text-anchor":"start"}}},Ae.prototype.defaults)}),ci=ee.extend({presentationAttributes:ee.addPresentationAttributes({size:["LABELS"],cells:[ee.Flags.RENDER]}),confirmUpdate:function(t,e){return this.hasFlag(t,"LABELS")&&!this.hasFlag(t,ee.Flags.RENDER)&&(this.renderLabels(),t=this.removeFlag(t,"LABELS")),ee.prototype.confirmUpdate.call(this,t,e)},renderMarkup:function(){ee.prototype.renderMarkup.apply(this,arguments),this.elCells=this.$(".cells")[0],this.elRowLabels=this.$(".labels .rows")[0],this.elColumnLabels=this.$(".labels .columns")[0],this.elForeground=this.$(".foreground")[0],this.elCell=X(this.model.cellMarkup),this.elGridLine=X(this.model.gridLineMarkup);var t=this.model.get("cells")||[],e=this.model.get("size");if(this.elBackgroundRect=this.$(".background rect")[0],X(this.elBackgroundRect).attr(e),Array.isArray(t)&&t.length!==0&&Array.isArray(t[0])&&t[0].length!==0){for(var i,n,r,o,s,a=e.height/t.length,l=e.width/t[0].length,h=document.createDocumentFragment(),u=(this.elCells.textContent="",this.elForeground.textContent="",document.createDocumentFragment()),d=0;d<t.length;d++)for((r=this.elGridLine.clone()).addClass("horizontal"),r.attr("d","M 0 "+d*a+" "+e.width+" "+d*a),u.appendChild(r.node),i=t[d],n=0;n<i.length;n++)d===0&&((r=this.elGridLine.clone()).addClass("vertical"),r.attr("d","M "+n*l+" 0 "+n*l+" "+e.height),u.appendChild(r.node)),(o=i[n])&&((s=this.elCell.clone()).attr(ct({x:n*l,y:d*a,width:l,height:a},o)),h.appendChild(s.node));this.elForeground.appendChild(u),this.elCells.appendChild(h),this.renderLabels()}},renderLabels:function(){this.elLabel=X(this.model.labelMarkup);var t=this.model.get("cells")||[];if(Array.isArray(t)&&t.length!==0&&Array.isArray(t[0])&&t[0].length!==0){for(var e,i,n,r,o=this.model.get("labels")||{},s=o.rows||[],a=o.columns||[],l=this.model.get("size"),h=l.height/t.length,u=l.width/t[0].length,d=(this.elRowLabels.textContent="",this.elColumnLabels.textContent="",document.createDocumentFragment()),p=0;p<s.length;p++)e=o.rows[p],(i=this.elLabel.clone()).text(e.text),i.attr(ct({x:-(o.padding||5),y:p*h+h/2,"text-anchor":"end","dominant-baseline":"central","font-size":h,"data-row":p},ai(e,"text"))),d.appendChild(i.node);this.elRowLabels.appendChild(d);for(var m=document.createDocumentFragment(),v=0;v<a.length;v++)e=o.columns[v],i=this.elLabel.clone(),r=-(o.padding||5),i.attr("x",n=v*u+u/2),i.text(e.text),i.attr(ct({y:r,"text-anchor":"start","dominant-baseline":"central","font-size":u,"data-column":v},ai(e,"text"))),i.rotate(-90,n,r),m.appendChild(i.node);this.elColumnLabels.appendChild(m)}}}),Ln={__proto__:null,Plot:Ln,PlotView:Dn,Pie:Wl,PieView:ri,Knob:zi,KnobView:Ma,Matrix:Qt,MatrixView:ci},pc={none:"",message:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDUxMiA1MTIiIGhlaWdodD0iNTEycHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB3aWR0aD0iNTEycHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGQ9Ik00NzkuOTk4LDY0SDMyQzE0LjMyOSw2NCwwLDc4LjMxMiwwLDk2djMyMGMwLDE3LjY4OCwxNC4zMjksMzIsMzIsMzJoNDQ3Ljk5OEM0OTcuNjcxLDQ0OCw1MTIsNDMzLjY4OCw1MTIsNDE2Vjk2ICBDNTEyLDc4LjMxMiw0OTcuNjcxLDY0LDQ3OS45OTgsNjR6IE00MTYsMTI4TDI1NiwyNTZMOTYsMTI4SDQxNnogTTQ0OCwzODRINjRWMTYwbDE5MiwxNjBsMTkyLTE2MFYzODR6Ii8+PC9zdmc+",plus:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIyLjUsMTRIMTR2OC41YzAsMC4yNzYtMC4yMjQsMC41LTAuNSwwLjVoLTRDOS4yMjQsMjMsOSwyMi43NzYsOSwyMi41VjE0SDAuNSAgQzAuMjI0LDE0LDAsMTMuNzc2LDAsMTMuNXYtNEMwLDkuMjI0LDAuMjI0LDksMC41LDlIOVYwLjVDOSwwLjIyNCw5LjIyNCwwLDkuNSwwaDRDMTMuNzc2LDAsMTQsMC4yMjQsMTQsMC41VjloOC41ICBDMjIuNzc2LDksMjMsOS4yMjQsMjMsOS41djRDMjMsMTMuNzc2LDIyLjc3NiwxNCwyMi41LDE0eiIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9zdmc+",cross:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGQ9Ik0yMi4yNDUsNC4wMTVjMC4zMTMsMC4zMTMsMC4zMTMsMC44MjYsMCwxLjEzOWwtNi4yNzYsNi4yN2MtMC4zMTMsMC4zMTItMC4zMTMsMC44MjYsMCwxLjE0bDYuMjczLDYuMjcyICBjMC4zMTMsMC4zMTMsMC4zMTMsMC44MjYsMCwxLjE0bC0yLjI4NSwyLjI3N2MtMC4zMTQsMC4zMTItMC44MjgsMC4zMTItMS4xNDIsMGwtNi4yNzEtNi4yNzFjLTAuMzEzLTAuMzEzLTAuODI4LTAuMzEzLTEuMTQxLDAgIGwtNi4yNzYsNi4yNjdjLTAuMzEzLDAuMzEzLTAuODI4LDAuMzEzLTEuMTQxLDBsLTIuMjgyLTIuMjhjLTAuMzEzLTAuMzEzLTAuMzEzLTAuODI2LDAtMS4xNGw2LjI3OC02LjI2OSAgYzAuMzEzLTAuMzEyLDAuMzEzLTAuODI2LDAtMS4xNEwxLjcwOSw1LjE0N2MtMC4zMTQtMC4zMTMtMC4zMTQtMC44MjcsMC0xLjE0bDIuMjg0LTIuMjc4QzQuMzA4LDEuNDE3LDQuODIxLDEuNDE3LDUuMTM1LDEuNzMgIEwxMS40MDUsOGMwLjMxNCwwLjMxNCwwLjgyOCwwLjMxNCwxLjE0MSwwLjAwMWw2LjI3Ni02LjI2N2MwLjMxMi0wLjMxMiwwLjgyNi0wLjMxMiwxLjE0MSwwTDIyLjI0NSw0LjAxNXoiLz48L3N2Zz4=",user:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIGlkPSJMYXllcl8xIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIyLDIwLjk5OGgtMWMwLDAtMSwwLTEtMVYxNy41YzAtMC4yNzctMC4yMjQtMC41LTAuNS0wLjVTMTksMTcuMjIzLDE5LDE3LjUgIGwtMC4wMDgsNC4yOTVjMCwwLjYwOS0yLjAxLDIuMjA1LTYuNDkyLDIuMjA1cy02LjQ5Mi0xLjU5Ni02LjQ5Mi0yLjIwNUw2LDE3LjVDNiwxNy4yMjMsNS43NzYsMTcsNS41LDE3UzUsMTcuMjIzLDUsMTcuNXYyLjQ5OCAgYzAsMS0xLDEtMSwxSDNjMCwwLTEsMC0xLTFWMTUuNzVjMC0yLjkyMiwyLjg5Mi01LjQwMSw2LjkzLTYuMzQxYzAsMCwxLjIzNCwxLjEwNywzLjU3LDEuMTA3czMuNTctMS4xMDcsMy41Ny0xLjEwNyAgYzQuMDM4LDAuOTQsNi45MywzLjQxOSw2LjkzLDYuMzQxdjQuMjQ4QzIzLDIwLjk5OCwyMiwyMC45OTgsMjIsMjAuOTk4eiBNMTIuNDc3LDljLTIuNDg1LDAtNC41LTIuMDE1LTQuNS00LjVTOS45OTEsMCwxMi40NzcsMCAgczQuNSwyLjAxNSw0LjUsNC41UzE0Ljk2Miw5LDEyLjQ3Nyw5eiIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9zdmc+",circle:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3gULEBE3DEP64QAAAwlJREFUaN7dmktrU0EUx38ZmmBbfEIL2hSjkYKC1EW6EDFudC+404/gE6WKSvGxERQfIH4AX1T9EOKrCrYurVrbgsZWoaBVixDbpC6ci+Fyz9ybZG478cBs7syc+Z+5c86c+c8ksCPrgW1ADtgEbARafG1+AW+AYWAIGADGWUTZAJwHxoD5GssocA7ILiTwLcADoFQHcH8pAfeB7jiBtwO3gLJF4P5S1mO02wa/C5iMEbi/TAI7bYE/Y3m5VLOs+sLAJULqrgKHIxhZBp4DT4FX2jkLGoinq1M7fg7YDmwFVATd14CjFboiy5UIs/QBOAmka/izaeCU1hE2zuVqlZ8IUfgVOAA0WViiTcBBrdM0Zm9UhTuAOYOiRzXOeJh0Ak8M484B+TAlK4BPBiU3gWSMoTqpw6g0fgFYblJww9D5dojT25IEcMeA47rUsdsQLp9FmPmURSNSOqpJS2lzUKd+ocN3IBNx5mz+oXXADwHTXX/jjMFxjy1iwtgrYJoF1lY27BMafozZaaMspYKA7XRlw7f1xt4Y5biA7bXXIGv4TW0OGNCmsQRhzCidlwTJADDlgAFTwAuhLq+AHqHyMe6IhKVHAV1C5ZBDBkhYupThPPreIQNGJTJBGXKLLw4Z8NmQu/Fb8PCkQwakBIxFRWPLvAJmhMpWh4AuFb7PKGBaqFzjkAGrhe/TSjNrQZJ1yAAJy5gCRoTKnEMGSFhGFDBoOBu7IhKWQe8wLRFLHQ6A7zCcFNNK59vvAjoqYK8DBuwTCLBhTUD8Hweahj9S2jjU297VqzrU26BVmi2yEjXRKg1PbHnpqYla7AeWxAi+GbhHHdSit2mYyN2XQQ5kQTJ6Y6qL3PUkCr2+H7v0+jcs0eueRLngGNeKa9mxY73g8JzpEtHusorAQ/7e+e7WUWIl//jSVTrK7QEu6KgW9d7tYr3B44iBWPJfkZZ8pZ4r2VngkC0HywMTLNwN5YSBcKtZWoGzernEBbyox2iJc6Np2KcGfnHisYet1CDouc2yCjbhp07MrD+3+QNxi4JkAscRswAAAABJRU5ErkJggg==",service:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB1RJREFUeNrMWltMVFcUHZAIRSAkSFACITRAVbQ/DVhHiRZC2y9jotFgqgmxKqShKdFCggZbEpP2h1Q/oLUg8GH0xy/LKwpDEEFsjKCM8kYkgAhTpggDMzCc7kX2mGF677w80J5khbnnntc+Zz/W2ReNxvsSQLhPWCBYGPhdTdjg7aBCCI/gVSfu+CHBfPz48ba7d+82AocOHfqT6mYIEV6Oua4CfE6YHxsbeyS49Pf3P6C6RYJ2vQTwVTtKHx+fXYRzhM0qTbYR/g4JCQmyVYSFhQXTHyMhUWXMzTzmTo3MorATHxH0eEXAriYrtCmNiop6tby8bLCdgNVqfR0ZGTlC735RaJ/EY+HhGSFhTVSIyg7CIO3mRHNzs44WOYydJuQQ/AjxhJ9hsFqt9qlwKElJSRB8nvAjIYYN+hucDMbCmMHBwZP03E/YLlUAKh8TnoSHh49NT0+vLG5paWk0JyfnPu9cJ8EUGho6cfTo0fbBwcFWRwH6+vpaYcy0yCk26Hb0zc7ObsFYaIOxaY5xqn9M2ClTgGw8wqM4LuzevXu6xMTEnitXrjTOz8/3Chfl7du3Ly5fvtyUkJDQrzRedXV1I2/KWZkCwCDrsMMWi+WV46Sk42+EhwV24VhnNpuHaY43NFct5pRtA7tw9BkZGQ/peVHIL+bDhw8/YrtKXJM4QOVrVNfV1TXKXr2d6mTK8EI+tk4KPrszNjY2mIJTiK+vb5iK+zX29vbqW1paLNRe7N271590PpF+hyq1hzpt3bpVTE5ODlDfFIU5FdfiTRxAkDKVlpY2QI2VVNvOHUIVXjJmUEcC6Rz7keGLffv2CdoMK5/AogzupCZA8aZNmwxkbEMKi18sKSmxqcF1QjohmgF6UYl3LPw7GxoYGBAbN24U+fn5puLi4qWqqqoBGdwJxZ+J2ZeEXF6U9dixYw+VdLi1tbWJF3/aycBn0aa9vb3J1q++vl4EBARAfYRM7oTSwpFzjjAeExMznJ6e/mRkZORfAoA20Mn8Re3KFAaD9zpH2MzP13GK1GcafSl+iIiICGEymd6Nh4BG7SbVNgNj8Zg7nQmwdPLkybahoaG22dnZbntu41i6u7sh7CzhM1fciZCKTUEf9M3KyhLJycnYBCGTO6FYmpqa3HKX5eXlDWysUW5wp0K0LSoqasvLyxP+/v7ixIkTQjZ3WhFAR8UbAdzgTmY/Pz9rfHy8KCgoEKOjo0I2d1pxzxhAr9e3GI3GZ87ogp0KpbriTrdv3+6ghS9XVlYaFxYWxFpxJ5QaltxMeAOOf+DAgQ4VI55mIy53hzuRx7GuNXfSsM5FwJURzhBK3HSjZ/8P3MmrQIYgxUJUcvDKx/OtW7c61ps7ObtSziHiqlEJ0AU+VqgfPI8lOjraajAYVNUGKgg7Kisra4RDwG9bnFAqZMTjcBBI3ziLA0ovQPL0cXFxg6STU84W1NPT8+DSpUtt8DY3btwwqqm2p9zJ1q+wsBAqC7uL9EQA3H+Fu+41NzdXkPELMmQhizvZeSc9bQ5OucAtATiKLsAPK+0KXCKIWW1trSBSJjIzM8EwxYULF4RM7mRf0tLSnrCX/JXwLW9CLPO4VVfKcHAj4kMvldwZ6ojzr5CywMBAsWXLFrFnz54VmjAxMSE84U4KQqziTvYFapqSktIJnkbtXjNvW+DU5ioB8vDIOrlq7Xfu3GmgINNHl47lixcvIiO3QszsuY273ElFgFXcSSVGTBFfew7eBv4GHucoAHz6Y+I1r23UgFRmED6e1QD8XZBOW7zlTk4EgE28rKioaHBnbNgnPJ+vw8UGrO8rcoVzdJ2MqKmp0ZEbC7l58yaSWacJn0LqoKCgcc1/XOg0nHqhBDt6XI+TsXvnNXdycQJpUCHouzOagTkxN9/mrKqZAE7QgloEOtR7zZ1cCFABRqpkxNgIMuKnmIsvQGaOJ9UepzLelzupjJnlzI2mpqZ28KKvcspHy2vY4I0AMrhTDOMLQhXeXbt2zftAJikd7yl3AmZAxXFK3lIJH08lUUo++aBSo+ki7vQBGaHTRBjdwJ7TghGENFqtNoAuPTvUEmFkDxN0Z7ZSkBymvlqltUj5DOQpd/Kk4HbG6pct5fuYp9xJQlk8depUK1/8P5EqgDvcydPV4g6gVMcutNmWd5IlgEvuhA8ixJl63LjU64uKinS4g+AW5niauE+wKn0vUwB3uNMcvM+RI0faQcKU0ioHDx60pVWMtmQWvj9jLFtaBXNwWmWXbBvYThiAO8TO8UIMHHAQaOIIPyEQ7d+/v9NRgN27d3exfv/AhG4D9zVgLIzJ7heJrW3SjdgVd7Jr8zsybfZUATyKU4tXVXKt9Txml2pqUdbXdDXuZPf+OySPkX+1CQBixtzmjEqfQL6tJaqtxU/ix3I9n4JaeUEInZmZGSHasVIxNTU1wx9TulTGNNGf35zN67eOFL6X4Hv+/Hkr3aN14PNEPYL5atgvjde4+1HBy3/PaXb49xwwzD/eZyP/EWAAQ3AUnjpOYHIAAAAASUVORK5CYII="},Dn={initialize:function(){this._parent=(this._parent||this).constructor.__super__,this._parent.initialize.apply(this,arguments),this.listenTo(this,"change:icon",this._onIconChange),this._onIconChange(this,this.get("icon")||"none")},_onIconChange:function(t,e){if(!Zn(pc,e))throw"BPMN: Unknown icon: "+e;t.attr({image:{"xlink:href":pc[e],dataIconType:e}})}},ri={initialize:function(){this._parent=(this._parent||this).constructor.__super__,this._parent.initialize.apply(this,arguments),this.listenTo(this,"change:subProcess",this._onSubProcessChange),this._onSubProcessChange(this,this.get("subProcess")||null)},_onSubProcessChange:function(t,e){t.attr({".sub-process":{visibility:e?"visible":"hidden","data-sub-process":e||""}})}},zi=io,Ma=Pr.extend({markup:['<g class="rotatable">','<g class="scalable"><rect class="body outer"/><rect class="body inner"/></g>',_n.test("svgforeignobject")?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>','<path class="sub-process"/><image class="icon"/></g>'].join(""),defaults:fi({size:{width:100,height:100},type:"bpmn.Activity",attrs:{rect:{rx:8,ry:8,width:100,height:100},".body":{fill:"#ffffff",stroke:"#000000"},".inner":{transform:"scale(0.9,0.9) translate(5,5)"},path:{d:"M 0 0 L 30 0 30 30 0 30 z M 15 4 L 15 26 M 4 15 L 26 15",ref:".inner","ref-x":.5,"ref-dy":-30,"x-alignment":"middle",stroke:"#000000",fill:"transparent"},image:{ref:".inner","ref-x":5,width:20,height:20}},activityType:"task",subProcess:null},Pr.prototype.defaults),initialize:function(){Pr.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:activityType",this.onActivityTypeChange),this.listenTo(this,"change:subProcess",this.onSubProcessChange),this.onSubProcessChange(this,this.get("subProcess")),this.onActivityTypeChange(this,this.get("activityType"))},onActivityTypeChange:function(t,e){switch(e){case"task":t.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":1,"stroke-dasharray":"none"},path:{ref:".outer"},image:{ref:".outer"}});break;case"transaction":t.attr({".inner":{visibility:"visible"},".outer":{"stroke-width":1,"stroke-dasharray":"none"},path:{ref:".inner"},image:{ref:".inner"}});break;case"event-sub-process":t.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":1,"stroke-dasharray":"1,2"},path:{ref:".outer"},image:{ref:".outer"}});break;case"call-activity":t.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":5,"stroke-dasharray":"none"},path:{ref:".outer"},image:{ref:".outer"}});break;default:throw"BPMN: Unknown Activity Type: "+e}},onSubProcessChange:function(t,e){e?t.attr({".fobj div":{style:{verticalAlign:"baseline",paddingTop:10}},image:{"ref-dy":-25,"ref-y":""},".content":{"ref-y":10,"y-alignment":null}}):t.attr({".fobj div":{style:{verticalAlign:"middle",paddingTop:0}},image:{"ref-dy":"","ref-y":5},".content":{"ref-y":.5,"y-alignment":"middle"}})}}).extend(Dn).extend(ri),Qt=io,ci=Pr.extend({markup:['<g class="rotatable">','<g class="scalable"><rect class="body"/></g>',_n.test("svgforeignobject")?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>','<path class="stroke"/></g>'].join(""),defaults:fi({size:{width:100,height:100},type:"bpmn.Annotation",attrs:{rect:{width:100,height:100},".body":{"fill-opacity":.1,fill:"#ffffff",stroke:"none"},".fobj div":{style:{textAlign:"left",paddingLeft:10}},".stroke":{stroke:"#000000",fill:"none","stroke-width":3}},wingLength:20},Pr.prototype.defaults),initialize:function(){Pr.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:size",this.onSizeChange),this.onSizeChange(this,this.get("size"))},onSizeChange:function(t,e){t.attr(".stroke",{d:t.getStrokePathData(e.width,e.height,t.get("wingLength"))})},getStrokePathData:function(t,e,i){return["M",i=Math.min(i,t),"0 L 0 0 0",e,i,e].join(" ")}}),fe=Kt.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="body"/><image/></g></g><text class="label"/>',defaults:fi({type:"bpmn.Gateway",size:{width:80,height:80},attrs:{".body":{points:"40,0 80,40 40,80 0,40",fill:"#ffffff",stroke:"#000000"},".label":{text:"",ref:".body","ref-x":.5,"ref-dy":20,"y-alignment":"middle","x-alignment":"middle","font-size":14,"font-family":"Arial, helvetica, sans-serif",fill:"#000000"},image:{width:40,height:40,"xlink:href":"",transform:"translate(20,20)"}}},Kt.prototype.defaults)}).extend(Dn),Bn=Kt.extend({markup:'<g class="rotatable"><g class="scalable"><circle class="body outer"/><circle class="body inner"/><image/></g><text class="label"/></g>',defaults:fi({type:"bpmn.Event",size:{width:60,height:60},attrs:{".body":{fill:"#ffffff",stroke:"#000000"},".outer":{"stroke-width":1,r:30,transform:"translate(30,30)"},".inner":{"stroke-width":1,r:26,transform:"translate(30,30)"},image:{width:40,height:40,"xlink:href":"",transform:"translate(10,10)"},".label":{text:"",fill:"#000000","font-family":"Arial","font-size":14,ref:".outer","ref-x":.5,"ref-dy":20,"x-alignment":"middle","y-alignment":"middle"}},eventType:"start"},Kt.prototype.defaults),initialize:function(){Kt.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:eventType",this.onEventTypeChange),this.onEventTypeChange(this,this.get("eventType"))},onEventTypeChange:function(t,e){switch(e){case"start":t.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":1}});break;case"end":t.attr({".inner":{visibility:"hidden"},".outer":{"stroke-width":5}});break;case"intermediate":t.attr({".inner":{visibility:"visible"},".outer":{"stroke-width":1}});break;default:throw"BPMN: Unknown Event Type: "+e}}}).extend(Dn),Ri=Kt.extend({markup:['<g class="rotatable">','<g class="scalable"><rect class="body"/></g>','<svg overflow="hidden" class="blackbox-wrap"><text class="blackbox-label"/></svg>','<rect class="header"/><text class="label"/>','<g class="lanes"/>',"</g>"].join(""),laneMarkup:'<g class="lane"><rect class="lane-body"/><rect class="lane-header"/><text class="lane-label"/></g>',defaults:fi({type:"bpmn.Pool",size:{width:600,height:300},attrs:{".body":{fill:"#ffffff",stroke:"#000000",width:500,height:200,"pointer-events":"stroke"},".header":{fill:"#ffffff",stroke:"#000000",width:20,ref:".body","ref-height":1,"pointer-events":"visiblePainted"},".label":{fill:"#000000",transform:"rotate(-90)",ref:".header","ref-x":10,"ref-y":.5,"font-family":"Arial","font-size":14,"x-alignment":"middle","text-anchor":"middle"},".lane-body":{fill:"#ffffff",stroke:"#000000","pointer-events":"stroke"},".lane-header":{fill:"#ffffff",stroke:"#000000","pointer-events":"visiblePainted"},".lane-label":{fill:"#000000",transform:"rotate(-90)","text-anchor":"middle","font-family":"Arial","font-size":13},".blackbox-wrap":{ref:".body","ref-width":1,"ref-height":1},".blackbox-label":{text:"Black Box","text-anchor":"middle",transform:"translate(0,-7)"},".blackbox-label > tspan":{dx:"50%",dy:"50%"}}},Kt.prototype.defaults)}),_e=ee.extend({options:{headerWidth:20},presentationAttributes:ee.addPresentationAttributes({lanes:["LANES"]}),confirmUpdate:function(){var t=ee.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"LANES")&&(this.renderLanes(this.model.get("lanes")),t=this.removeFlag(t,["LANES"])),t},update:function(){return this.lanesAttrs===void 0?this.renderLanes(this.model.get("lanes")):ee.prototype.update.call(this,this.model,ze({},this.model.get("attrs"),this.lanesAttrs||{}))},renderMarkup:function(){ee.prototype.renderMarkup.apply(this,arguments),this.$lanes=this.$(".lanes"),this.laneMarkup=X(this.model.laneMarkup)},renderLanes:function(t){t=t||{};var e=(void(this.index=0)===t.headerWidth?this.options:t).headerWidth;this.lanesAttrs={".header":{width:e},".label":{text:t.label||""}},this.$lanes.empty(),t.sublanes&&this.renderSublanes(t.sublanes,e,0,1,"lanes"),this.update(this.model,ze({},this.model.get("attrs"),this.lanesAttrs))},calculateRatios:function(t,e){for(var i=0,n=[],r=[],o=0,s=t.length;o<s;o++){var a=t[o].ratio;Number.isFinite(a)?(i+=a/10,r[o]=a/10/e):n.push(o)}for(var l=Math.max(1-i,0)*e/n.length,h=0,u=n.length;h<u;h++)r[n[h]]=l;return r},renderSublanes:function(t,e,i,n,r){var o=this.options.headerWidth,s=r+"/sublanes/",a=this.calculateRatios(t,n);kt(t).reduce((function(l,h,I){var k="lane"+this.index,d="."+k+" .lane-body",p="."+k+" .lane-header",m="."+k+" .lane-label",v=(h.name&&(k+=" "+h.name),s+I),k=this.laneMarkup.clone().addClass(k).attr({"data-lane-path":v,"data-lane-index":this.index}),k=(this.$lanes.append(k.node),a[I]),I=h.headerWidth===void 0?o:h.headerWidth,N=i+l;return this.lanesAttrs[d]={ref:".body","ref-height":k,"ref-width":-e,"ref-x":e,"ref-y":N},this.lanesAttrs[p]={width:I,ref:".body","ref-height":k,"ref-x":e,"ref-y":N},this.lanesAttrs[m]={text:h.label,ref:p,"ref-x":10,"ref-y":.5,"x-alignment":"middle"},this.index++,h.sublanes&&this.renderSublanes(h.sublanes,e+I,N,k,v),l+k}).bind(this),0)}}),Fo=Kt.extend({markup:'<g class="rotatable"><g class="scalable"><rect class="body"/></g><rect class="label-rect"/><g class="label-group"><svg overflow="hidden" class="label-wrap"><text class="label"/></svg></g></g>',defaults:fi({type:"bpmn.Group",size:{width:200,height:200},attrs:{".body":{width:200,height:200,stroke:"#000000","stroke-dasharray":"6,6","stroke-width":2,fill:"transparent",rx:15,ry:15,"pointer-events":"stroke"},".label-rect":{ref:".body","ref-width":.6,"ref-x":.4,"ref-y":-30,height:25,fill:"#ffffff",stroke:"#000000"},".label-group":{ref:".label-rect","ref-x":0,"ref-y":0},".label-wrap":{ref:".label-rect","ref-width":1,"ref-height":1},".label":{text:"",x:"50%",y:"1.3em","text-anchor":"middle","font-family":"Arial","font-size":14,fill:"#000000"}}},Kt.prototype.defaults)}),Xi=Kt.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="body"/></g><text class="label"/></g>',defaults:fi({type:"bpmn.DataObject",size:{width:60,height:80},attrs:{".body":{points:"20,0 60,0 60,80 0,80 0,20 20,0 20,20 0,20",stroke:"#000000",fill:"#ffffff"},".label":{ref:".body","ref-x":.5,"ref-dy":5,text:"","text-anchor":"middle"}}},Kt.prototype.defaults)}),Oi=Kt.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="body"/></g><text class="label"/><path class="sub-process"/></g>',defaults:fi({type:"bpmn.Conversation",size:{width:100,height:100},attrs:{".body":{points:"25,0 75,0 100,50 75,100 25,100 0,50",stroke:"#000000",fill:"#ffffff"},".label":{text:"",ref:".body","ref-x":.5,"ref-dy":5,"text-anchor":"middle"},path:{d:"M 0 0 L 30 0 30 30 0 30 z M 15 4 L 15 26 M 4 15 L 26 15",ref:".body","ref-x":.5,"ref-dy":-30,"x-alignment":"middle",fill:"#ffffff",stroke:"#000000","fill-opacity":0}},conversationType:"conversation"},Kt.prototype.defaults),initialize:function(){Kt.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:conversationType",this.onConversationTypeChange),this.onConversationTypeChange(this,this.get("conversationType"))},onConversationTypeChange:function(t,e){switch(e){case"conversation":t.attr("polygon/stroke-width",1);break;case"call-conversation":t.attr("polygon/stroke-width",4);break;default:throw"BPMN: Unknown Conversation Type: "+e}}}).extend(ri),oo=Pr.extend({markup:['<g class="rotatable">','<g class="scalable"><rect class="body"/></g>',_n.test("svgforeignobject")?'<foreignObject class="fobj"><body xmlns="http://www.w3.org/1999/xhtml"><div class="content"/></body></foreignObject>':'<text class="content"/>','<text class="label"/><path class="sub-process"/><g class="participants"/>',"</g>"].join(""),participantMarkup:'<g class="participant"><rect class="participant-rect"/><text class="participant-label"/></g>',defaults:fi({type:"bpmn.Choreography",size:{width:60,height:80},attrs:{rect:{},".body":{width:60,height:80,stroke:"#000000",fill:"#ffffff"},".label":{ref:".body","ref-x":.5,"ref-dy":5,text:"","text-anchor":"middle"},".participant-rect":{stroke:"#000000",fill:"#aaaaaa",ref:".body","ref-width":1},".participant-label":{"text-anchor":"middle",ref:".participant_0 .participant-rect","ref-x":.5,"ref-y":.5,"y-alignment":"middle"},".sub-process":{d:"M 0 0 L 30 0 30 30 0 30 z M 15 4 L 15 26 M 4 15 L 26 15",ref:".body","ref-x":.5,"ref-dy":-30,"x-alignment":"middle",fill:"transparent",stroke:"#000000"}},participants:[],initiatingParticipant:0},Pr.prototype.defaults)}).extend(ri),Ji=io.extend({options:{participantHeight:20},presentationAttributes:io.addPresentationAttributes({participants:"PARTICIPANTS",initiatingParticipant:"INIT_PARTICIPANT"}),initFlag:["PARTICIPANTS"].concat(io.prototype.initFlag),confirmUpdate:function(){var t=io.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(t,"PARTICIPANTS")?(this.renderParticipants(this.model.get("participants")),this.removeFlag(t,["PARTICIPANTS","INIT_PARTICIPANT"])):(this.hasFlag(t,"INIT_PARTICIPANT")&&(this.layoutAndUpdate(),t=this.removeFlag(t,"INIT_PARTICIPANT")),t)},update:function(){return this.participantsAttrs===void 0?this.renderParticipants(this.model.get("participants")):(this.layoutAndUpdate(),this)},render:function(){this.participantsAttrs=void 0,ee.prototype.render.apply(this,arguments)},renderMarkup:function(){ee.prototype.renderMarkup.apply(this,arguments),this.$participants=this.$(".participants"),this.participantMarkup=X(this.model.participantMarkup)},renderParticipants:function(t){var e=this,i=this.$participants,n=X(i[0]).children();i.empty(),this.participantsAttrs={},kt(t).forEach(function(r,o){var s="participant_"+o,a="."+s,a=(e.participantsAttrs[a+" .participant-rect"]={height:e.options.participantHeight},e.participantsAttrs[a+" .participant-label"]={text:r},o<n.length?n[o]:e.participantMarkup.clone());e.$participants.append(a.addClass(s).node)}),this.layoutAndUpdate()},layoutAndUpdate:function(){var a=this.model.get("participants")||[],t=a.length,e=this.options.participantHeight,l=this.model.get("size").height,i=Math.max(0,l-e*t),n=0,s=this.model.get("initiatingParticipant"),r=Math.max(Nt(s)?Math.abs(s):a.indexOf(s),0),o=Math.min(r,t-2),s=(kt(a).forEach(function(h,u){var d=".participant_"+u;this.participantsAttrs[d]={transform:"translate(0,"+n+")"},this.participantsAttrs[d+" .participant-rect"].fill=r==u?this.model.attr(".body/fill"):this.model.attr(".participant-rect/fill"),this.participantsAttrs[d+" .participant-rect"].stroke=r==u?this.model.attr(".body/stroke"):this.model.attr(".participant-rect/stroke"),n+=e+(o==u?i:0)},this),t<2?0:o-t+1),a=(this.participantsAttrs[".sub-process"]={"ref-dy":Math.max(-l,s*e-30)},t<2?0:o+1),l=(this.participantsAttrs[".fobj div"]={style:{height:i,paddingTop:e*a}},this.participantsAttrs[".content"]={"ref-y":e*a+i/2},ze({},this.model.get("attrs"),this.participantsAttrs||{}));Cl(l,"div/html"),io.prototype.update.call(this,this.model,l)}}),Ni=Kt.extend({markup:'<g class="rotatable"><g class="scalable"><polygon class="body"/></g><text class="label"/></g>',defaults:fi({type:"bpmn.Message",size:{width:60,height:40},attrs:{".body":{points:"0,0 60,0 60,40 0,40 0,0 60,0 30,20 0,0",stroke:"#000000",fill:"#ffffff"},".label":{ref:".body","ref-x":.5,"ref-dy":5,text:"","text-anchor":"middle"}}},Kt.prototype.defaults)}),fn=Ke.extend({defaults:{type:"bpmn.Flow",attrs:{".marker-source":{d:"M 0 0"},".marker-target":{d:"M 10 0 L 0 5 L 10 10 z",fill:"#000000"},".connection":{"stroke-dasharray":" ","stroke-width":1},".connection-wrap":{style:"",onMouseOver:"",onMouseOut:""}},flowType:"normal"},initialize:function(){Ke.prototype.initialize.apply(this,arguments),this.listenTo(this,"change:flowType",this.onFlowTypeChange),this.onFlowTypeChange(this,this.get("flowType"))},onFlowTypeChange:function(t,e){var i;switch(e){case"default":i={".marker-source":{d:"M 0 5 L 20 5 M 20 0 L 10 10",fill:"none"}};break;case"conditional":i={".marker-source":{d:"M 20 8 L 10 0 L 0 8 L 10 16 z",fill:"#FFF"}};break;case"normal":i={};break;case"message":i={".marker-target":{fill:"#FFF"},".connection":{"stroke-dasharray":"4,4"}};break;case"association":i={".marker-target":{d:"M 0 0"},".connection":{"stroke-dasharray":"4,4"}};break;case"conversation":i={".marker-target":{d:"M 0 0"},".connection":{"stroke-width":"7px"},".connection-wrap":{style:"stroke: #fff; stroke-width: 5px; opacity: 1;",onMouseOver:"var s=this.style;s.stroke='#000';s.strokeWidth=15;s.opacity=.4",onMouseOut:"var s=this.style;s.stroke='#fff';s.strokeWidth=5;s.opacity=1"}};break;default:throw"BPMN: Unknown Flow Type: "+e}i.root={dataFlowType:e},t.attr(ze({},this.defaults.attrs,i))}}),Dn={__proto__:null,icons:pc,IconInterface:Dn,SubProcessInterface:ri,ActivityView:zi,Activity:Ma,AnnotationView:Qt,Annotation:ci,Gateway:fe,Event:Bn,Pool:Ri,PoolView:_e,Group:Fo,DataObject:Xi,Conversation:Oi,Choreography:oo,ChoreographyView:Ji,Message:Ni,Flow:fn},ri=Ke,og=Oo,Xf=new Q(1,0),zi=ri.define("measurement.Distance",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",targetMarker:{type:"path","stroke-width":2,d:"M 0 10 0 -10 M 10 10 0 0 10 -10",fill:"none"},sourceMarker:{type:"path","stroke-width":2,d:"M 0 10 0 -10 M 10 10 0 0 10 -10",fill:"none"}},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"},anchorLines:{stroke:"#333333",strokeWidth:1,strokeDasharray:"1,2"},sourceAnchorLine:{dAnchor:"source"},targetAnchorLine:{dAnchor:"target"},distanceLabel:{distanceText:{unit:"px",fixed:0},fontFamily:"sans-serif",fontWeight:"lighter",fontSize:14,labelPosition:{ratio:.5,offset:12},textAnchor:"middle",textVerticalAnchor:"middle"}}},{markup:[{tagName:"path",selector:"sourceAnchorLine",groupSelector:"anchorLines"},{tagName:"path",selector:"targetAnchorLine",groupSelector:"anchorLines"},{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}},{tagName:"text",selector:"distanceLabel"}],getDistanceText:function(r,n){var i=(n=n===void 0?{}:n).fixed,n=(i===void 0&&(i=0),n.unit),r=(n===void 0&&(n=""),r.getConnectionLength().toFixed(i));return n?r+" "+n:""+r}},{attributes:{distanceText:{set:function(t){for(var e,i=[],n=arguments.length-1;0<n--;)i[n]=arguments[n+1];(e=og.text.set).call.apply(e,[this,this.model.getDistanceText(this,t)].concat(i))}},dAnchor:{set:function(t){return{d:"M "+new Ot(this.getEndAnchor(t),this.getEndConnectionPoint(t)).serialize()}}},labelPosition:{set:function(r){var e,i,n=r.ratio,r=r.offset,n=(r===void 0&&(r=0),this.getTangentAtRatio(n=n===void 0?.5:n)),n=(n?(i=n.vector().vectorAngle(Xf),e=n.start):(e=this.path.start,i=0),r),r=i===0?"translate("+e.x+","+e.y+")":(i!==(i=Xe((i+90)%180-90))&&(n=-r),"translate("+e.x+","+e.y+") rotate("+i+")");return{transform:r,y:n}}}}}),ks={self:"self",source:"source",target:"target"},He={clockwise:"clockwise",anticlockwise:"anticlockwise",small:"small",large:"large"};function fc(t,e,i){var l="angleData",n=t.nodeCache(t.el);if(l in n){if(e in n[l])return n[l][e]}else n[l]={};var r,o,s,a,l=typeof i.angle=="number",h=t.getEndView(e);return(h||l)&&(r=t.getTangentAtRatio((o=e==="target")?1:0))?(o&&r.scale(-1,-1,r.start),l=l?(o=r,s=(l=i).angle,l=i.angleRadius,a=o.clone().rotate(o.start,-s),sg(o,a,{angleRadius:l,angleStart:ks.target,angleDirection:s<0?He.clockwise:He.anticlockwise})):h.model.isLink()?(o=r,a=i,s=(l=h).getClosestPointLength(o.start),l=l.getTangentAtLength(s),sg(o,l,a)):(o=t.getEndMagnet(e),function(u,N,G,k){var v=k.angleRadius,k=k.angleDirection,I=N.model,_=I.getBBox(),I=I.angle(),_=_.center(),N=N.getNodeUnrotatedBBox(G),G=u.clone().setLength(1).end.rotate(_,I);if(N.containsPoint(G))return null;var F,H=0,Y=0,_=u.angle()-I;G.y>N.y+N.height||G.y<N.y?(_+=90,H=v):Y=v,_=Xe(_);var K=Math.floor(_/90);switch(K){case 0:F=1;break;case 1:F=0;break;case 2:H*=-1,Y*=-1,F=1;break;case 3:H*=-1,Y*=-1,F=0}var tt=!1;switch(k){case He.large:tt=!0;break;case He.anticlockwise:tt=K===0||K===2;break;case He.clockwise:tt=K===1||K===3}return tt&&(H*=-1,Y*=-1,F^=1),G=u.setLength(v),N=G.start,k=G.end,u=N.clone().offset(H,Y).rotate(N,-I),v=N.angleBetween(k,u),180<v&&(v=360-v),{arcAngle:_,angleBetween:v,sweepFlag:F,largeArcFlag:0,otherArcPoint:u,linkArcPoint:k,connectionPoint:N}}(r,h,o,i)),n.angleData[e]=l):null}function sg(l,h,a){var n=a.angleRadius,r=a.angleStart,o=a.angleDirection,a=l.setLength(n),s=a.start,a=a.end,l=l.angle(),h=h.setLength(n).end,u=s.angleBetween(a,h),d=1,p=0,m=!1,v=!1,k=!0,I=Math.floor(u/90);switch(r){case ks.target:switch(o===He.small?o=u<180?He.clockwise:He.anticlockwise:o===He.large&&(o=180<u?He.clockwise:He.anticlockwise),o){case He.anticlockwise:0<u&&u<180&&(p^=1),v=!0;break;default:case He.clockwise:180<=u&&(p^=1),d^=1}k=!1;break;case ks.source:switch(o===He.small?o=180<u?He.clockwise:He.anticlockwise:o===He.large&&(o=u<180?He.clockwise:He.anticlockwise),o){case He.anticlockwise:180<u&&(p^=1),d=1,v=!0;break;default:case He.clockwise:u<180&&(p^=1),d=0}m=!(k=!1),u=Xe(u+180);break;default:case ks.self:switch(o){case He.anticlockwise:m=I===0||I===1,d=1,v=!0;break;case He.clockwise:m=I===2||I===3,d=0,v=!1;break;case He.small:m=I===1||I===2,d=I===0||I===2?0:1,v=I===1||I===3;break;case He.large:m=I===0||I===3,d=I===1||I===3?0:1,v=I===0||I===2}}return m&&(h=h.reflection(s)),k&&180<=u&&(u=Xe(u-180)),{angleBetween:u=v?Xe((k?180:360)-u):u,connectionPoint:s,linkArcPoint:a,otherArcPoint:h,largeArcFlag:p,sweepFlag:d,arcAngle:l}}Ma={__proto__:null,Distance:zi,Angle:ri.define("measurement.Angle",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round"},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"},angles:{stroke:"#333333",fill:"none",strokeWidth:1,angleRadius:40},sourceAngle:{angleD:"source"},targetAngle:{angleD:"target"},angleLabels:{textAnchor:"middle",textVerticalAnchor:"middle",fill:"#333333",fontSize:11,fontFamily:"sans-serif",angleTextDecimalPoints:0,angleTextDistance:23},sourceAngleLabel:{angleText:"source",angleTextPosition:"source"},targetAngleLabel:{angleText:"target",angleTextPosition:"target"}}},{markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}},{tagName:"path",selector:"sourceAngle",groupSelector:"angles",attributes:{cursor:"pointer"}},{tagName:"path",selector:"targetAngle",groupSelector:"angles",attributes:{cursor:"pointer"}},{tagName:"text",selector:"sourceAngleLabel",groupSelector:"angleLabels"},{tagName:"text",selector:"targetAngleLabel",groupSelector:"angleLabels"}],getAngleText:function(i){var e=(i=i===void 0?{}:i).angle,i=i.decimalPoints;return(e=e===void 0?0:e).toFixed(i=i===void 0?2:i)+"°"}},{AngleStarts:ks,AngleDirections:He,attributes:{angleD:{set:function(u,e,i,n){var r=n.angleRadius,o=n.angleStart,s=(o===void 0&&(o=ks.self),n.anglePie),a=(s===void 0&&(s=!1),n.angleDirection);a===void 0&&(a=He.small);var l,h,u=fc(this,u,{angle:n.angle,angleRadius:r=r===void 0?40:r,angleStart:o,angleDirection:a});return u?(n=u.connectionPoint,o=u.linkArcPoint,a=u.otherArcPoint,l=u.arcAngle,h=u.largeArcFlag,u=u.sweepFlag,o=["M "+o.serialize(),"A "+r+" "+r+" "+l+" "+h+" "+u+" "+a.serialize()],s&&o.push("L "+n.serialize()+" Z"),{d:o.join(" ")}):{d:"M 0 0 0 0"}}},angleText:{set:function(o,e,i,n){var r="",o=fc(this,o,{angleRadius:40});o&&(r=this.model.getAngleText({angle:o.angleBetween,decimalPoints:n.angleTextDecimalPoints})),og.text.set.call(this,r,e,i,n)}},angleTextPosition:{set:function(u,e,i,h){var r,o,s,a,l,h=h.angleTextDistance,u=fc(this,u,{angleRadius:h=h===void 0?60:h});return u?(r=u.connectionPoint,l=u.otherArcPoint,a=u.linkArcPoint,s=u.angleBetween,u=u.largeArcFlag,Math.abs(s-180)<1e-6?(s=a.clone().rotate(r,u?90:-90),o=new Ot(r,s).setLength(h)):(s=new Ot(a,l).midpoint(),o=new Ot(r,s).setLength(h),u&&o.scale(-1,-1,o.start)),a=o.end,l=Xe((o.angle()+90)%180-90),{transform:"translate("+a.serialize()+") rotate("+l+")"}):{}}},angle:{},angleRadius:{},angleTextDistance:{},angleTextDecimalPoints:{},anglePie:{},angleStart:{},angleDirection:{}}})},Qt='xmlns="http://www.w3.org/2000/svg"',fe=(ci=(ci={color:"${color}",svg:!0})===void 0?{}:ci).color,ci=ci.svg,Yl={none:null,message1:"<svg "+Qt+' viewBox="10 10 20 20"><path fill="none" stroke="'+(fe=fe===void 0?"#000":fe)+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2" d="M12.5 15.313v9.374h15v-9.375zm0 0l7.5 5.624 7.5-5.625"/></svg>',message2:"<svg "+Qt+' viewBox="10 10 20 20"><path fill="'+fe+'" d="M12.5 14.344l7.5 5.625 7.5-5.625zm0 .937v9.375h15v-9.375L20 20.906z"/></svg>',timer1:"<svg "+Qt+' viewBox="8 8 24 24"><g fill="none" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><circle cx="20" cy="20" r="10"/><path d="M20 10v3m5-2l-1.5 3m5.5 1l-3 1.5m4 3.5h-3m2 5l-3-1.5M25 29l-1.5-3M20 30v-3m-5 2l1.5-3M11 25l3-1.5M10 20h3m-2-5l3 1.5m1-5.5l1.5 3m5.5-1l-2 7h4"/></g></svg>',conditional1:"<svg "+Qt+' viewBox="6 6 28 28"><path fill="none" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.563 11.563h16.874v16.874H11.563V11.563m2.813 2.813h11.25m-11.25 3.75h11.25m-11.25 3.75h11.25m-11.25 3.75h11.25z"/></svg>',link1:"<svg "+Qt+' viewBox="8 8 24 24"><path fill="none" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M14.406 18.125h8.438v-2.813L27.53 20l-4.687 4.688v-2.813h-9.375v-3.75"/></svg>',link2:"<svg "+Qt+' viewBox="8 8 24 24"><path fill="'+fe+'" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M14.406 18.125h8.438v-2.813L27.53 20l-4.687 4.688v-2.813h-9.375v-3.75"/></svg>',signal1:"<svg "+Qt+'  viewBox="8 8 24 24"><path fill="none" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13.17 24.851h13.706l-6.853-11.879-6.854 11.88z"/></svg>',signal2:"<svg "+Qt+'  viewBox="8 8 24 24"><path fill="'+fe+'" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13.17 24.851h13.706l-6.853-11.879-6.854 11.88z"/></svg>',error1:"<svg "+Qt+' viewBox="8 8 24 24"><path fill="none" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M26.4 15.455l-3.238 12.58L17.7 18.37 13.76 23.8l3.478-12.412 5.576 8.72 3.586-4.652z"/></svg>',error2:"<svg "+Qt+' viewBox="8 8 24 24"><path fill="'+fe+'" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M26.4 15.455l-3.238 12.58L17.7 18.37 13.76 23.8l3.478-12.412 5.576 8.72 3.586-4.652z"/></svg>',escalation1:"<svg "+Qt+' viewBox="8 8 24 24"><path fill="none" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 13.219l5.625 14.062L20 20.953l-5.625 6.328z"/></svg>',escalation2:"<svg "+Qt+' viewBox="8 8 24 24"><path fill="'+fe+'" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 13.219l5.625 14.062L20 20.953l-5.625 6.328z"/></svg>',termination1:"<svg "+Qt+' viewBox="8 8 24 24"><circle cx="20" cy="20" r="10.5" fill="none" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"/></svg>',termination2:"<svg "+Qt+' viewBox="8 8 24 24"><circle cx="20" cy="20" r="10.5" fill="'+fe+'" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"/></svg>',compensation1:"<svg "+Qt+' viewBox="8 8 24 24"><path fill="none" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 13.438v13.124L12.437 20 19 13.437m6.563 0v13.126L19 20l6.563-6.563z"/></svg>',compensation2:"<svg "+Qt+' viewBox="8 8 24 24"><path fill="'+fe+'" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 13.438v13.124L12.437 20 19 13.437m6.563 0v13.126L19 20l6.563-6.563z"/></svg>',cancel1:"<svg "+Qt+' viewBox="8 8 24 24"><path fill="none" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.284 14.274l2.867-2.868 5.735 5.735 5.735-5.735 2.868 2.868-5.735 5.735 5.735 5.735-2.868 2.867-5.735-5.735-5.735 5.735-2.867-2.867 5.735-5.735-5.735-5.735z"/></svg>',cancel2:"<svg "+Qt+' viewBox="8 8 24 24"><path fill="'+fe+'" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.284 14.274l2.867-2.868 5.735 5.735 5.735-5.735 2.868 2.868-5.735 5.735 5.735 5.735-2.868 2.867-5.735-5.735-5.735 5.735-2.867-2.867 5.735-5.735-5.735-5.735z"/></svg>',multiple1:"<svg "+Qt+' viewBox="8 8 24 24"><path fill="none" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M24.52 26.39h-9.443l-2.918-8.982 7.64-5.55 7.64 5.551-2.919 8.98z"/></svg>',multiple2:"<svg "+Qt+' viewBox="8 8 24 24"><path fill="'+fe+'" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M24.52 26.39h-9.443l-2.918-8.982 7.64-5.55 7.64 5.551-2.919 8.98z"/></svg>',parallel1:"<svg "+Qt+' viewBox="8 8 24 24"><path fill="none" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.344 17.203v5.625h5.86v6.328h5.624v-6.328h6.328v-5.625h-6.328v-5.86h-5.625v5.86z"/></svg>',parallel2:"<svg "+Qt+' viewBox="8 8 24 24"><path fill="'+fe+'" stroke="'+fe+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.344 17.203v5.625h5.86v6.328h5.624v-6.328h6.328v-5.625h-6.328v-5.86h-5.625v5.86z"/></svg>'};var mc,Yl,vc,Ul,yc,Hl,bc,Xl,Bn=(ci=ci!==void 0&&ci)?Yl:(mc={},Object.keys(Yl).forEach(function(t){mc[t]="data:image/svg+xml,"+encodeURIComponent(Yl[t])}),mc),Fo=(_e=(Ri=(Ri={color:"${color}",svg:!0})===void 0?{}:Ri).color,Ri=Ri.svg,Ul={exclusive_blank:null,exclusive:"<svg "+Qt+' viewBox="12 12 26 26"><path fill="'+(_e=_e===void 0?"#000":_e)+'" stroke="'+_e+'" d="M18.25 17.063L23.5 25.5l-5.25 8.438h4l3.25-5.25 3.25 5.25h3.906L27.438 25.5l5.218-8.438H28.75l-3.25 5.25-3.25-5.25h-4z"/></svg>',inclusive:"<svg "+Qt+' viewBox="12 12 26 26"><circle cx="25" cy="25" r="9.429" fill="none" stroke="'+_e+'" stroke-width="3"/></svg>',parallel:"<svg "+Qt+' viewBox="12 12 26 26"><path fill="'+_e+'" stroke="'+_e+'" stroke-width="1.4" d="M16.388 21.821v5.625h5.86v6.328h5.624v-6.328H34.2v-5.625h-6.328v-5.86h-5.625v5.86z"/></svg>',event:"<svg "+Qt+' viewBox="12 12 26 26"><circle stroke-width="1.4" cx="25" cy="25" r="12.121" fill="none" stroke="'+_e+'"/><circle stroke-width="1.4" cx="25" cy="25" r="10.121" fill="none" stroke="'+_e+'"/><path fill="none" stroke="'+_e+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.4" d="M29.828 31.845h-9.069l-2.801-8.625 7.337-5.33 7.335 5.33-2.802 8.625z"/></svg>',exclusive_event:"<svg "+Qt+' viewBox="12 12 26 26"><circle stroke-width="1.4" cx="25" cy="25" r="12.121" fill="none" stroke="'+_e+'"/><path fill="none" stroke="'+_e+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.4" d="M29.828 31.845h-9.069l-2.801-8.625 7.337-5.33 7.335 5.33-2.802 8.625z"/></svg>',parallel_event:"<svg "+Qt+' viewBox="12 12 26 26"><circle stroke-width="1.4" cx="25" cy="25" r="12.121" fill="none" stroke="'+_e+'"/><path fill="none" stroke="'+_e+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.4" d="M16.388 21.821v5.625h5.86v6.328h5.624v-6.328H34.2v-5.625h-6.328v-5.86h-5.625v5.86z"/></svg>',complex:"<svg "+Qt+' viewBox="13 13 25 25"><path fill="none" stroke="'+_e+'" stroke-width="4" d="M16.25 25.5h19m-9.75-9.25v19m-6.644-2.96L32.29 18.857m-13.435.353L32.29 32.644"/></svg>'},(Ri=Ri!==void 0&&Ri)?Ul:(vc={},Object.keys(Ul).forEach(function(t){vc[t]="data:image/svg+xml,"+encodeURIComponent(Ul[t])}),vc)),oo=(Oi=(Xi=(Xi={color:"${color}",svg:!0})===void 0?{}:Xi).color,Xi=Xi.svg,Hl={none:null,parallel:"<svg "+Qt+' viewBox="-3 -3 16 16"><path fill="none" stroke="'+(Oi=Oi===void 0?"#000":Oi)+'" stroke-width="2" d="M0 0v10M3 0v10M6 0v10"/></svg>',sequential:"<svg "+Qt+' viewBox="-3 -3 16 16"><path fill="none" stroke="'+Oi+'" stroke-width="2" d="M0 2h10M0  5h10M0 8h10"/></svg>',"sub-process":"<svg "+Qt+' viewBox="-2 -2 14 14"><path fill="none" stroke="'+Oi+'" stroke-width="1" d="M0 0h10v10H0zm5 2v6M2 5h6"/></svg>',compensation:"<svg "+Qt+' viewBox="8 8 24 24"><path fill="none" stroke="'+Oi+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 13.438v13.124L12.437 20 19 13.437m6.563 0v13.126L19 20l6.563-6.563z"/></svg>',"ad-hoc":"<svg "+Qt+' viewBox="0 0 2000 2000"><path fill="'+Oi+'" d="M300 1039.87c58.332-138.228 134.894-282.23 266.546-360.085c97.784-58.392 218.701-22.42 308.428 34.819c138.188 85.207 246.292 211.842 382.606 299.507c82.335 48.265 184.733 8.718 244.748-58.056c72.401-84.446 155.215-164.023 197.672-269.981v330.038c-61.331 121.67-140.231 248.152-266.392 307.169c-103.228 44.44-223.148 17.789-312.524-46.586c-131.02-87.979-227.486-223.69-369.854-294.78c-69.172-36.004-157.377-27.545-215.331 26.623C431.412 1101.042 371.534 1231.858 300 1350v-310.13z"/></svg>',loop:"<svg "+Qt+' viewBox="0 0 2000 2000"><path fill="'+Oi+'" d="M1057.07 410.836C805.11 407.3 563.447 583.065 491.134 824.983c-55.584 173.977-23.105 373.061 85.522 520.027l-269.086-52.09l-22.804 117.814l483.865 93.664l93.687-479.986l-117.779-22.988l-56.861 291.316c-138.733-165.6-136.73-427.773 4.367-591.379c137.417-171.716 399.203-221.007 590.733-114c183.232 94.568 284.888 318.597 234.896 518.746c-44.77 208.91-247.404 367.34-460.604 363.053c-55.485-3.935-83.374 76.196-37.436 107.561c40.104 24.986 90.846 7.364 134.808 4.475c248.181-37.748 457.52-249.452 489.52-498.91c36.994-238.025-91.384-488.935-304.803-600.241c-86.168-46.769-184.068-71.364-282.089-71.21z"/></svg>'},(Xi=Xi!==void 0&&Xi)?Hl:(yc={},Object.keys(Hl).forEach(function(t){yc[t]="data:image/svg+xml,"+encodeURIComponent(Hl[t])}),yc)),fn=(Ni=(Ji=(Ji={color:"${color}",svg:!0})===void 0?{}:Ji).color,Ji=Ji.svg,Xl={none:null,"business-rule":"<svg "+Qt+' viewBox="5 5 25 20"><path fill="'+(Ni=Ni===void 0?"#000":Ni)+'" stroke="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2" d="m 8,8 0,4 20,0 0,-4 z"/><path stroke="'+Ni+'" fill="none" d=" m 8,8 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"/></svg>',manual:"<svg "+Qt+' viewBox="0 0 2000 2000"><path d="M919.379 382.988c-22.3.007-42.953 8.258-60.567 19.616l-.029.017-.027.02c-94.694 61.32-418.867 286.29-490.127 335.2l-.002.003h-.002c-64.371 44.196-107.733 110.904-132.662 189.935l-.004.016-.004.014c-25.952 82.515-22.622 172.403-22.371 247.685l.002.02v.02c.255 56.685 1.606 106.154 16.309 166.148l.003.015c21.373 87.802 62.768 151.336 121.23 190.285 58.46 38.948 130.615 52.768 211.575 53.018 292.284 1.097 584.741 1.49 877.182 0h.05c32.21-.211 62.96-13.752 82.135-37.678 19.174-23.923 27.017-54.865 27.43-88.81.29-22.768-2.91-44.287-10.307-63.512h32.375c31.532 0 60.434-8.984 81.153-27.916 20.711-18.926 31.304-44.62 36.808-71.68v-.007c7.683-37.64 4.055-74.807-10.916-105.997 32.946-2.661 62.034-15.102 80.74-37.906 21.024-25.627 27.148-58.205 27.256-92.72.115-36.034-8.629-70.421-28.812-97.766s-53.772-45.956-91.567-46.01H1666.21c-13.76-.011-26.16.008-41.781 0 7.516-18.744 10.82-39.826 10.752-62.006v-.113c-.228-35.772-9.251-69.954-29.535-97.127-20.284-27.173-53.809-45.753-91.586-45.754-224.42-.885-446.252 2.157-634.903 1.203 9.83-9.885 19.378-19.525 29.871-29.96 32.482-32.304 63.7-62.743 79.827-83.612 38.555-49.623 44.307-116.852 11.85-166.305-17.114-26.143-42.208-43.832-69.151-47.513a89.543 89.543 0 00-10.012-.8v.003a90.145 90.145 0 00-2.162-.026zm.547 70.028a17.31 17.31 0 012.148.152c5.305.725 10.986 2.62 20.07 16.506l.018.025.016.026c12.691 19.326 12.131 58.305-8.623 84.992l-.035.045-.036.045c-7.546 9.77-41.454 44.616-73.818 76.802-32.364 32.187-63.134 61.896-78.357 80.442-14.557 17.734-9.216 32.647-5.268 41.982 3.948 9.335 8.465 20.237 28.598 25.02 6.028 1.432 6.36 1.02 8.289 1.152 1.929.133 3.923.224 6.267.309 4.689.169 10.688.297 18.094.406 226.465 1.38 450.423-1.24 676.709-.92h.063c17.211 0 26.557 5.657 35.492 17.627 8.929 11.962 15.468 31.813 15.629 55.652.066 24.73-5.857 39.82-13.057 48.133-7.2 8.313-16.845 13.52-37.475 13.588H1030v70h484.791c66.478.006 101.54-.042 151.363 0 17.308.03 26.53 5.662 35.324 17.578 8.8 11.922 15.21 31.827 15.133 55.975v.002c-.08 25.822-5.346 41.196-11.375 48.545-6.029 7.349-14.638 12.732-39.482 12.902-8.43.058-68.808.014-93.863.043-.397-.005-.786-.042-1.184-.043-180.227-.85-360.455-.002-540.682-.002H1030l-.025 70h.025c.043 0 382.517.239 541.33.047 19.7.279 31.511 8.21 40.934 23.601 9.563 15.621 14.323 40.11 8.68 67.756v.028c-3.737 18.38-9.413 28.473-15.436 33.976-6.023 5.504-14.335 9.592-33.934 9.592-180.523-.086-361.044-.452-541.568 0h-.092l.092 70h409.414c14.707.096 21.247 4.008 27.96 12.977 6.715 8.968 12.44 25.642 12.132 49.652v.025c-.284 23.412-5.952 38.272-12.057 45.889-6.105 7.617-12.405 11.357-27.973 11.459-292.123 1.488-584.356 1.097-876.51 0h-.025c-73.053-.223-130.456-12.932-173-41.275-42.55-28.344-73.607-72.869-92.039-148.598l-.008-.03-.005-.029c-12.87-52.492-14.06-94.01-14.311-149.81v-.041c-.256-76.57-1.724-160.05 19.146-226.408 21.392-67.802 55.988-119.253 105.512-153.256l.004-.002c72.125-49.505 398.23-275.66 488.5-334.12l.004-.001c8.476-5.465 15.5-7.79 20.719-8.303.87-.086 1.689-.122 2.457-.113z" fill="'+Ni+'" /></svg>',receive:"<svg "+Qt+' viewBox="10 10 20 20"><path fill="none" stroke="'+Ni+'" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2" d="M12.5 15.313v9.374h15v-9.375zm0 0l7.5 5.624 7.5-5.625"/></svg>',script:"<svg "+Qt+' viewBox="0 0 2000 2000"><path d="M759.41 378l-8.262 4.904-2.699 1.604C631.658 453.72 551.284 517.185 498.23 579.16c-53.13 62.06-78.817 124.548-79.547 184.787-1.454 119.88 86.972 209.719 165.425 290.067 78.394 80.286 148.323 156.002 154.905 218.664 3.354 31.938-4.195 64.019-39.02 107.943-34.678 43.74-97.616 96.128-198.24 154.785L353.193 1622h916.854l10.85-6.313.011-.01c106.636-62.16 178.477-119.59 224.254-177.33 45.914-57.91 64.594-118.499 58.62-175.378-11.838-112.702-103.646-194.827-180.829-273.873-77.243-79.108-139.852-153.721-139-224.024.43-35.49 14.072-75.084 57.219-125.484 43.073-50.314 115.696-109.181 227.031-175.158v-.002L1674.045 378H759.41zm25.842 92.918h564.643c-49.73 37.078-89.049 72.898-119.307 108.242-53.13 62.06-78.817 124.548-79.547 184.787-1.453 119.882 86.977 209.72 165.43 290.067 78.393 80.286 148.316 156 154.898 218.664 3.355 31.938-4.193 64.019-39.017 107.943-33.397 42.123-93.456 92.386-187.79 148.461h-566.09c39.27-30.627 70.469-60.635 94.33-90.732 45.914-57.911 64.594-118.5 58.62-175.38-11.838-112.701-103.645-194.826-180.828-273.872-77.243-79.108-139.85-153.721-138.998-224.024.43-35.49 14.07-75.084 57.216-125.484 41.627-48.624 111.275-105.346 216.44-168.672zM653.13 629.393v42.92h441.398v-42.92H653.131zm-16.402 231.175v42.918h456.384v-42.918H636.73zm206.794 231.17v42.918h441.989v-42.918H843.523zm63.198 231.174v42.918h457.986v-42.918H906.721z" fill="'+Ni+'"/></svg>',send:"<svg "+Qt+' viewBox="10 10 20 20"><path fill="'+Ni+'" d="M12.5 14.344l7.5 5.625 7.5-5.625zm0 .937v9.375h15v-9.375L20 20.906z"/></svg>',service:"<svg "+Qt+' viewBox="0 0 2000 2000"><path d="M825.746 438.174c-.046 36.998.01 73.998.106 110.996-31.554 8.927-60.387 21.384-87.616 36.644l-79.582-78.625-148.806 149.668 79.576 78.612a393.526 393.526 0 00-35.752 87.242l-112.725.205v210.79l113.903-.411c10.416 41.298 33.084 78.425 55.662 111.623V963.094l-99.565.357V892.79l99.069-.18 5.56-28.172c8.11-41.084 24.17-80.249 47.244-115.292l15.785-23.973-69.603-68.762 50.094-50.385 69.73 68.893 23.73-15.836c36.264-23.926 75.929-39.963 115.481-48.316l27.96-5.805-.25-96.785h71.966l-.557 96.281h188.834c-17.713-21.144-91.12-48.658-118.508-56.324l.635-109.957c-78.4-.002-139.865.004-212.37-.002zm199.158 201.658l.287 110.992c-31.554 8.927-60.387 21.383-87.617 36.645l-79.584-78.625-148.806 149.668 79.578 78.611a393.515 393.515 0 00-35.754 87.244l-112.723.203v210.79l113.9-.409c8.966 31.257 21.395 59.8 36.626 86.746l-81.495 81.176 150.465 147.879 81.201-80.824c27.815 15.444 57.38 27.436 88.034 35.781l.052 114.713c72.392.634 149.467.307 211.336.3v-116.07c31.578-8.904 60.501-21.45 87.737-36.705l81.134 79.996 148.905-149.48-81.305-80.123a394.444 394.444 0 0035.799-87.399l110.379-.681v-210.586l-111.618.68c-8.972-31.287-21.22-59.637-36.654-86.762l77.121-77.319-150.38-148.13-77.022 77.285a398.637 398.637 0 00-87.68-35.639l.633-109.957h-212.549zm70.18 70h71.967l-.555 96.283 28.426 5.578c41.272 8.1 80.83 24.14 116.015 47.073l23.825 15.529 67.216-67.445 50.618 49.86-67.31 67.483 16.194 23.907c23.765 35.872 39.529 74.65 48.428 114.58l5.856 28.011 97.28-.591v70.59l-96.737.595-5.557 28.012a324.606 324.606 0 01-47.299 115.398l-15.803 24.006 71.258 70.223-50.086 50.28-71.265-70.266-23.69 15.738c-36.275 23.706-75.624 40.123-115.324 48.21l-28.144 5.622v102.215c-19.241.046-40.231.016-71.37-.028l-.045-101.449-28.271-5.521c-41.33-8.071-80.823-24.038-115.947-47.067l-23.754-15.574-71.541 71.21-50.625-49.757 71.64-71.361-16.347-24.004c-23.787-35.794-39.523-74.612-48.438-114.496l-5.85-27.926-99.564.355v-70.66l99.069-.181 5.56-28.168c8.11-41.085 24.17-80.252 47.244-115.295l15.785-23.975-69.605-68.762 50.094-50.384 69.732 68.892 23.73-15.834c36.31-23.77 74.841-39.541 115.481-48.314l27.96-5.805-.251-96.787zm37.166 257.203c-86.647 0-157.639 70.994-157.639 157.64 0 86.648 70.992 157.638 157.639 157.638s157.639-70.99 157.639-157.637-70.992-157.64-157.639-157.64zm0 70c48.816 0 87.639 38.825 87.639 87.64 0 48.817-38.823 87.638-87.639 87.638-48.816 0-87.637-38.821-87.637-87.637s38.82-87.64 87.637-87.64z" fill="'+Ni+'"/></svg>',user:"<svg "+Qt+' viewBox="0 0 2000 2000"><path d="M991.75 365c-177.277 0-304.097 136.28-304.453 291.514v.088c.011 46.944 12.714 96.49 32.56 141.177 14.33 32.267 32.147 61.932 53.858 85.696-129.03 44.143-280.193 116.795-356.598 260.054L413 1151.25V1615h1157.5v-463.75l-4.117-7.72c-75.306-141.2-223.199-213.75-350.98-258.077 62.379-63.433 80.78-145.306 80.8-228.851v-.088C1295.847 501.28 1169.027 365 991.75 365zM870.709 530.299c8.194.02 17.191.294 27.11.879 79.022 4.657 105.618 18.882 126.062 32.373 20.443 13.49 34.855 26.333 88.883 27.908h.034c42.101-1.575 62.349-9.081 76.869-17.584 5.884-3.445 10.824-7.027 15.887-10.447 13.38 28.682 20.567 60.389 20.648 93.203-.028 93.44-16.092 158.876-101.768 212.424l8.381 63.17c17.833 5.415 36.266 11.357 54.975 17.873 2.613 10.9 5.632 25.196 7.662 40.394 2.127 15.923 2.964 32.489 1.652 44.928-1.311 12.439-5.173 19.154-5.851 19.832-43.547 43.547-120.847 68.943-199.252 68.943-78.406 0-155.705-25.396-199.252-68.943-.678-.678-4.54-7.393-5.852-19.832-1.311-12.439-.475-29.005 1.653-44.928 2.041-15.282 5.084-29.662 7.707-40.584 18.522-6.44 36.77-12.32 54.43-17.683l4.995-67.688c-4.068-5.217-8.213-8.673-13.16-12.385-19.121-14.345-42.31-45.903-58.69-82.785-16.373-36.868-26.517-79.01-26.532-112.744.101-40.444 10.985-79.211 30.976-112.697 3.577-1.332 7.349-2.739 11.588-4.133 14.908-4.903 35.337-9.583 70.846-9.494zM719.361 979.855c-.063.46-.133.907-.195 1.368-2.587 19.363-4.107 40.44-1.883 61.537 2.224 21.096 7.79 43.81 25.969 61.988 62.048 62.048 155.95 89.447 248.748 89.447 92.797 0 186.7-27.4 248.748-89.447 18.178-18.178 23.745-40.892 25.969-61.988 2.224-21.097.704-42.174-1.883-61.537-.051-.382-.11-.753-.162-1.133 94.334 41.369 185.515 100.615 235.828 189.074V1545H1333v-265h-70v265H719v-265h-70v265H483v-375.836c50.408-88.626 141.838-147.93 236.361-189.309z" fill="'+Ni+'" fill-rule="evenodd"/></svg>'},(Ji=Ji!==void 0&&Ji)?Xl:(bc={},Object.keys(Xl).forEach(function(t){bc[t]="data:image/svg+xml,"+encodeURIComponent(Xl[t])}),bc));function ag(t){return function(e,i,n,r){switch(e){case"double":var o=i.clone().inflate(-3),s=r.fill;return s===void 0&&(s="none"),{d:t(i,r,0)+" "+t(o,r,3),fill:s};case"thick":return o=i.clone().inflate(-3),s=r.stroke,s===void 0&&(s="black"),{d:t(i,r,0)+" "+t(o,r,3),fill:s};default:return{d:t(i,r,0),fill:"none"}}}}function lg(t,e,i,n){switch(t){case"dashed":var o=e.width,r=e.height,o=Math.floor(Math.min(o,r)/20),s=4*o+","+o;break;case"dotted":r=n.strokeWidth||n["stroke-width"],s=r+","+2*r;break;default:s="none"}return{"stroke-dasharray":s}}function hg(t,e,n){var n=(n=n===void 0?{}:n)[t];return{"xlink:href":typeof n=="string"?(e=e.iconColor,n=n.replace(/\${color}/g,e=e===void 0?"black":e),"data:image/svg+xml,"+encodeURIComponent(n)):null,"data-icon-type":t}}function Sa(t){return function(e,i,n,r){return hg(e,r,this.model.constructor[t])}}var Jl="row",cg="column",Ts={topLeft:"left-top",bottomLeft:"left-bottom",topRight:"right-top",bottomRight:"right-bottom",topMiddle:"top",bottomMiddle:"bottom",rightMiddle:"right",leftMiddle:"left",center:"center"},ug=Object.keys(Ts).reduce(function(t,e){return t[Ts[e]]=e,t},{});function dg(t){return function(e,i,n,r){var o=this,s=P(n),a="joint-icons",l=s.data(a.toString()),d=r.iconColor,h=(d===void 0&&(d="#333333"),r.iconSize),u=(h===void 0&&(h=30),r.iconsFlow),d=(u===void 0&&(u=Jl),e.toString()+" "+d+" "+h+" "+u);if(l!==d){var l=X(n),p=(l.empty(),u===cg);if(!Array.isArray(e))return;n=e.map(function(v,k){var I,N=X("image");return N.attr(hg(v,r,o.model.constructor[t])),v=p?(I=0,k*h):(I=k*h,0),N.attr({x:I,y:v,width:h,height:h}),N}),l.append(n)}s.data(a,d)}}function gg(l,e,i,s){var r,o=s.iconSize,a=(o===void 0&&(o=30),s.iconsFlow),s=(a===void 0&&(a=Jl),s.iconsOrigin),l=(s===void 0&&(s=Ts.topLeft),Array.isArray(l)?l.length:0),a=a===cg?l*(r=o):(r=l*o,o),l=new nt(0,0,-r,-a);return s in ug?l[ug[s]]():l.center()}function pg(t,e,i,m,v,o,s){var a,l=ot(m),p=ti(m.labelMargin),h=p.left,u=p.right,d=p.top,p=p.bottom,m=Jf[m.labelAlignment],v=new nt(h,d,v-h-u,o-d-p);return m&&(l.textAnchor=m["text-anchor"],l.textVerticalAnchor=m["text-vertical-anchor"]),h=e.textWrap?(a="textWrap",{text:s,ellipsis:e.ellipsis}):(a="text",s),t.getAttributeDefinition(a).set.call(t,h,v,i,l),m}var Ai=ot(Ts),Jf={"left-top":{"text-anchor":"start","text-vertical-anchor":"top"},"left-bottom":{"text-anchor":"start","text-vertical-anchor":"bottom"},"right-top":{"text-anchor":"end","text-vertical-anchor":"top"},"right-bottom":{"text-anchor":"end","text-vertical-anchor":"bottom"},top:{"text-anchor":"middle","text-vertical-anchor":"top"},bottom:{"text-anchor":"middle","text-vertical-anchor":"bottom"},right:{"text-anchor":"end","text-vertical-anchor":"middle"},left:{"text-anchor":"start","text-vertical-anchor":"middle"},center:{"text-anchor":"middle","text-vertical-anchor":"middle"}},zi=Kt.define("bpmn2.Event",{size:{width:40,height:40},attrs:{root:{magnetSelector:"background",highlighterSelector:"background"},background:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%",fill:"#FFFFFF"},border:{stroke:"#333333",fillRule:"evenodd",borderType:"single",borderStyle:"solid",strokeWidth:2},icon:{iconColor:"#333333",iconType:"none",refX:"15%",refY:"15%",refWidth:"70%",refHeight:"70%"},label:{refDy:10,refX:"50%",textVerticalAnchor:"top",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold"}}},{markup:[{tagName:"ellipse",selector:"background"},{tagName:"image",selector:"icon"},{tagName:"path",selector:"border"},{tagName:"text",selector:"label"}]},{attributes:{borderType:{set:ag(function(t){return e=(t=t).center(),e=X("ellipse",{cx:e.x,cy:e.y,rx:t.width/2,ry:t.height/2}),X.convertEllipseToPathData(e);var e})},borderStyle:{set:lg},iconType:{set:Sa("EVENT_ICONS")}},EVENT_ICONS:Bn}),ri=Kt.define("bpmn2.Gateway",{size:{width:58,height:58},attrs:{root:{magnetSelector:"body",highlighterSelector:"body"},body:{refPoints:"1,0,2,1,1,2,0,1",fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},icon:{iconColor:"#333333",refX:"19%",refY:"19%",refWidth:"62%",refHeight:"62%"},label:{refDy:10,refX:"50%",textVerticalAnchor:"top",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold"}}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"image",selector:"icon"},{tagName:"text",selector:"label"}]},{attributes:{iconType:{set:Sa("GATEWAY_ICONS")}},GATEWAY_ICONS:Fo}),fe=Kt.define("bpmn2.DataStore",{size:{width:63,height:63},attrs:{root:{magnetSelector:"body",highlighterSelector:"body"},body:{lateralArea:10,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},top:{refCx:"50%",cy:10,refRx:"50%",ry:10,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:10,fontSize:12,fontFamily:"sans-serif",fontWeight:"bold",fill:"#333333",textWrap:{width:"200%"}}}},{markup:[{tagName:"path",selector:"body"},{tagName:"ellipse",selector:"top"},{tagName:"text",selector:"label"}],topRy:function(t,e){var i;return t===void 0?this.attr("body/lateralArea"):(i=ni(t),this.attr({body:{lateralArea:t},top:i?{refCy:t,refRy:t,cy:null,ry:null}:{refCy:null,refRy:null,cy:t,ry:t},label:{refY2:t}},e))}},{attributes:{lateralArea:{set:function(s,d){var o=ni(s),p=(o&&(s=parseFloat(s)/100),d.x),m=d.y,a=d.width,d=d.height,i=o?d*s:s,r=X.KAPPA,n=r*(a/2),r=r*(o?d*s:s),o=p,s=p+a/2,a=p+a,l=m+i,h=l-i,u=m+d-i,m=m+d,d=["M",o,l,"L",o,u,"C",p,u+r,s-n,m,s,m,"C",s+n,m,a,u+r,a,u,"L",a,l,"C",a,l-r,s+n,h,s,h,"C",s-n,h,o,l-r,o,l,"Z"],p=l+7,m=l+i+7;return d.push("M",a,p,"C",a,p+r,s+n,m,s,m,"C",s-n,m,o,p+r,o,p),d.push("L",o,p+=7,"C",o,p+r,s-n,m+=7,s,m,"C",s+n,m,a,p+r,a,p,"Z"),{d:d.join(" ")}}}}}),ci=Kt.define("bpmn2.DataObject",{size:{width:48,height:65},attrs:{root:{magnetSelector:"body",highlighterSelector:"body"},body:{objectD:10,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},label:{refY:"100%",refY2:10,refX:"50%",textVerticalAnchor:"top",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold",textWrap:{width:"200%"}},dataTypeIcon:{iconColor:"#333333",iconType:"none",x:0,y:0,width:25,height:25},collectionIcon:{iconColor:"#333333",collection:!1,refX:"50%",refY:"100%",y:-18,x:-6,width:16,height:16}}},{markup:[{tagName:"path",selector:"body"},{tagName:"text",selector:"label"},{tagName:"image",selector:"dataTypeIcon"},{tagName:"image",selector:"collectionIcon"}]},{attributes:{objectD:{set:function(t,a){var i=a.topLeft(),n=a.bottomLeft(),r=a.bottomRight(),a=a.topRight(),o=a.clone().offset(-t,t),s=a.clone().offset(0,t),a=a.clone().offset(-t,0);return{d:"M "+i.serialize()+" "+n.serialize()+" "+r.serialize()+" "+s.serialize()+" "+a.serialize()+" Z "+("M "+a.serialize()+" "+o.serialize()+" "+s.serialize())}}},iconType:{set:Sa("DATA_OBJECT_TYPE_ICONS")},collection:{set:Sa("DATA_OBJECT_COLLECTION_ICONS")}},DATA_OBJECT_TYPE_ICONS:{none:null,input:Bn.link1,output:Bn.link2},DATA_OBJECT_COLLECTION_ICONS:{false:null,true:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="-3 -3 16 16"><path fill="none" stroke="${color}" stroke-width="2" d="M0 0v10M3 0v10M6 0v10"/></svg>'}}),_e={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{label:{fill:"#333333",fontSize:12,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"sans-serif"},body:{ref:"label",fill:"#ffffff",stroke:"none",refX:0,refY:0,refWidth:"100%",refHeight:"100%"}},position:{distance:.5}},Ri=Ke.define("bpmn2.DataAssociation",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",strokeDasharray:"2,5",targetMarker:{type:"path",d:"M 10 -7 0 0 10 7","stroke-width":2,fill:"none"}},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{defaultLabel:_e,markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),Oi=Kt.define("bpmn2.Activity",{size:{width:120,height:100},attrs:{root:{magnetSelector:"background",highlighterSelector:"background"},background:{refWidth:"100%",refHeight:"100%",fill:"#FFFFFF",rx:10,ry:10},border:{stroke:"#333333",fillRule:"evenodd",borderType:"single",borderStyle:"solid",borderRadius:10,strokeWidth:2},icon:{iconColor:"#333333",iconType:"none",x:5,y:0,width:30,height:30},label:{refY:"50%",refX:"50%",textVerticalAnchor:"middle",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold",textWrap:{width:-10,height:-50,ellipsis:!0}},markers:{event:"element:marker:pointerdown",iconSize:16,iconColor:"#333333",iconTypes:[""],iconsOrigin:Ts.bottomMiddle,iconsFlow:Jl,refX:"50%",refY:"100%",refY2:-5}}},{markup:[{tagName:"rect",selector:"background"},{tagName:"image",selector:"icon"},{tagName:"path",selector:"border"},{tagName:"text",selector:"label"},{tagName:"g",selector:"markers"}]},{attributes:{borderType:{set:ag(function(t,e,i){return e=e.borderRadius,e===void 0&&(e=0),e=Math.max(Math.min(e,2),e-i),i=t.toJSON(),i.rx=i.ry=e,X.rectToPath(i)})},borderStyle:{set:lg},iconType:{set:Sa("ACTIVITY_TYPE_ICONS")},iconTypes:{set:dg("ACTIVITY_MARKER_ICONS"),position:gg},iconSize:{},iconsOrigin:{},iconsFlow:{},iconColor:{},borderRadius:{}},ACTIVITY_TYPE_ICONS:fn,ACTIVITY_MARKER_ICONS:ai(oo,"none")}),Xi=Kt.define("bpmn2.Conversation",{size:{width:58,height:47},attrs:{root:{magnetSelector:"body",highlighterSelector:"body"},body:{fill:"#FFFFFF",stroke:"#333333",refPoints:"1,0 3,0, 4,1 3,2 1,2 0,1, 1,0",strokeLinejoin:"round",strokeWidth:2},markers:{event:"element:marker:pointerdown",iconSize:16,iconColor:"#333333",iconTypes:[],iconsOrigin:Ts.bottomMiddle,iconsFlow:Jl,refX:"50%",refY:"100%"},label:{refDy:10,refX:"50%",textVerticalAnchor:"top",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold"}}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"text",selector:"label"},{tagName:"g",selector:"markers"}]},{attributes:{iconTypes:{set:dg("CONVERSATION_MARKER_ICONS"),position:gg},iconSize:{},iconsOrigin:{},iconsFlow:{},iconColor:{}},CONVERSATION_MARKER_ICONS:ai(oo,"none")}),Qt=Ke.define("bpmn2.ConversationLink",{attrs:{line:{connection:!0,stroke:"#FFFFFF",strokeWidth:2,strokeLinejoin:"round"},outline:{connection:!0,stroke:"#333333",strokeWidth:6,strokeLinejoin:"round"},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{defaultLabel:_e,markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"outline",attributes:{fill:"none","pointer-events":"none"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),$f=Oo.sourceMarker.set,Kf=Oo.targetMarker.set,$l={sequence:"sequence",default:"default",conditional:"conditional",message:"message"},Ni=Ke.define("bpmn2.Flow",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",flowType:"sequence"},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{defaultLabel:_e,markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]},{attributes:{flowType:{set:function(t,e,i,n){var r,o,s=n.markerFill,a=(s===void 0&&(s="#FFFFFF"),n.strokeWidth),l=(a===void 0&&(a=2),{"stroke-dasharray":"none","marker-start":null,"marker-end":null});switch(t){case $l.default:r={d:"M 5 -5 15 5","stroke-width":a},o={type:"path",d:"M 12 -5 0 0 12 5 z"};break;case $l.conditional:r={d:"M 0 0 9 -5 18 0 9 5 Z","stroke-width":a,fill:s},o={type:"path",d:"M 12 -5 0 0 12 5 z"};break;case $l.message:l["stroke-dasharray"]="5,2",r={type:"circle",cx:5,r:5,"stroke-width":a,fill:s},o={type:"path",d:"M 12 -5 0 0 12 5 z","stroke-width":a,fill:s};break;default:o={type:"path",d:"M 12 -5 0 0 12 5 z"}}return r&&ct(l,$f.call(this,r,e,i,n)),o&&ct(l,Kf.call(this,o,e,i,n)),l}},markerFill:{}},FLOW_TYPES:$l}),Ji=Kt.define("bpmn2.Group",{size:{width:120,height:100},attrs:{root:{magnetSelector:"body",highlighterSelector:"body"},body:{refWidth:"100%",refHeight:"100%",fill:"transparent",rx:10,ry:10,stroke:"#333333",borderStyle:"dashed",strokeWidth:2,strokeLinecap:"square",pointerEvents:"none"},wrapper:{refX:5,refY:5,refWidth:-10,refHeight:-10,pointerEvents:"stroke",strokeWidth:10,stroke:"transparent",fill:"none"},label:{refY:6,refX:"50%",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold",textWrap:{width:-12,height:-12,ellipsis:!0}}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"wrapper"},{tagName:"text",selector:"label"}]},{attributes:{borderStyle:{set:function(t,e,i,n){return n=n.strokeWidth||n["stroke-width"]||1,{"stroke-dasharray":2*n+","+2*n+","+n/2}}}}}),Fo=Kt.define("bpmn2.Annotation",{size:{width:80,height:40},attrs:{root:{magnetSelector:"body",highlighterSelector:"body"},body:{refWidth:"100%",refHeight:"100%",fill:"transparent"},border:{annotationD:{size:10},fill:"none",stroke:"#333333",strokeWidth:2},label:{refY:6,refX:4,fontSize:12,fontFamily:"sans-serif",textWrap:{width:-12,height:-12,ellipsis:!0}}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"path",selector:"border"},{tagName:"text",selector:"label"}]},{attributes:{annotationD:{set:function(n,e){var i=n.size||0,n=n.side,r=e.topLeft(),o=e.bottomLeft(),s=e.topRight(),a=e.bottomRight();switch(n){case"top":var l=r.clone().offset(0,i),h=s.clone().offset(0,i);return{d:"M "+l.serialize()+" "+r.serialize()+" "+s.serialize()+" "+h.serialize()};case"right":return l=s.clone().offset(-i,0),h=a.clone().offset(-i,0),{d:"M "+l.serialize()+" "+s.serialize()+" "+a.serialize()+" "+h.serialize()};case"bottom":return l=o.clone().offset(0,-i),h=a.clone().offset(0,-i),{d:"M "+l.serialize()+" "+o.serialize()+" "+a.serialize()+" "+h.serialize()};default:return l=r.clone().offset(i,0),h=o.clone().offset(i,0),{d:"M "+l.serialize()+" "+r.serialize()+" "+o.serialize()+" "+h.serialize()}}}}}}),Bn=Ke.define("bpmn2.AnnotationLink",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",strokeDasharray:"2,5"},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{defaultLabel:_e,markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),fn=Kt.define("bpmn2.Pool",{size:{width:600,height:300},lanes:null,milestones:null,milestonesSize:20,padding:0,headerSize:20,attrs:{body:{refWidth:"100%",refHeight:"100%",fill:"transparent"},laneGroups:{laneContainerPosition:!0},laneHeaders:{fill:"#ffffff",stroke:"#333333",strokeWidth:2,headerSize:!0,shapeRendering:"optimizespeed"},laneLabels:{fontSize:14,fill:"#333333",transform:"rotate(-90)",textAnchor:"middle",textVerticalAnchor:"middle",labelAlignment:Ai.center,labelMargin:{vertical:1,horizontal:10},fontFamily:"sans-serif",labelPosition:!0,laneLabel:{textWrap:!0,ellipsis:!0}},lanes:{stroke:"#333333",strokeWidth:2,fill:"#ffffff",laneSize:!0,shapeRendering:"optimizespeed"},milestoneGroups:{milestoneContainerPosition:!0},milestoneHeaders:{fill:"#ffffff",stroke:"#333333",strokeWidth:2,milestoneHeaderSize:!0,shapeRendering:"optimizespeed"},milestoneLabels:{fontSize:14,fill:"#333333",textAnchor:"end",textVerticalAnchor:"middle",labelAlignment:Ai.rightMiddle,labelMargin:{vertical:1,horizontal:10},fontFamily:"sans-serif",milestoneLabelPosition:!0,milestoneLabel:{textWrap:!0,ellipsis:!0}},milestoneLines:{stroke:"#333333",strokeWidth:2,milestoneLinePosition:!0,shapeRendering:"optimizespeed"}}},{metrics:null,markup:[{tagName:"rect",selector:"body"}],markupAttributes:["lanes","padding","milestones","headerSize","milestonesSize"],initialize:function(){Kt.prototype.initialize.apply(this,arguments),this.on("change",this.onChange,this),this.buildMarkup()},anyHasChanged:function(t){return!!Array.isArray(t)&&t.some(function(e){return this.hasChanged(e)},this)},onChange:function(t,e){e.pool!==this.id&&this.hasChanged("markup")&&rn("Markup cannot be modified."),this.anyHasChanged(this.markupAttributes)&&this.buildMarkup(e)},buildMarkup:function(t){var e=dt(this.markup),i=(Array.isArray(e)||rn("Expects Prototype JSON Markup."),this.attributes.lanes||[{}]),n=(Array.isArray(i)||rn("Expects lanes to be an array."),this.attributes.milestones||[]),r=(Array.isArray(n)||rn("Expects milestones to be an array."),this.metrics={}),r=(r.lanes={},r.lanesNameCache={},r.milestonesNameCache={},r.milestones={},r.totalTakenHeightSpace=0,r.topLaneGroupsCount=i.length,r.padding=ti(this.attributes.padding),this.buildLanesMarkupRecursively(i,e,null,1,0),this.buildMilestones(n,e),ct({pool:this.id,dry:!0},t));this.set("markup",e,r),r.autoResize!==!1&&this.autoresize(r)},buildLanesMarkupRecursively:function(t,e,i,n,r){var o=this,s=(Array.isArray(t)||rn("Expects lanes to be an array."),0);return t.forEach(function(F,l){var h,u=0,d=F.id!==void 0&&F.id!==""?F.id:null,p=i!==null?i+"_"+l:""+l,m=o.getLaneGroupMarkup(p,d),v=(e.push(m),Number.isFinite(F.size)?Math.max(F.size,0):void 0),k=o.getLaneMarkup(p,d),k=(m.children.push(k),F.label),I=typeof F.label=="string",N=I?Number.isFinite(F.headerSize)?Math.max(F.headerSize,0):o.attributes.headerSize:0,G=(I&&(G=o.getHeaderMarkup(p,d),h=o.getLabelMarkup(p,d),m.children.push(G),m.children.push(h)),F.sublanes&&!Array.isArray(F.sublanes)&&rn("Expects sublanes to be an array."),F.sublanes||[]),F=(G.length&&(h=m.children,u=o.buildLanesMarkupRecursively(G,h,p,n+1,G.length)),s+=u=v&&u<v?v:u,{nestLevel:n,laneIndexWithinGroup:l,parentId:i?"lanes_"+i:null,parentSublanesCount:r,headerSize:N,label:k,hasLabel:I,size:v,takenUpSpaceByLaneAndSublanes:u,sublanesCount:G.length,customId:d});o.addLaneGroupMetrics(p,F)}),s},buildMilestones:function(t,e){var i=this,n=this.metrics,r=this.attributes,o=n.padding;n.milestonesCount=t.length,o.top+=t.length?r.milestonesSize:0,t.forEach(function(s,a){var l=s.id,h="milestone_"+a,d=n.milestonesNameCache[h]!==void 0,u=(l&&(u=l!==h&&n.milestones[l]!==void 0,n.milestonesNameCache[l]===void 0&&!u||rn("Duplicated milestone group id: "+l),n.milestonesNameCache[l]=h),d&&rn("Duplicated milestone group id: "+h),i.getMilestoneGroupMarkup(a,l)),d=(e.push(u),i.getMilestoneHeaderMarkup(a,l)),p=i.getMilestoneLabelMarkup(a,l),m=i.getMilestoneLineMarkup(a,l);n.milestones[h]={label:typeof s.label=="string"?s.label:"",indexWithin:a,size:Number.isFinite(s.size)?Math.max(s.size,0):void 0,customId:l},u.children.push(m),u.children.push(d),u.children.push(p)})},addLaneGroupMetrics:function(n,e){var i,n="lanes_"+n,r=e.laneSize,o=e.customId,s=this.metrics;s.lanesNameCache[n]!==void 0&&rn("Duplicated lane group id: "+n),o!==null&&(i=o!==n&&s.lanes[o]!==void 0,s.lanesNameCache[o]===void 0&&!i||rn("Duplicated lane group id: "+o),s.lanesNameCache[o]=n),s.lanes[n]=e,Number.isFinite(r)&&(s.totalTakenHeightSpace+=r)},autoresize:function(t){var e=this.getMinimalSize(),i=this.attributes.size;this.resize(Math.max(e.width,i.width),Math.max(e.height,i.height),t)},getMinimalSize:function(){var t,e=this.metrics,i=e.padding,n=0,r=0,o=0,s=this.attributes.milestonesSize,a=e.lanes,l=e.milestones;return Object.keys(a).forEach(function(h){for(var u=a[h],d=h,p=0;d;){var m=e.lanes[d];p+=m.headerSize||0,d=m.parentId}n=n<p?p:n,u.nestLevel===1&&(r+=u.takenUpSpaceByLaneAndSublanes||0)}),Object.keys(l).forEach(function(h){o+=l[h].size||0}),t=o<n?n:o,{height:(e.milestonesCount&&r<s?0:r)+i.top+i.bottom,width:t+i.left+i.right}},getLaneGroupMarkup:function(t,e){var i=["laneGroups"];return e&&i.push("lanes_"+e),{tagName:"g",selector:"lanes_"+t,groupSelector:i,attributes:{laneGroupId:"lanes_"+t},children:[]}},getMilestoneGroupMarkup:function(t,e){var i=["milestoneGroups"];return e&&i.push("milestone_"+e),{tagName:"g",selector:"milestone_"+t,groupSelector:i,attributes:{milestoneGroupId:"milestone_"+t},children:[]}},getLaneMarkup:function(t,e){var i=["lanes"];return e&&i.push("lane_"+e),{tagName:"rect",selector:"lane_"+t,groupSelector:i,children:[],attributes:{laneGroupId:"lanes_"+t}}},getHeaderMarkup:function(t,e){var i=["laneHeaders"];return e&&i.push("header_"+e),{tagName:"rect",selector:"header_"+t,groupSelector:i,attributes:{laneGroupId:"lanes_"+t}}},getLabelMarkup:function(t,e){var i=["laneLabels"];return e&&i.push("label_"+e),{tagName:"text",selector:"label_"+t,groupSelector:i,attributes:{laneGroupId:"lanes_"+t}}},getMilestoneHeaderMarkup:function(t,e){var i=["milestoneHeaders"];return e&&i.push("milestoneHeader_"+e),{tagName:"rect",selector:"milestoneHeader_"+t,groupSelector:i,attributes:{milestoneGroupId:"milestone_"+t}}},getMilestoneLabelMarkup:function(t,e){var i=["milestoneLabels"];return e&&i.push("milestoneLabel_"+e),{tagName:"text",selector:"milestoneLabel_"+t,groupSelector:i,attributes:{milestoneGroupId:"milestone_"+t}}},getMilestoneLineMarkup:function(t,e){var i=["milestoneLines"];return e&&i.push("milestoneLine_"+e),{tagName:"line",selector:"milestoneLine_"+t,groupSelector:i,attributes:{milestoneGroupId:"milestone_"+t}}},getParentIndexesArray:function(t){for(var e=[],i=t;i;)e.push(i),i=this.metrics.lanes[i].parentId;return e.reverse()},getFlexAndFixedLaneSizesWithinGroup:function(i){var e=this.metrics,i=e.lanes[i],n=i.parentId,r=0,o=0,s=i.parentSublanesCount-1;for(n||(n="lanes",s=e.topLaneGroupsCount-1);0<=s;){var a=e.lanes[n+"_"+s];Number.isFinite(a.size)?r+=Math.max(a.size,a.takenUpSpaceByLaneAndSublanes):o++,s--}return{totalFixedSize:r,flexLanesWithinGroupCount:o}},getLaneWidth:function(i){var e=this.metrics,n=e.padding,i=this.getParentIndexesArray(i),n=this.attributes.size.width-n.left-n.right,r=0;return i.forEach(function(o){o=e.lanes[o],r+=o.headerSize}),Math.max(n-r,0)},getLaneHeight:function(t){var e=this,i=this.metrics,n=i.lanes[t],r=i.padding,o=this.getParentIndexesArray(t),s=this.attributes.size.height-r.top-r.bottom,a=n.parentId,l=s;if(a){var h,s=i.lanes[a].sublanesCount;if(n.laneIndexWithinGroup===s-1)return s=this.getLaneContainerPosition(t).y,h=this.getLaneHeight(a),Math.max(h-s,0)}return Number.isFinite(n.size)?a||n.laneIndexWithinGroup!==i.topLaneGroupsCount-1?(h=n.takenUpSpaceByLaneAndSublanes,Math.max(h,n.size,0)):(s=this.getLaneContainerPosition(t).y,Math.max(this.attributes.size.height-s-r.bottom,0)):((a=o.map(function(u){return u}).reverse().find(function(u){return i.lanes[u].size}))&&(s=(h=o.map(function(u){return u})).indexOf(a),o=h.slice(s+1),l=i.lanes[a].size),o.forEach(function(u){for(var d=e.getFlexAndFixedLaneSizesWithinGroup(u),p=i.lanes[u].parentId,u=i.lanes[u].parentSublanesCount,m=i.topLaneGroupsCount,v=0,k=0,I=(l-d.totalFixedSize)/(d.flexLanesWithinGroupCount||1),N=p?u-1:m-1;0<=N;){var G,F=(p||"lanes")+"_"+N;F===t||(G=(F=i.lanes[F]).takenUpSpaceByLaneAndSublanes,!F.size&&I<G&&(v+=G,k++)),N--}l=(l-=d.totalFixedSize+v)/Math.max(d.flexLanesWithinGroupCount-k,1)}),r=n.takenUpSpaceByLaneAndSublanes,h=l<r?r:l,Math.max(h,0))},getMilestoneWidth:function(n){var e=this.metrics,i=e.padding,i=this.attributes.size.width-i.left-i.right,n=e.milestones[n],r=e.milestonesCount;if(Number.isFinite(n.size))return n.size;for(var o=r-1,s=0,a=0;0<=o;){var l=e.milestones["milestone_"+o];Number.isFinite(l.size)&&(s+=l.size,a++),o--}return Math.max((i-s)/(r-a||1),0)},getLaneContainerPosition:function(t){for(var o=this.metrics,e=o.padding,t=o.lanes[t],i=t.laneIndexWithinGroup,n=t.nestLevel,r=t.parentId,t=r?o.lanes[r].headerSize:0,o=0,s=(n===1&&(t+=e.left,o+=e.top),0),a=i-1;0<=a;)s+=this.getLaneHeight(r?r+"_"+a:"lanes_"+a),a--;return new Q(t,o+s)},getMilestoneContainerPosition:function(n){for(var o=this.metrics,n=o.milestones[n].indexWithin,o=o.padding,e=n-1,i=0;0<=e;)i+=this.getMilestoneWidth("milestone_"+e),e--;var n=this.attributes.milestonesSize,r=i+o.left,o=o.top-n;return new Q(r,o)},getLaneBBox:function(t){typeof t!="string"&&rn("Expects id to be a string");var e,i,n,r=this.metrics,o=this.position(),s=r.lanes[t];return s||(t=r.lanesNameCache[t],s=r.lanes[t]),s?(r=s.parentId,s=s.headerSize,e={x:0,y:0},r&&(r=this.getLaneBBox(r),e.x+=r.x-o.x,e.y+=r.y-o.y),i=(r=this.getLaneContainerPosition(t)).x,r=r.y,n=this.getLaneWidth(t),t=this.getLaneHeight(t),new nt({x:i+e.x+o.x,y:r+e.y+o.y,width:n+s,height:t})):null},getParentLaneId:function(n){var i=this.metrics,e=i.lanes,i=i.lanesNameCache,i=i.hasOwnProperty(n)?i[n]:n,n=(i in e||rn("Lane with ID "+n+" wasn't found"),e[i]);return n.parentId===null?null:(i=e[n.parentId]).customId!==null?i.customId:n.parentId},getLanesIds:function(){var t=this.metrics.lanes;return Object.keys(t).map(function(e){var i=t[e].customId;return i!==null?i:e})},getMilestoneBBox:function(t){typeof t!="string"&&rn("Expects id to be a string");var e,i=this.metrics,n=this.attributes,r=i.padding,o=i.milestones;return o[t]||o[t=i.milestonesNameCache[t]]?(o=this.position(),i=this.getMilestoneWidth(t),e=n.milestonesSize,n=n.size.height-r.bottom-r.top+e,e=(r=this.getMilestoneContainerPosition(t)).x,t=r.y,new nt(e+o.x,t+o.y,i,n)):null},getLanesFromPoint:function(t){var e,i,n,r,o=this,s=(t||rn("A point is required"),this.getBBox()),a=s.center(),l=this.angle(),h=new Q(t).rotate(a,l);return s.containsPoint(h)?(e=this.metrics,i=e.lanes,n=[],(r=function(u){for(var d=u?i[u].sublanesCount-1:e.topLaneGroupsCount-1;0<=d;){var p=u?u+"_"+d:"lanes_"+d;if(o.getLaneBBox(p).containsPoint(h)){var m=i[p].customId;n.push(m||p),r(p);break}d--}})(),n.reverse()):[]},getMilestoneFromPoint:function(t){t||rn("A point is required");var e=this.metrics,i=this.getBBox(),n=this.angle(),r=new Q(t).rotate(i.center(),n);if(i.containsPoint(r))for(var o=e.milestonesCount-1;0<=o;){var s,a="milestone_"+o;if(this.getMilestoneBBox(a).containsPoint(r))return(s=e.milestones[a].customId)===void 0?a:s;o--}return null},getLanePath:function(t){var e=this.metrics,i=e.lanes,n=i[t];if((n=n===void 0?i[e.lanesNameCache[t]]:n)===void 0)return[];for(var r=[n.laneIndexWithinGroup],o=n;o.parentId;){var s=i[o.parentId].laneIndexWithinGroup;r.unshift(s,"sublanes"),o=i[o.parentId]}return r.unshift("lanes"),r},toJSON:function(){var t=Kt.prototype.toJSON.apply(this,arguments);return delete t.markup,t}},{attributes:{laneContainerPosition:{position:function(t,e,i){return i=i.getAttribute("laneGroupId"),this.model.getLaneContainerPosition(i)}},laneSize:{set:function(t,e,r){var n=this.model,r=r.getAttribute("laneGroupId"),o=n.getLaneWidth(r),s=n.getLaneHeight(r);return{width:o+n.metrics.lanes[r].headerSize,height:s}}},headerSize:{set:function(t,e,i){return i=i.getAttribute("laneGroupId"),{width:this.model.metrics.lanes[i].headerSize,height:Math.max(this.model.getLaneHeight(i),0)}}},labelPosition:{position:function(t,e,r,n){var a=this.model,r=r.getAttribute("laneGroupId"),o=a.metrics.lanes[r].headerSize,s=a.getLaneHeight(r),a=ti(n.labelMargin),l=a.left,h=a.top,u=a.right,d=a.bottom,p=s/2,m=o/2;switch(n.labelAlignment){case Ai.topMiddle:return{x:h,y:p+l-u};case Ai.topLeft:return{x:h,y:s-u};case Ai.topRight:return{x:h,y:l};case Ai.leftMiddle:return{x:m+h-d,y:s-u};case Ai.rightMiddle:return{x:m+h-d,y:l};case Ai.bottomLeft:return{x:o-d,y:s-u};case Ai.bottomMiddle:return{x:o-d,y:p+l-u};case Ai.bottomRight:return{x:o-d,y:l};default:return Ai.center,{x:m+h-d,y:p+l-u}}}},laneLabel:{set:function(t,e,i,n){var r,o,s,a;return ve(t)?(r=this.model,o=i.getAttribute("laneGroupId"),a=(s=r.metrics.lanes[o]).headerSize,pg(this,t,i,n,r.getLaneHeight(o),a,s.label)):null}},milestoneContainerPosition:{position:function(t,e,i){return i=i.getAttribute("milestoneGroupId"),this.model.getMilestoneContainerPosition(i)}},milestoneHeaderSize:{set:function(t,e,r){var n=this.model,r=r.getAttribute("milestoneGroupId");return{width:n.getMilestoneWidth(r),height:n.attributes.milestonesSize}}},milestoneLabelPosition:{position:function(t,e,a,n){var r=this.model,a=a.getAttribute("milestoneGroupId"),o=r.getMilestoneWidth(a),s=r.attributes.milestonesSize,a=ti(n.labelMargin),l=a.left,h=a.top,u=a.right,d=a.bottom,p=s/2,m=o/2;switch(n.labelAlignment){case Ai.topMiddle:return{x:m+l-u,y:h};case Ai.topLeft:return{x:l,y:h};case Ai.topRight:return{x:o-u,y:h};case Ai.leftMiddle:return{x:l,y:p+h-d};case Ai.bottomLeft:return{x:l,y:s-d};case Ai.bottomMiddle:return{x:m+l-u,y:s-d};case Ai.bottomRight:return{x:o-u,y:s-d};case Ai.rightMiddle:return{x:o-u,y:p+h-d};default:return Ai.center,{x:m+l-u,y:p+h-d}}}},milestoneLabel:{set:function(t,e,i,n){var r,o,s;return ve(t)?(r=this.model,o=i.getAttribute("milestoneGroupId"),s=r.metrics.milestones[o],pg(this,t,i,n,r.getMilestoneWidth(o),r.attributes.milestonesSize,s.label)):null}},milestoneLinePosition:{set:function(t,e,a){var s=this.model,n=s.position(),r=s.metrics.padding,o=s.attributes.milestonesSize,a=a.getAttribute("milestoneGroupId"),s=s.getMilestoneBBox(a),a=s.x,l=s.width,h="block";return{x1:l,x2:l,y1:o,y2:s.height,display:h=e.width-r.right<=Math.ceil(a)-n.x+Math.ceil(l)?"none":h}}},textVertical:{set:function(){return{transform:"rotate(-90)"}}},textWrap:{set:function(t,e,i,n){var r;n.textVertical&&(r=e.width,e.width=e.height,e.height=r),Oo.textWrap.set.call(this,t,e,i,n)}},labelMargin:{},labelAlignment:{}}}),oo=fn.define("bpmn2.HeaderedPool",{padding:{top:0,left:30,right:0,bottom:0},attrs:{header:{width:30,refHeight:"100%",stroke:"#333333",strokeWidth:2,fill:"#ffffff",shapeRendering:"optimizespeed"},headerLabel:{textVertical:!0,textWrap:{width:-10,ellipsis:!0,maxLineCount:1},refX:15,refY:"50%",fontSize:20,fill:"#333333",fontFamily:"sans-serif",textAnchor:"middle",textVerticalAnchor:"middle"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerLabel"}]}),_e=fn.prototype.markupAttributes.reduce(function(t,e){return t[e]=["UPDATE","TOOLS"],t},{}),_e=ee.extend({presentationAttributes:ee.addPresentationAttributes(_e)});function rn(t){throw new Error("shapes.bpmn2.Pool: "+t)}var zi={__proto__:null,Event:zi,Gateway:ri,DataStore:fe,DataObject:ci,DataAssociation:Ri,Activity:Oi,Conversation:Xi,ConversationLink:Qt,Flow:Ni,Group:Ji,Annotation:Fo,AnnotationLink:Bn,Pool:fn,HeaderedPool:oo,PoolView:_e,HeaderedPoolView:_e},ka={exportElement:function(t){return t.size()},exportLink:function(t){var e=t.get("labelSize")||{};return{minLen:t.get("minLen")||1,weight:t.get("weight")||1,labelpos:t.get("labelPosition")||"c",labeloffset:t.get("labelOffset")||0,width:e.width||0,height:e.height||0}},importElement:function(t,e,r){var n=this.getCell(e),r=r.node(e);t.setPosition?t.setPosition(n,r):n.set("position",{x:r.x-r.width/2,y:r.y-r.height/2})},importLink:function(t,a,s){var n,r,o=this.getCell(a.name),s=s.edge(a),a=s.points||[],l=new ie(a);(t.setVertices||t.setLinkVertices)&&(Rt(t.setVertices)?t.setVertices(o,a):(l.simplify({threshold:.001}),r=(n=l.points.map(function(h){return h.toJSON()})).length,o.set("vertices",n.slice(1,r-1)))),t.setLabels&&"x"in s&&"y"in s&&(n={x:s.x,y:s.y},Rt(t.setLabels)?t.setLabels(o,n,a):(r=l.closestPointLength(n),s=l.pointAtLength(r),t=r/l.length(),a=new Q(n).difference(s).toJSON(),o.label(0,{position:{distance:t,offset:a}})))},layout:function(a,e){var i=a instanceof wi?a:new wi().resetCells(a,{dry:!0,sort:!1}),a=(e=Jt(e||{},{resizeClusters:!(a=null),clusterPadding:10,exportElement:this.exportElement,exportLink:this.exportLink})).dagre||(typeof dagre<"u"?dagre:void 0);if(a===void 0)throw new Error('The the "dagre" utility is a mandatory dependency.');var n=ka.toGraphLib(i,{graphlib:e.graphlib,directed:!0,multigraph:!0,compound:!0,setNodeLabel:e.exportElement,setEdgeLabel:e.exportLink,setEdgeName:function(l){return l.id}}),r={},o=e.marginX||0,s=e.marginY||0,a=(e.rankDir&&(r.rankdir=e.rankDir),e.align&&(r.align=e.align),e.nodeSep&&(r.nodesep=e.nodeSep),e.edgeSep&&(r.edgesep=e.edgeSep),e.rankSep&&(r.ranksep=e.rankSep),e.ranker&&(r.ranker=e.ranker),o&&(r.marginx=o),s&&(r.marginy=s),n.setGraph(r),a.layout(n,{debugTiming:!!e.debugTiming}),i.startBatch("layout"),ka.fromGraphLib(n,{importNode:this.importElement.bind(i,e),importEdge:this.importLink.bind(i,e)}),e.resizeClusters&&(r=n.nodes().filter(function(l){return 0<n.children(l).length}).map(i.getCell.bind(i)).sort(function(l,h){return h.getAncestors().length-l.getAncestors().length}),qe(r,"fitToChildren",{padding:e.clusterPadding})),i.stopBatch("layout"),n.graph());return new nt(o,s,Math.abs(a.width-2*o),Math.abs(a.height-2*s))},fromGraphLib:function(t,e){var i=(e=e||{}).importNode||zo,n=e.importEdge||zo,r=this instanceof wi?this:new wi;return t.nodes().forEach(function(o){i.call(r,o,t,r,e)}),t.edges().forEach(function(o){n.call(r,o,t,r,e)}),r},toGraphLib:function(t,e){var i=(e=e||{}).graphlib||(typeof graphlib<"u"?graphlib:void 0);if(i===void 0)throw new Error('The the "graphlib" utility is a mandatory dependency.');for(var n=wl(e,"directed","compound","multigraph"),r=new i.Graph(n),o=e.setNodeLabel||zo,s=e.setEdgeLabel||zo,a=e.setEdgeName||zo,l=t.get("cells"),h=0,u=l.length;h<u;h++){var d=l.at(h);if(d.isLink()){var p=d.get("source"),m=d.get("target");if(!p.id||!m.id)break;r.setEdge(p.id,m.id,s(d),a(d))}else r.setNode(d.id,o(d)),r.isCompound()&&d.has("parent")&&(p=d.get("parent"),l.has(p)&&r.setParent(d.id,p))}return r}},ri=(wi.prototype.toGraphLib=function(t){return ka.toGraphLib(this,t)},wi.prototype.fromGraphLib=function(t,e){return ka.fromGraphLib.call(this,t,e)},{__proto__:null,Port:ud,PortLabel:yd,DirectedGraph:ka}),fe=R.Model.extend({defaults:{linkDistance:10,linkStrength:1,charge:10,x:0,y:0},cacheAttribute:"_fcache",initialize:function(){var t=this.get("graph");if(Array.isArray(t))for(var e=t,i=[],n=[],r=0,o=e.length;r<o;r++){var s=e[r];(s.isLink()?i:n).push(s)}else n=t.getElements(),i=t.getLinks();this.links=i,this.elements=n,this.x=this.get("x"),this.y=this.get("y"),this.width=this.get("width"),this.height=this.get("height"),this.gravityCenter=this.get("gravityCenter"),this.t=1,this.energy=1/0,this.progress=0},start:function(){var t=this.width,e=this.height,i=this.x,n=this.y;this.elements.forEach(function(r){var o=bn(i,i+t),s=bn(n,n+e),a=(r.position(o,s,{forceDirected:!0}),r[this.cacheAttribute]={});a.charge=r.get("charge")||this.get("charge"),a.weight=r.get("weight")||1,a.x=a.px=o,a.y=a.py=s,a.fx=0,a.fy=0},this),this.links.forEach(function(r){var o=r[this.cacheAttribute]={};o.source=r.getSourceElement(),o.target=r.getTargetElement(),o.strength=r.get("strength")||this.get("linkStrength"),o.distance=r.get("distance")||this.get("linkDistance")},this)},step:function(){if(.99*this.t<.005)return this.notifyEnd();for(var t,e,i,n,r,o,s,a,l,h,u=this.cacheAttribute,d=this.width,p=this.height,m=this.x,v=this.y,k=this.gravityCenter,I=this.energy,N=this.energy=0,G=0,F=0,H=0,Y=this.elements.length,_=this.links.length,K=0;K<Y-1;K++)for(N+=(e=this.elements[K][u]).x,G+=e.y,t=K+1;t<Y;t++)o=(n=(i=this.elements[t][u]).x-e.x)*n+(r=i.y-e.y)*r,s=Math.sqrt(o),h=(a=this.t*e.charge/o)*r,e.fx-=l=a*n,e.fy-=h,i.fx+=l,i.fy+=h,this.energy+=l*l+h*h;var tt,b,vt,O,M,T=this.elements[Y-1][u];for(N+=T.x,G+=T.y,K=0;K<_;K++)e=(tt=this.links[K][u]).source[u],o=(n=(i=tt.target[u]).x-e.x)*n+(r=i.y-e.y)*r,s=Math.sqrt(o),h=(tt=this.t*tt.strength*(s-tt.distance)/s)*r,b=e.weight/(e.weight+i.weight),e.x+=(l=tt*n)*(1-b),e.y+=h*(1-b),i.x-=l*b,i.y-=h*b,this.energy+=l*l+h*h;for(K=0;K<Y;K++)M={x:(O=(vt=this.elements[K])[u]).x,y:O.y},k&&(M.x+=(k.x-M.x)*this.t*.1,M.y+=(k.y-M.y)*this.t*.1),M.x+=O.fx,M.y+=O.fy,M.x=Math.max(m,Math.min(m+d,M.x)),M.y=Math.max(v,Math.min(m+p,M.y)),M.x+=.9*(O.px-M.x),M.y+=.9*(O.py-M.y),O.px=M.x,O.py=M.y,O.fx=O.fy=0,O.x=M.x,O.y=M.y,F+=O.x,H+=O.y,this.notify(vt,K,M);this.t=this.cool(this.t,this.energy,I),T=N-F,I=G-H,Math.sqrt(T*T+I*I)<1&&this.notifyEnd()},cool:function(t,e,i){return e<i?(this.progress+=1,5<=this.progress?(this.progress=0,t/.99):t):(this.progress=0,.99*t)},notify:function(t,e,i){t.set("position",i,{forceDirected:!0})},notifyEnd:function(){this.trigger("end")}});function Qf(t,o,i){var n,r=o.size,o=o.position;r&&(n=r.width,r=r.height,t.resize(n,r,i)),o&&(n=o.x,r=o.y,t.position(n,r,i))}var xc={layout:function(O,e){var i=O instanceof wi?O:new wi().resetCells(O,{dry:!0,sort:!1}),n=(O=null,e=e||{},i.getElements()),r=e.columns||1,o=Math.ceil(n.length/r),s=e.dx||0,a=e.dy||0,O=e.centre===void 0||e.centre!==!1,l=O?"middle":e.verticalAlign,h=O?"middle":e.horizontalAlign,u=!!e.resizeToFit,O=e.marginX||0,d=e.marginY||0,p=e.columnGap||0,m=e.rowGap||0,v=e.setAttributes,k=(typeof v!="function"&&(v=Qf),[]),I=e.columnWidth;if(I==="compact")for(var N=0;N<r;N++){var G=this._elementsAtColumn(n,N,r);k.push(this._maxDim(G,"width")+s)}else{I&&!Ft(I)||(I=this._maxDim(n,"width")+s);for(var F=0;F<r;F++)k.push(I)}var H=this._accumulate(k,O).map(function(M,T){return M+(T-.5)*p}),Y=[],_=e.rowHeight;if(_==="compact")for(var K=0;K<o;K++){var tt=this._elementsAtRow(n,K,r);Y.push(this._maxDim(tt,"height")+a)}else{_&&!Ft(_)||(_=this._maxDim(n,"height")+a);for(var b=0;b<o;b++)Y.push(_)}var vt=this._accumulate(Y,d).map(function(M,T){return M+(T-.5)*m}),O=(i.startBatch("layout"),n.forEach(function(M,Z){var j,f,x,C,D=Z%r,Z=Math.floor(Z/r),it=k[D],st=Y[Z],lt=0,at=0,mt=M.get("size"),Mt={};switch(u&&(j=it-2*s,f=st-2*a,x=mt.height*(mt.width?j/mt.width:1),C=mt.width*(mt.height?f/mt.height:1),st<x?j=C:f=x,Mt.size=mt={width:j,height:f}),l){case"top":break;case"bottom":at=st-mt.height;break;case"middle":at=(st-mt.height)/2}switch(h){case"left":break;case"right":lt=it-mt.width;break;case"middle":lt=(it-mt.width)/2}Mt.position={x:H[D]+s+lt+p/2,y:vt[Z]+a+at+m/2},v.call(i,M,Mt,e)}),i.stopBatch("layout"),0<r&&(H[0]+=p/2,H[r]-=p/2),0<o?(vt[0]+=m/2,vt[o]-=m/2):vt.length===0&&(vt=[d,d]),new nt(O,d,H[r]-H[0],vt[o]-vt[0]));return{rowHeights:Y,columnWidths:k,gridY:vt,gridX:H,bbox:O}},_maxDim:function(t,e){return t.reduce(function(i,n){return Math.max(n.get("size")[e],i)},0)},_elementsAtRow:function(t,e,i){for(var n=[],r=i*e,o=Math.min(r+i,t.length);r<o;r++)n.push(t[r]);return n},_elementsAtColumn:function(t,e,i){for(var n=[],r=e,o=t.length;r<o;r+=i)n.push(t[r]);return n},_accumulate:function(t,e){return t.length===0?[]:t.reduce(function(i,n,r){return i.push(i[r]+n),i},[e||0])}};function Kl(t,e,i){i=Jt(i||{},{siblingGap:0}),this.width=0,this.height=0,this.layoutAreas=this.sortLayoutAreas(t),this.parentArea=e,this.siblingGap=i.siblingGap,this.exists()&&this.computeSize(i)}ct(Kl.prototype,{sortLayoutAreas:function(t){return t=vi(t,"siblingRank"),t.forEach(function(e,i){e.siblingRank=i}),t},move:function(t,e){for(var i=0,n=this.layoutAreas.length;i<n;i++)this.layoutAreas[i].dx+=t,this.layoutAreas[i].dy+=e},exists:function(){return 0<this.layoutAreas.length},sumGaps:function(t){return Math.max(this.layoutAreas.length-1,0)*t},getSiblingRankByPoint:function(t){return this.exists()?(t=this.findAreaByPoint(t))?t.siblingRank-1:this.layoutAreas.length-1:-1},getFirstChildConnectionPoints:function(){return[]},getConnectionPoints:function(t,e){var i;return this.exists()?(i={dx:t.x-this.parentArea.rootCX,dy:t.y-this.parentArea.rootCY},this.layoutAreas[0].getRootVertices(i,e)):this.getFirstChildConnectionPoints(t)},getParentConnectionPoint:function(){var t=this.parentArea,e=this.proxyLayoutArea("getConnectionPoint",t.rootSize);return se(t.rootCX,t.rootCY).offset(e.x,e.y)},getChildConnectionPoint:function(t,e){return e=this.proxyLayoutArea("getConnectionPoint",e),se(t).difference(e)},proxyLayoutArea:function(t){var e=Array.prototype.slice.call(arguments,1);return on.fromDirection(this.direction).prototype[t].apply(this.parentArea,e)}}),Kl.extend=R.Model.extend;var ci=Kl.extend({getTopDY:function(){return-this.height/2},findAreaByPoint:function(t){return this.layoutAreas.find(function(e){return e.rootCY>t.y})},computeSize:function(t){var e,i=this,n=(this.height=this.sumGaps(t.siblingGap),this.layoutAreas);t.symmetrical?(e=n.reduce(function(r,o){return Math.max(r,o.height+o.prevSiblingGap+o.nextSiblingGap)},0),this.height+=e*n.length,n.reduce(function(r,o){return i.width=Math.max(i.width,o.getExtendedWidth()),o.dy+=r+e/2,r+e+t.siblingGap},this.getTopDY())):(this.height+=n.reduce(function(r,o){return r+o.height+o.prevSiblingGap+o.nextSiblingGap},0),n.reduce(function(r,o){return i.width=Math.max(i.width,o.getExtendedWidth()),o.dy+=r+o.getCY(),r+o.prevSiblingGap+o.height+o.nextSiblingGap+t.siblingGap},this.getTopDY()))},getYTowardsParent:function(){return this.parentArea.rootCY},getXTowardsParent:function(){var t=this.parentArea;return t.rootCX+this.LRSign*(t.rootSize.width/2+t.gap)},getNeighborPointFromRank:function(t){var e,i=this.siblingGap;return e=this.exists()?(e=this.layoutAreas[t],t=this.layoutAreas[t+1],e?t?(e.y+e.height+t.y)/2:e.y+e.height+i/2:t.y-i/2):this.getYTowardsParent(),{x:this.getXTowardsParent(),y:e}}}),qf=ci.extend({direction:"L",LRSign:-1}),tm=ci.extend({direction:"R",LRSign:1}),Ri={getXTowardsParent:function(){var t=this.parentArea;return t.rootCX+this.LRSign*t.gap},getYTowardsParent:function(){var t=this.parentArea,e=t.getLRHeight(t.siblings)/2;return e+=Math.min(t.firstChildGap,this.siblingGap/2),t.rootCY+this.TBSign*e},getFirstChildConnectionPoints:function(t){return[se(this.parentArea.rootCX,t.y)]},getChildConnectionPoint:function(t,e){return se(t).offset(-this.LRSign*e.width/2,0)},getParentConnectionPoint:function(){var t=this.parentArea;return se(t.rootCX,t.rootCY).offset(0,this.TBSign*(t.rootSize.height-t.rootMargin)/2)}},Oi={getTopDY:function(){return 0}},Xi={getTopDY:function(){return-this.height}},fg=ci.extend({direction:"BR",LRSign:1,TBSign:1}),mg=(ct(fg.prototype,Ri,Oi),ci.extend({direction:"BL",LRSign:-1,TBSign:1})),vg=(ct(mg.prototype,Ri,Oi),ci.extend({direction:"TR",LRSign:1,TBSign:-1})),yg=(ct(vg.prototype,Ri,Xi),ci.extend({direction:"TL",LRSign:-1,TBSign:-1})),Qt=(ct(yg.prototype,Ri,Xi),Kl.extend({getLeftDX:function(){return-this.width/2},findAreaByPoint:function(t){return this.layoutAreas.find(function(e){return e.rootCX>t.x})},computeSize:function(t){var e,i=this,n=(this.width=this.sumGaps(t.siblingGap),this.layoutAreas);t.symmetrical?(e=n.reduce(function(r,o){return Math.max(r,o.width+o.prevSiblingGap+o.nextSiblingGap)},0),this.width+=e*n.length,n.reduce(function(r,o){return i.height=Math.max(i.height,o.getExtendedHeight()),o.dx+=r+e/2,r+e+t.siblingGap},this.getLeftDX())):(this.width+=n.reduce(function(r,o){return r+o.width+o.prevSiblingGap+o.nextSiblingGap},0),n.reduce(function(r,o){return i.height=Math.max(i.height,o.getExtendedHeight()),o.dx+=r+o.getCX(),r+o.prevSiblingGap+o.width+o.nextSiblingGap+t.siblingGap},this.getLeftDX()))},getNeighborPointFromRank:function(t){var e;return{x:this.exists()?(e=this.layoutAreas[t],t=this.layoutAreas[t+1],e?t?(e.x+e.width+t.x)/2:e.x+e.width+this.siblingGap/2:t.x-this.siblingGap/2):this.parentArea.rootCX,y:this.getYTowardsParent()}}})),em=Qt.extend({direction:"T",getYTowardsParent:function(){var t=this.parentArea;return t.rootCY-t.getLRHeight()/2-t.gap}}),im=Qt.extend({direction:"B",getYTowardsParent:function(){var t=this.parentArea;return t.rootCY+t.getLRHeight()/2+t.gap}});function on(t,e){this.root=t,t=ct({},e,this.getRootAttributes(t,e.attributeNames)),e=e.gap||0,Jt(t,{parentGap:e,siblingGap:e,firstChildGap:e}),this.siblingRank=t.siblingRank,this.rootOffset=t.rootOffset,this.rootMargin=t.rootMargin,this.siblingGap=t.siblingGap,this.gap=this.parentGap=t.parentGap,this.nextSiblingGap=t.nextSiblingGap,this.prevSiblingGap=t.prevSiblingGap,this.firstChildGap=t.firstChildGap,this.dx=0,this.dy=0,this.width=0,this.height=0,this.symmetrical=t.symmetrical}ct(on,{create:function(t,e,i){return new(on.fromDirection(t,i))(e,i)},fromDirection:function(t,e){var i;switch(t){case"L":i=om;break;case"T":i=sm;break;case"R":i=rm;break;case"B":i=am;break;case"BR":i=lm;break;case"BL":i=hm;break;case"TR":i=cm;break;case"TL":i=um;break;default:i=on}return i}}),ct(on.prototype,{direction:null,compute:function(t){this.childAreas=t,this.computeRelativePosition(this.root,t)},getHeight:function(t,e){return this.getTHeight(t)+this.getBHeight(t)+this.getLRHeight()},getWidth:function(t,e){var i=Math.max(t.T.width,t.B.width)/2;return Math.max(this.getLWidth(t,e)+e.width/2,i)+Math.max(this.getRWidth(t,e)+e.width/2,i)},getLRHeight:function(){return Math.max(this.rootSize.height,this.siblings.L.height,this.siblings.R.height)},getTHeight:function(t){return t.T.height+this.getTXHeight(t)},getBHeight:function(t){return t.B.height+this.getBXHeight(t)},getXLRWidth:function(t,e){return this.getLWidth(t,e)+e.width+this.getRWidth(t,e)},getXRWidth:function(t,e){return t=Math.max(t.BR.width,t.TR.width),0<t&&(t-=e.width/2),t},getTXHeight:function(t){return t=Math.max(t.TR.height,t.TL.height),0<t&&(t+=this.firstChildGap),t},getBXHeight:function(t){return t=Math.max(t.BR.height,t.BL.height),0<t&&(t+=this.firstChildGap),t},getXLWidth:function(t,e){return t=Math.max(t.BL.width,t.TL.width),0<t&&(t-=e.width/2),t},getRWidth:function(t,e){return Math.max(t.R.width,this.getXRWidth(t,e))},getLWidth:function(t,e){return Math.max(t.L.width,this.getXLWidth(t,e))},getTBOverlap:function(t,e){return t=Math.max(t.T.width,t.B.width),t=0<t?(t-e.width)/2:t},getRootDX:function(t,e){var i=this.getTBOverlap(t,e),n=Math.max(this.getLWidth(t,e),i);return(n-=Math.max(this.getRWidth(t,e),i))/2},getMinimalGap:function(t){return Math.min(t.siblingGap,this.firstChildGap,this.parentGap)},getBBox:function(i){var e=It(this),i=i&&i.expandBy;return i&&e.moveAndExpand({x:-i,y:-i,width:2*i,height:2*i}),e},containsPoint:function(t,e){return this.getBBox(e).containsPoint(t)},getLayoutSiblings:function(t){return this.siblings[t]},getExtendedWidth:function(){return this.width+this.gap+this.rootOffset},getExtendedHeight:function(){return this.height+this.gap+this.rootOffset},findMinimalAreaByPoint:function(t,e){var i;return this.containsPoint(t,e)?(this.childAreas.some(function(n){return!!(i=n.findMinimalAreaByPoint(t,e))}),i||this):null},getType:function(){var t=this;return Object.keys(this.siblings).reduce(function(e,i){return t.siblings[i].exists()?e.concat(i):e},[]).sort().join("-")},getRootAttributes:function(t,e){var i={rootOffset:t.get(e.offset||"offset")||0,rootMargin:t.get(e.margin||"margin")||0,prevSiblingGap:t.get(e.prevSiblingGap||"prevSiblingGap")||0,nextSiblingGap:t.get(e.nextSiblingGap||"nextSiblingGap")||0},n=t.get(e.siblingRank||"siblingRank"),n=(Nt(n)&&(i.siblingRank=n),t.get(e.firstChildGap||"firstChildGap"));return Nt(n)&&(i.firstChildGap=n),i},getRootSize:function(t,e){return t=t.size(),t[this.marginDimension]+=e,t},createSiblings:function(t,e){return t=Si(t,"direction"),{L:new qf(t.L,this,e),T:new em(t.T,this,e),R:new tm(t.R,this,e),B:new im(t.B,this,e),BR:new fg(t.BR,this,e),BL:new mg(t.BL,this,e),TR:new vg(t.TR,this,e),TL:new yg(t.TL,this,e)}},computeSize:function(t,e){return{width:this.getWidth(t,e),height:this.getHeight(t,e)}},computeOrigin:function(){var t=this.siblings,e=this.rootSize,e=Math.max(this.getLWidth(t,e)+e.width/2,this.getXLWidth(t,e)+e.width/2,t.T.width/2,t.B.width/2);return{x:this.rootCX-e,y:this.rootCY-this.getTHeight(t)-this.getLRHeight()/2}},moveSiblings:function(t,e){this.hasHorizontalSiblings(t)&&(e=e.width/2,t.L.move(-e,0),t.R.move(e,0)),this.hasVerticalSiblings(t)&&(e=this.getLRHeight()/2,t.T.move(0,-e),t.B.move(0,e),t.BR.move(0,e),t.BL.move(0,e),t.B.move(0,this.getBXHeight(t)),t.TR.move(0,-e),t.TL.move(0,-e),t.T.move(0,-this.getTXHeight(t)))},moveRootToConnectionPoint:function(t){t=this.getConnectionPoint(t),this.dx+=t.x,this.dy+=t.y},computeRelativePosition:function(t,e){e=this.siblings=this.createSiblings(e,{siblingGap:this.siblingGap,symmetrical:this.symmetrical}),t=this.rootSize=this.getRootSize(t,this.rootMargin),ct(this,this.computeSize(e,t)),this.moveSiblings(e,t),this.moveRootToConnectionPoint(t),this.moveRootBehindSiblings(e,t),this.moveRootFromParent()},computeAbsolutePosition:function(){var t;this.parentArea?(this.rootCX=this.parentArea.rootCX+this.dx,this.rootCY=this.parentArea.rootCY+this.dy,this.level=this.parentArea.level+1):(t=this.root.getBBox().center(),this.rootCX=t.x,this.rootCY=t.y,this.level=0),ct(this,this.computeOrigin())},hasVerticalSiblings:function(t){return t.T.exists()||t.B.exists()||t.BR.exists()||t.BL.exists()||t.TR.exists()||t.TL.exists()},hasHorizontalSiblings:function(t){return t.L.exists()||t.R.exists()},isSourceArea:function(){return!this.parentArea},isSinkArea:function(){return this.childAreas.length===0},getRootPosition:function(){var t=this.root.get("size");return{x:this.rootCX-t.width/2,y:this.rootCY-t.height/2}},getRootVertices:function(t,e){var i;return e=e||{},(t=t||this)[this.deltaCoordinate]!==0&&this.parentArea?(i=this.parentArea.getInnerSize(),e=!e.ignoreSiblings&&this.hasSiblingsBetweenParent()?(e=this.siblings[this.oppositeDirection],this.getRelativeVerticesAvoidingSiblings(i,t,e)):this.getRelativeVertices(i,t),qe(e,"offset",this.parentArea.rootCX,this.parentArea.rootCY)):[]},getInnerSize:function(){return{width:this.rootSize.width,height:this.getLRHeight()}},getConnectionPoint:function(){return null},getRelativeVertices:function(){return null},moveRootFromParent:function(){},moveRootBehindSiblings:function(){},hasSiblingsBetweenParent:function(){return!this.isSourceArea()&&this.siblings[this.oppositeDirection].exists()},getCY:function(){return this.height/2+this.prevSiblingGap},getCX:function(){return this.width/2+this.prevSiblingGap}}),on.extend=R.Model.extend;function nm(t,o,i){var n,r=o.size,o=o.position;r&&(n=r.width,r=r.height,t.resize(n,r,i)),o&&(n=o.x,r=o.y,t.position(n,r,i))}function Lr(t,e,i){this.top=t.topLine().rotate(e,-i),this.left=t.leftLine().rotate(e,-i),this.right=t.rightLine().rotate(e,-i),this.bottom=t.bottomLine().rotate(e,-i)}function bg(){this.options={handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElement"},icon:null},{name:"direction",position:"se",events:{pointerdown:"directionSwap"},icon:null}],bbox:function(t){return t.paper.localToPaperPoint(t.getPointAtRatio(.5))},typeCssName:"type-link",tinyThreshold:-1,smallThreshold:-1,boxContent:!1}}function Ci(){this.options={handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElement"},icon:null},{name:"resize",position:"se",events:{pointerdown:"startResizing",pointermove:"doResize",pointerup:"stopBatch"},icon:null},{name:"clone",position:"n",events:{pointerdown:"startCloning",pointermove:"doClone",pointerup:"stopCloning"},icon:null},{name:"link",position:"e",events:{pointerdown:"startLinking",pointermove:"doLink",pointerup:"stopLinking"},icon:null},{name:"fork",position:"ne",events:{pointerdown:"startForking",pointermove:"doFork",pointerup:"stopForking"},icon:null},{name:"unlink",position:"w",events:{pointerdown:"unlinkElement"},icon:null},{name:"rotate",position:"sw",events:{pointerdown:"startRotating",pointermove:"doRotate",pointerup:"stopBatch"},icon:null}],bbox:function(t,e){return t.getBBox({useModelGeometry:e.options.useModelGeometry})},typeCssName:"type-element",tinyThreshold:40,smallThreshold:80,boxContent:function(n,e){var i=Li("x: <%= x %>, y: <%= y %>, width: <%= width %>, height: <%= height %>, angle: <%= angle %>"),n=n.model,r=n.getBBox();return i({x:Math.floor(r.x),y:Math.floor(r.y),width:Math.floor(r.width),height:Math.floor(r.height),angle:Math.floor(n.get("angle")||0)})},magnet:function(t){return t.el},loopLinkPreferredSide:"top",loopLinkWidth:40,rotateAngleGrid:15,rotateEmbeds:!1,linkAttributes:{},smoothLinks:void 0}}function Ta(){this.dependencies={}}function Vo(t,e,i){this.inspector=t,this.dependencyService=e,this.sources={},this.options=i||{}}function sn(t){t===void 0&&(t={}),yi(this,"handleKey"),this.options=ct({},t),this.parser=new Ps,this.enable()}function Zo(t,e){this.options=ct({friction:.92},e),this.onInertiaMove=t,this._isDragging=!1,this.initialize()}var rm=on.extend({direction:"R",oppositeDirection:"L",deltaCoordinate:"dx",marginDimension:"height",getConnectionPoint:function(t){return se(t.width/2,0)},moveRootBehindSiblings:function(t,e){this.dx+=Math.max(this.getLWidth(t,e),this.getTBOverlap(t,e)),this.dy+=(this.getTHeight(t)-this.getBHeight(t))/2},moveRootFromParent:function(){this.dx+=this.parentGap+this.rootOffset},getRelativeVertices:function(i,e){var i=this.getConnectionPoint(i),n=this.parentGap/2;return[i.clone().offset(n,0),i.clone().offset(n,e.dy)]},getRelativeVerticesAvoidingSiblings:function(n,s,r){var n=this.getConnectionPoint(n),o=r.siblingGap/2,a=0<this.dx?-1:1,r=s.dy+a*(r.height+o)/2,o=s.dy+a*this.rootSize.height/4,s=this.gap/2,a=1.5*s+Math.max(this.getLWidth(this.siblings,this.rootSize),this.getTBOverlap(this.siblings,this.rootSize));return[n.clone().offset(s,0),n.clone().offset(s,r),n.clone().offset(a,r),n.clone().offset(a,o)]}}),om=on.extend({direction:"L",oppositeDirection:"R",deltaCoordinate:"dx",marginDimension:"height",getConnectionPoint:function(t){return se(-t.width/2,0)},moveRootBehindSiblings:function(t,e){this.dx-=Math.max(this.getRWidth(t,e),this.getTBOverlap(t,e)),this.dy+=(this.getTHeight(t)-this.getBHeight(t))/2},moveRootFromParent:function(){this.dx-=this.parentGap+this.rootOffset},getRelativeVertices:function(i,e){var i=this.getConnectionPoint(i),n=-this.parentGap/2;return[i.clone().offset(n,0),i.clone().offset(n,e.dy)]},getRelativeVerticesAvoidingSiblings:function(n,o,r){var n=this.getConnectionPoint(n),s=0<this.dx?-1:1,r=o.dy+s*(r.height+r.siblingGap/2)/2,o=o.dy+s*this.rootSize.height/4,s=this.gap/2,a=1.5*s+Math.max(this.getRWidth(this.siblings,this.rootSize),this.getTBOverlap(this.siblings,this.rootSize));return[n.clone().offset(-s,0),n.clone().offset(-s,r),n.clone().offset(-a,r),n.clone().offset(-a,o)]}}),sm=on.extend({direction:"T",oppositeDirection:"B",deltaCoordinate:"dy",marginDimension:"width",getConnectionPoint:function(t){return se(0,-t.height/2)},moveRootBehindSiblings:function(t,e){this.dx+=this.getRootDX(t,e),this.hasHorizontalSiblings(t)&&(this.dy-=(this.getLRHeight()-e.height)/2),this.dy-=this.getBHeight(t)},moveRootFromParent:function(){this.dy-=this.parentGap+this.rootOffset},getRelativeVertices:function(i,e){var i=this.getConnectionPoint(i),n=-this.getTXHeight(this.parentArea.siblings)-this.parentGap/2;return[i.clone().offset(0,n),i.clone().offset(e.dx,n)]},getRelativeVerticesAvoidingSiblings:function(i,e){var i=this.getConnectionPoint(i),l=this.siblings,n=l.B,r=this.getTXHeight(this.parentArea.siblings)+this.parentGap/2,o=r+n.height,s=(o+=this.getBXHeight(this.siblings)+this.parentGap/4,this.dy<0?-1:1),l=l[0<s?"BR":"BL"].width,a=e.dx,l=(a+=s*(Math.max(l,n.width/2)+n.siblingGap/4),e.dx+s*this.rootSize.width/4);return[i.clone().offset(0,-r),i.clone().offset(a,-r),i.clone().offset(a,-o),i.clone().offset(l,-o)]}}),am=on.extend({direction:"B",oppositeDirection:"T",deltaCoordinate:"dy",marginDimension:"width",getConnectionPoint:function(t){return se(0,t.height/2)},moveRootBehindSiblings:function(t,e){this.dx+=this.getRootDX(t,e),this.dy+=this.getTHeight(t),this.hasHorizontalSiblings(t)&&(this.dy+=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){this.dy+=this.parentGap+this.rootOffset},getRelativeVertices:function(i,e){var i=this.getConnectionPoint(i),n=this.getBXHeight(this.parentArea.siblings)+this.parentGap/2;return[i.clone().offset(0,n),i.clone().offset(e.dx,n)]},getRelativeVerticesAvoidingSiblings:function(i,e){var i=this.getConnectionPoint(i),l=this.siblings,n=l.T,r=this.getBXHeight(this.parentArea.siblings)+this.parentGap/2,o=r+n.height,s=(o+=this.getTXHeight(l)+this.parentGap/4,this.dy<0?-1:1),l=l[0<s?"TR":"TL"].width,a=e.dx,l=(a+=s*(Math.max(l,n.width/2)+n.siblingGap/4),e.dx+s*this.rootSize.width/4);return[i.clone().offset(0,r),i.clone().offset(a,r),i.clone().offset(a,o),i.clone().offset(l,o)]}}),lm=on.extend({direction:"BR",oppositeDirection:"L",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return se(0,t.height/2)},getCY:function(){return this.prevSiblingGap},moveRootBehindSiblings:function(t,e){var i=Math.max(t.T.width,t.B.width);this.dx+=Math.max(this.getLWidth(t,e),(i-e.width)/2),this.dy+=this.getTHeight(t),this.hasHorizontalSiblings(t)&&(this.dy+=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy+=t.firstChildGap),this.dx+=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(o,r){var i=this.getConnectionPoint(o),n=r.dx,r=r.dy,s=o.width,o=o.height,s=r-o/2<0?(s/2+(n-this.rootSize.width/2))/2:0;return[i.clone().offset(s,r-o/2)]},getRelativeVerticesAvoidingSiblings:function(t,r,i){var n=r.dx-this.rootSize.width/4,r=r.dy,r=(r+=Math.max(i.height,this.rootSize.height)/2)+this.getMinimalGap(i)/2;return[se(0,r),se(n,r)]}}),hm=on.extend({direction:"BL",oppositeDirection:"R",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return se(0,t.height/2)},getCY:function(){return this.prevSiblingGap},moveRootBehindSiblings:function(t,e){var i=Math.max(t.T.width,t.B.width);this.dx-=Math.max(this.getRWidth(t,e),(i-e.width)/2),this.dy+=this.getTHeight(t),this.hasHorizontalSiblings(t)&&(this.dy+=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy+=t.firstChildGap),this.dx-=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(o,r){var i=this.getConnectionPoint(o),n=r.dx,r=r.dy,s=o.width,o=o.height,s=r-o/2<0?(-s/2+(n+this.rootSize.width/2))/2:0;return[i.clone().offset(s,r-o/2)]},getRelativeVerticesAvoidingSiblings:function(t,r,i){var n=r.dx+this.rootSize.width/4,r=r.dy,r=(r+=Math.max(i.height,this.rootSize.height)/2)+this.getMinimalGap(i)/2;return[se(0,r),se(n,r)]}}),cm=on.extend({direction:"TR",oppositeDirection:"L",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return se(0,t.height/2)},getCY:function(){return this.height-this.rootSize.height+this.prevSiblingGap},moveRootBehindSiblings:function(t,e){this.dx+=Math.max(this.getLWidth(t,e),this.getTBOverlap(t,e)),this.dy-=this.getBHeight(t),this.hasHorizontalSiblings(t)&&(this.dy-=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy-=t.firstChildGap),this.dx+=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(o,r){var i=this.getConnectionPoint(o),n=r.dx,r=r.dy,s=o.width,o=o.height,s=0<r+o/2?(s/2+(n-this.rootSize.width/2))/2:0;return[i.clone().offset(s,r-o/2)]},getRelativeVerticesAvoidingSiblings:function(t,r,i){var n=r.dx-this.rootSize.width/4,r=r.dy,r=(r-=Math.max(i.height,this.rootSize.height)/2)-this.getMinimalGap(i)/2;return[se(0,r),se(n,r)]}}),um=on.extend({direction:"TL",oppositeDirection:"R",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return se(0,t.height/2)},getCY:function(){return this.height-this.rootSize.height+this.prevSiblingGap},moveRootBehindSiblings:function(t,e){this.dx-=Math.max(this.getRWidth(t,e),this.getTBOverlap(t,e)),this.dy-=this.getBHeight(t),this.hasHorizontalSiblings(t)&&(this.dy-=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy-=t.firstChildGap),this.dx-=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(o,r){var i=this.getConnectionPoint(o),n=r.dx,r=r.dy,s=o.width,o=o.height,s=0<r+o/2?(-s/2+(n+this.rootSize.width/2))/2:0;return[i.clone().offset(s,r-o/2)]},getRelativeVerticesAvoidingSiblings:function(t,r,i){var n=r.dx+this.rootSize.width/4,r=r.dy,r=(r-=Math.max(i.height,this.rootSize.height)/2)-this.getMinimalGap(i)/2;return[se(0,r),se(n,r)]}}),Ni={rotate:function(t){var e="LRBT",i=e.indexOf(t[0])-e.indexOf(t[1]);return function(n){var r=e.indexOf(n);return 0<=r?e[(4+r-i)%4]:n}},flip:function(t){var e=t[0],i=t[1];return function(n){return n===e?i:n===i?e:n}},straighten:function(t){return function(){return t[1]}}},Ji=R.Model.extend({defaults:{graph:void 0,gap:20,parentGap:20,siblingGap:20,firstChildGap:20,direction:"R",directionRule:Ni.straighten,updatePosition:function(t,e,i){t.set("position",e,i)},updateVertices:function(t,e,i){t.set("vertices",e,i)},updateAttributes:null,filter:null,attributeNames:{}},initialize:function(){this._cacheOptions(this.attributes),this.layoutAreas={}},layout:function(t){this.layoutAreas={};for(var e=this.getGraphSources(t),i=0,n=e.length;i<n;i++)this.layoutTree(e[i],t);return this.trigger("layout:done",t),this},layoutTree:function(t,e){return(e=e||{}).treeLayout=!0,t=this._computeLayoutAreas(t,null,e),this._computeAbsolutePositions(t),this._updateCells(t,e),this},getLayoutBBox:function(){return this.getRootLayoutAreas().reduce(function(t,e){return e=e.getBBox(),t?t.union(e):e},null)},getLayoutArea:function(t){return this.layoutAreas[t.id||t]||null},getRootLayoutAreas:function(){return this.getGraphSources().map(this.getLayoutArea,this)},getGraphSources:function(t){var e=this.graph.getSources();return e=this.filter&&0<e.length&&this.filter(e,null,t)||e},getMinimalRootAreaByPoint:function(t){var e=this.getRootLayoutAreas().filter(function(i){return i.containsPoint(t)});return pt(e)?null:e.reduce(function(i,n){return n.width*n.height<i.min&&(i.min=n.width*n.height,i.item=n),i},{min:1/0,item:void 0}).item},_computeLayoutAreas:function(t,e,i){for(var n=e?e.direction:this.get("direction"),n=t.get(this.getAttributeName("direction"))||n,r=on.create(n,t,this.attributes),o=(r.parentArea=e,r.link=this.graph.getConnectedLinks(t,{inbound:!0})[0],this._getChildren(t,i)),s=(this.layoutAreas[t.id]=r,[]),a=0,l=o.length;a<l;a++)s.push(this._computeLayoutAreas(o[a],r,i));return r.compute(s),r},_cacheOptions:function(t){["updateAttributes","updateVertices","updatePosition","filter"].forEach(function(e){this[e]=Rt(t[e])?t[e]:null},this),this.graph=t.graph},_getChildren:function(t,e){var i;return this.layoutAreas[t.id]?[]:(i=this.graph.getNeighbors(t,{outbound:!0}),this.filter&&0<i.length&&this.filter(i,t,e)||i)},_computeAbsolutePositions:function(t){t.computeAbsolutePosition(t);for(var e=0,i=t.childAreas.length;e<i;e++)this._computeAbsolutePositions(t.childAreas[e])},_updateCells:function(t,e){var i=t.root,n=t.link||null;n&&(this.updatePosition&&this.updatePosition(i,t.getRootPosition(),e),this.updateVertices&&this.updateVertices(n,t.getRootVertices(),e)),this.changeSiblingRank(i,t.siblingRank,e),this.updateAttributes&&this.updateAttributes(t,i,n,e);for(var r=0,o=t.childAreas.length;r<o;r++)this._updateCells(t.childAreas[r],e)},updateDirections:function(t,e,i){var n=this,r=(i=i||{},this.getAttributeName("direction")),o=this.get("directionRule")(e);this.graph.search(t,function(s,a){a!==0&&(a=o(s.get(r)),n.changeDirection(s,a,i))},{outbound:!0})},reconnectElement:function(t,e,i){i=i||{};var n=this.getLayoutArea(t),r=n.link;return!!r&&(r.set("source",{id:e.id||e},i),r=n.direction,e=i.direction||r,n=i.siblingRank||void 0,this.changeSiblingRank(t,n,i),this.changeDirection(t,e,i),r!==e&&this.updateDirections(t,[r,i.direction],i),!0)},changeSiblingRank:function(t,e,i){t.set(this.getAttributeName("siblingRank"),e,i)},changeDirection:function(t,e,i){t.set(this.getAttributeName("direction"),e,i)},getAttributeName:function(t){return this.get("attributeNames")[t]||t},getAttribute:function(t,e){return t.get(this.getAttributeName(e))},prepare:function(){return this},removeElement:function(t,e){e===void 0&&(e={});var i,n,r=this.graph.getNeighbors(t,{inbound:!0})[0];r&&(i=t.get("siblingRank"),(n=this.graph.getConnectedLinks(t,{outbound:!0})).forEach(function(s){s.source(r);var s=s.getTargetCell(),a=Ge.linear([0,n.length],[0,1],s.get("siblingRank"));s.set("siblingRank",i+a,e)})),t.remove(e),e.layout!==!1&&this.layout(e)}},{directionRules:Ni}),gn={TopBottom:"TB",BottomTop:"BT",LeftRight:"LR",RightLeft:"RL"},Ql={Start:"start",Middle:"middle",End:"end"},Ti={Directions:gn,Alignments:Ql,layout:function(t,e){for(var i,n,r,o,s,a=(e=e===void 0?{}:e).direction,l=(a===void 0&&(a=gn.TopBottom),e.topLeft),h=e.bottomLeft,u=e.topRight,d=e.bottomRight,p=e.stackGap,m=(p===void 0&&(p=10),e.stackElementGap),v=(m===void 0&&(m=10),e.stackSize),Y=(v===void 0&&(v=100),e.stackCount),k=e.setAttributes,I=(k===void 0&&(k=nm),e.alignment),N=(I===void 0&&(I=Ql.Middle),e.stackIndexAttributeName),G=(N===void 0&&(N="stackIndex"),e.stackElementIndexAttributeName),F=(G===void 0&&(G="stackElementIndex"),t instanceof wi?(n=t.getElements(),r=t):(n=t)[0]&&(r=n[0].graph),i=Y?Array(Y).fill(null).map(function(){return Array()}):[],n.forEach(function(T){var j=T.get(N)||0;i[j]||(i[j]=[]),i[j].push(T)}),a===gn.TopBottom||a===gn.BottomTop),H=a===gn.LeftRight||a===gn.RightLeft,t=i.length,Y=(F&&(o=i.reduce(function(T,j){return Math.max(T,j.reduce(function(f,x){return f+x.size().height},0)+(j.length-1)*m)},0),s=t*v+(t-1)*p),H&&(s=i.reduce(function(T,j){return Math.max(T,j.reduce(function(f,x){return f+x.size().width},0)+(j.length-1)*m)},0),o=t*v+(t-1)*p),l?new nt(l.x,l.y,s,o):u?new nt(u.x-s,u.y,s,o):h?new nt(h.x,h.y-o,s,o):d?new nt(d.x-s,d.y-o,s,o):new nt(0,0,s,o)),_=Y.topLeft(),K=[],tt=0;tt<i.length;tt++)i[tt]=vi(i[tt],function(T){return T.get(G)||0}),F&&(K.push({bbox:new nt(_.x,_.y,v,o),elements:i[tt],index:tt}),_.x+=v+p),H&&(K.push({bbox:new nt(_.x,_.y,s,v),elements:i[tt],index:tt}),_.y+=v+p);r&&r.startBatch("layout");for(var b=0;b<K.length;b++){var vt,O=K[b];O.elements.length&&(vt=O.bbox.topLeft(),a===gn.BottomTop&&(vt.y+=O.bbox.height),a===gn.RightLeft&&(vt.x+=O.bbox.width),O.elements.forEach(function(M){var T=M.size(),j=(a===gn.BottomTop&&(vt.y-=T.height),a===gn.RightLeft&&(vt.x-=T.width),vt.toJSON());switch(I){case Ql.Middle:F?j.x+=(v-T.width)/2:j.y+=(v-T.height)/2;break;case Ql.End:F?j.x+=v-T.width:j.y+=v-T.height}k(M,{position:j},e),a===gn.BottomTop&&(vt.y-=m),a===gn.TopBottom&&(vt.y+=T.height+m),a===gn.RightLeft&&(vt.x-=m),a===gn.LeftRight&&(vt.x+=T.width+m)}))}return r&&r.stopBatch("layout"),{bbox:Y,stacks:K}}},Fo={__proto__:null,ForceDirected:fe,GridLayout:xc,TreeLayout:Ji,StackLayout:Ti},Bn=Da.extend({name:"swimlane-boundary",tagName:"rect",options:{padding:10,laneId:""},update:function(){var t=this.vel,r=this.relatedView,e=this.options,r=r.model,i=r.angle(),n=r.getBBox().center(),r=this.getBoundaryBBox(r,e.laneId,e.padding);return r===null?t.attr({width:0,height:0}):(t.attr(r.toJSON()),t.rotate(i,n.x,n.y,{absolute:!0})),this},getBoundaryBBox:function(a,e,s){var s=ti(s),n=s.left,r=s.top,o=s.right,s=s.bottom,a=a.getLaneBBox(e);return a===null?null:(a.moveAndExpand({x:-n,y:-r,width:n+o,height:r+s}),a.width<0&&(a.width=0),a.height<0&&(a.height=0),a)}}),fn=(Lr.inflatedOnSide=function(t,e,i,n,r){var o=new Lr(t,e,i),s=o.getLine(r);switch(r){case"top":case"right":o[r]=s.parallel(-n);break;case"bottom":case"left":o[r]=s.parallel(n)}return o},Lr.prototype={getLine:function(t){switch(t){case"top":return this.top;case"right":return this.right;case"bottom":return this.bottom;case"left":return this.left}},isPointOnLine:function(t,e){return Math.round(this.getLine(e).closestPoint(t).distance(t))===0},isPointToTheLeftOfLine:function(t,e){var i=Math.round(this.getLine(e).pointOffset(t));switch(e){case"top":case"right":return 0<i;case"bottom":case"left":return i<0}},isPointToTheRightOfLine:function(t,e){var i=Math.round(this.getLine(e).pointOffset(t));switch(e){case"top":case"right":return i<0;case"bottom":case"left":return 0<i}},isPointInside:function(t){var e=this.isPointToTheLeftOfLine(t,"top"),i=this.isPointToTheLeftOfLine(t,"right"),n=this.isPointToTheLeftOfLine(t,"bottom");return this.isPointToTheLeftOfLine(t,"left")&&e&&i&&n},isPointInsideOrOnLine:function(o){var e=this.isPointInside(o),i=this.isPointOnLine(o,"top"),n=this.isPointOnLine(o,"right"),r=this.isPointOnLine(o,"bottom"),o=this.isPointOnLine(o,"left");return e||i||n||r||o},findClosestPointToLine:function(t,e){var i=this,n=new Q,r=1/0;return t.forEach(function(o){var s=i.getDistanceFromLineToPoint(o,e);s<r&&(n.update(o.x,o.y),r=s)}),n},findFurthestPointFromLine:function(t,e){var i=this,n=new Q,r=-1/0;return t.forEach(function(o){var s=i.getDistanceFromLineToPoint(o,e);r<s&&(n.update(o.x,o.y),r=s)}),n},getDistanceFromLineToPoint:function(t,i){var n=this.getLine(i),i=this.isPointToTheRightOfLine(t,i)?1:-1,n=Math.abs(n.pointOffset(t))*i;return Math.round(n)}},Be.SegmentHandle.extend({className:"swimlane-transform-handle",children:[{tagName:"rect",selector:"handle",attributes:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#3498db",stroke:"#FFFFFF","stroke-width":2}}],position:function(r,e,i){var n=this.childNodes.handle,r=X.createSVGMatrix().translate(r,e).rotate(i);n.setAttribute("transform",X.matrixToTransformString(r)),n.setAttribute("cursor",i%180==0?"row-resize":"col-resize")}})),_o="top",Na="right",ql="bottom",Ns="left",th="x",wc="y",oo={__proto__:null,SwimlaneBoundary:Bn,SwimlaneTransform:nr.extend({name:"swimlane-transform",options:{laneId:void 0,minSize:30,padding:10,stopPropagation:!0,constraintsPadding:10,handleClass:fn,minSizeConstraints:void 0,maxSizeConstraints:void 0},handles:null,minConstraintPoints:null,maxConstraintPoints:null,initialize:function(){var t=this,e=this.options;e.minSizeConstraints===void 0&&(e.minSizeConstraints=function(i,n,r){return t.getMinConstraintsToEmbeds(i,n,r)}),e.maxSizeConstraints===void 0&&(e.maxSizeConstraints=function(i,n,r){return t.getMaxConstraintsToEmbeds(i,n,r)})},update:function(){return this.render(),this},onRender:function(){return this.removeHandles(),this.doesLaneExist()&&this.renderHandles(),this},onRemove:function(){this.removeHandles()},doesLaneExist:function(){return this.relatedView.model.getLaneBBox(this.options.laneId)!==null},removeHandles:function(){var t=this.handles;if(this.handles=[],this.stopListening(),Array.isArray(t))for(var e=0;e<t.length;e++)t[e].remove()},renderHandles:function(){var t=this;this.getHandlesPositionInfo().forEach(function(e){e=t.renderHandle(e),t.simulateRelatedView(e.el),t.handles.push(e)})},getHandlesPositionInfo:function(){var t=this.options,r=this.relatedView,e=t.laneId,r=r.model,i=r.angle(),n=r.getBBox().center(),r=this.getHandlesBoundaryBBox(r,e,t.padding);return[{position:r.topMiddle().rotate(n,-i),axis:wc,side:_o},{position:r.leftMiddle().rotate(n,-i),axis:th,side:Ns},{position:r.rightMiddle().rotate(n,-i),axis:th,side:Na},{position:r.bottomMiddle().rotate(n,-i),axis:wc,side:ql}]},getHandlesBoundaryBBox:function(a,e,s){var s=ti(s),n=s.left,r=s.top,o=s.right,s=s.bottom,a=a.getLaneBBox(e).moveAndExpand({x:-n,y:-r,width:n+o,height:r+s});return a.width<0&&(a.width=0),a.height<0&&(a.height=0),a},renderHandle:function(t){var e=this,i=new this.options.handleClass({paper:this.paper,axis:t.axis,side:t.side,guard:function(n){return e.guard(n)}});return i.render(),i.vel.appendTo(this.el),this.updateHandlePosition(i,t.position),this.startHandleListening(i),i},updateHandlePosition:function(t,e){var i=this.relatedView.model.angle();t.options.axis===th&&(i+=90),t.position(e.x,e.y,i)},startHandleListening:function(t){this.listenTo(t,"change:start",this.onHandleChangeStart),this.listenTo(t,"changing",this.onHandleChanging),this.listenTo(t,"change:end",this.onHandleChangeEnd)},onHandleChangeStart:function(t,e){var i=t.options.side,n=this.options,r=this.handles,o=this.relatedView,s=o.model,a=o.paper;Array.isArray(r)&&(this.hideNonSelectedHandles(r,t),this.updateConstraintPoints(i),this.focus(),s.startBatch("lane-resize",{ui:!0,tool:this.cid}),n.stopPropagation||o.notifyPointerdown.apply(o,a.getPointerArgs(e)))},hideNonSelectedHandles:function(t,e){t.forEach(function(i){return i===e?i.show():i.hide()})},updateConstraintPoints:function(t){var e,i,r=this.relatedView,s=this.options,n=s.laneId,r=r.model,o=s.minSizeConstraints,s=s.maxSizeConstraints;Rt(o)&&(e=o(r,n,t)),Rt(s)&&(i=s(r,n,t)),this.minConstraintPoints=Array.isArray(e)?e.map(function(a){return new Q(a)}):[],this.maxConstraintPoints=Array.isArray(i)?i.map(function(a){return new Q(a)}):[]},onHandleChanging:function(t,d){var o=this.options,i=this.relatedView,n=i.model,p=i.paper,r=o.laneId,o=o.stopPropagation,s=n.getBBox(),a=n.angle(),v=s.center(),u=t.options,l=u.axis,h=u.side,u=this.getHandlesPositionInfo().find(function(I){return I.side===h}).position,d=Tt(d),p=p.snapToGrid(d.clientX,d.clientY),m=p.clone().rotate(v,a).round(),v=u.clone().rotate(v,a).round(),m=m.difference(v),v=m.y!==0,k=m.x!==0;l===wc&&v?(v=h===_o?-m.y:m.y,this.updateLaneHeight(r,v,h,s,a)):l===th&&k&&(v=h===Ns?-m.x:m.x,this.updateLaneWidth(r,v,n,h,s,a)),this.updateHandlePosition(t,u),o||i.notifyPointermove(d,p.x,p.y)},onHandleChangeEnd:function(t,o){var i=this.options,n=this.relatedView,a=n.paper,r=n.model,o=Tt(o),a=a.snapToGrid(o.clientX,o.clientY),s=a.x,a=a.y;this.render(),this.blur(),r.stopBatch("lane-resize",{ui:!0,tool:this.cid}),i.stopPropagation||n.notifyPointerup(o,s,a),n.checkMouseleave(o)},updateLaneHeight:function(t,e,i,n,r){var o=this,s=this.relatedView.model,h=s.metrics.lanes,a=dt(s.prop("lanes")),l=this.getNeighbourLanesIds(h,t,i),h=this.getSublanesAndMostEmbeddedLaneId(h,t,i),u=l.foundNeighbourLaneId===void 0,d=[l.foundNeighbourLaneId].concat(l.sublaneIds),p=[t].concat(h.sublaneIds,l.laneIdsPathToNeighbour);e=this.getDiffWithinConstraints(t,e,i,n.center(),r),e=this.getDiffWithinLaneSizeLimits(s,e,h.mostEmbeddedLaneId,l.mostEmbeddedLaneId),p.forEach(function(m){return o.addSizeToLane(s,a,m,e)}),u?this.resizeShape(s,n.width,n.height+e,i):d.forEach(function(m){return o.addSizeToLane(s,a,m,-e)}),s.prop("lanes",a,{ui:!0,tool:this.cid,autoResize:!1})},getSublanesAndMostEmbeddedLaneId:function(t,e,i){return t=this.getIdsOfClosestSublanesToTheSide(t,e,i),{sublaneIds:t,mostEmbeddedLaneId:t[0]||e}},getOppositeHandleSide:function(t){switch(t){case _o:return ql;case Na:return Ns;case ql:return _o;case Ns:return Na}},getNeighbourLanesIds:function(s,o,r){var n=this.getOppositeHandleSide(r),o=this.findNeighbourLane(s,o,r),r=o.foundNeighbourLaneId,o=o.laneIdsPathToNeighbour,s=this.getIdsOfClosestSublanesToTheSide(s,r,n);return{foundNeighbourLaneId:r,laneIdsPathToNeighbour:o,sublaneIds:s,mostEmbeddedLaneId:s[0]||r}},addSizeToLane:function(t,e,i,n){n=this.getLaneBBoxHeight(t,i)+n,t=t.getLanePath(i),t.push("size"),Qr({lanes:e},t,n)},updateLaneWidth:function(t,e,i,n,r,o){e=this.getDiffWithinConstraints(t,e,n,r.center(),o),t=i.getMinimalSize().width,o=Math.max(r.width+e,t),this.resizeShape(i,o,r.height,n)},resizeShape:function(t,e,i,n){t.resize(e,i,{ui:!0,tool:this.cid,direction:n})},getLaneBBoxHeight:function(t,e){return t.getLaneBBox(e).height},getDiffWithinLaneSizeLimits:function(a,e,o,l){var r=Math.sign(e),s=l!==void 0,o=this.getLaneBBoxHeight(a,o),s=s?this.getLaneBBoxHeight(a,l):1/0,a=o+e,l=s-e,h=this.getMinSize();return a<h?e=(o-h)*r:l<h&&(e=(s-h)*r),Math.round(e)},getMinSize:function(){var t=this.options.minSize,e=2*this.options.constraintsPadding;return t=t<e?e:t},getDiffWithinConstraints:function(a,e,i,l,h){var a=this.relatedView.model.getLaneBBox(a),o=this.getConstraintPaddingRelativeToHandleSide(e),s=Lr.inflatedOnSide(a,l,h,o,i),a=Lr.inflatedOnSide(a,l,h,e+o,i),l=this.getMaxConstraintPointsInsideLane(a),h=this.getMinConstraintPointsOutsideLane(a,i);return 0<l.length?(o=s.findClosestPointToLine(l,i),e=s.getDistanceFromLineToPoint(o,i)):0<h.length&&(a=s.findFurthestPointFromLine(h,i),e=s.getDistanceFromLineToPoint(a,i)),e},getConstraintPaddingRelativeToHandleSide:function(t){return this.options.constraintsPadding*(t<0?-1:1)},getMaxConstraintPointsInsideLane:function(t){return this.maxConstraintPoints.filter(function(e){return t.isPointInside(e)})},getMinConstraintPointsOutsideLane:function(t,e){return this.minConstraintPoints.filter(function(r){var n=t.isPointToTheRightOfLine(r,e),r=t.isPointOnLine(r,e);return n||r})},findNeighbourLane:function(t,e,i){for(var n=[],r=i===_o,o=void 0,s=e;s;){var a=t[s],l=a.parentId,h=a.laneIndexWithinGroup;if(!(r?h===0:h===a.parentSublanesCount-1)){o=this.getSublaneIdOfParent(t,l,r?h-1:h+1);break}l&&n.unshift(l),s=l}return{foundNeighbourLaneId:o,laneIdsPathToNeighbour:n}},getSublaneIdOfParent:function(t,e,i){return Object.keys(t).find(function(o){var o=t[o],r=o.parentId===e,o=o.laneIndexWithinGroup===i;return r&&o})},getIdsOfClosestSublanesToTheSide:function(t,e,i){for(var n=[],o=e;o;)var r=t[o].sublanesCount,r=o+"_"+(i===_o?0:r-1),o=t[r]!==void 0?(n.unshift(r),r):void 0;return n},getMinConstraintsToEmbeds:function(t,r,i){var n=[],o=t.getBBox().center(),s=t.angle(),r=t.getLaneBBox(r),r=new Lr(r,o,s),o=t.getEmbeddedCells({deep:!0}),s=i===Ns||i===Na;return this.getEmbedPointsInsideLane(r,o,i).forEach(function(a){return n.push(a)}),s&&0<o.length&&(s=(i=this.findLeftMostAndRightMostEmbedPoints(t,r,o)).leftMostPoint,t=i.rightMostPoint,n.push(s),n.push(t)),n},getMaxConstraintsToEmbeds:function(t,e,i){var n=[],r=t.angle(),l=t.metrics.lanes,o=t.getBBox().center(),s=t.getEmbeddedCells({deep:!0}),a=this.findNeighbourLane(l,e,_o).foundNeighbourLaneId,l=this.findNeighbourLane(l,e,ql).foundNeighbourLaneId;return a!==void 0&&(e=t.getLaneBBox(a),a=new Lr(e,o,r),this.getEmbedPointsInsideLane(a,s,i,{addOverflowingEmbedsOnlyOnHandleSide:!0}).forEach(function(h){return n.push(h)})),l!==void 0&&(e=t.getLaneBBox(l),a=new Lr(e,o,r),this.getEmbedPointsInsideLane(a,s,i,{addOverflowingEmbedsOnlyOnHandleSide:!0}).forEach(function(h){return n.push(h)})),n},getEmbedPointsInsideLane:function(t,e,i,n){var r=this,o=[];return e.forEach(function(s){var a=s.angle(),l=s.getBBox(),h=l.center();s.isLink()||(s=r.getBBoxCornerPoints(l,h,a),r.isElementInsideLane(t,s,h,i,n)&&s.forEach(function(u){return o.push(u)}))}),o},isElementInsideLane:function(t,e,a,n,s){var o,s=(s=s===void 0?{}:s).addOverflowingEmbedsOnlyOnHandleSide,a=t.isPointInsideOrOnLine(a);return s?(o=this.getOppositeHandleSide(n),s=e.every(function(l){return t.isPointInsideOrOnLine(l)}),n=e.some(function(u){var h=t.isPointToTheLeftOfLine(u,o),u=t.isPointOnLine(u,o);return h||u}),e=e.some(function(l){return t.isPointToTheRightOfLine(l,o)}),a&&(s||n&&e)):a},getBBoxCornerPoints:function(t,e,i){return[t.topLeft().rotate(e,-i).round(),t.topRight().rotate(e,-i).round(),t.bottomLeft().rotate(e,-i).round(),t.bottomRight().rotate(e,-i).round()]},findLeftMostAndRightMostEmbedPoints:function(t,e,i){var n=this,r=t.angle(),o=t.getBBox(),a=o.center(),o=new Lr(o,a,r),s=[],a=(i.forEach(function(l){var h,u;l.isLink()||(u=(h=l.getBBox()).center(),l=l.angle(),n.getBBoxCornerPoints(h,u,l).forEach(function(d){return s.push(d)}))}),o.findFurthestPointFromLine(s,Ns));return{leftMostPoint:this.getLeftMostPointCorrectedToPoolHeaders(t,a,o.left,e.left),rightMostPoint:o.findFurthestPointFromLine(s,Na)}},getLeftMostPointCorrectedToPoolHeaders:function(o,e,a,r){var s=this.getTotalLaneHeadersWidth(o),o=o.metrics.padding.left,r=r.pointOffset(a.start)-o-s,o=a.closestPoint(e),s=new Ot(o,e),a=s.length()+r;return s.setLength(a),s.end},getTotalLaneHeadersWidth:function(t){var e=t.metrics.lanes,i=0;return Object.keys(e).forEach(function(n){for(var r=n,o=0;r;){var s=t.metrics.lanes[r];o+=s.headerSize||0,r=s.parentId}i=i<o?o:i}),i}},{TransformHandle:fn}),RecordScrollbar:nr.extend({name:"scroll-bar",tagName:"rect",options:{margin:2,width:8,rightAlign:!1},attributes:{fill:"#333",rx:4,ry:4,"fill-opacity":.4,cursor:"grab"},events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},onRender:function(){this.update()},update:function(){var t=this.getBBox();return t?(this.enable(),this.vel.attr(t.toJSON())):this.disable(),this},getTrackHeight:function(){var t=this.relatedView,e=this.options,t=t.model,i=t.metrics.padding,e=e.margin,i=i.top+i.bottom+2*Math.abs(e);return t.attributes.size.height-i},getScale:function(){var e=this.relatedView.model,t=e.metrics,e=e.attributes,t=t.minHeight,e=e.size.height,i=this.getTrackHeight();return i/(t-(e-i))},getBBox:function(){var t,e,i,n,r,o,s,a,l,u=this.relatedView,h=this.options,u=u.model;return u.isEveryItemInView()||(i=u.metrics,t=(a=u.attributes).size.width,e=i.padding,i=i.overflow,(o=this.getTrackHeight())<=0)?null:(n=h.margin,r=h.width,s=o*(o=this.getScale()),l=(a=a.position).x,a=a.y+Math.abs(n)+e.top,l=l,h.rightAlign?(l+=t-n,0<=n&&(l-=r),i||(l-=e.right)):(l+=n,n<0&&(l-=r),i||(l+=e.left)),new nt({x:l,y:a+o*u.getScrollTop(),width:r,height:s}))},disable:function(){this.vel.attr("display","none")},enable:function(){this.vel.attr("display","")},onPointerDown:function(t){var e,i;this.guard(t)||(t.stopPropagation(),t.preventDefault(),(i=(e=this.relatedView).model).startBatch("scroll-record",{ui:!0,tool:this.cid}),this.focus(),this.delegateDocumentEvents(null,{y:t.clientY,scrollTop:i.getScrollTop()}),e.paper.undelegateEvents())},onPointerMove:function(e){var e=Tt(e),n=e.data,i=n.y,s=n.scrollTop,n=n.lastScrollTop,r=this.relatedView.model,o=this.getScale(),s=s+(e.clientY-i)/o;n!==s&&(e.data.lastScrollTop=s,r.setScrollTop(s))},onPointerUp:function(){this.undelegateDocumentEvents(),this.paper.delegateEvents(),this.blur(),this.el.style.pointerEvents="",this.relatedView.model.stopBatch("scroll-record",{ui:!0,tool:this.cid})}})},_e=R.Collection.extend({LOCAL_STORAGE_KEY:"joint.ui.Clipboard.cells",defaults:{useLocalStorage:!0,deep:!1,origin:"center",translate:{dx:20,dy:20}},constructor:function(t){R.Collection.prototype.constructor.call(this,[],t),this.defaults=ct({},this.defaults,t),this.cid=qr()},copyElements:function(r,e,i){i=ct({},this.defaults,i);var n,r=Array.isArray(r)?r:r.toArray(),r=(i.deep?(n=[],r.forEach(function(o){n.push.apply(n,[o].concat(o.getEmbeddedCells({deep:!0})))})):n=r,vi(Object.values(e.cloneSubgraph(n,i)),function(o){return o.attributes.z||0}));return this.reset(r),i.useLocalStorage&&window.localStorage&&localStorage.setItem(this.LOCAL_STORAGE_KEY,JSON.stringify(this.toJSON())),n},cutElements:function(t,e,i){return i=ct({},this.defaults,i),t=this.copyElements(t,e,i),i=i.removeCellOptions||{},i.clipboard=this.cid,e.startBatch("cut"),qe(t,"remove",i),e.stopBatch("cut"),t},pasteCells:function(t,e){var i=this,n=((e=ct({},this.defaults,e)).useLocalStorage&&this.updateFromStorage(t),t.maxZIndex()),o=this.map(function(s){return n+=1,i.modifyCell(s,e,n)}),r=e.addCellOptions||{},o=(r.clipboard=this.cid,vi(o,function(s){return s.isLink()?2:1}));return t.startBatch("paste"),t.addCells(o,r),t.stopBatch("paste"),this.copyElements(this,t,e),o},pasteCellsAtPoint:function(t,e,i){var n,r=this,o=((i=ct({},this.defaults,i)).useLocalStorage&&this.updateFromStorage(t),vi(Object.values(t.cloneSubgraph(this.toArray(),i)),function(l){return l.attributes.z||0})),s=t.get("cells").cellNamespace,s=new wi([],{cellNamespace:s}),a=(s.resetCells(o,{sort:!1}),this.getOriginPoint(o,s,i.origin));return a?(e={dx:e.x-a.x,dy:e.y-a.y},i.translate=e,n=t.maxZIndex(),a=this.map(function(l){return n+=1,r.modifyCell(l,i,n)}),(e=i.addCellOptions||{}).clipboard=this.cid,a=vi(a,function(l){return l.isLink()?2:1}),t.startBatch("paste"),t.addCells(a,e),t.stopBatch("paste"),this.copyElements(o,s,i),a):[]},isEmpty:function(t){return t=ct({},this.defaults,t),!(0<this.length||t.useLocalStorage&&(t=this.getJSONFromStorage(),t&&t.length))},clear:function(t){t=ct({},this.defaults,t),this.reset([]),t.useLocalStorage&&window.localStorage&&localStorage.removeItem(this.LOCAL_STORAGE_KEY)},modifyCell:function(t,e,i){return t.set("z",i),t.isLink()&&e.link&&t.set(e.link),e.translate&&(e=(i=e.translate).dx,i=i.dy,t.translate(isFinite(e)?e:0,isFinite(i)?i:0)),t.collection=null,t},updateFromStorage:function(t){var e=this.getJSONFromStorage();e&&(e={cells:e},t=t.get("cells").cellNamespace,t=new wi([],{cellNamespace:t}).fromJSON(e,{sort:!1,dry:!0}),this.reset(t.getCells()))},getJSONFromStorage:function(){return window.localStorage&&JSON.parse(localStorage.getItem(this.LOCAL_STORAGE_KEY))||null},getOriginPoint:function(t,e,i){return e=e.getCellsBBox(t),e?Ro(e,i):null}}),Pa=ke.extend({className:"select-box",events:{"click .select-box-selection":"onToggle"},options:{options:[],width:void 0,openPolicy:"auto",target:null,keyboardNavigation:!0,selected:void 0,selectBoxOptionsClass:void 0,disabled:!1},init:function(){this.options.target=this.options.target||document.body,yi(this,"onOutsideClick","onOptionSelect"),P(document).on("click.selectBox",this.onOutsideClick),this.$el.data("view",this),this.options.selected===void 0?this.selection=kt(this.options.options).find(function(t){return t.selected===!0})||this.options.options[0]:this.selection=this.options.options[this.options.selected]},render:function(){return this.$el.empty(),this.$selection=null,this.renderSelection(this.selection),this.options.width&&this.$el.css("width",this.options.width),this.options.disabled&&this.disable(),this.$el.append(this.$options),this},renderOptions:function(){this.removeOptions();var t=this.options,e={selectBoxView:this,parentClassName:Fe(this,"className")||null,extraClassName:Fe(t,"selectBoxOptionsClass")||null,options:t.options},e=(t.width&&(e.width=t.width),t.theme&&(e.theme=t.theme),this.optionsView=new this.constructor.OptionsView(e));e.render(),this.listenTo(e,"option:select",this.onOptionSelect),this.listenTo(e,"option:hover",this.onOptionHover),this.listenTo(e,"options:mouseout",this.onOptionsMouseOut),this.$options=e.$el,this.$optionsArrow=e.$arrow,this.$target=P(t.target)},setOptions:function(t,e){this.options.options=t;for(var i=this.getSelectionValue(this.selection),n=(i||e==null||(i=t[e].value),this.options.options||[]),r=0;r<n.length;r++){var o=n[r];if(o.value===void 0&&o.content===i)return this.select(r);if(o.value!==void 0&&yt(o.value,i))return this.select(r)}this.selection=null,this.renderSelection(),this.trigger("option:select"),this.selectByValue(i,null)},onOptionHover:function(t,e){this.trigger("option:hover",t,e)},onOptionsMouseOut:function(t){this.trigger("options:mouseout",t)},onOptionSelect:function(t,e){this.select(t,e)},removeOptions:function(){this.optionsView&&(this.stopListening(this.optionsView),this.optionsView.remove(),this.optionsView=null)},renderSelection:function(t){this.$selection||(this.$selection=P("<div/>",{class:"select-box-selection"}),this.$el.append(this.$selection)),this.$selection.empty(),t?(t=this.constructor.OptionsView.prototype.renderOptionContent.call(void 0,t),this.$selection.append(t)):this.options.placeholder&&(t=P("<div/>",{class:"select-box-placeholder",html:this.options.placeholder}),this.$selection.append(t))},onToggle:function(t){this.toggle()},onOutsideClick:function(t){!this.el.contains(t.target)&&this.$el.hasClass("opened")&&this.close()},getSelection:function(){return this.selection},getSelectionValue:function(t){return(t=t||this.selection)&&(t.value===void 0?t.content:t.value)},getSelectionIndex:function(){return kt(this.options.options).findIndex((function(t){return t===this.selection}).bind(this))},select:function(t,e){e===void 0&&(e={}),this.selection=this.options.options[t],this.renderSelection(this.selection),this.trigger("option:select",this.selection,t,e),this.close()},selectByValue:function(t,e){for(var i=this.options.options||[],n=0;n<i.length;n++){var r=i[n];if(r.value===void 0&&r.content===t)return this.select(n,e);if(r.value!==void 0&&yt(r.value,t))return this.select(n,e)}},isOpen:function(){return this.$el.hasClass("opened")},toggle:function(){this.isOpen()?this.close():this.open()},position:function(){var r=this.$(".select-box-selection"),t=r.outerHeight(),r=r.offset(),s=r.left,e=r.top,i=this.$options.outerHeight(),n={left:0,top:0},r=(this.options.target!==document.body?((n=this.$target.offset()).width=this.$target.outerWidth(),n.height=this.$target.outerHeight(),n.left-=this.$target.scrollLeft(),n.top-=this.$target.scrollTop()):(n.width=P(window).width(),n.height=P(window).height()),s),o="auto",s=this.options.openPolicy;switch(s=s!=="selected"||this.selection?s:"auto"){case"above":o=e-i;break;case"coverAbove":o=e-i+t;break;case"below":o=e+t;break;case"coverBelow":o=e;break;case"selected":o=e-this.$options.find(".selected").position().top;break;default:o=e-this.$target.scrollTop()+i>n.top+n.height?e-i+t:e}r-=n.left,o-=n.top,this.$options.css({left:r,top:o})},open:function(){this.isDisabled()||(this.renderOptions(),this.$options.appendTo(this.options.target),this.$options.addClass("rendered"),this.position(),this.$el.addClass("opened"),this.respectWindowBoundaries(),this.alignOptionsArrow())},respectWindowBoundaries:function(){var t=this.calculateElOverflow(this.$options,this.$target),e={left:0,top:0};this.$options.outerWidth()<=this.$target.innerWidth()&&(t.left&&t.right||(t.left?e.left=t.left:t.right&&(e.left=-t.right))),this.$options.outerHeight()<=this.$target.innerHeight()&&(t.top&&t.bottom||(t.top?e.top=t.top:t.bottom&&(e.top=-t.bottom))),this.$options.css({left:"+="+e.left,top:"+="+e.top})},alignOptionsArrow:function(){var e=this.$el[0].getBoundingClientRect(),t=this.$options[0].getBoundingClientRect(),e=e.left+e.width/2,e=(e-=t.left)-this.$optionsArrow.outerWidth()/2;this.$optionsArrow.css({left:e})},close:function(){this.removeOptions(),this.$el.removeClass("opened"),this.trigger("close")},onRemove:function(){this.removeOptions(),P(document).off(".selectBox",this.onOutsideClick)},isDisabled:function(){return this.$el.hasClass("disabled")},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.close(),this.$el.addClass("disabled")},onSetTheme:function(t,e){this.$options&&(t&&this.$options.removeClass(this.themeClassNamePrefix+t),this.$options.addClass(this.themeClassNamePrefix+e))},calculateElOverflow:function(t,e){e=e||window,t instanceof P&&(t=t[0]),e instanceof P&&(e=e[0]);var i,n,r={},o=t.getBoundingClientRect();return n=e===window?{width:t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height:i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,left:0,top:0,right:t,bottom:i}:e.getBoundingClientRect(),["left","top"].forEach(function(s){r[s]=Math.min(0,o[s]-n[s])}),["right","bottom"].forEach(function(s){r[s]=Math.min(0,n[s]-o[s])}),Se(r,function(s,a){r[a]=Math.abs(Math.round(s))}),r}},{OptionsView:ke.extend({events:{"mouseover .select-box-option":"onOptionHover","click .select-box-option":"onOptionClick"},className:function(){var t=["select-box-options"],e=this.options.parentClassName;return e&&t.push(e),t.join(" ")},init:function(){yi(this,"onMouseout","onKeydown"),P(document).on({"keydown.selectBoxOptions":this.onKeydown,"mouseleave.selectBoxOptions mouseout.selectBoxOptions":this.onMouseout})},render:function(){var t=this.options.extraClassName;return t&&this.$el.addClass(t),this.options.width&&this.$el.css("width",this.options.width),kt(this.options.options).forEach(function(e,i){i=this.renderOption(e,i),this.options.selectBoxView.selection===e&&i.addClass("selected hover"),this.$el.append(i)},this),this.$arrow=P("<div/>").addClass("select-box-options-arrow").appendTo(this.$el),this},renderOption:function(t,e){return t=this.renderOptionContent(t),t.addClass("select-box-option"),t.data("index",e),t},renderOptionContent:function(t){var e=P("<div/>",{class:"select-box-option-content",html:t.content});return t.icon&&e.prepend(P("<img/>",{class:"select-box-option-icon",src:t.icon})),e},select:function(t,e){this.trigger("option:select",t,e=e===void 0?{}:e)},hover:function(t){var e=this.options.options[t];this.markOptionHover(t),this.trigger("option:hover",e,t)},onOptionClick:function(t){t=this.getOptionIndex(t.target),this.select(t,{ui:!0})},onOptionHover:function(t){t=this.getOptionIndex(t.target),this.hover(t)},onMouseout:function(t){this.trigger("options:mouseout",t)},onKeydown:function(t){var e,i=this.options.selectBoxView;if(i.options.keyboardNavigation&&i.isOpen()){switch(t.which){case 39:case 40:e=1;break;case 38:case 37:e=-1;break;case 13:var n=this.getOptionHoverIndex();return void(0<=n&&this.select(n));case 27:return i.close();default:return}t.preventDefault();var t=this.getOptionHoverIndex()+e,r=this.options.options;(t=t<0?r.length-1:t)>=r.length&&(t=0),this.hover(t)}},onRemove:function(){P(document).off(".selectBoxOptions")},markOptionHover:function(t){this.$el.find(".hover").removeClass("hover"),P(this.$el.find(".select-box-option")[t]).addClass("hover")},getOptionHoverIndex:function(){return this.$el.find(".select-box-option.hover").index()},getOptionIndex:function(t){return P(t).closest(".select-box-option").data("index")}})}),xg=Pa.extend({className:"select-box color-palette",position:function(){var i=this.$(".select-box-selection"),t=i.outerHeight(),i=i.offset(),e=i.left,i=i.top+t;this.options.target!==document.body&&(this.$target=this.$target||P(this.options.target),e-=(t=this.$target.offset()).left-this.$target.scrollLeft(),i-=t.top-this.$target.scrollTop()),this.$options.css({left:e,top:i})}},{OptionsView:Pa.OptionsView.extend({renderOptionContent:function(t){var e=P("<div/>",{class:"select-box-option-content"});return e.css("background-color",t.content),t.icon&&e.prepend(P("<img/>",{class:"select-box-option-icon",src:t.icon})),e}})}),Oi=ke.extend({className:"context-toolbar",eventNamespace:"context-toolbar",events:{"click .tool":"onToolPointerdown","touchstart .tool":"onToolPointerdown"},options:{padding:20,autoClose:!0,vertical:!1,anchor:"top",position:"bottom",scale:1},documentEvents:{mousedown:"onDocumentPointerdown",touchstart:"onDocumentPointerdown"},init:function(){yi(this,"onDocumentPointerdown")},render:function(){var t=this.options,e=this.constructor;return e.opened&&e.close(),t.autoClose&&setTimeout(this.delegateAutoCloseEvents.bind(this),0),t.type&&this.$el.attr("data-type",t.type),this.beforeMount(),this.getRoot().append(this.$el),this.renderContent(),this.position(),this.scale(),e.opened=this},delegateAutoCloseEvents:function(){this.delegateDocumentEvents(),document.addEventListener("mousedown",this.onDocumentPointerdown,!0),document.addEventListener("touchstart",this.onDocumentPointerdown,!0)},undelegateAutoCloseEvents:function(){this.undelegateDocumentEvents(),document.removeEventListener("mousedown",this.onDocumentPointerdown,!0),document.removeEventListener("touchstart",this.onDocumentPointerdown,!0)},beforeMount:function(){this.$el.toggleClass("joint-vertical",!!this.options.vertical)},renderContent:function(){var t=P("<div/>",{class:"tools"});this.options.tools&&kt(this.options.tools).forEach(function(e){var i=e.icon?P("<img/>",{src:e.icon}):e.content,i=P("<button/>",{class:"tool",html:i,"data-action":e.action});e.attrs&&i.attr(e.attrs),t.append(i)}),this.$el.append(t)},getRoot:function(){return P(this.options.root||document.documentElement)},position:function(){var t=this.options,o=t.target,s=t.padding,n=t.position,t=t.anchor,e=this.$el,i={x:0,y:0},n=(X.toNode(o)!==void 0?(r=Ro(Do(o),n),i.x=r.x,i.y=r.y,r=Ro(new nt().inflate(s),n),i.x+=r.x,i.y+=r.y):(s=new Q(o),i.x=s.x,i.y=s.y),e.outerWidth()),r=e.outerHeight(),o=Ro(new nt(0,0,n,r),t),s=(i.x-=o.x,i.y-=o.y,Do(this.getRoot()));i.x-=s.x,i.y-=s.y,e.css({left:i.x,top:i.y})},scale:function(){var e=this.options,t=e.scale,e=e.anchor;t&&(this.el.style.transform="scale("+t+", "+t+")",(t=Bh(e).split("-"))[0]==="corner"&&(t[0]="bottom",t[1]="right"),t[0]==="origin"&&(t[0]="top",t[1]="left"),t[1]==="middle"&&(t[1]=null),this.el.style.transformOrigin=t[0]+" "+(t[1]||""))},onRemove:function(){this.undelegateAutoCloseEvents(),this.constructor.opened=void 0},onToolPointerdown:function(t){var e=P(t.currentTarget).attr("data-action");e&&this.trigger("action:"+e,t)},onDocumentPointerdown:function(n){var e=this.el,i=this.options.target,n=n.target;X.toNode(i)!==void 0&&(i=P(i)[0],!i||i===n||i.contains(n))||e.contains(n)||e===n||(this.constructor.close(),this.remove())}},{opened:void 0,close:function(){var t=this.opened;t&&(t.trigger("close"),t.remove(),this.opened=null)},update:function(){this.opened&&this.opened.position()}}),an=ke.extend({className:"dialog",events:{"click .bg":"action","click .btn-close":"action","click .controls button":"action","mousedown .titlebar":"onDragStart","touchstart .titlebar":"onDragStart"},options:{draggable:!1,closeButtonContent:"&times;",closeButton:!0,inlined:!1,modal:!0,width:0,title:"",buttons:null,type:"",content:null},init:function(){yi(this,"onDrag","onDragEnd"),this.buttons=this.options.buttons},render:function(){var t,e,i,n=P("<div/>",{class:"bg","data-action":"close"}),r=P("<div/>",{class:"fg"}),o=P("<div/>",{class:"titlebar"}),s=P("<div/>",{class:"body"}),a=P("<button/>",{class:"btn-close","data-action":"close",html:this.options.closeButtonContent}),l=P("<div/>",{class:"controls"});return this.$el.toggleClass("draggable",!!this.options.draggable),this.options.type&&this.$el.attr("data-type",this.options.type),this.options.inlined&&this.$el.addClass("inlined"),this.options.modal&&this.$el.addClass("modal"),this.options.width&&r.width(this.options.width),this.options.title?o.append(this.options.title):o.addClass("empty"),this.options.content&&s.append(this.options.content),this.buttons&&(t=[],e=[],i=[],this.buttons.forEach(function(h){var u=P("<button/>",{class:"control-button",html:h.content,"data-action":h.action});(h.position?h.position==="left"?(u.addClass(h.position),i):h.position==="center"?(u.addClass(h.position),e):(u.addClass(h.position),t):t).push(u)}),t.reverse().forEach(function(h){l.append(h)}),i.forEach(function(h){l.append(h)}),e.forEach(function(h){l.append(h)})),r.append(o,s,l),this.options.closeButton&&r.append(a),this.$el.empty().append(n,r),this},open:function(t){return this.delegateEvents(),this.on("action:close",this.close,this),P(t||document.body).append(this.render().el),this.$el.addClass("rendered"),this},close:function(){return this.remove(),this.trigger("close"),this},action:function(t){t=P(t.target).closest("[data-action]").attr("data-action"),t&&this.trigger("action:"+t)},onDragStart:function(t){var e;this.options.draggable&&(t.preventDefault(),t=Tt(t),e=this.$el.find(".fg").offset(),this.delegateDocumentEvents({mousemove:this.onDrag,touchmove:this.onDrag,mouseup:this.onDragEnd,touchend:this.onDragEnd},{dx:t.clientX-e.left,dy:t.clientY-e.top}))},onDrag:function(t){var e=(t=Tt(t)).data;this.$(".fg").offset({top:t.clientY-e.dy,left:t.clientX-e.dx})},onDragEnd:function(){this.undelegateDocumentEvents()}}),wg=an.extend({className:an.prototype.className+" flash-message",options:ze({},an.prototype.options,{closeButton:!0,modal:!1,cascade:!0,closeAnimation:{delay:2e3,duration:200,easing:"swing",properties:{opacity:0}},openAnimation:{duration:200,easing:"swing",properties:{opacity:1}}}),init:function(){yi(this,"startCloseAnimation"),an.prototype.init.apply(this,arguments),this.on("close:animation:complete",this.close,this)},open:function(){an.prototype.open.apply(this,arguments);var t=this.$(".fg");return this._foregroundHeight=t.height(),this.addToCascade(),t.css("height",0),this.startOpenAnimation(),this.options.closeAnimation&&this.options.closeAnimation.delay&&setTimeout(this.startCloseAnimation,this.options.closeAnimation.delay),this},close:function(){return an.prototype.close.apply(this,arguments),this.removeFromCascade(),this},addToCascade:function(){var t;this.options.cascade&&(t=this.constructor.top,this.$(".fg").css("top",t),this.constructor.top+=this._foregroundHeight+this.constructor.padding),this.constructor.opened.push(this)},removeFromCascade:function(){if(this.options.cascade){for(var t=this.constructor.opened,e=!1,i=0;i<t.length;i++){var n,r=t[i];r.options.cascade&&e&&(n=parseInt(r.$(".fg").css("top"),10),r.$(".fg").css("top",n-this._foregroundHeight-this.constructor.padding)),r===this&&(e=!0)}e&&(this.constructor.top-=this._foregroundHeight+this.constructor.padding)}this.constructor.opened=Lo(this.constructor.opened,this)},startCloseAnimation:function(){this.$(".fg").animate(this.options.closeAnimation.properties,ct({complete:(function(){this.trigger("close:animation:complete")}).bind(this)},this.options.closeAnimation))},startOpenAnimation:function(){this.$(".fg").animate(ct({},this.options.openAnimation.properties,{height:this._foregroundHeight}),ct({complete:(function(){this.trigger("open:animation:complete")}).bind(this)},this.options.openAnimation))}},{top:20,padding:15,opened:[],open:function(t,e,i){return new wg(ct({title:e,type:"info",content:t},i=i||{})).open(i.target)},close:function(){qe(this.opened,"close")}}),Ag=ke.extend({className:"free-transform",events:{"mousedown .resize":"startResizing","mousedown .rotate":"startRotating","touchstart .resize":"startResizing","touchstart .rotate":"startRotating"},DIRECTIONS:["nw","n","ne","e","se","s","sw","w"],POSITIONS:["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"],options:{cellView:void 0,rotateAngleGrid:15,resizeGrid:void 0,preserveAspectRatio:!1,minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,allowOrthogonalResize:!0,resizeDirections:null,allowRotation:!0,clearAll:!0,clearOnBlankPointerdown:!0,usePaperScale:!1,padding:3},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup"},init:function(){var t=this.options,e=(t.cellView?Jt(t,{cell:t.cellView.model,paper:t.cellView.paper,graph:t.cellView.paper.model}):t.paper&&t.cell&&Jt(t,{cellView:t.cell.findView(t.paper),graph:t.paper.model}),t.paper);t.clearAll&&this.constructor.clear(e),this.startListening(),e.$el.append(this.el),this.constructor.registerInstanceToPaper(this,e)},startListening:function(){var t=this,r=this.options,e=r.cell,i=r.paper,n=r.graph,r=r.clearOnBlankPointerdown;this.listenTo(e,"change:size change:position change:angle",this.onCellAttributeChange),this.listenTo(i,"scale translate",function(){return t.requestUpdate()}),this.listenTo(n,"reset",function(){return t.remove()}),this.listenTo(e,"remove",function(){return t.remove()}),r&&this.listenTo(i,"blank:pointerdown",function(){return t.remove()})},onCellAttributeChange:function(t,e,i){i.updateHandled||this.requestUpdate()},renderHandles:function(){var t=this.options,e=this.POSITIONS,i=P("<div/>").prop("draggable",!1),n=i.clone().addClass("rotate"),r=e.map(function(s){return i.clone().addClass("resize").attr("data-position",s)}),o=t.resizeDirections;Array.isArray(o)&&r.forEach(function(s,a){o.includes(e[a])||s.hide()}),this.$el.empty().append(r,n)},render:function(){var r=this.options,t=this.$el,e=r.cell,i=r.preserveAspectRatio,n=r.allowRotation,r=r.allowOrthogonalResize;t.attr("data-type",e.get("type")),t.toggleClass("no-orthogonal-resize",i||!r),t.toggleClass("no-rotation",!n),this.renderHandles(),this.requestUpdate()},requestUpdate:function(t){var e=this.UPDATE_PRIORITY;this.options.paper.requestViewUpdate(this,1,e,t)},confirmUpdate:function(){this.update()},update:function(){this.options.usePaperScale?this.updateFrameScaled():this.updateFrameNoScale(),this.updateHandleDirections()},updateFrameScaled:function(){var e=this.options,r=e.paper,n=e.cell,e=e.padding,e=ti(e),i=e.left,o=e.right,t=e.top,e=e.bottom,i=n.getBBox().moveAndExpand({x:-i,y:-t,width:i+o,height:t+e}),o=i.x,t=i.y,e=i.width,i=i.height,n=n.angle(),r=r.matrix().translate(o,t).translate(e/2,i/2).rotate(n).translate(-e/2,-i/2),o=X.matrixToTransformString(r);this.$el.css({width:e,height:i,left:0,top:0,"transform-origin":"0 0",transform:o,"-webkit-transform":o,"-ms-transform":o})},updateFrameNoScale:function(){var n=this.options,s=n.paper,l=n.cell,n=n.padding,n=ti(n),t=n.left,e=n.right,i=n.top,n=n.bottom,s=s.matrix(),r=s.a,o=s.d,h=s.e,s=s.f,a=l.getBBox(),l=l.angle(),h=(a.x*=r,a.x+=h,a.y*=o,a.y+=s,a.width*=r,a.height*=o,a.moveAndExpand({x:-t,y:-i,width:t+e,height:i+n}),"rotate("+l+"deg)");this.$el.css({width:a.width,height:a.height,left:a.x,top:a.y,"transform-origin":"50% 50%",transform:h,"-webkit-transform":h,"-ms-transform":h})},updateHandleDirections:function(){var t,e=this.options.cell.angle(),e=Math.floor(e*(this.DIRECTIONS.length/360));e!=this._previousDirectionsShift&&(t=this.DIRECTIONS.slice(e).concat(this.DIRECTIONS.slice(0,e)),this.$(".resize").removeClass(this.DIRECTIONS.join(" ")).each(function(i,n){P(n).addClass(t[i])}),this._previousDirectionsShift=e)},calculateTrueDirection:function(i){var e=this.options.cell,e=Xe(e.get("angle")),i=this.POSITIONS.indexOf(i),i=(i+=Math.floor(e*(this.POSITIONS.length/360)))%this.POSITIONS.length;return this.POSITIONS[i]},startResizing:function(t){t.stopPropagation();var d=this.options,e=d.cell,n=d.graph,i=d.paper,n=(n.startBatch("free-transform",{freeTransform:this.cid}),P(t.target).data("position")),r=this.calculateTrueDirection(n),o=0,s=0,a=(n.split("-").forEach(function(m){o={left:-1,right:1}[m]||o,s={top:-1,bottom:1}[m]||s}),this.toValidResizeDirection(n)),p={"top-right":"bottomLeft","top-left":"corner","bottom-left":"topRight","bottom-right":"origin"}[a],l=d.minWidth,h=d.minHeight,u=d.maxWidth,d=d.maxHeight,l=typeof l=="function"?l.call(this,e,this):l,h=typeof h=="function"?h.call(this,e,this):h,u=typeof u=="function"?u.call(this,e,this):u,d=typeof d=="function"?d.call(this,e,this):d,p={action:"resize",angle:e.angle(),resizeX:o,resizeY:s,selector:p,direction:a,relativeDirection:n,trueDirection:r,maxHeight:d,minHeight:h,maxWidth:u,minWidth:l,cellView:e.findView(i)};this.startOp(t.target),this.eventData(t,p),this.trigger(p.action+":start",t),this.delegateDocumentEvents(null,t.data)},toValidResizeDirection:function(t){return{top:"top-left",bottom:"bottom-right",left:"bottom-left",right:"top-right"}[t]||t},startRotating:function(t){t.stopPropagation();var i=Tt(t),e=(this.options.graph.startBatch("free-transform",{freeTransform:this.cid}),this.options.cell.getBBox().center()),i=this.options.paper.snapToGrid({x:i.clientX,y:i.clientY}),i={action:"rotate",centerRotation:e,modelAngle:Xe(this.options.cell.get("angle")||0),startAngle:se(i).theta(e)};this.startOp(t.target),this.eventData(t,i),this.trigger(i.action+":start",t),this.delegateDocumentEvents(null,t.data)},pointermove:function(t){var e=this.eventData(t),i=e.action,n=e.maxHeight,r=e.maxWidth,o=e.minHeight,s=e.minWidth,a=e.cellView;if(i){t=Tt(t);var l=this.options,h=l.cell,u=l.paper.snapToGrid({x:t.clientX,y:t.clientY}),d=l.paper.options.gridSize,p=l.resizeGrid||{},m=p.width||d,v=p.height||d;switch(i){case"resize":var k,I=h.getBBox(),G=se(u).rotate(I.center(),e.angle).difference(I[e.selector]()),N=e.resizeX?G.x*e.resizeX:I.width,G=e.resizeY?G.y*e.resizeY:I.height,N=Ce(N,m),G=Ce(G,v);N=Math.max(N,s||m),G=Math.max(G,o||v),N=Math.min(N,r),G=Math.min(G,n),l.preserveAspectRatio&&(F=I.width*G/I.height,k=I.height*N/I.width,N<F?G=k:N=F),I.width==N&&I.height==G||(k={freeTransform:this.cid,direction:e.direction,relativeDirection:e.relativeDirection,trueDirection:e.trueDirection,ui:!0,minWidth:s,minHeight:o,maxWidth:r,maxHeight:n,preserveAspectRatio:l.preserveAspectRatio},a.scalableNode&&(k.async=!1),h.resize(N,G,k));break;case"rotate":var F=e.startAngle-se(u).theta(e.centerRotation);h.rotate(Ce(e.modelAngle+F,l.rotateAngleGrid),!0,null,{freeTransform:this.cid})}this.trigger(""+i,t)}},pointerup:function(t){this.undelegateDocumentEvents();var e=this.eventData(t);e.action&&(this.stopOp(),this.trigger(e.action+":stop",t),this.options.graph.stopBatch("free-transform",{freeTransform:this.cid}))},onRemove:function(){Ag.unregisterInstanceFromPaper(this,this.options.paper)},startOp:function(t){t&&(P(t).addClass("in-operation"),this._elementOp=t),this.$el.addClass("in-operation"),this.options.paper.undelegateEvents()},stopOp:function(){this._elementOp&&(P(this._elementOp).removeClass("in-operation"),this._elementOp=null),this.$el.removeClass("in-operation"),this.options.paper.delegateEvents()}},{instancesByPaper:{},clear:function(t){t.trigger("freetransform:create"),this.removeInstancesForPaper(t)},removeInstancesForPaper:function(t){qe(this.getInstancesForPaper(t),"remove")},getInstancesForPaper:function(t){return this.instancesByPaper[t.cid]||{}},registerInstanceToPaper:function(t,e){this.instancesByPaper[e.cid]||(this.instancesByPaper[e.cid]={}),this.instancesByPaper[e.cid][t.cid]=t},unregisterInstanceFromPaper:function(t,e){this.instancesByPaper[e.cid]&&(this.instancesByPaper[e.cid][t.cid]=null)}}),ci=(bg.prototype.directionSwap=function(){var t=this.options.cellView.model;t.set({source:t.get("target"),target:t.get("source")},{halo:this.cid})},Ci.prototype.startLinking=function(o,e,i){this.startBatch();var r=this.options,n=r.paper,r=r.graph,o=this.createLinkConnectedToSource(o);o.set({target:{x:e,y:i}}).addTo(r,{validation:!1,halo:this.cid,async:!1}),n.undelegateEvents(),(this._linkView=o.findView(n)).startArrowheadMove("target",{whenNotAllowed:"remove"})},Ci.prototype.startForking=function(t,e,i){var n=this.options,s=n.paper,n=n.graph,r=(this.startBatch(),this.cloneCell({fork:!0})),o=r[0],r=r.slice(1),r=[o].concat(vi(r,function(a){return a.isLink()})),r=(n.addCells(r,{halo:this.cid,async:!1}),this.centerElementAtCursor(o,e,i),this.createLinkConnectedToSource(t)),o=o.findView(s),s=this.getElementMagnet(o,"target",t),s=this.getLinkEnd(o,s,t);r.set("target",s).addTo(n,{halo:this.cid,async:!1}),o.pointerdown(t,e,i),this.eventData(t,{cloneView:o})},Ci.prototype.getElementMagnet=function(t,e,i){var n=this.options.magnet;if(Rt(n)&&(n=n.call(this,t,e,i),n instanceof SVGElement))return n;throw new Error("ui.Halo: magnet() has to return an SVGElement.")},Ci.prototype.getLinkEnd=function(t,e,i){var n,r={id:t.model.id};return e!==t.el&&((n=t.findAttribute("port",e))?r.port=n:r.selector=t.getSelector(e)),r},Ci.prototype.createLinkConnectedToSource=function(r){var e=this.options,o=e.paper,i=e.cellView,n=this.getElementMagnet(i,"source",r),r=this.getLinkEnd(i,n,r),o=o.getDefaultLink(i,n).set("source",r);return o.attr(e.linkAttributes),Kr(e.smoothLinks)&&o.set("smooth",e.smoothLinks),o},Ci.prototype.startResizing=function(t){this.startBatch(),this._flip=[1,0,0,1,1,0,0,1][Math.floor(Xe(this.options.cellView.model.get("angle"))/45)]},Ci.prototype.startRotating=function(t,e,i){this.startBatch();var n=this.options.cellView.model,r=n.getBBox().center(),o=[n];this.options.rotateEmbeds&&n.getEmbeddedCells({deep:!0}).reduce(function(s,a){return a.isElement()&&s.push(a),s},o),this.eventData(t,{center:r,elements:o,rotationStartAngles:o.map(function(s){return s.angle()}),clientStartAngle:new Q(e,i).theta(r)})},Ci.prototype.doResize=function(t,e,i,n,r){var s=this.options.cellView.model.get("size"),o=Math.max(s.width+(this._flip?n:r),1),s=Math.max(s.height+(this._flip?r:n),1);this.options.cellView.model.resize(o,s,{absolute:!0,halo:this.cid})},Ci.prototype.doRotate=function(t,e,i){var n=this.eventData(t),r=n.clientStartAngle-new Q(e,i).theta(n.center);n.elements.forEach(function(o,s){s=n.rotationStartAngles[s],s=Ce(s+r,this.options.rotateAngleGrid),o.rotate(s,!0,n.center,{halo:this.cid})},this)},Ci.prototype.doClone=function(t,e,i){var n=this.eventData(t).cloneView;n&&n.pointermove(t,e,i)},Ci.prototype.startCloning=function(t,e,i){var n=this.options.paper,s=n.model,o=(this.startBatch(),this.cloneCell({clone:!0})),r=o[0],o=o.slice(1),o=[r].concat(vi(o,function(a){return a.isLink()})),s=(s.addCells(o,{halo:this.cid,async:!1}),this.centerElementAtCursor(r,e,i),r.findView(n));s.pointerdown(t,e,i),this.eventData(t,{cloneView:s})},Ci.prototype.centerElementAtCursor=function(t,r,o){var n=t.getBBox().center(),r=r-n.x,o=o-n.y;t.translate(r,o,{deep:!0,halo:this.cid})},Ci.prototype.doFork=function(t,e,i){var n=this.eventData(t).cloneView;n&&n.pointermove(t,e,i)},Ci.prototype.doLink=function(t,e,i){this._linkView&&this._linkView.pointermove(t,e,i)},Ci.prototype.stopLinking=function(t,e,i){var n=this._linkView;n&&(n.pointerup(t,e,i),(t=n.model).hasLoop()&&this.makeLoopLink(t),this.triggerAction("link","add",t),this.stopBatch(),this._linkView=null),this.options.paper.delegateEvents()},Ci.prototype.stopForking=function(t,e,i){var n=this.eventData(t).cloneView;n&&n.pointerup(t,e,i),this.stopBatch()},Ci.prototype.stopCloning=function(t,e,i){var n=this.eventData(t).cloneView;n&&n.pointerup(t,e,i),this.stopBatch()},Ci.prototype.unlinkElement=function(t){this.startBatch(),this.options.graph.removeLinks(this.options.cellView.model),this.stopBatch()},ke.extend({PIE_INNER_RADIUS:20,PIE_OUTER_RADIUS:50,className:"halo",events:{"mousedown .handle":"onHandlePointerDown","touchstart .handle":"onHandlePointerDown","mousedown .pie-toggle":"onPieTogglePointerDown","touchstart .pie-toggle":"onPieTogglePointerDown"},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup"},options:{clearAll:!0,clearOnBlankPointerdown:!0,useModelGeometry:!(Ci.prototype.makeLoopLink=function(t){var e,i,n=this.options.loopLinkWidth,r=this.options.paper.options,o=It({x:0,y:0,width:r.width,height:r.height}),s=this.options.paper.paperToLocalRect(this.options.cellView.getBBox());J([this.options.loopLinkPreferredSide,"top","bottom","left","right"]).find(function(a){var l,h=0,u=0;switch(a){case"top":l=se(s.x+s.width/2,s.y-n),h=n/2;break;case"bottom":l=se(s.x+s.width/2,s.y+s.height+n),h=n/2;break;case"left":l=se(s.x-n,s.y+s.height/2),u=n/2;break;case"right":l=se(s.x+s.width+n,s.y+s.height/2),u=n/2}return e=se(l).offset(-h,-u),i=se(l).offset(h,u),o.containsPoint(e)&&o.containsPoint(i)},this)&&t.set("vertices",[e,i],{halo:this.cid})}),clone:function(t,e){return t.clone().unset("z")},type:"surrounding",pieSliceAngle:45,pieStartAngleOffset:0,pieIconSize:14,pieToggles:[{name:"default",position:"e"}]},init:function(){var t=this.options,n=t.cellView,e=n.model,i=new(e.isLink()?bg:Ci),n=(ct(this,ai(i,"options")),n.paper),r=n.model;Jt(t,i.options,{paper:n,graph:r}),yi(this,"render","update"),t.clearAll&&this.constructor.clear(n),this.listenTo(r,"reset",this.close),this.listenTo(e,"remove",this.close),this.listenTo(n,"halo:create",this.close),t.clearOnBlankPointerdown&&this.listenTo(n,"blank:pointerdown",this.close),this.listenTo(r,"all",this.update),this.listenTo(n,"scale translate",this.update),this.handles=[],kt(t.handles).forEach(this.addHandle,this)},render:function(){var t=this.options;switch(this.$el.empty(),this.$handles=P("<div/>").addClass("handles").appendTo(this.el),this.$box=P("<label/>").addClass("box").appendTo(this.el),this.$pieToggles={},this.$el.addClass(t.type),this.$el.addClass(this.cellTypeCssClass()),this.$el.attr("data-type",t.cellView.model.get("type")),this.$handles.append(kt(this.handles).map(this.renderHandle,this)),t.type){case"toolbar":case"surrounding":this.hasHandle("fork")&&this.toggleFork();break;case"pie":kt(this.options.pieToggles).forEach(function(e){var i=P("<div/>");i.addClass("pie-toggle "+(e.position||"e")),i.attr("data-name",e.name),Bo(i,e.attrs),i.appendTo(this.el),this.$pieToggles[e.name]=i},this);break;default:throw new Error("ui.Halo: unknown type")}return this.update(),this.$el.addClass("animate").appendTo(t.paper.el),this.setPieIcons(),this},setPieIcons:function(){this.options.type==="pie"&&this.$el.find(".handle").each((function(t,e){var i,n=P(e),r=n.attr("data-action"),r=this.getHandle(r);r&&r.icon||((r=window.getComputedStyle(e,":before").getPropertyValue("content"))&&r!=="none"&&0<(i=n.find(".slice-text-icon")).length&&X(i[0]).text(r.replace(/['"]/g,"")),(e=n.css("background-image"))&&(r=e.match(/url\(['"]?([^'"]+)['"]?\)/))&&(e=r[1],0<(i=n.find(".slice-img-icon")).length&&X(i[0]).attr("xlink:href",e)))}).bind(this))},update:function(){var t;this.isRendered()&&(this.updateBoxContent(),t=this.getBBox(),this.$el.toggleClass("tiny",t.width<this.options.tinyThreshold&&t.height<this.options.tinyThreshold),this.$el.toggleClass("small",!this.$el.hasClass("tiny")&&t.width<this.options.smallThreshold&&t.height<this.options.smallThreshold),this.$el.css({width:t.width,height:t.height,left:t.x,top:t.y}),this.hasHandle("unlink")&&this.toggleUnlink())},getBBox:function(){var e=this.options.cellView,t=this.options.bbox,e=Rt(t)?t(e,this):t,e=Jt({},e,{x:0,y:0,width:1,height:1});return It(e)},cellTypeCssClass:function(){return this.options.typeCssName},updateBoxContent:function(){var t=this.options.boxContent,e=this.options.cellView;Rt(t)?(e=t.call(this,e,this.$box[0]))&&this.$box.html(e):t?this.$box.html(t):this.$box.remove()},extendHandles:function(t){Se(t,(function(e){var i=this.getHandle(e.name);i&&ct(i,e)}).bind(this))},addHandles:function(t){return kt(t).forEach(this.addHandle,this),this},addHandle:function(t){return this.getHandle(t.name)||(this.handles.push(t),Se(t.events,(function(e,i){Ft(e)?this.on("action:"+t.name+":"+i,this[e],this):this.on("action:"+t.name+":"+i,e)}).bind(this)),this.$handles&&this.renderHandle(t).appendTo(this.$handles)),this},renderHandle:function(t){var e=this.getHandleIdx(t.name),i=P("<div/>").addClass("handle").addClass(t.name).attr("data-action",t.name).prop("draggable",!1);switch(this.options.type){case"toolbar":case"surrounding":i.addClass(t.position),t.content&&i.html(t.content);break;case"pie":var s=this.PIE_OUTER_RADIUS,o=this.PIE_INNER_RADIUS,a=(s+o)/2,n=se(s,s),h=Qe(this.options.pieSliceAngle),l=e*h+Qe(this.options.pieStartAngleOffset),o=X.createSlicePathData(o,s,l,l+h),r=X("svg").addClass("slice-svg"),o=X("path").attr("d",o).translate(s,s).addClass("slice"),s=se.fromPolar(a,-l-h/2,n),a=this.options.pieIconSize,l=X("image").attr(s).addClass("slice-img-icon"),h=(s.y=s.y+a-2,X("text",{"font-size":a}).attr(s).addClass("slice-text-icon"));l.attr({width:a,height:a}),l.translate(-a/2,-a/2),h.translate(-a/2,-a/2),r.append([o,l,h]),i.append(r.node)}return t.icon&&this.setHandleIcon(i,t.icon),Bo(i,t.attrs),i},setHandleIcon:function(t,e){switch(this.options.type){case"pie":var i=t.find(".slice-img-icon");X(i[0]).attr("xlink:href",e);break;case"toolbar":case"surrounding":t.css("background-image","url("+e+")")}},removeHandles:function(){for(;this.handles.length;)this.removeHandle(this.handles[0].name);return this},removeHandle:function(t){var e=this.getHandleIdx(t),i=this.handles[e];return i&&(Se(i.events,(function(n,r){this.off("action:"+t+":"+r)}).bind(this)),this.$(".handle."+t).remove(),this.handles.splice(e,1)),this},changeHandle:function(t,e){var i=this.getHandle(t);return i&&(this.removeHandle(t),this.addHandle(ze({name:t},i,e))),this},hasHandle:function(t){return this.getHandleIdx(t)!==-1},getHandleIdx:function(t){return kt(this.handles).findIndex(function(e){return e.name===t})},getHandle:function(t){return kt(this.handles).find(function(e){return e.name===t})},toggleHandle:function(t,e){var i=this.getHandle(t);return i&&(t=this.$(".handle."+t),e===void 0&&(e=!t.hasClass("selected")),t.toggleClass("selected",e),(e=e?i.iconSelected:i.icon)&&this.setHandleIcon(t,e)),this},selectHandle:function(t){return this.toggleHandle(t,!0)},deselectHandle:function(t){return this.toggleHandle(t,!1)},deselectAllHandles:function(){return kt(this.handles).forEach(function(t){this.deselectHandle(t.name)},this),this},onHandlePointerDown:function(t){var e,i,n=this._action=t.currentTarget.dataset.action;n&&(t.preventDefault(),t.stopPropagation(),t=Tt(t),e=(i=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY})).x,i=i.y,this._localX=e,this._localY=i,(this._evt=t).type==="mousedown"&&t.button===2?this.triggerAction(n,"contextmenu",t,e,i):(this.triggerAction(n,"pointerdown",t,e,i),this.delegateDocumentEvents(null,t.data)))},onPieTogglePointerDown:function(t){t.stopPropagation(),t=P(t.target).closest(".pie-toggle").attr("data-name"),this.isOpen(t)||this.isOpen()&&this.toggleState(),this.toggleState(t)},triggerAction:function(t,e,i){var n=Array.prototype.slice.call(arguments,2);n.unshift("action:"+t+":"+e),this.trigger.apply(this,n)},stopBatch:function(){var t=this.options.graph;t.hasActiveBatch("halo")&&t.stopBatch("halo",{halo:this.cid})},startBatch:function(){this.options.graph.startBatch("halo",{halo:this.cid})},pointermove:function(t){var e,i,n;this._action&&(t.preventDefault(),t.stopPropagation(),t=Tt(t),i=(e=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY})).x-this._localX,n=e.y-this._localY,this._localX=e.x,this._localY=e.y,this._evt=t,this.triggerAction(this._action,"pointermove",t,e.x,e.y,i,n))},pointerup:function(t){var e,i=this._action;i&&(this._action=null,this._evt=null,e=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY}),this.triggerAction(i,"pointerup",t,e.x,e.y),this.undelegateDocumentEvents())},onRemove:function(){this._action&&this._evt&&this.pointerup(this._evt),this.stopBatch()},close:function(){return this.closed||(this.closed=!0,this.remove(),this.trigger("close")),this},onSetTheme:function(){this.setPieIcons()},removeElement:function(){this.options.cellView.model.remove()},toggleUnlink:function(){var t=0<this.options.graph.getConnectedLinks(this.options.cellView.model).length;this.$handles.children(".unlink").toggleClass("hidden",!t)},toggleFork:function(){var t=this.canFork();this.$handles.children(".fork").toggleClass("hidden",!t)},canFork:function(){var t,i=this.options,e=i.cellView,i=i.paper,n=i.options.validateConnection;return typeof n!="function"||(t=this.cloneCell({fork:!0,validation:!0})[0],t=i.createViewForModel(t),n=n.call(i,e,null,t,null,"target"),t.remove(),n)},cloneCell:function(t){var i=this.options,e=i.cellView,i=(0,i.clone)(e.model,t=t===void 0?{}:t);if(i instanceof bi)return[i];if(Array.isArray(i)&&0<i.length&&i.every(function(n){return n instanceof bi}))return i;throw new Error('ui.Halo: option "clone" has to return a cell.')},toggleState:function(t){var e,i;this.isRendered()&&(e=this.$el,Se(this.$pieToggles,function(n){n.removeClass("open")}),this.isOpen()?(this.trigger("state:close",t),e.removeClass("open")):(this.trigger("state:open",t),t&&((i=kt(this.options.pieToggles).find(function(n){return n.name===t}))&&e.attr({"data-pie-toggle-position":i.position,"data-pie-toggle-name":i.name}),this.$pieToggles[t].addClass("open")),e.addClass("open")))},isOpen:function(t){return!!this.isRendered()&&(t?this.$pieToggles[t]:this.$el).hasClass("open")},isRendered:function(){return this.$box!==void 0}},{clear:function(t){t.trigger("halo:create")},HandlePosition:{N:"n",NW:"nw",W:"w",SW:"sw",S:"s",SE:"se",E:"e",NE:"ne"}})),Ac=ke.extend({className:"select-button-group",events:{"click .select-button-group-button":"onSelect","mouseover .select-button-group-button":"onOptionHover",mouseleave:"onMouseOut","mousedown .select-button-group-button":"pointerdown","touchstart .select-button-group-button":"pointerdown","mouseup .select-button-group-button":"pointerup","touchend .select-button-group-button":"pointerup"},options:{options:[],disabled:!1,multi:!1,selected:void 0,singleDeselect:!1,noSelectionValue:void 0,width:void 0,buttonWidth:void 0,buttonHeight:void 0,iconWidth:void 0,iconHeight:void 0},init:function(){yi(this,"onSelect","pointerup"),this.$el.data("view",this);var t,e=this.options.options,i=this.options.multi,n=this.options.selected;n===void 0?(t=kt(e).filter(function(r){return r&&r.selected===!0}),this.selection=i?t:t[0]):this.selection=i?Array.isArray(n)?e.filter(function(r,o){return n.includes(o)}):[e[n]]:e[n]},render:function(){return this.renderOptions(this.selection),this.options.width&&this.$el.css("width",this.options.width),this.options.disabled&&this.disable(),this.$el.append(this.$options),this},renderOptions:function(){this.removeOptions(),kt(this.options.options).forEach(function(n,e){var i=this.options.multi?this.selection.includes(n):this.selection===n,n=this.renderOption(n,e,i);this.$el.append(n),i&&n.addClass("selected")},this)},removeOptions:function(){this.$el.empty()},renderOption:function(t,e,i){return i=this.renderOptionContent(t,i),i.data("index",e),e=t.buttonWidth||this.options.buttonWidth,e&&i.css("width",e),e=t.buttonHeight||this.options.buttonHeight,e&&i.css("height",e),i},renderOptionContent:function(t,e){var i,n=P("<div/>",{class:"select-button-group-button",html:t.content});return(t.icon||e&&t.iconSelected)&&(e=P("<img/>",{class:"select-button-group-button-icon",src:e&&t.iconSelected?t.iconSelected:t.icon}),(i=t.iconWidth||this.options.iconWidth)&&e.css("width",i),(i=t.iconHeight||this.options.iconHeight)&&e.css("height",i),n.prepend(e)),Bo(n,t.attrs),n},setOptions:function(t,e){this.options.options=t,this.selection=e,this.render(),this.trigger("option:select",this.selection)},getOptionIndex:function(t){return P(t).closest(".select-button-group-button").data("index")},onSelect:function(t){this.isDisabled()||(t=this.getOptionIndex(t.target),this.select(t,{ui:!0}))},onOptionHover:function(t){this.isDisabled()||(t=this.getOptionIndex(t.target),this.trigger("option:hover",this.options.options[t],t))},onMouseOut:function(t){this.isDisabled()||this.trigger("mouseout",t)},getSelection:function(){return this.selection},getSelectionValue:function(t){t=t||this.selection;var e,i=this.options.noSelectionValue;return this.options.multi?(e=kt(t)).length===0?i!==void 0?i:[]:e.map(function(n){var r=n.value;return r!==void 0?r:n.content}):t?(e=t.value)!==void 0?e:t.content:i!==void 0?i:void 0},select:function(t,e){var i,n,r=P(this.$(".select-button-group-button")[t]),o=this.options.options[t],s=null,a=null,l=null,h=null,u=(this.options.multi?(r.toggleClass("selected"),r.hasClass("selected")?(l=t,this.selection.indexOf(h=o)===-1&&this.selection.push(o),o.iconSelected&&r.find(".select-button-group-button-icon").attr("src",o.iconSelected)):(s=t,this.selection=Lo(this.selection,a=o),o.iconSelected&&r.find(".select-button-group-button-icon").attr("src",o.icon))):(u=(i=this.$(".selected")).index(),n=this.options.options[u],r.toggleClass("selected"),r.hasClass("selected")?(n&&(s=u,a=n,i.removeClass("selected"),n.iconSelected&&i.find(".select-button-group-button-icon").attr("src",n.icon)),l=t,(this.selection=h=o).iconSelected&&r.find(".select-button-group-button-icon").attr("src",o.iconSelected)):this.options.singleDeselect?(s=t,a=o,this.selection=void 0,o.iconSelected&&r.find(".select-button-group-button-icon").attr("src",o.icon)):r.addClass("selected")),ct({},e));u.deselectedIndex=s,u.deselectedOption=a,u.selectedIndex=l,u.selectedOption=h,this.trigger("option:select",this.selection,t,u)},selectByValue:function(t,e){Array.isArray(t)||(t=[t]);for(var i=this.options.options||[],n=0;n<i.length;n++){var r=i[n];(r.value===void 0&&t.includes(r.content)||r.value!==void 0&&t.find(function(o){return yt(o,r.value)}))&&this.select(n,e)}},deselect:function(){this.$(".selected").removeClass("selected"),this.options.multi?this.selection=[]:this.selection=void 0},isDisabled:function(){return this.$el.hasClass("disabled")},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.$el.addClass("disabled")},pointerdown:function(t){t=this.getOptionIndex(t.target),P(this.$(".select-button-group-button")[t]).addClass("is-in-action"),P(document).on("mouseup.select-button-group touchend.select-button-group",this.pointerup)},pointerup:function(){this.$(".is-in-action").removeClass("is-in-action"),P(document).off("mouseup.select-button-group touchend.select-button-group")}}),Cg=ke.extend({className:"radio-group",events:{"click input":"onOptionClick"},options:{options:[],name:void 0},currentValue:void 0,groupOptions:void 0,name:void 0,inputOptions:{},init:function(){this.groupOptions=this.options.options||[],this.name=this.options.name||this.cid},render:function(){return this.renderOptions(),this},renderOptions:function(){var t=this;this.el.innerHTML="",this.inputOptions={},this.groupOptions.forEach(function(e,i){t.renderOption(e,i)})},renderOption:function(t,e){var i=document.createElement("label"),n=(i.setAttribute("tabindex",0),document.createElement("input")),n=(n.type="radio",n.value=t.value,n.name=this.name,i.appendChild(n),this.inputOptions[t.value]={input:n,index:e},document.createElement("span"));n.innerHTML=t.content,i.appendChild(n),this.el.appendChild(i)},getSelectionIndex:function(){return this.inputOptions[this.currentValue].index},getCurrentValue:function(){return this.currentValue},select:function(t){t=this.groupOptions[t].value,t&&this.selectByValue(t)},selectByValue:function(e){var e=this.inputOptions[e];e&&(e=e.input)&&e.value!==this.currentValue&&(e.checked=!0,this.currentValue=e.value,this.trigger("option:select",this.currentValue,this))},onOptionClick:function(t){t=t.target,t.value!==this.currentValue&&this.selectByValue(t.value)},setOptions:function(t){this.groupOptions=t,this.renderOptions(),t=this.inputOptions[this.currentValue],t&&t.input?t.input.checked=!0:(this.currentValue=null,this.trigger("option:select",this.currentValue,this))}}),Ea=(Ta.prototype.subscribe=function(t,e){var i=this;t.forEach(function(n){var r=n.path;i.dependencies[r]||(i.dependencies[r]=[]),i.dependencies[r].push({callback:e,dependency:n})})},Ta.prototype.changed=function(t){var e=this;Object.getOwnPropertyNames(this.dependencies).filter(function(i){return e.isSubPathOrSuperPath(i,t)}).forEach(function(i){e.dependencies[i].forEach(function(n){n.callback(n.dependency,t)})})},Ta.prototype.clear=function(){this.dependencies={}},Ta.prototype.isSubPathOrSuperPath=function(t,e){var i=t.split("/"),n=e.split("/");return i.length>n.length?!n.some(function(r,o){return!yt(r,i[o])}):!i.some(function(r,o){return!yt(r,n[o])})},Vo.prototype.add=function(t,e,i){var n=this;this.sources[t]={sourceOption:e,updateFunction:i,initialized:!1},e.dependencies&&(i=e.dependencies.map(function(r){return{name:r,path:n.resolveDependency(t,r)}}),this.dependencyService.subscribe(i,function(r,o){var s={};s[r.name]={path:r.path,changedPath:o},n.refresh(t,{dependencies:s})}))},Vo.prototype.initSources=function(){for(var t in this.sources){var e=this.sources[t];e.initialized||(this.refresh(t,{initialized:!0}),e.initialized=!0)}},Vo.prototype.refresh=function(t,e){var i,n,r=this,o=(e===void 0&&(e={}),this.sources[t]);o&&(i=this.inspector.getModel(),n=e.dependencies||{},o.sourceOption.dependencies&&o.sourceOption.dependencies.forEach(function(s){var a=r.resolveDependency(t,s);n[s]||(n[s]={path:a,changedPath:null}),n[s].value=i.prop(a)}),(e=o.sourceOption.source({dependencies:n,inspector:this.inspector,model:i,initialized:!!e.initialized,path:t}))instanceof Promise?e.then(function(s){o.updateFunction(s)}).catch(function(s){console.error("Inspector source resolving: "+s)}):o.updateFunction(e))},Vo.prototype.refreshAll=function(){for(var t in this.sources)this.refresh(t)},Vo.prototype.resolveDependency=function(t,n){var i=this.options.wildcard,n=n.split("/"),r=t.split("/");return n.reduce(function(o,s,a){return s===i?o+r[a]+"/":o+s+"/"},"").slice(0,-1)},Vo.prototype.clear=function(){this.sources={}},ke.extend({className:"inspector",options:{cellView:void 0,cell:void 0,live:!0,validateInput:function(t,e,i,n){return!t.validity||t.validity.valid},renderFieldContent:void 0,renderLabel:void 0,focusField:void 0,operators:{},multiOpenGroups:!0,container:null,stateKey:function(t){return t.id}},events:{"change [data-attribute]:not([data-custom-field])":"onChangeInput","click .group-label":"onGroupLabelClick","click .btn-list-add":"addListItem","click .btn-list-del":"deleteListItem","mousedown .field":"pointerdown","touchstart .field":"pointerdown","focusin .field":"pointerfocusin","focusout .field":"pointerfocusout"},HTMLEntities:{lt:"<",gt:">",amp:"&",nbsp:" ",quot:'"',cent:"¢",pound:"£",euro:"€",yen:"¥",copy:"©",reg:"®"},init:function(){var t,e=this.options.groups=this.options.groups||{},i=(yi(this,"stopBatchCommand","pointerup","onContentEditableBlur","replaceHTMLEntity"),this.DEFAULT_PATH_WILDCARD="${index}",this.pathWildcard=this.options.pathWildcard,this.widgets={},this._byPath={},this._attributeKeysInUse=[],this.flatAttributes=this.flattenInputs(this.options.inputs),this.expandAttributes=this.expandAttrs(this.options.inputs||{}),this._when={},this.dependencyService=new Ta,this.sourceService=new Vo(this,this.dependencyService,{wildcard:this.pathWildcard||this.DEFAULT_PATH_WILDCARD}),Object.keys(this.flatAttributes).map(function(r){var o=this.flatAttributes[r];return this._registerDependants.call(this,o,r),o.path=r,o},this));for(t in e){var n=e[t];n&&e.hasOwnProperty(t)&&this.extractExpressionPaths(n.when).forEach(function(r){this._when[r]||(this._when[r]=[])},this)}i=vi(i,"index"),this.groupedFlatAttributes=vi(i,(function(r){return r=this.options.groups[r.group],r&&r.index||Number.MAX_VALUE}).bind(this)),this.listenTo(this.getModel(),"all",this.onCellChange,this)},_registerDependants:function(t,e){var i,n;t.when&&(i=t.when,n={expression:i,path:e},this.extractExpressionPaths(i).forEach(function(r){(this._when[r]||(this._when[r]=[])).push(n)},this)),this._registerNestedDependants.call(this,t,e)},_registerNestedDependants:function(t,e){var i,n,r=Array.isArray(e)?e:e.split("/");t.type==="object"&&t.properties?(i=t.properties,Object.keys(i).forEach(function(a){var s=i[a],a=r.concat(a);this._registerDependants(s,a)},this)):t.type==="list"&&t.item?(e=t.item,n=r.concat(null),this._registerDependants(e,n)):typeof t.type!="string"&&Object.keys(t).forEach(function(o){var s=t[o];typeof s=="object"&&(o=r.concat(o),this._registerDependants(s,o))},this)},cacheInputs:function(){var t={};Array.from(this.$("[data-attribute]")).forEach(function(i){var i=P(i),n=i.attr("data-attribute");t[n]=i},this),this._byPath=t,this._attributeKeysInUse=this.getAttributeKeysInUse()},updateGroupsVisibility:function(){for(var t=this.$groups,e=0,i=t.length;e<i;e++){var n=P(t[e]),r=n.attr("data-name"),r=this.options.groups[r],o=n.find("> .field:not(.hidden)").length===0,o=(n.toggleClass("empty",o),!(!r||!r.when||this.isExpressionValid(r.when)));n.toggleClass("hidden",o)}},expandAttrs:function(t){for(var e={},i=Object.keys(t),n=0;n<i.length;n++){var o=i[n],r=t[o],o=o.split("/");Qr(e,o,ve(r)?this.expandAttrs(r):r)}return e},flattenInputs:function(t){return Il(t,"/",function(e){return typeof e.type=="string"})},getModel:function(){return this.options.cell||this.options.cellView.model},onCellChange:function(t,e,i,n){if((n=n||{}).inspector!=this.cid)switch(t){case"remove":this.constructor.instance&&this.trigger("close"),this.remove();break;case"change:position":this.updateInputPosition();break;case"change:size":this.updateInputSize();break;case"change:angle":this.updateInputAngle();break;case"change:source":case"change:target":case"change:vertices":break;default:var r="change:";t.slice(0,r.length)===r&&(r=t.slice(r.length),this._attributeKeysInUse.includes(r)?this.render({refresh:!0}):this.dependencyService.changed(r))}},render:function(t){var e,i,n=t&&t.refresh,r=(n&&this.options.storeGroupsState&&this.storeGroupsState(),this.sourceService.clear(),this.dependencyService.clear(),this.$el.empty(),this.removeWidgets(),[]);return this.groupedFlatAttributes.forEach(function(o){var s;e!==o.group&&(s=this.options.groups[o.group],i=this.renderGroup({name:o.group,label:s&&s.label}),n||(s&&s.closed?this.closeGroup(i,{init:!0}):this.openGroup(i,{init:!0})),r.push(i)),this.renderTemplate(i,o,o.path),e=o.group},this),this.$document=P(this.el.ownerDocument),this.$groups=P(r),this.$el.append(r),n&&this.options.restoreGroupsState&&this.restoreGroupsState(),this.afterRender(),this},getAttributeKeysInUse:function(){var t=Object.keys(this._byPath).map(function(n){return n.substring(0,n.indexOf("/"))||n}),e=kt(this._bound),i=Object.keys(this._when);return J([].concat(t,e,i))},getCellAttributeValue:function(t,e){var i=this.getModel(),i=Vi(i.attributes,t,"/");if((e=e||this.flatAttributes[t])&&(i===void 0&&e.defaultValue!==void 0&&(i=e.defaultValue),e.valueRegExp)){if(i===void 0)throw new Error("Inspector: defaultValue must be present when valueRegExp is used.");t=i.match(new RegExp(e.valueRegExp)),i=t&&t[2]}return i},resolvableTypes:["select","select-box","color-palette","select-button-group","radio-group"],resolveBindings:function(t){var e,i;-1<this.resolvableTypes.indexOf(t.type)&&(i=t.options||[],Ft(i)&&(i={dependencies:[e=i],source:function(n){return n=n.dependencies[e].value,Array.isArray(n)?n.map(function(r){return Ft(r)?{value:r,content:r}:r}):[]}}),(i=Array.isArray(i)&&!Dt(i[0])?kt(i).map(function(n){return{value:n,content:n}}):i).source?(t._optionsSource=i,t.items=[]):t.items=i)},renderFieldContent:function(t,e,i){var n,r,o=this;if(Rt(this.options.renderFieldContent)&&(n=this.options.renderFieldContent(t,e,i,this)))return P(n).attr({"data-attribute":e,"data-type":t.type,"data-custom-field":!0});switch(t.type){case"select-box":var s,h=kt(t.items).findIndex(function(d){var p=d.value,m=i;return p===void 0&&d.content===m||((d=t.key)&&(m=Vi(m,d,"/"),p=Vi(p,d,"/")),yt(p,m))}),a=ct({theme:this.options.theme,target:this.options.container},ai(t,"type","group","index","selectBoxOptionsClass","options"),{options:t.items,selected:h,selectBoxOptionsClass:[Ui("inspector-select-box-options"),t.selectBoxOptionsClass].filter(function(d){return!!d}).join(" ")});(s=new Pa(a)).$el.attr({"data-attribute":e,"data-type":t.type,"data-overwrite":t.overwrite}),s.render(),a=this.renderOwnLabel(t,e),n=P("<div/>").append(a,s.el),t.previewMode?(r=s.selection,s.on("options:mouseout close",function(){s.selection=r,this.processInput(s.$el,{previewCancel:!0,dry:!0})},this),s.on("option:hover",function(d,p){s.selection=d,this.processInput(s.$el,{dry:!0})},this),s.on("option:select",function(d,p){var m=r===void 0?void 0:s.getSelectionValue(r),v=s.getSelectionValue(d);this.processInput(s.$el,{previewDone:!0,dry:m===v,originalValue:m}),r=d},this)):s.on("option:select",function(d,p){this.processInput(s.$el)},this),t._optionsSource&&this.sourceService.add(e,t._optionsSource,function(d){var p=o.getModel().prop(e),m=d.findIndex(function(v){var k=v.value,I=p;return k===void 0&&v.content===I||((v=t.key)&&(I=Vi(I,v,"/"),k=Vi(k,v,"/")),yt(k,I))});s.setOptions(d,m=m===-1?void 0:m)}),this.widgets[e]=s;break;case"color-palette":h=kt(t.items).findIndex(function(d){return d.value===i||d.value===void 0&&d.content===i}),h=ct({theme:this.options.theme,target:this.options.container},ai(t,"type","group","index","options"),{options:t.items,selected:h}),(s=new xg(h)).$el.attr({"data-attribute":e,"data-type":t.type}),s.render(),a=this.renderOwnLabel(t,e),n=P("<div/>").append(a,s.el),t.previewMode?(r=s.selection,s.on("options:mouseout close",function(){s.selection=r,this.processInput(s.$el,{previewCancel:!0,dry:!0})},this),s.on("option:hover",function(d,p){s.selection=d,this.processInput(s.$el,{dry:!0})},this),s.on("option:select",function(d,p){var m=r===void 0?void 0:s.getSelectionValue(r),v=s.getSelectionValue(d);this.processInput(s.$el,{previewDone:!0,dry:m===v,originalValue:m}),r=d},this)):s.on("option:select",function(d,p){this.processInput(s.$el)},this),t._optionsSource&&this.sourceService.add(e,t._optionsSource,function(d){var p=o.getModel().prop(e),m=d.findIndex(function(v){return v.value===p||v.value===void 0&&v.content===p});s.setOptions(d,m=m===-1?void 0:m)}),this.widgets[e]=s;break;case"select-button-group":var l=function(k,p){var m,v,k=kt(k);return t.multi?(m=[],v=[],k.forEach(function(I,N){var G=I.value===void 0?I.content:I.value,F=t.key;F&&(G=Vi(G,F,"/")),kt(p).find(function(H){return F&&(H=Vi(H,F,"/")),yt(G,H)})&&(v.push(I),m.push(N))})):(v=void 0,-1<(m=k.findIndex(function(I){var N=I.value,G=p;return N===void 0&&I.content===G||((I=t.key)&&(G=Vi(G,I,"/"),N=Vi(N,I,"/")),yt(N,G))}))&&(v=k[m])),{selectedIndex:m,selected:v}},h=ct({theme:this.options.theme},ai(t,"type","group","index","options"),{options:t.items,selected:l(t.items,i).selectedIndex});(s=new Ac(h)).$el.attr({"data-attribute":e,"data-type":t.type,"data-overwrite":t.overwrite}),s.render(),a=this.renderOwnLabel(t,e),n=P("<div/>").append(a,s.el),t.previewMode?(r=s.selection,s.on("mouseout",function(){s.selection=r,this.processInput(s.$el,{previewCancel:!0,dry:!0})},this),s.on("option:hover",function(d,p){t.multi?s.selection=J(s.selection.concat([d])):s.selection=d,this.processInput(s.$el,{dry:!0})},this),s.on("option:select",function(d,p){var m=r===void 0?void 0:s.getSelectionValue(r),v=s.getSelectionValue(d),v=yt(m,v);this.processInput(s.$el,{previewDone:!0,dry:v,originalValue:m}),r=d},this)):s.on("option:select",function(d,p){this.processInput(s.$el)},this),t._optionsSource&&this.sourceService.add(e,t._optionsSource,function(d){var p=o.getModel().prop(e),p=l(d,p).selected;s.setOptions(d,p)}),this.widgets[e]=s;break;case"radio-group":var h=ct({theme:this.options.theme},ai("type","group","index","options"),{name:e}),u=new Cg(h);u.render(),u.el.setAttribute("data-attribute",e),u.el.setAttribute("data-type",t.type),t.overwrite&&u.el.setAttribute("data-overwrite",t.overwrite),a=this.renderOwnLabel(t,e),n=P("<div/>").append(a,u.el),u.selectByValue(i),u.on("option:select",function(d){o.processInput(u.$el)}),t._optionsSource&&this.sourceService.add(e,t._optionsSource,function(d){u.setOptions(d)}),this.widgets[e]=u;break;default:n=this.renderOwnFieldContent({options:t,type:t.type,overwrite:t.overwrite,label:t.label||e,attribute:e,value:i})}return n},renderGroup:function(i){i=i||{};var e=P("<div/>").addClass("group").attr("data-name",i.name),i=P("<h3/>").addClass("group-label").text(i.label||i.name);return e.append(i)},renderOwnLabel:function(t,e){var i,n=this.options.renderLabel;if((i=typeof n=="function"?n(t,e,this):i)!==void 0)return P(i);switch(t.type){case"select-box":case"color-palette":case"select-button-group":return P("<label/>").html(t.label||e);default:return P("<label/>").text(t.label||e)}},renderOwnFieldContent:function(t){var e,i,n,r,o=this,s=this.renderOwnLabel(t.options,t.attribute);switch(t.type){case"number":u=P("<input/>",{type:"number",min:t.options.min,max:t.options.max,step:t.options.step}).val(t.value),e=[s,P("<div/>").addClass("input-wrapper").append(u)];break;case"range":s.addClass("with-output"),i=P("<output/>").text(t.value),h=P("<span/>").addClass("units").text(t.options.unit),(u=P("<input/>",{type:"range",name:t.type,min:t.options.min,max:t.options.max,step:t.options.step}).val(t.value)).on("change input",function(){i.text(u.val())}),e=[s,i,h,u];break;case"textarea":u=P("<textarea/>").text(t.value),e=[s,P("<div/>").addClass("input-wrapper").append(u)];break;case"content-editable":var h=t.value,l=t.options,a=(l=l===void 0?{}:l).html,l=(a===void 0&&(a=!0),l.readonly);l===void 0&&(l=!1),a=Ft(h)?(a?jh(h):this.encodeHTMLEntities(h)).replace(/\n/g,"<br>"):"",u=P("<div/>").prop("contenteditable",!l).toggleClass("content-editable-readonly",!!l).css("display","inline-block").html(a).on("blur",this.onContentEditableBlur),e=[s,P("<div/>").addClass("input-wrapper").append(u)];break;case"select":var h=t.options.items,u=P("<select/>");t.options.multiple&&u.prop({size:t.options.size||h.length,multiple:!0}),kt(h).forEach(function(d){var p,m=P("<option/>",{value:d.value}).text(d.content);p=d.value,(t.options.multiple?kt(t.value).find(function(v){return yt(p,v)}):yt(p,t.value))&&m.attr("selected","selected"),u.append(m)}),t.options._optionsSource&&this.sourceService.add(t.attribute,t.options._optionsSource,function(d){u.empty();var p=o.getModel().prop(t.attribute);d.forEach(function(m){var v,k=P("<option/>",{value:m.value}).text(m.content);v=m.value,(t.options.multiple?kt(p).find(function(I){return yt(v,I)}):yt(v,p))&&k.attr("selected","selected"),u.append(k)})}),e=[s,u];break;case"toggle":n=P("<span><i/></span>"),u=P("<input/>",{type:"checkbox"}).prop("checked",!!t.value),e=[s,P("<div/>").addClass(t.type).append(u,n)];break;case"color":e=[s,u=P("<input/>",{type:"color"}).val(t.value)];break;case"text":u=P("<input/>",{type:"text"}).val(t.value),e=[s,P("<div/>").addClass("input-wrapper").append(u)];break;case"object":u=P("<div/>"),r=P("<div/>").addClass("object-properties"),e=[s,u.append(r)];break;case"list":n=P("<button/>").addClass("btn-list-add").text(t.options.addButtonLabel||"+"),r=P("<div/>").addClass("list-items"),e=[s,(u=P("<div/>")).append(n,r)]}return u&&u.addClass(t.type).attr({"data-type":t.type,"data-attribute":t.attribute,"data-overwrite":t.overwrite}),P.fn.append.apply(P("<div>"),e).children()},onContentEditableBlur:function(t){var e=P("<input/>",{disabled:!0,tabIndex:-1,style:{width:"1px",height:"1px",border:"none",margin:0,padding:0}}).appendTo(this.$el);e.focus(),e[0].setSelectionRange(0,0),e.blur().remove(),P(t.target).trigger("change")},replaceHTMLEntity:function(t,e){return this.HTMLEntities[e]||""},encodeHTMLEntities:function(t){return t.replace(/[\u00A0-\u9999<>&]/g,function(e){return"&#"+e.charCodeAt(0)+";"})},renderObjectProperty:function(t){return P("<div/>",{"data-property":(t=t||{}).property,class:"object-property"})},renderListItem:function(t){t=t||{};var e=P("<button/>").addClass("btn-list-del").text(t.options.removeButtonLabel||"-");return P("<div/>",{"data-index":t.index,class:"list-item"}).append(e)},renderFieldContainer:function(t){return P("<div/>",{"data-field":(t=t||{}).path,class:"field "+t.type+"-field"})},renderTemplate:function(t,e,i,n){t=t||this.$el,n=n||{},this.resolveBindings(e),typeof e.type!="string"&&(e={type:"object",properties:e});var r,o,s,a=this.renderFieldContainer({path:i,type:e.type}),l=(n.hidden&&a.addClass("hidden"),this.getCellAttributeValue(i,e)),h=this.renderFieldContent(e,i,l);a.append(h),Bo(a,e.attrs),e.type==="list"&&e.item?(kt(l).forEach(function(u,d){var p=this.renderListItem({index:d,options:e});this.renderTemplate(p,e.item,i+"/"+d),h.children(".list-items").append(p)},this),l=l&&l.length,r=e&&e.min,o=e&&e.max,this.fixListButtons(h,l,r,o)):e.type==="object"&&e.properties&&(s=this.flattenInputs(e.properties),l=Object.keys(s).map(function(u){var d=s[u];return d.path=u,d}),(l=vi(l,function(u){return u.index})).forEach(function(u){var d=this.renderObjectProperty({property:u.path});this.renderTemplate(d,u,i+"/"+u.path),h.children(".object-properties").append(d)},this)),n.replace?t.find('[data-field="'+i+'"]').replaceWith(a):t.append(a)},updateInputPosition:function(){var t=this._byPath["position/x"],e=this._byPath["position/y"],i=this.getModel().get("position");t&&t.val(i.x),e&&e.val(i.y)},updateInputSize:function(){var t=this._byPath["size/width"],e=this._byPath["size/height"],i=this.getModel().get("size");t&&t.val(i.width),e&&e.val(i.height)},updateInputAngle:function(){var t=this._byPath.angle,e=this.getModel().get("angle");t&&t.val(e)},validateInput:function(t,e,i){switch(t){case"select-box":case"color-palette":var n=this.widgets[i];return n?n.getSelectionIndex()!==-1:!1;case"select-button-group":return!!this.widgets[i];default:return this.options.validateInput(e,i,t,this)}},refreshSources:function(){this.sourceService.refreshAll()},refreshSource:function(t){this.sourceService.refresh(t)},focusField:function(t){var e=this.getOptionsFromPath(t),i=this._byPath[t];if(!i)throw"path not found";this._focusFieldInternal(e,t,i[0])},_focusListField:function(t,e,i){i=i.querySelector("[data-attribute]:not(.hidden)"),i&&this._focusFieldInternal(t.item,i.getAttribute("data-attribute"),i)},_focusObjectField:function(t,e,o){var n,r,o=o.querySelector("[data-attribute]:not(.hidden)");o&&(n=o.getAttribute("data-attribute"),r=this.getOptionsFromPath(n),this._focusFieldInternal(r,n,o))},_focusFieldInternal:function(t,e,i){switch(t.type){case"number":case"text":case"range":case"color":case"toggle":case"select":case"textarea":case"content-editable":i.focus();break;case"object":this._focusObjectField(t,e,i);break;case"list":this._focusListField(t,e,i);break;default:this.options.focusField&&this.options.focusField(t,e,i,this)}},onChangeInput:function(t){t.target===t.currentTarget&&this.processInput(P(t.target))},processInput:function(t,e){var i,n=t.attr("data-attribute"),r=t.attr("data-type");this.validateInput(r,t[0],n)&&(this.options.live&&this.updateCell(t,n,e),i=this.getFieldValue(t[0],r),r=this.parse(r,i,t[0]),e&&e.dry||this.dependencyService.changed(n),this.trigger("change:"+n,r,t[0],e))},updateFieldsVisibility:function(){var t=this;this._attributeKeysInUse.forEach(function(e){t.updateDependants(e)})},updateDependants:function(t){var e=this,i=this._when,n=Object.keys(i),r=this._byPath,o=Object.keys(r),s=this.flatAttributes;function a(h,u){var d,p={};for(d in h){var m,v,k=h[d];if(Array.isArray(k))for(var I=d,N=k,G=(p[I]=[],N.length),F=0;F<G;F++){var H=N[F],H=a.call(this,H,u);p[I].push(H)}else this._isComposite(h)?(v=d,m=a.call(this,k,u),p[v]=m):(v=d,Y.call(this,v,k,u,p))}return p;function Y(_,K,tt,b){for(var vt in b[_]={},K){var O=K[vt],vt=M.call(this,vt,tt);b[_][vt]=O}function M(T,j){for(var f=this.pathWildcard||this.DEFAULT_PATH_WILDCARD,x=[],C=0,D=T.split("/"),Z=D.length,it=0;it<Z;it++){var st=D[it];st===f&&(st=j[C]||f,C+=1),x.push(st)}return x.join("/")}}}function l(h,u,d){for(var p,m=d.pathWildcard,v=d.comparisonWildcard,k=[],I=u.length,N=h.length,G=0;G<N;G++){var F=h[G],H=(p=F,Array.isArray(p)?p:p.split("/")),Y=H.length;if(Y===I){for(var _=!0,K=[],tt=[],b=0;b<Y;b++){var vt=H[b],O=u[b],M=vt===m,T=O===v;if(vt!==O&&!M&&!T){_=!1;break}M?K.push(O):T&&tt.push(vt)}_&&k.push({path:F,pathWildcardValues:K,comparisonWildcardValues:tt})}}return k}(function(h,d){var d=d.split("/"),p=this.pathWildcard||this.DEFAULT_PATH_WILDCARD;return l(h,d,{pathWildcard:p})}).call(this,n,t).forEach(function(h){h=h.path,kt(i[h]).forEach(function(m){var d,p=m.path,m=m.expression,v=e._getBareExpression(m),k=e._getExpressionExtras(m);m=o,p=p,(Array.isArray(p)?(d=p).indexOf(null)!==-1?l(m,d,{comparisonWildcard:null}):[{path:d.join("/"),pathWildcardValues:[],comparisonWildcardValues:[]}]:[{path:p,pathWildcardValues:[],comparisonWildcardValues:[]}]).forEach(function(H){var N=H.path,H=H.comparisonWildcardValues,G=r[N],Y=G.closest(".field"),F=Y.hasClass("hidden"),H=a.call(e,v,H),H=e.isExpressionValid(H),Y=(Y.toggleClass("hidden",!H),k.otherwise);Y&&Y.unset&&e.options.live&&(H?F&&e.updateCell(G,N):(e.unsetProperty(N),(Y=function(_,K){var tt=_[K];if(tt==null)for(var b=K.split("/"),vt=b.length,O=b[0],M=tt=_[O],T=1;T<vt;T++){var j=b[T];if(tt===void 0)tt=(M===void 0?_:M)[O+="/"+j];else{if((M=tt).type==="object"&&tt.properties)tt=tt.properties[j];else if(tt.type==="list"&&tt.item)tt=tt.item;else{if(typeof tt.type=="string")break;tt=tt[j]}O=j}}return tt}(s,N))&&e.renderTemplate(null,Y,N,{replace:!0,hidden:!0}),e.afterPartialRender([N])))},e)},e)},this)},unsetProperty:function(t,e){(e=e||{}).inspector=this.cid,e["inspector_"+this.cid]=!0,this.getModel().removeProp(t,e)},getOptions:function(t){if(t.length!==0)return t=t.attr("data-attribute"),this.getOptionsFromPath(t)},markForRemoval:function(t,e){var i=this.findParentListByPath(t);i&&(t=t.substr(i.length+1),t=parseInt(t,10),Number.isFinite(t)&&(e.remove[i]=e.remove[i]||[],e.remove[i].includes(t)||e.remove[i].push(t)))},markForUpdate:function(t,e,i,n){t=t.substr(n.length+1),e.update[n]&&Qr(e.update[n].value,t,i,"/")},updateCell:function(t,e,i){var n=this.getModel(),r={},o=(t?r[e]=P(t):r=this._byPath,this.startBatchCommand(),{}),s={update:{},remove:{}};Se(r,(function(a,l){if(!a.closest(".field").hasClass("hidden")){var h,u,d,p,m=a.attr("data-type"),v=a.attr("data-overwrite"),k=v!=="false"&&v!==void 0,I=a.hasClass("remove");switch(m){case"list":case"object":I&&this.markForRemoval(l,s);break;default:this.validateInput(m,a[0],l)&&(h=this.getFieldValue(a[0],m),h=this.parse(m,h,a[0]),(u=this.getOptionsFromPath(l)).valueRegExp&&(h=(Vi(n.attributes,l,"/")||u.defaultValue).replace(new RegExp(u.valueRegExp),"$1"+h+"$3")),I?this.markForRemoval(l,s):(u=u.parent)&&u.type==="object"&&u.overwrite!==void 0&&u.overwrite!==!1?((d={})[(p=l.split("/"))[p.length-1]]=h,s.update[u.path]={value:d,overwrite:!0}):o[l]={value:h,overwrite:k})}}}).bind(this)),Se(o,(function(a,l){this.setProperty(l,a.value,ct({overwrite:a.overwrite},i))}).bind(this)),vi(Object.keys(s.remove),function(a){return a.split("/").length}).reverse().forEach((function(a){var l=s.remove[a];this.removeProperty(a,l,ct({rewrite:!0},i))}).bind(this)),Se(s.update,(function(a,l){this.setProperty(l,this.compactDeep(a.value),ct({rewrite:!0,overwrite:a.overwrite},i))}).bind(this)),this.updateFieldsVisibility(),this.updateGroupsVisibility(),this.stopBatchCommand()},compactDeep:function(t){return Array.isArray(t)?t.reduce((function(e,i){return i&&e.push(this.compactDeep(i)),e}).bind(this),[]):t},findParentListByPath:function(t){for(var e=t.split("/"),i=(e.pop(),e);i.length;){var n=this.getOptionsFromPath(i.join("/"));if(n&&n.type==="list")return e.slice(0,i.length).join("/");i.pop()}return null},getOptionsFromPath:function(t){for(var e,i=t.split("/"),n=this.expandAttributes,r=[];i.length;){var o=s;n&&n.type==="object"?s="properties":(s=i.shift(),!i.length&&n.type!=="list"||(e=n,r.push(s)));var s=!Number.isNaN(parseInt(s))&&n.type==="list"?"item":s;if(Object(n)!==n||!(s in n||n[t]))return{};n=n[s]||n[t]}return n=ct({},n),(e=ct({},e)).path=r.join("/"),o&&o==="properties"&&(e.type="object"),n.parent=e,n},getFieldValue:function(t,e){if(Rt(this.options.getFieldValue)){var i=this.options.getFieldValue(t,e,this);if(i)return i.value}var n=P(t);switch(e){case"select-box":case"color-palette":case"select-button-group":var r=n.attr("data-attribute");return this.widgets[r].getSelectionValue();case"radio-group":return this.widgets[n.attr("data-attribute")].currentValue;case"content-editable":return n.html().replace(/((<br\s*\/*>)?<\/div>)|(((&nbsp;)|(<br\s*\/*>))?<\/p>)|(<br\s*\/*>)/gi,`
`).replace(/(<([^>]+)>)/gi,"").replace(/&(\w+);/gi,this.replaceHTMLEntity).replace(/\n$/,"");default:return n.val()}},removeProperty:function(t,e,i){var n,r=this.getModel(),o=bi.prototype.prop,s=o.call(r,t);s&&(s=s.reduce(function(a,l,h){return e.includes(h)||a.push(l),a},[]),n=this.flatAttributes[t],Array.isArray(s)&&s.length===0&&!n&&(s=null),o.call(r,t,s,i))},setProperty:function(t,e,i){(i=i||{}).inspector=this.cid;var n,r,o=bi.prototype.prop,s=this.getModel(),a=i.overwrite||!1;i.previewDone&&o.call(s,t,i.originalValue,{rewrite:!0,silent:!0}),e===void 0?bi.prototype.removeProp.call(s,t,i):(r=Dt(e)&&!a?(n=o.call(s,t),r=Array.isArray(e)?[]:{},ze(r,n,e)):ot(e),a&&(i.rewrite=!0),o.call(s,t,r,i))},parse:function(t,e,i){switch(t){case"number":case"range":e=parseFloat(e);break;case"toggle":e=i.checked}return e},startBatchCommand:function(){var t;this.inBatch||(this.inBatch=!0,(t=this.getModel())instanceof bi&&t.startBatch("inspector",{cid:this.cid}))},stopBatchCommand:function(){var t;this.inBatch&&((t=this.getModel())instanceof bi&&t.stopBatch("inspector",{cid:this.cid}),this.inBatch=!1)},afterRender:function(){this.cacheInputs(),this.updateFieldsVisibility(),this.updateGroupsVisibility(),this.sourceService.initSources(),this.trigger("render")},afterPartialRender:function(t){var e=this;this.cacheInputs(),this.updateGroupsVisibility(),this.sourceService.initSources(),t&&t.forEach(function(i){e.dependencyService.changed(i)}),this.trigger("render")},addListItem:function(e){var e=P(e.target).parent("[data-attribute]"),i=this.getOptions(e),n=e.children(".list-items"),r=n.children(".list-item"),s=r.last(),s=(s.length===0?-1:parseInt(s.attr("data-index"),10))+1,o=this.renderListItem({index:s,options:i}),s=e.attr("data-attribute")+"/"+s;this.renderTemplate(o,i.item,s),n.append(o),n=(r=n.children(".list-item")).not(".remove").length,this.fixListButtons(e,n,i.min,i.max),this.afterPartialRender([s]),r=o[0],i.item.type!=="object"&&i.item.type!=="list"&&(r=r.querySelector("[data-attribute]")),this.options.live&&this.updateCell(),this._focusFieldInternal(i.item,s,r)},deleteListItem:function(n){var n=P(n.target),e=n.closest("[data-attribute]"),i=this.getOptions(e),n=n.closest(".list-item");n.hide(),n.addClass("remove"),n.find("[data-field]").each(function(){P(this).hide().addClass("remove")}),n.find("[data-attribute]").each(function(){P(this).hide().addClass("remove")}),n=e.children(".list-items").children(".list-item").not(".remove").length,this.fixListButtons(e,n,i.min,i.max),n=e.attr("data-attribute"),this.afterPartialRender([n]),this.options.live&&this.updateCell()},fixListButtons:function(t,e,i,n){var r=t.children(".btn-list-add");o=e,typeof(n=n)!="number"||typeof o!="number"||o<n?r.removeClass("hidden"):r.addClass("hidden");var o=t.children(".list-items").children(".list-item").children(".btn-list-del");n=e,typeof(r=i)!="number"||r<=0||!(typeof n!="number"||n<=0)&&r<n?o.removeClass("hidden"):o.addClass("hidden")},bindDocumentEvents:function(){var t=this.getEventNamespace();this.$document.on("mouseup"+t+" touchend"+t,this.pointerup)},unbindDocumentEvents:function(){this.$document.off(this.getEventNamespace())},pointerdown:function(t){t.stopPropagation(),this.bindDocumentEvents(),this.startBatchCommand(),this._$activeField=P(t.currentTarget).addClass("is-in-action")},pointerup:function(){this.unbindDocumentEvents(),this.stopBatchCommand(),this._$activeField&&(this._$activeField.removeClass("is-in-action"),this._$activeField=null)},pointerfocusin:function(t){t.stopPropagation(),P(t.currentTarget).addClass("is-focused")},pointerfocusout:function(t){t.stopPropagation(),P(t.currentTarget).removeClass("is-focused")},onRemove:function(){this.unbindDocumentEvents(),this.removeWidgets(),this===this.constructor.instance&&(this.constructor.instance=null)},removeWidgets:function(){var t,e=this.widgets;for(t in e)e[t].remove();this.widgets={}},onGroupLabelClick:function(t){t.preventDefault(),this.options.multiOpenGroups||this.closeGroups(),t=P(t.target).closest(".group"),this.toggleGroup(t)},toggleGroup:function(t){t=Ft(t)?this.$('.group[data-name="'+t+'"]'):P(t),t.hasClass("closed")?this.openGroup(t):this.closeGroup(t)},closeGroup:function(t,e){e=e||{},t=Ft(t)?this.$('.group[data-name="'+t+'"]'):P(t),!e.init&&t.hasClass("closed")||(t.addClass("closed"),this.trigger("group:close",t.data("name"),e))},openGroup:function(t,e){e=e||{},t=Ft(t)?this.$('.group[data-name="'+t+'"]'):P(t),(e.init||t.hasClass("closed"))&&(t.removeClass("closed"),this.trigger("group:open",t.data("name"),e))},closeGroups:function(){for(var t=0,e=this.$groups.length;t<e;t++)this.closeGroup(this.$groups[t])},openGroups:function(){for(var t=0,e=this.$groups.length;t<e;t++)this.openGroup(this.$groups[t])},COMPOSITE_OPERATORS:["not","and","or","nor"],PRIMITIVE_OPERATORS:["eq","ne","regex","text","lt","lte","gt","gte","in","nin","equal"],_isComposite:function(t){return 0<Dh(this.COMPOSITE_OPERATORS,Object.keys(t)).length},_isPrimitive:function(t){var e=Object.keys(this.options.operators).concat(this.PRIMITIVE_OPERATORS);return 0<Dh(e,Object.keys(t)).length},_evalCustomPrimitive:function(t,e,i,n){return!!this.options.operators[t].apply(this,[this.getModel(),e].concat(i).concat([n]))},_evalPrimitive:function(t){return Object.keys(t).reduce((function(e,i){var n=t[i];return Object.keys(n).reduce((function(r,o){var s=n[o],a=this.getCellAttributeValue(o);if(Rt(this.options.operators[i]))return this._evalCustomPrimitive(i,a,s,o);switch(i){case"eq":return s==a;case"ne":return s!=a;case"regex":return new RegExp(s).test(a);case"text":return!s||Ft(a)&&-1<a.toLowerCase().indexOf(s);case"lt":return a<s;case"lte":return a<=s;case"gt":return s<a;case"gte":return s<=a;case"in":return Array.isArray(s)&&s.includes(a);case"nin":return Array.isArray(s)&&!s.includes(a);case"equal":return yt(s,a);default:return r}}).bind(this),!1)}).bind(this),!1)},_evalExpression:function(t){if(this._isPrimitive(t))return this._evalPrimitive(t);if(this._isComposite(t))return Object.keys(t).reduce((function(e,i){var n=t[i];if(i=="not")return!this._evalExpression(n);var r=kt(n).map(this._evalExpression,this);switch(i){case"and":return r.every(function(o){return!!o});case"or":return r.some(function(o){return!!o});case"nor":return!r.some(function(o){return!!o});default:return e}}).bind(this),!1);throw new Error('Inspector: Invalid custom operator used in an expression. The operator "'+Object.keys(t)[0]+'" must be registered in the `operators` property.')},_getBareExpression:function(t){return ai(t,"otherwise","dependencies")},_getExpressionExtras:function(t){return{otherwise:ot(t.otherwise),dependencies:ot(t.dependencies)}},_extractVariables:function(t){return Array.isArray(t)||this._isComposite(t)?kt(t).reduce((function(e,i){return e.concat(this._extractVariables(i))}).bind(this),[]):kt(t).reduce(function(e,i){return Object.keys(i)},[])},isExpressionValid:function(t){return t=this._getBareExpression(t),this._evalExpression(t)},extractExpressionPaths:function(i){var e=i&&i.dependencies||[],i=this._getBareExpression(i);return J(this._extractVariables(i).concat(e))},getGroupsStateKey:function(){if(Rt(this.options.stateKey))return this.options.stateKey(this.getModel());throw new Error("Inspector: Option stateKey must be a function")},storeGroupsState:function(){var t=this.getGroupsStateKey(),e=kt(this.$(".group.closed"));Ea.groupStates[t]=e.map(function(i){return P(i).attr("data-name")})},getGroupsState:function(){return Ea.groupStates[this.getGroupsStateKey()]},restoreGroupsState:function(){function t(i,n){Se(n.options.groups,(function(r,o){i(r,o)?this.closeGroup(o):this.openGroup(o)}).bind(n))}var e=this.getGroupsStateKey();Ea.groupStates[e]?t(function(i,n){return Ea.groupStates[e].includes(n)},this):t(function(i){return i.closed},this)}},{groupStates:{},instance:null,create:function(t,e){Jt(e=e||{},{updateCellOnClose:!0,restoreGroupsState:!0,storeGroupsState:!0});var i=e.cell||e.cellView.model,n=this.instance;return n&&n.getModel()===i||(n&&n.el.parentNode&&(e.storeGroupsState&&n.storeGroupsState(),e.updateCellOnClose&&n.updateCell(),n.trigger("close"),n.remove()),n=new this(e).render(),this.instance=n,P(t).html(n.el),e.restoreGroupsState&&n.restoreGroupsState()),n},close:function(){var t,e=this.instance;e&&(t=document.activeElement,P.contains(e.el,t)&&t.blur(),e.trigger("close"),e.remove())}})),Ps=(ct(sn.prototype,R.Events),sn.prototype.on=function(t,e,i){return R.Events.on.call(this,this.normalizeEvent(t),e,i),this},sn.prototype.off=function(t,e,i){return t=t?this.normalizeEvent(t):null,R.Events.off.call(this,t,e,i),this},sn.prototype.normalizeEvent=function(t){if(typeof t!="object")return this.normalizeShortcut(t);for(var e=Object.keys(t),i={},n=0,r=e.length;n<r;n++){var o=e[n];i[this.normalizeEvent(o)]=t[o]}return i},sn.prototype.normalizeShortcut=function(t){var e=t.toLowerCase();if(e in Ic)return Ic[e];for(var i=this.parser.toEventObjectList(t),n=[],r=0;r<i.length;r++)n.push(this.hash(i[r]));return n.join(" ")},sn.prototype.enable=function(){window.addEventListener?(document.addEventListener("keydown",this.handleKey,!1),document.addEventListener("keypress",this.handleKey,!1),document.addEventListener("keyup",this.handleKey,!1)):window.attachEvent&&(document.attachEvent("keydown",this.handleKey,!1),document.attachEvent("keypress",this.handleKey,!1),document.attachEvent("keyup",this.handleKey,!1))},sn.prototype.disable=function(){window.removeEventListener?(document.removeEventListener("keydown",this.handleKey,!1),document.removeEventListener("keypress",this.handleKey,!1),document.removeEventListener("keyup",this.handleKey,!1)):window.detachEvent&&(document.detachEvent("keydown",this.handleKey,!1),document.detachEvent("keypress",this.handleKey,!1),document.detachEvent("keyup",this.handleKey,!1))},sn.prototype.isActive=function(t,e){return this.isModifierActive(t,e)},sn.prototype.isModifierActive=function(t,e){for(var i=this.parser.toEventObjectList(t),n=0;n<i.length;n++)if(i[n].modifiersCompare(e))return!0;return!1},sn.prototype.isKeyPrintable=function(t){return!!t&&!!(t=t.key)&&(t.length===1||t==="Unidentified")},sn.prototype.hash=function(t){function e(i){return i?1:0}return[t.type,":",t.which,e(t.shiftKey),e(t.ctrlKey),e(t.altKey),e(t.metaKey)].join("")},sn.prototype.handleKey=function(t){var e=this.options.filter;if(typeof e=="function"){if(!e.call(this,t,this))return}else if(this.isConsumerElement(t))return;e=Ls.fromNative(t),R.Events.trigger.call(this,this.hash(e),t),this.isKeyPrintable(t)&&R.Events.trigger.call(this,t.type+":printable",t)},sn.prototype.isConsumerElement=function(i){var e,i=i.target||i.srcElement;return!!i&&((e=i.tagName.toUpperCase())==="INPUT"||e==="SELECT"||e==="TEXTAREA"||i.isContentEditable)},function(){}),Ig=(Ps.prototype={constructor:Ps,parseEventString:function(t){for(var e=(t=t||"").split("+"),i=new Ls(0),n=0;n<e.length;n++){var r=e[n],o=this.getModifierPropertyName(r);o&&(i[o]=!0),e.length!==1&&o!==void 0||(i.which=Ps.getCode(r))}return i},toEventObjectList:function(t){return t.replace(/\s*\+\s*/gi,"+").split(" ").map(this.composeEventObject,this)},composeEventObject:function(t){var e=t.split(":"),i=so.KEYDOWN,n=e[0];if(1<e.length&&(n=e[1],i=e[0]),dm.indexOf(i)===-1)throw t+": invalid shortcut definition-page";return e=this.parseEventString(n),i===so.KEYUP&&Es[e.which]&&(e[Es[e.which]]=!1),e.setType(i)},getModifierPropertyName:function(t){return t=Ig[t],Es[t]}},Ps.getCode=function(t){return Mg[t]||t.toUpperCase().charCodeAt(0)},{"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91,meta:91}),Es={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"},Cc={226:"\\",57392:"ctrl",63289:"num",59:";",61:"=",173:"-"},Mg={backspace:8,tab:9,shift:16,ctrl:17,alt:18,meta:91,clear:12,enter:13,return:13,esc:27,escape:27,capslock:20,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,insert:45,ins:45,pageup:33,pagedown:34,plus:187,minus:189,"-":189,",":188,".":190,"/":191,"`":192,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123},Ic={all:"all",printable:"keypress:printable","keypress:printable":"keypress:printable","keydown:printable":"keydown:printable","keyup:printable":"keyup:printable"},so=(ct(sn,{keyMap:Mg,modifierMap:Es,modifiers:Ig,charCodeAlternatives:Cc,eventNamesMap:Ic}),{KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup"}),dm=[so.KEYPRESS,so.KEYDOWN,so.KEYUP],Ls=function(t,e,i,n,r,o){this.which=t,this.shiftKey=e||!1,this.ctrlKey=i||!1,this.altKey=n||!1,this.metaKey=r||!1,this.type=o||so.KEYDOWN},Ri=(Ls.fromNative=function(t){var e=t.which,i=(t.type===so.KEYPRESS&&(e=String.fromCharCode(t.which).toUpperCase().charCodeAt(0)),Cc[e]&&(e=Ps.getCode(Cc[e])),new Ls(e,t.shiftKey,t.ctrlKey,t.altKey,t.metaKey,t.type));return t.type===so.KEYUP&&Es[e]&&(i[Es[e]]=!1),i},Ls.prototype.modifiersCompare=function(t){return!(this.shiftKey&&this.shiftKey!==t.shiftKey||this.ctrlKey&&this.ctrlKey!==t.ctrlKey||this.altKey&&this.altKey!==t.altKey||this.metaKey&&this.metaKey!==t.metaKey)},Ls.prototype.setType=function(t){return this.type=t,this},an.extend({className:an.prototype.className+" lightbox",options:ze({},an.prototype.options,{closeButton:!0,modal:!0,downloadable:!1,downloadAction:"download",fileName:"Image",closeAnimation:{delay:2e3,duration:200,easing:"swing",properties:{opacity:0}},top:100,windowArea:.8,openAnimation:!1}),init:function(){var t,e=arguments,i=this;yi(this,"startCloseAnimation","positionAndScale"),an.prototype.init.apply(this,arguments),this.options.image&&(this.$image=P("<img/>").on("load",this.positionAndScale),this.options.content=this.$image),this.options.downloadable&&(t={action:this.options.downloadAction,content:"Download",position:"center"},this.buttons=Array.isArray(this.buttons)?this.buttons.slice():[],this.buttons.push(t)),this.on("action:"+this.options.downloadAction,this.download),P(window).on("resize",this.positionAndScale),this.on("close:animation:complete",function(){an.prototype.close.apply(i,e)})},open:function(){return an.prototype.open.apply(this,arguments),this.$image&&this.$image.attr("src",this.options.image),this.positionAndScale(),this.startOpenAnimation(),this},positionAndScale:function(){var t=this.$(".fg"),e=this.$(".body > img"),i=this.$(".titlebar"),n=this.$(".controls"),o=this.options.windowArea,r=window.innerWidth*o,s=(this.$el.css("margin-top",this.options.top),i.css("width",r),i.height()),a=n.height(),o=window.innerHeight*o-this.options.top-s-a,s=(t.css({width:r,height:o}),e.width()),a=e.height();t.css({width:s,height:a}),i.css("width","auto"),i.hasClass("empty")||n.css("top",i.outerHeight())},download:function(){Gh(this.options.image,(function(t,e){Wu(e,this.options.fileName)}).bind(this))},close:function(){return this.options.closeAnimation?this.startCloseAnimation():an.prototype.close.apply(this,arguments),this},onRemove:function(){an.prototype.onRemove.apply(this,arguments),P(window).off("resize",this.positionAndScale),this.$image&&this.$image.off("load",this.positionAndScale)},startCloseAnimation:function(){this.$el.animate(this.options.closeAnimation.properties,ct({complete:(function(){this.trigger("close:animation:complete")}).bind(this)},this.options.closeAnimation))},startOpenAnimation:function(){this.$el.animate(ct({},this.options.openAnimation.properties,{height:this._foregroundHeight}),ct({complete:(function(){this.trigger("open:animation:complete")}).bind(this)},this.options.openAnimation))}})),Xi=ke.extend({className:"navigator",events:{mousedown:"startAction",touchstart:"startAction"},documentEvents:{mousemove:"doAction",touchmove:"doAction",mouseup:"stopAction",touchend:"stopAction"},options:{paperConstructor:ki,paperOptions:{},zoomOptions:null,zoom:{min:.5,max:2},width:300,height:200,padding:10},init:function(){this.options.zoomOptions?this.options.zoom=ct({},this.options.zoom,this.options.zoomOptions):this.options.zoom&&(this.options.zoom=Jt({},this.options.zoom,this.constructor.prototype.options.zoom)),yi(this,"updateCurrentView","doAction","stopAction","scrollTo"),this.updateCurrentView=Vn(this.updateCurrentView,0);var t=this.options.paperScroller,t=this.sourcePaper=t.options.paper;this.toggleUseContentBBox(this.options.useContentBBox),this.targetPaper=new this.options.paperConstructor(ze({model:t.model,interactive:!1,frozen:!0},this.options.paperOptions))},startListening:function(){var t=this,n=this.options,e=this.sourcePaper,i=n.useContentBBox,n=n.paperScroller;i?this.listenTo(e,"render:done",function(){return t.updatePaper()}):this.listenTo(e,"resize",function(){return t.updatePaper()}),this.listenTo(n,"scroll",function(){return t.updateCurrentView()})},render:function(){var t;return this.targetPaper.$el.appendTo(this.el),this.targetPaper.unfreeze(),this.$currentView=P("<div>").addClass("current-view"),this.options.zoom&&(t=P("<div>").addClass("current-view-control"),this.$currentView.append(t)),this.$el.append(this.$currentView).css({width:this.options.width,height:this.options.height,padding:this.options.padding}),this.updatePaper(),this},freeze:function(t){this.targetPaper.freeze(t)},unfreeze:function(t){this.targetPaper.unfreeze(t)},CONTENT_BBOX_CLASS_NAME:"navigator-use-content-bbox",NO_CONTENT_CLASS_NAME:"navigator-no-content",toggleUseContentBBox:function(t){var e=this.CONTENT_BBOX_CLASS_NAME,i=this.$el,n=this.targetPaper;this.options.useContentBBox=t=t===void 0?!1:t,this.stopListening(),this.startListening(),i.toggleClass(e,!!t),n&&this.updatePaper()},updatePaper:function(){var r=this.sourcePaper,t=this.targetPaper,n=this.options,e=this.$el,i=this.NO_CONTENT_CLASS_NAME,n=n.useContentBBox,n=n?r.getContentBBox(n):r.getComputedSize(),r=e.hasClass(i);0<n.width&&0<n.height?(r&&(e.removeClass(i),t.unfreeze({key:"navigator"})),this.updatePaperWithBBox(n),this.updateCurrentView()):r||(e.addClass(i),t.freeze({key:"navigator"}))},updatePaperWithBBox:function(m){var e,i,n,r,o,s,a,l,h,u=m.width,d=m.height,p=m.x,m=(p===void 0&&(p=0),m.y);m===void 0&&(m=0),u&&d&&(o=this.sourcePaper,e=this.targetPaper,a=this.options,i=(o=o.matrix()).a,n=o.d,r=o.e,o=o.f,l=a.padding,h=a.preserveAspectRatio,s=(a.width-2*l)/(u/=i),a=(a.height-2*l)/(d/=n),(h=h===void 0?!0:h)&&(a=s=Math.min(s,a)),l=(r-p)*(this.ratioX=s)/i,h=(o-m)*(this.ratioY=a)/n,e.setDimensions(u*=s,d*=a),e.setOrigin(l,h),e.scale(s,a))},updateCurrentView:function(){var t,e,i,n,r,o,s;this.$currentView&&(t=this.ratioX,e=this.ratioY,i=this.sourcePaper.scale(),r=(n=this.options.paperScroller).clientToLocalPoint(0,0),o=this.targetPaper.$el.position(),(s=this.targetPaper.translate()).ty=s.ty||0,this.currentViewGeometry={top:o.top+r.y*e+s.ty,left:o.left+r.x*t+s.tx,width:n.$el.innerWidth()*t/i.sx,height:n.$el.innerHeight()*e/i.sy},this.$currentView.css(this.currentViewGeometry))},startAction:function(t){var e=(t=Tt(t)).clientX,i=t.clientY,n=t.target.classList.contains("current-view-control"),n=(!n&&!t.target.classList.contains("current-view")&&this.scrollTo(t),n?"zooming":"panning"),s=this.options,r=this.currentViewGeometry,o=this.sourcePaper,s=s.paperScroller;switch(this.delegateDocumentEvents(null,{action:n,startClientX:e,startClientY:i,startScrollLeft:s.el.scrollLeft,startScrollTop:s.el.scrollTop,startZoom:s.zoom(),startGeometry:r,startScale:o.scale()}),n){case"panning":this.trigger("pan:start",t);break;case"zooming":this.trigger("zoom:start",t)}},doAction:function(o){var e=(o=Tt(o)).clientX,i=o.clientY,n=o.data,r=this.sourcePaper,o=this.options,s=this.ratioX,a=this.ratioY,l=n.action,h=n.startClientX,u=n.startClientY,d=n.startScrollLeft,p=n.startScrollTop,m=n.startZoom,v=n.startGeometry,k=n.startScale,I=n.frameId,N=o.paperScroller,G=o.zoom;switch(l){case"panning":var H=r.scale(),F=H.sx,H=(i-u)*H.sy;N.el.scrollLeft=d+(e-h)*F/s,N.el.scrollTop=p+H/a;break;case"zooming":var Y=1+(h-e)/v.width/k.sx;ys(I),n.frameId=vs(function(){N.zoom(Y*m,Jt({absolute:!0},G))})}},stopAction:function(t){switch(this.undelegateDocumentEvents(),t.data.action){case"panning":this.trigger("pan:stop",t);break;case"zooming":this.trigger("zoom:stop",t)}},scrollTo:function(i){i=Tt(i);var i=this.targetPaper.clientToLocalPoint({x:i.clientX,y:i.clientY}),e=i.x,i=i.y,n=this.options.paperScroller,r=n.zoom();n.scroll(e*r,i*r)},onRemove:function(){this.targetPaper.remove()}}),La=(Zo.prototype.initialize=function(){this._dragLastX=0,this._dragLastY=0,this._dragDeltaX=0,this._dragDeltaY=0,this._dragLastDeltaX=0,this._dragLastDeltaY=0,this._velocityX=0,this._velocityY=0,this._requestAnimationFrameId=-1},Zo.prototype.approxZero=function(t){return Math.abs(t)<.5},Zo.prototype.updateVelocity=function(){var t=this._velocityX,e=this._velocityY,i=this._isDragging,n=this.options,r=this.onInertiaMove;!i&&this.approxZero(t)&&this.approxZero(e)?this.initialize():(this._requestAnimationFrameId=vs(this.updateVelocity.bind(this)),i?(this._dragLastDeltaX=this._dragDeltaX,this._dragLastDeltaY=this._dragDeltaY,this._dragDeltaX=this._dragLastX,this._dragDeltaY=this._dragLastY,this._velocityX=this._dragDeltaX-this._dragLastDeltaX,this._velocityY=this._dragDeltaY-this._dragLastDeltaY):(i=t,t=e,e=n.friction,this._velocityX*=e,this._velocityY*=e,typeof r=="function"&&r(i,t)))},Zo.prototype.handleDragStart=function(t){this._isDragging=!0,ys(this._requestAnimationFrameId),this.initialize(),this._dragLastX=t.clientX,this._dragLastY=t.clientY,this._dragDeltaX=t.clientX,this._dragDeltaY=t.clientY,this.updateVelocity()},Zo.prototype.handleDragMove=function(t){this._dragLastX=t.clientX,this._dragLastY=t.clientY},ke.extend({className:"paper-scroller",events:{scroll:"onScroll"},options:{paper:void 0,padding:function(){var t=this.getClientSize(),e=Math.max(this.options.minVisiblePaperSize,1)||1,i={};return i.left=i.right=Math.max(t.width-e,0),i.top=i.bottom=Math.max(t.height-e,0),i},scrollWhileDragging:!(Zo.prototype.handleDragEnd=function(t){this._isDragging=!1}),minVisiblePaperSize:50,autoResizePaper:!1,baseWidth:void 0,baseHeight:void 0,contentOptions:void 0,cursor:"default",inertia:!1,borderless:!1},_padding:{left:0,top:0},init:function(){var t=this,e=(yi(this,"startPanning","stopPanning","pan","onBackgroundEvent"),this.options),i=this.el,n=e.paper,r=e.autoResizePaper,o=e.scrollWhileDragging,s=e.cursor,a=e.inertia,l=e.baseWidth,h=e.baseHeight,d=n.scale(),d=(this._sx=d.sx,this._sy=d.sy,n.options),u=d.width,d=d.height;if(!Number.isFinite(u)||!Number.isFinite(d))throw new Error("PaperScroller: paper dimension must be a number");l===void 0&&(e.baseWidth=u),h===void 0&&(e.baseHeight=d),this.$background=P("<div/>").addClass("paper-scroller-background").css({width:n.options.width,height:n.options.height}).append(n.el).appendTo(i),this.listenTo(n,"scale",this.onScale).listenTo(n,"resize",this.onResize).listenTo(n,"beforeprint beforeexport",this.storeScrollPosition).listenTo(n,"afterprint afterexport",this.restoreScrollPosition),r&&this.listenTo(n,"render:done",this.onPaperRenderDone),o&&(this.listenTo(n,"cell:pointermove",this.onCellPointermove),this.listenTo(n,"cell:pointerup",this.onCellPointerup)),this.debouncedStoreCenter=Vn(function(){return t.storeCenter()}),this.storeCenter(n.options.width/2,n.options.height/2),this.delegateBackgroundEvents(),this.setCursor(s),a&&(this.inertia=new Zo((function(p,m){var v=this.el;v.scrollTop-=m,v.scrollLeft-=p}).bind(this),a)),l=new ResizeObserver(function(){return t.storeCenter()}),l.observe(i),this.resizeObserver=l},onCellPointermove:function(t,e,i,n){var r=this.options.scrollWhileDragging;r&&this.scrollWhileDragging(e,i,n,r)},onCellPointerup:function(t,e){this.stopScrollWhileDragging(e)},scrollWhileDragging:function(t,e,i,s){var r=this.el,o=(s=s===void 0?{}:s).interval,d=(o===void 0&&(o=25),s.padding),s=(d===void 0&&(d=-20),s.scrollingFunction);s===void 0&&(s=function(m){return m<20?5:20});var a=this.eventData(t).scrollId,l=new Q(e,i),d=ti(d),h=d.top,p=d.left,u=d.right,d=d.bottom,p=this.getVisibleArea().moveAndExpand({x:-p,y:-h,width:p+u,height:h+d});p.containsPoint(l)?(clearInterval(a),this.eventData(t,{scrollId:null})):(u=p.pointNearestToPoint(l).distance(l),h=s.call(this,u,t),d=p.x,l=p.y,s=p.width,u=p.height,this.eventData(t,{scrollX:e<d?-1:d+s<e?1:0,scrollY:i<l?-1:l+u<i?1:0,scrollPerTick:h,container:r}),a||(p=this.eventData(t),a=setInterval(function(N){var v=N.scrollPerTick,k=N.scrollX,I=N.scrollY,N=N.container;N.scrollLeft+=v*k,N.scrollTop+=v*I},o,p),p.scrollId=a))},stopScrollWhileDragging:function(t){t=this.eventData(t).scrollId,t&&clearInterval(t)},onPaperRenderDone:function(t){t.priority<2&&this.adjustPaper()},lock:function(){return this.$el.css("overflow","hidden"),this},unlock:function(){return this.$el.css("overflow","scroll"),this},setCursor:function(t){return t==="grab"?this.$el.css("cursor",""):this.$el.css("cursor",t),this.$el.attr("data-cursor",t),this.options.cursor=t,this},delegateBackgroundEvents:function(t){t=t||Fe(this.options.paper,"events");var e=this.paperEvents=Object.keys(t||{}).reduce((function(i,n){var r=t[n];return n.indexOf(" ")===-1&&(i[n]=Rt(r)?r:this.options.paper[r]),i}).bind(this),{});return Object.keys(e).forEach(function(i){this.delegate(i,{guarded:!1},this.onBackgroundEvent)},this),this},onBackgroundEvent:function(t){this.$background.is(t.target)&&(t=this.paperEvents[t.type],Rt(t)&&t.apply(this.options.paper,arguments))},onScroll:function(t){this.trigger("scroll",t),this.debouncedStoreCenter()},onResize:function(){this.restoreCenter()},onScale:function(t,e,i,n){this.adjustScale(t,e),this._sx=t,this._sy=e,(i||n)&&this.center(i,n),t=this.options,e=t.contentOptions,i=t.borderless,typeof e!="function"&&!i||this.adjustPaper()},storeScrollPosition:function(){this._scrollLeftBeforePrint=this.el.scrollLeft,this._scrollTopBeforePrint=this.el.scrollTop},restoreScrollPosition:function(){this.el.scrollLeft=this._scrollLeftBeforePrint,this.el.scrollTop=this._scrollTopBeforePrint,this._scrollLeftBeforePrint=null,this._scrollTopBeforePrint=null},beforePaperManipulation:function(){(_n.test("msie")||_n.test("msedge"))&&this.$el.css("visibility","hidden")},afterPaperManipulation:function(){(_n.test("msie")||_n.test("msedge"))&&this.$el.css("visibility","visible")},clientToLocalPoint:function(t,e){var i=this.options.paper.matrix();return t=(t+=this.getLTRScrollLeft()-this._padding.left-i.e)/i.a,e=(e+=this.el.scrollTop-this._padding.top-i.f)/i.d,new Q(t,e)},localToBackgroundPoint:function(i,n){var i=new Q(i,n),n=this.options.paper.matrix(),r=this._padding;return X.transformPoint(i,n).offset(r.left,r.top)},getPadding:function(){var t=this.options.padding;return Rt(t)&&(t=t.call(this,this)),ti(t)},computeRequiredPadding:function(s){var r=this.options.paper.scale(),n=r.sx,r=r.sy,i=this.getCenter(),e=i.x,i=i.y,n=(e*=n,i*=r,s.x),r=s.y,o=n+s.width,s=r+s.height,l=this.getClientSize(),a=l.width/2,l=l.height/2,p=this.getPadding(),h=p.left,u=p.right,d=p.top,p=p.bottom;return{left:Math.max(a-h-e+n,0)+h,right:Math.max(a-u+e-o,0)+u,top:Math.max(l-d-i+r,0)+d,bottom:Math.max(l-p+i-s,0)+p}},addPadding:function(){var t,e,i,n,r=this.options,s=r.borderless,r=r.paper,o=(s?t=e=i=n=0:(o=(s=r.scale()).sx,s=s.sy,a=r.getArea(),a=this.computeRequiredPadding(a.scale(o,s,{x:0,y:0})),t=Math.round(a.left),e=Math.round(a.right),i=Math.round(a.top),n=Math.round(a.bottom)),this._padding={left:t,top:i,bottom:n,right:e},r.getComputedSize()),s=o.width,a=o.height;return this.$background.css({width:t+s+e,height:i+a+n}),r.$el.css({left:t,top:i}),this},storeCenter:function(t,e){t=Nt(t)?new Q(t,e):this.computeCenter(),this._center=t},restoreCenter:function(){var t=this._center;t&&this.center(t.x,t.y)},getCenter:function(){return this._center||(this._center=this.options.paper.getArea().center()),this._center},computeCenter:function(){var e=this.getClientSize(),t=e.width,e=e.height;return this.clientToLocalPoint(t/2,e/2)},adjustPaper:function(){var t,e,i,n,s=this.options,r=s.paper,o=s.borderless,s=s.contentOptions,s=(typeof s=="function"&&(s=s.call(this,this)),ct({gridWidth:this.options.baseWidth,gridHeight:this.options.baseHeight,allowNewOrigin:"negative"},s));return o?(o=r.getFitToContentArea(this.transformContentOptions(s)),n=(t=r.scale()).sx,t=t.sy,o.x*=n,o.y*=t,o.width*=n,o.height*=t,t=(n=this.computeRequiredPadding(o)).left,e=n.right,i=n.top,n=n.bottom,o.moveAndExpand({x:-t,y:-i,width:t+e,height:i+n}),r.setOrigin(-o.x,-o.y),r.setDimensions(o.width,o.height)):r.fitToContent(this.transformContentOptions(s)),this},adjustScale:function(r,o){var i=this.options.paper,n=i.options,r=r/this._sx,o=o/this._sy;i.setOrigin(n.origin.x*r,n.origin.y*o),i.setDimensions(n.width*r,n.height*o)},transformContentOptions:function(t){var e=this._sx,i=this._sy;return t.gridWidth&&(t.gridWidth*=e),t.gridHeight&&(t.gridHeight*=i),t.minWidth&&(t.minWidth*=e),t.minHeight&&(t.minHeight*=i),Dt(t.padding)?t.padding={left:(t.padding.left||0)*e,right:(t.padding.right||0)*e,top:(t.padding.top||0)*i,bottom:(t.padding.bottom||0)*i}:Nt(t.padding)&&(t.padding=t.padding*e),t},center:function(t,e,i){var n,r=this.options.paper,l=r.matrix(),o=l.a,s=l.d,a=l.e,l=l.f,h=Nt(t),u=Nt(e);return h||u?(n=i,h||(t=this.getVisibleArea().center().x),u||(e=this.getVisibleArea().center().y),t*=o,e*=s):(n=t,t=(-a+(i=r.getComputedSize()).width)/2,e=(-l+i.height)/2),this.storeCenter(t/o,e/s),this.addPadding(),this.scroll(t,e,n),this},centerContent:function(t){return this.positionContent("center",t)},centerElement:function(t,e){return this.checkElement(t,"centerElement"),this.positionElement(t,"center",e)},positionContent:function(t,e){var i=this.options.paper.getContentArea(e);return this.positionRect(i,t,e)},positionElement:function(t,e,i){return this.checkElement(t,"positionElement"),t=t.getBBox(),this.positionRect(t,e,i)},positionRect:function(t,e,i){var n;switch(e){case"center":return n=t.center(),this.positionPoint(n,"50%","50%",i);case"top":return n=t.topMiddle(),this.positionPoint(n,"50%",0,i);case"top-right":return n=t.topRight(),this.positionPoint(n,"100%",0,i);case"right":return n=t.rightMiddle(),this.positionPoint(n,"100%","50%",i);case"bottom-right":return n=t.bottomRight(),this.positionPoint(n,"100%","100%",i);case"bottom":return n=t.bottomMiddle(),this.positionPoint(n,"50%","100%",i);case"bottom-left":return n=t.bottomLeft(),this.positionPoint(n,0,"100%",i);case"left":return n=t.leftMiddle(),this.positionPoint(n,0,"50%",i);case"top-left":return n=t.topLeft(),this.positionPoint(n,0,0,i);default:throw new Error("Provided positionName ('"+e+"') was not recognized.")}},positionPoint:function(t,s,a,n){var o=ti((n=n||{}).padding),l=new nt(this.getClientSize()),o=l.clone().moveAndExpand({x:o.left,y:o.top,width:-o.right-o.left,height:-o.top-o.bottom}),r=ni(s),r=(s=parseFloat(s),(s=r?s/100*Math.max(0,o.width):s)<0&&(s=o.width+s),ni(a)),r=(a=parseFloat(a),(a=r?a/100*Math.max(0,o.height):a)<0&&(a=o.height+a),o.origin().offset(s,a)),o=l.center().difference(r),s=this.zoom(),a=o.scale(1/s,1/s),l=t.clone().offset(a);return this.center(l.x,l.y,n)},scroll:function(t,e,i){var n,r=this.options.paper.matrix(),o=this.getClientSize(),s={};Nt(t)&&(n=o.width/2,s.scrollLeft=this.getScrollLeftFromLTR(t-n+r.e+(this._padding.left||0))),Nt(e)&&(t=o.height/2,s.scrollTop=e-t+r.f+(this._padding.top||0)),i&&i.animation?this.$el.animate(s,i.animation):this.$el.prop(s)},scrollToContent:function(t){var e=this.options.paper.getContentArea(t).center(),i=this._sx,n=this._sy;return e.x*=i,e.y*=n,this.scroll(e.x,e.y,t)},scrollToElement:function(i,e){this.checkElement(i,"scrollToElement");var i=i.getBBox().center(),n=this._sx,r=this._sy;return i.x*=n,i.y*=r,this.scroll(i.x,i.y,e)},zoom:function(t,e){var i,n,r,o,s,a;return e===void 0&&(e={}),t===void 0?this._sx:(i=this.computeCenter(),r=t=t,e.absolute||(n=1e12,t=(a=function(l,h){return(l*n+h*n)/n})(this._sx,t),r=a(this._sy,r)),e.grid&&(t=Math.round(t/e.grid)*e.grid,r=Math.round(r/e.grid)*e.grid),e.max&&(t=Math.min(e.max,t),r=Math.min(e.max,r)),e.min&&(t=Math.max(e.min,t),r=Math.max(e.min,r)),a=e.ox===void 0||e.oy===void 0?(s=i.x,i.y):(a=t/this._sx,o=r/this._sy,s=e.ox-(e.ox-i.x)/a,e.oy-(e.oy-i.y)/o),this.beforePaperManipulation(),this.options.paper.scale(t,r),this.center(s,a),this.afterPaperManipulation(),this)},zoomToRect:function(t,e){e===void 0&&(e={}),t=new nt(t);var i=this.options.paper,n=ct({},i.options.origin),n=(e.fittingBBox=e.fittingBBox||ct({},new Q(n),{width:this.$el.width(),height:this.$el.height()}),e.contentArea=t,this.beforePaperManipulation(),i.scaleContentToFit(e),t.center());return this.adjustPaper(),this.center(n.x,n.y),this.afterPaperManipulation(),this},zoomToFit:function(t){var e=this.options.paper.getContentArea(t=t===void 0?{}:t);return this.zoomToRect(e,t),this},transitionClassName:"transition-in-progress",transitionEventName:"transitionend.paper-scroller-transition",transitionToPoint:function(t,e,i){Dt(t)&&(i=e,e=t.y,t=t.x),i=i||{};var n,r,o=this._sx,s=Math.max(i.scale||o,1e-6),a=new Q(t,e),l=this.computeCenter();return o===s?n="translate("+(n=l.difference(a).scale(o,o).round()).x+"px,"+n.y+"px)":(r=s/(o-s)*a.distance(l),l=l.clone().move(a,r),n="scale("+s/o+")",r=(a=this.localToBackgroundPoint(l).round()).x+"px "+a.y+"px"),this.$el.addClass(this.transitionClassName),this.$background.off(this.transitionEventName).on(this.transitionEventName,(function(h){var u=this.paperScroller,d=(u.syncTransition(this.scale,{x:this.x,y:this.y}),this.onTransitionEnd);Rt(d)&&d.call(u,h)}).bind({paperScroller:this,scale:s,x:t,y:e,onTransitionEnd:i.onTransitionEnd})).css({transition:"transform",transitionDuration:i.duration||"1s",transitionDelay:i.delay,transitionTimingFunction:i.timingFunction,transformOrigin:r,transform:n}),this},syncTransition:function(t,e){return this.beforePaperManipulation(),this.options.paper.scale(t),this.removeTransition().center(e.x,e.y),this.afterPaperManipulation(),this},removeTransition:function(){return this.$el.removeClass(this.transitionClassName),this.$background.off(this.transitionEventName).css({transition:"",transitionDuration:"",transitionDelay:"",transitionTimingFunction:"",transform:"",transformOrigin:""}),this},transitionToRect:function(t,e){e===void 0&&(e={}),t=new nt(t);var i=e.maxScale||1/0,n=e.minScale||Number.MIN_VALUE,r=e.scaleGrid||null,l=e.visibility||1,o=e.center?new Q(e.center):t.center(),a=this.getClientSize(),s=a.width*l,a=a.height*l,l=new nt({x:o.x-s/2,y:o.y-a/2,width:s,height:a}).maxRectUniformScaleToFit(t,o),l=Math.min(l,i);return r&&(l=Math.floor(l/r)*r),l=Math.max(n,l),this.transitionToPoint(o,Jt({scale:l},e)),this},startPanning:function(t){t=Tt(t),this._clientX=t.clientX,this._clientY=t.clientY,this.trigger("pan:start",t),this.delegatePanning(),this.options.inertia&&this.inertia.handleDragStart(t)},pan:function(t){var e=(t=Tt(t)).clientX-this._clientX,i=t.clientY-this._clientY;this.el.scrollTop-=i,this.el.scrollLeft-=e,this._clientX=t.clientX,this._clientY=t.clientY,this.options.inertia&&this.inertia.handleDragMove(t)},stopPanning:function(t){this.undelegatePanning(),t=t&&Tt(t),this.trigger("pan:stop",t),this.options.inertia&&this.inertia.handleDragEnd(t)},delegatePanning:function(){this.$el.addClass("is-panning"),this.delegateDocumentEvents({mousemove:"pan",touchmove:"pan",mouseup:"stopPanning",touchend:"stopPanning",touchcancel:"stopPanning"})},undelegatePanning:function(){this.$el.removeClass("is-panning"),this.undelegateDocumentEvents()},getClientSize:function(){var t=this.el;return{width:t.clientWidth,height:t.clientHeight}},getVisibleArea:function(){var t=this.options.paper.matrix(),e=this.getClientSize(),e={x:this.getLTRScrollLeft(),y:this.el.scrollTop||0,width:e.width,height:e.height},e=X.transformRect(e,t.inverse());return e.x-=(this._padding.left||0)/this._sx,e.y-=(this._padding.top||0)/this._sy,new nt(e)},isElementVisible:function(t,e){return this.checkElement(t,"isElementVisible"),e=(e=e||{}).strict?"containsRect":"intersect",!!this.getVisibleArea()[e](t.getBBox())},isPointVisible:function(t){return this.getVisibleArea().containsPoint(t)},checkElement:function(t,e){if(!(t&&t instanceof Kt))throw new TypeError("ui.PaperScroller."+e+"() accepts instance of dia.Element only")},onRemove:function(){this.undelegatePanning(),this.resizeObserver.disconnect()},isRTLDirection:function(){return getComputedStyle(this.el).direction==="rtl"},getLTRScrollLeft:function(){var t,e=this.el;return this.isRTLDirection()?(t=e.scrollLeft,e.scrollWidth-e.clientWidth+t):e.scrollLeft},getScrollLeftFromLTR:function(t){var e;return this.isRTLDirection()?t-((e=this.el).scrollWidth-e.clientWidth):t}})),Qt=(_n.addTest("msie",function(){var t=window.navigator.userAgent;return t.indexOf("MSIE")!==-1||t.indexOf("Trident")!==-1}),_n.addTest("msedge",function(){return/Edge\/\d+/.test(window.navigator.userAgent)}),ke.extend({tagName:"g",svgElement:!0,className:"path-drawer",events:{"mousedown .start-point":"onStartPointPointerDown",mousedown:"onPointerDown","touchstart .start-point":"onStartPointPointerDown",touchstart:"onPointerDown",dblclick:"onDoubleClick",contextmenu:"onContextMenu"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{pathAttributes:{class:null,fill:"#ffffff",stroke:"#000000","stroke-width":1,"pointer-events":"none"},startPointMarkup:'<circle r="5"/>',snapRadius:0,enableCurves:!0},init:function(){var t=this.svgTarget=X(this.options.target);this.path=new At,this.$document=P(t.node.ownerDocument),this.action="awaiting-input",this.render()},onRemove:function(){var t=this.pathNode;t&&X(t).remove(),this.clear()},clear:function(){var t=this.path,e=this.pathNode;e&&t&&t.segments.length<=1&&X(e).remove(),this.svgStart.remove(),this.svgControl.remove(),this.pathNode=null,this.path=new At,this.undelegateDocumentEvents(),this.action="awaiting-input",this.trigger("clear")},render:function(){var t=this.options;return this.svgPathTemplate=X("path").attr(t.pathAttributes),this.svgStart=X(t.startPointMarkup).addClass("start-point"),this.svgControl=X("path").addClass("control-path"),this.vel.append(X("rect",{x:0,y:0,width:"100%",height:"100%",fill:"transparent",stroke:"none"})),this.svgTarget.append(this.el),this},createPath:function(t,e){var i=this.svgPathTemplate.clone(),n=this.pathNode=i.node,r=this.svgStart.translate(t,e,{absolute:!0});this.trigger("path:create",n),this.addMoveSegment(t,e),this.vel.before(i),this.vel.append(r)},closePath:function(){var t=this.path,e=this.pathNode,i=t.getSegment(0),n=t.getSegment(t.segments.length-1);n.type==="L"?t.replaceSegment(t.segments.length-1,At.createSegment("Z")):(n.end.x=i.end.x,n.end.y=i.end.y,t.appendSegment(At.createSegment("Z"))),e.setAttribute("d",t.toString()),this.finishPath("path:close")},finishPath:function(t){var e=this.path,i=this.pathNode;e&&0<this.numberOfVisibleSegments()?(this.trigger("path:finish",i),this.trigger(t,i)):this.trigger("path:abort",i),this.clear()},numberOfVisibleSegments:function(){var t=this.path,e=t.segments.length;return--e,t.getSegment(t.segments.length-1).type==="Z"&&--e,e},addMoveSegment:function(r,e){var i=this.path,n=this.pathNode,r=At.createSegment("M",r,e);i.appendSegment(r),n.setAttribute("d",i.toString()),this.trigger("path:segment:add",n),this.trigger("path:move-segment:add",n)},addLineSegment:function(r,e){var i=this.path,n=this.pathNode,r=At.createSegment("L",r,e);i.appendSegment(r),n.setAttribute("d",i.toString()),this.trigger("path:segment:add",n),this.trigger("path:line-segment:add",n)},addCurveSegment:function(t,e,l,n,r,o){var s=this.path,a=this.pathNode,l=At.createSegment("C",l,n,r||t,o||e,t,e);s.appendSegment(l),a.setAttribute("d",s.toString()),this.trigger("path:segment:add",a),this.trigger("path:curve-segment:add",a)},adjustLastSegment:function(t,e,i,n,r,o){var s=this.path,a=this.pathNode,l=this.options.snapRadius,l=(l&&(t=(l=this.snapLastSegmentCoordinates(t,e,l)).x,e=l.y),s.getSegment(s.segments.length-1));t!=null&&(l.end.x=t),e!=null&&(l.end.y=e),i!=null&&(l.controlPoint1.x=i),n!=null&&(l.controlPoint1.y=n),r!=null&&(l.controlPoint2.x=r),o!=null&&(l.controlPoint2.y=o),a.setAttribute("d",s.toString()),this.trigger("path:edit",a),this.trigger("path:last-segment:adjust",a)},snapLastSegmentCoordinates:function(t,e,i){for(var n=this.path,r=!1,o=!1,s=t,a=e,l=n.segments.length-2;0<=l&&(!r||!o);l--){var u=n.getSegment(l),h=u.end.x,u=u.end.y;!r&&Math.abs(h-t)<i&&(s=h,r=!0),!o&&Math.abs(u-e)<i&&(a=u,o=!0)}return new Q(s,a)},removeLastSegment:function(){var t=this.path,e=this.pathNode;t.removeSegment(t.segments.length-1),e.setAttribute("d",t.toString()),this.trigger("path:edit",e),this.trigger("path:last-segment:remove",e)},findControlPoint:function(t,e){var i=this.path,i=i.getSegment(i.segments.length-1);return new Q(t,e).reflection({x:i.end.x,y:i.end.y})},replaceLastSegmentWithCurve:function(){var t=this.path,e=this.pathNode,i=t.getSegment(t.segments.length-1),n=t.getSegment(t.segments.length-2),n=At.createSegment("C",n.end.x,n.end.y,i.end.x,i.end.y,i.end.x,i.end.y);t.replaceSegment(t.segments.length-1,n),e.setAttribute("d",t.toString()),this.trigger("path:edit",e),this.trigger("path:last-segment:replace-with-curve",e)},adjustControlPath:function(s,e,i,n){var r=this.pathNode,o=this.svgControl.node,s=new At([At.createSegment("M",s,e),At.createSegment("L",i,n)]);o.setAttribute("d",s.toString()),this.vel.append(o),this.trigger("path:interact",r),this.trigger("path:control:adjust",r)},removeControlPath:function(){var t=this.pathNode,e=this.svgControl.node;e.removeAttribute("d"),this.vel.append(e),this.trigger("path:interact",t),this.trigger("path:control:remove",t)},onPointerDown:function(t){if(t=Tt(t),t.stopPropagation(),!(1<t.which)&&!(1<t.originalEvent.detail)&&this.el.parentNode){var e=this.vel.toLocalPoint(t.clientX,t.clientY);switch(this.action){case"awaiting-input":this.createPath(e.x,e.y),this.options.enableCurves?this.action="path-created":(this.addLineSegment(e.x,e.y),this.action="adjusting-line-end"),this.delegateDocumentEvents();break;case"adjusting-line-end":this.options.enableCurves?this.action="awaiting-line-end":this.addLineSegment(e.x,e.y);break;case"adjusting-curve-end":this.action="awaiting-curve-control-2"}this._timeStamp=t.timeStamp}},MOVEMENT_DETECTION_THRESHOLD:150,onPointerMove:function(t){if(t=Tt(t),t.stopPropagation(),this.action!="awaiting-input"){var e,i,n=this.vel.toLocalPoint(t.clientX,t.clientY),r=this._timeStamp;if(r)if(t.timeStamp-r<this.MOVEMENT_DETECTION_THRESHOLD)switch(this.action){case"path-created":this.options.enableCurves&&(e=this.svgStart.translate(),this.adjustControlPath(e.tx,e.ty,n.x,n.y));break;case"adjusting-line-end":case"awaiting-line-end":case"adjusting-curve-control-1":this.adjustLastSegment(n.x,n.y);break;case"awaiting-curve-control-2":this.adjustLastSegment(n.x,n.y,null,null,n.x,n.y)}else switch(this.action){case"path-created":this.options.enableCurves&&(this.action="adjusting-curve-control-1");break;case"awaiting-line-end":this.options.enableCurves&&(this.replaceLastSegmentWithCurve(),this.action="adjusting-curve-control-2");break;case"adjusting-line-end":this.options.enableCurves||this.adjustLastSegment(n.x,n.y);break;case"awaiting-curve-control-2":this.action="adjusting-curve-control-2";break;case"adjusting-curve-control-1":e=this.svgStart.translate(),this.adjustControlPath(e.tx,e.ty,n.x,n.y);break;case"adjusting-curve-control-2":i=this.findControlPoint(n.x,n.y),this.adjustLastSegment(null,null,null,null,i.x,i.y),this.adjustControlPath(i.x,i.y,n.x,n.y)}else switch(this.action){case"adjusting-line-end":this.adjustLastSegment(n.x,n.y);break;case"adjusting-curve-end":this.adjustLastSegment(n.x,n.y,null,null,n.x,n.y)}}},onPointerUp:function(t){if(this._timeStamp=null,t=Tt(t),t.stopPropagation(),!(1<t.which||1<t.originalEvent.detail)){var e=this.vel.toLocalPoint(t.clientX,t.clientY);switch(this.action){case"path-created":case"awaiting-line-end":this.addLineSegment(e.x,e.y),this.action="adjusting-line-end";break;case"awaiting-curve-control-2":this.removeControlPath(),this.addLineSegment(e.x,e.y),this.action="adjusting-line-end";break;case"adjusting-curve-control-1":case"adjusting-curve-control-2":this.addCurveSegment(e.x,e.y,e.x,e.y),this.action="adjusting-curve-end"}}},onStartPointPointerDown:function(t){t=Tt(t),t.stopPropagation(),1<t.which||1<t.originalEvent.detail||this.closePath()},onDoubleClick:function(t){t=Tt(t),t.preventDefault(),t.stopPropagation(),1<t.which||this.pathNode&&0<this.numberOfVisibleSegments()&&(this.removeLastSegment(),this.finishPath("path:stop"))},onContextMenu:function(t){t=Tt(t),t.preventDefault(),t.stopPropagation(),1<t.originalEvent.detail||this.pathNode&&0<this.numberOfVisibleSegments()&&(this.removeLastSegment(),this.finishPath("path:stop"))}})),Ni=ke.extend({tagName:"g",svgElement:!0,className:"path-editor",events:{"mousedown .anchor-point":"onAnchorPointPointerDown","mousedown .control-point":"onControlPointPointerDown","mousedown .segment-path":"onSegmentPathPointerDown","touchstart .anchor-point":"onAnchorPointPointerDown","touchstart .control-point":"onControlPointPointerDown","touchstart .segment-path":"onSegmentPathPointerDown","dblclick .anchor-point":"onAnchorPointDoubleClick","dblclick .control-point":"onControlPointDoubleClick","dblclick .segment-path":"onSegmentPathDoubleClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{anchorPointMarkup:'<circle r="2.5"/>',controlPointMarkup:'<circle r="2.5"/>'},init:function(){var t=this.pathNode=X(this.options.pathElement).normalizePath().node;this.path=At.parse(this.options.pathElement.getAttribute("d")),this.svgRoot=X(t.ownerSVGElement),this.$document=P(t.ownerDocument),this.render()},onRemove:function(){this.undelegateDocumentEvents(),this.clear()},clear:function(){this.vel.empty(),this.directionPaths=[],this.segmentPaths=[],this.segmentPathElements=[],this.controlPoints=[],this.anchorPoints=[],this._subPathIndices=[0],this.trigger("clear",this.pathNode)},_transformPoint:function(t,e,i){return X.transformPoint(new Q(t,e),i)},_getPathCTM:function(){return this.pathNode.getCTM()},render:function(){this.clear();for(var t=this.path,e=this.vel,i=this.anchorPoints,n=this.controlPoints,r=this.directionPaths,o=this.segmentPaths,s=this.segmentPathElements,a=this._getPathCTM(),l=X(this.options.anchorPointMarkup).addClass("anchor-point"),h=X(this.options.controlPointMarkup).addClass("control-point"),u=X('<path class="direction-path"/>'),d=X('<path class="segment-path"/>'),p=this._subPathIndices,m=0,v=0,k=0;m<t.segments.length;m++){var I=t.getSegment(m),N=this._transformPoint(I.end.x,I.end.y,a),G=N.x,F=N.y;if(I.type!=="Z"&&(i[m]=l.clone().attr({index:m,cx:G,cy:F})),I.type!=="M"){var H=new At;switch(H.appendSegment(new At.createSegment("M",v,k)),I.type){case"Z":var Y=t.getSegment(p[0]),Y=this._transformPoint(Y.end.x,Y.end.y,a),G=Y.x,F=Y.y;H.appendSegment(new At.createSegment("L",G,F)),p.unshift(m+1);break;case"L":H.appendSegment(new At.createSegment("L",G,F));break;case"C":var Y=this._transformPoint(I.controlPoint1.x,I.controlPoint1.y,a),_=h.clone().attr({index:m,"attribute-index":1,cx:Y.x,cy:Y.y}),K=this._transformPoint(I.controlPoint2.x,I.controlPoint2.y,a),tt=h.clone().attr({index:m,"attribute-index":2,cx:K.x,cy:K.y});n[m]=[_,tt],H.appendSegment(new At.createSegment("C",Y.x,Y.y,K.x,K.y,G,F)),r[m]=[u.clone().attr("d",["M",v,k,"L",Y.x,Y.y].join(" ")),u.clone().attr("d",["M",G,F,"L",K.x,K.y].join(" "))]}o[m]=H,N=d.clone().attr("index",m).node,N.setAttribute("d",H.toString()),s[m]=N}v=G,k=F}var b=[];s.forEach(function(vt){vt&&b.push(vt)}),r.forEach(function(vt){vt&&Array.prototype.push.apply(b,vt)}),i.forEach(function(vt){vt&&b.push(vt)}),n.forEach(function(vt){vt&&Array.prototype.push.apply(b,vt)}),e.append(b),this.svgRoot.append(e)},startMoving:function(e){var e=Tt(e),i=this.$point=P(e.target),n=(this.prevClientX=e.clientX,this.prevClientY=e.clientY,parseInt(this.$point.attr("index"),10));this.trigger("path:interact"),i.hasClass("anchor-point")?this.trigger("path:anchor-point:select",n):i.hasClass("control-point")?(i=parseInt(this.$point.attr("attribute-index"),10),this.trigger("path:control-point:select",n,i)):this.trigger("path:segment:select",n),e.stopPropagation(),e.preventDefault(),this.index=void 0,this.controlPointIndex=void 0,this.segPoint=void 0,this.pathEditedEventType=void 0},move:function(t){var e,i,n,r=this.$point;r&&(e=(t=Tt(t)).clientX-this.prevClientX,i=t.clientY-this.prevClientY,n=parseInt(r.attr("index"),10),r.hasClass("anchor-point")?this.adjustAnchorPoint(n,e,i,t):r.hasClass("control-point")?(r=parseInt(r.attr("attribute-index"),10),this.adjustControlPoint(n,r,e,i,t)):this.adjustSegment(n,e,i,t),this.prevClientX=t.clientX,this.prevClientY=t.clientY)},adjustSegment:function(t,e,i,n,r){r=(r=r===void 0?{}:r).dry,r===void 0&&(r=void 0),this.adjustAnchorPoint(t-1,e,i,{dry:!0}),this.adjustAnchorPoint(t,e,i,{dry:!0}),r||(this.pathEditedEventType="path:segment:adjust",this.index=t,this.trigger("path:editing",this.pathNode,n),this.trigger("path:segment:adjusting",this.pathNode,n,{index:t}))},adjustControlPoint:function(t,e,I,v,r,h){var s,a,l,h=(h=h===void 0?{}:h).dry,u=(h===void 0&&(h=void 0),this._getPathCTM()),d=this.path,p=this.controlPoints,m=d.getSegment(t),k=u.inverse(),I=(k.e=0,k.f=0,this._transformPoint(I,v,k)),v="controlPoint"+e,k=(m[v].x+=I.x,m[v].y+=I.y,this._transformPoint(m[v].x,m[v].y,u)),I=new Q(k);p[t][e-1].attr({cx:k.x,cy:k.y}).hasClass("locked")&&(k=this.getBoundIndex(t,e),s=e===1?2:1,d=d.getSegment(k),a="controlPoint"+s,l=new Q((e===1?d:m).end.x,(e===1?d:m).end.y),m=new Q(m[v].x,m[v].y),v=l.distance(new Q(d[a].x,d[a].y)),l=l.move(m,v),d[a].x=l.x,d[a].y=l.y,m=this._transformPoint(d[a].x,d[a].y,u),p[k][s-1].attr({cx:m.x,cy:m.y}),this.updateDirectionPaths(k),this.updateSegmentPath(k)),this.updateDirectionPaths(t),this.updateSegmentPath(t),h||(this.pathEditedEventType="path:control-point:adjust",this.index=t,this.controlPointIndex=e,this.segPoint=I,this.trigger("path:editing",this.pathNode,r),this.trigger("path:control-point:adjusting",this.pathNode,r,{index:t,controlPointIndex:e,segPoint:I}))},findSubpathIndex:function(t){for(var e=this._subPathIndices,i=0,n=e.length;i<n;i++)if(e[i]<t)return e[i]},findReversedSubpathIndex:function(t){for(var e=this._subPathIndices,i=e.length-1;0<=i;i--)if(e[i]>t)return e[i]},adjustAnchorPoint:function(t,p,m,n,o){var o=(o=o===void 0?{}:o).dry,s=(o===void 0&&(o=void 0),this._getPathCTM()),a=this.path,v=this.anchorPoints,l=this.controlPoints,h=a.getSegment(t),d=(h.type==="Z"&&(t=this.findSubpathIndex(t),h=a.getSegment(t)),v.length-1),u=((t===0||t===d)&&l[1]&&l[d]&&(u=l[1][0],d=l[d][1],u&&u.hasClass("locked")&&u.removeClass("locked"),d&&d.hasClass("locked")&&d.removeClass("locked")),s.inverse()),d=(u.e=0,u.f=0,this._transformPoint(p,m,u)),p=(h.end.x+=d.x,h.end.y+=d.y,this._transformPoint(h.end.x,h.end.y,s)),m=new Q(p),v=(v[t].attr({cx:p.x,cy:p.y}),h.type==="C"&&(h.controlPoint2.x+=d.x,h.controlPoint2.y+=d.y,u=this._transformPoint(h.controlPoint2.x,h.controlPoint2.y,s),l[t][1].attr({cx:u.x,cy:u.y})),t+1<a.segments.length?a.getSegment(t+1):0);v&&(v.type==="C"&&(v.controlPoint1.x+=d.x,v.controlPoint1.y+=d.y,p=this._transformPoint(v.controlPoint1.x,v.controlPoint1.y,s),l[t+1][0].attr({cx:p.x,cy:p.y}),this.updateDirectionPaths(t+1)),this.updateSegmentPath(t+1)),this.updateDirectionPaths(t),this.updateSegmentPath(t),o||(this.pathEditedEventType="path:anchor-point:adjust",this.index=t,this.segPoint=m,this.trigger("path:editing",this.pathNode,n),this.trigger("path:anchor-point:adjusting",this.pathNode,n,{index:t,segPoint:m}))},updateDirectionPaths:function(t){var e=this._getPathCTM(),s=this.path,i=s.getSegment(t),n=this._transformPoint(i.end.x,i.end.y,e),r=0<t?s.getSegment(t-1):null,o=r?this._transformPoint(r.end.x,r.end.y,e):null,s=this.directionPaths[t];Array.isArray(s)&&s.forEach(function(a,l){var h=this._transformPoint(i["controlPoint"+ ++l].x,i["controlPoint"+l].y,e);a.attr("d",["M",(1<l||!r?n:o).x,(1<l||!r?n:o).y,h.x,h.y].join(" "))},this)},updateSegmentPath:function(t){var e=this.path;if(this._subPathIndices.includes(t)){var i=this.findReversedSubpathIndex(t)||this.path.segments.length;if(e.getSegment(--i).type!=="Z")return;t=i}if(i=this.segmentPaths[t]){var n=this._getPathCTM(),r=e.getSegment(t-1),r=this._transformPoint(r.end.x,r.end.y,n),i=new At,o=At.createSegment("M",r.x,r.y),s=(i.appendSegment(o),e.getSegment(t)),a=this._transformPoint(s.end.x,s.end.y,n);switch(s.type){case"Z":var l=e.getSegment(this.findSubpathIndex(t)),l=this._transformPoint(l.end.x,l.end.y,n),o=At.createSegment("L",l.x,l.y);break;case"L":o=At.createSegment("L",a.x,a.y);break;case"C":var l=this._transformPoint(s.controlPoint1.x,s.controlPoint1.y,n),h=this._transformPoint(s.controlPoint2.x,s.controlPoint2.y,n);o=At.createSegment("C",l.x,l.y,h.x,h.y,a.x,a.y)}i.appendSegment(o),this.segmentPaths[t]=i,r=this.segmentPathElements[t],r&&r.setAttribute("d",i.toString()),this.pathNode.setAttribute("d",e.toString())}},stopMoving:function(o){var e,i,n,r,o=Tt(o);this.$point=void 0,this.pathEditedEventType&&(e=this.pathNode,i=this.index,n=this.controlPointIndex,r=this.segPoint,this.trigger("path:edit",e,o),this.trigger(this.pathEditedEventType,e,o,{index:i,controlPointIndex:n,segPoint:r})),this.index=void 0,this.controlPointIndex=void 0,this.segPoint=void 0,this.pathEditedEventType=void 0},createAnchorPoint:function(e){var e=Tt(e),i=X(e.target).attr("index"),n=this.pathNode,r=this.path,o=X(n).toLocalPoint(e.pageX,e.pageY),s=r.getSegment(i);switch(s.type){case"Z":var a=new Ot(s.start,s.end).closestPoint(o);r.insertSegment(i,At.createSegment("L",a.x,a.y));break;case"L":a=new Ot(s.start,s.end).closestPoint(o),r.insertSegment(i,At.createSegment("L",a.x,a.y));break;case"C":a=new $t(s.start,s.controlPoint1,s.controlPoint2,s.end).closestPointT(o),a=s.divideAtT(a),r.insertSegment(i,a[0]),s.controlPoint1.x=a[1].controlPoint1.x,s.controlPoint1.y=a[1].controlPoint1.y,s.controlPoint2.x=a[1].controlPoint2.x,s.controlPoint2.y=a[1].controlPoint2.y}this.render(),this.pathNode.setAttribute("d",r.toString()),this.trigger("path:edit",n,e),this.trigger("path:anchor-point:create",n,e)},removeAnchorPoint:function(n){var e,i,n=Tt(n),r=parseInt(P(n.target).attr("index"),10),o=this.pathNode,s=this.path,a=s.getSegment(r);switch(a.type){case"M":e=s.getSegment(r+1),i=At.createSegment("M",e.end.x,e.end.y),s.replaceSegment(r+1,i),s.removeSegment(r);break;case"L":s.removeSegment(r);break;case"C":r+1<=s.segments.length-1&&(e=s.getSegment(r+1)).type==="C"&&(e.controlPoint1.x=a.controlPoint1.x,e.controlPoint1.y=a.controlPoint1.y),s.removeSegment(r)}this.render(),this.pathNode.setAttribute("d",s.toString()),this.trigger("path:edit",o,n),this.trigger("path:anchor-point:remove",o,n);var l=s.segments.length;s.getSegment(s.segments.length-1).type==="Z"&&--l,l<2&&this.trigger("path:invalid",o,n)},lockControlPoint:function(i){var e,i=Tt(i),i=P(i.target),n=parseInt(i.attr("index")),r=parseInt(i.attr("attribute-index"),10),s=this.getBoundIndex(n,r),o=r===1?2:1,s=this.controlPoints[s];s&&(e=i.hasClass("locked"),i.toggleClass("locked"),s[o-1].toggleClass("locked"),this.trigger("path:interact"),e?this.trigger("path:control-point:unlock",n,r):(this.trigger("path:control-point:lock",n,r),this.adjustControlPoint(n,r,0,0,{dry:!0})))},getBoundIndex:function(t,e){var i,n,r,o,s,a=this.path,l=this.anchorPoints,h=l.length-1;return e===1?(i=t-1)===0&&(n=a.segments.length-1,r=a.getSegment(n).type==="Z",o=l[0].attr("cx")===l[h].attr("cx"),s=l[0].attr("cy")===l[h].attr("cy"),r&&o&&s&&(i=h)):(i=t+1)===1+h&&(n=a.segments.length-1,r=a.getSegment(n).type==="Z",o=l[0].attr("cx")===l[h].attr("cx"),s=l[0].attr("cy")===l[h].attr("cy"),r&&o&&s&&(i=1)),i},getControlPointLockedStates:function(){for(var t=this.controlPoints,e=[],i=0;i<t.length;i++)if(t[i]){e[i]=[];for(var n,r=0;r<=1;r++)t[i][r]&&(n=r+1,t[i][r].hasClass("locked")?e[i][n]=!0:e[i][n]=!1)}return e},setControlPointLockedStates:function(t){for(var e=this.controlPoints,i=0;i<e.length;i++)if(t[i]&&e[i])for(var n=1;n<=2;n++)t[i][n]&&e[i][n-1]&&(t[i][n]===!0?e[i][n-1].addClass("locked"):e[i][n-1].removeClass("locked"))},convertSegmentPath:function(e){var e=Tt(e),i=X(e.target).attr("index"),n=this.pathNode,r=this.path,o=r.getSegment(i);switch(o.type){case"Z":r.insertSegment(i,At.createSegment("C",o.start.x,o.start.y,o.end.x,o.end.y,o.end.x,o.end.y));break;case"L":r.replaceSegment(i,At.createSegment("C",o.start.x,o.start.y,o.end.x,o.end.y,o.end.x,o.end.y));break;case"C":r.replaceSegment(i,At.createSegment("L",o.end.x,o.end.y))}this.render(),this.pathNode.setAttribute("d",r.toString()),this.trigger("path:edit",n,e),this.trigger("path:segment:convert",n,e)},addClosePathSegment:function(e){var e=Tt(e),i=parseInt(P(e.target).attr("index"),10),n=this.path,r=this.pathNode;i!==0&&i!==n.segments.length-1||n.getSegment(n.segments.length-1).type!=="Z"&&(n.appendSegment(At.createSegment("Z")),this.render(),this.pathNode.setAttribute("d",n.toString()),this.trigger("path:edit",r,e),this.trigger("path:closepath-segment:add",r,e))},removeClosePathSegment:function(e){var e=Tt(e),i=X(e.target).attr("index"),n=this.path,r=this.pathNode;n.getSegment(i).type==="Z"&&(n.removeSegment(i),this.render(),this.pathNode.setAttribute("d",n.toString()),this.trigger("path:edit",r,e),this.trigger("path:closepath-segment:remove",r,e))},isMoreThanFirstClick:function(){return this.clickCounter=this.clickCounter||0,this.clickCounter+=1,this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){this.clickCounter=0},400),2<=this.clickCounter&&(this.clickCounter=0,clearTimeout(this.timeout),!0)},onAnchorPointPointerDown:function(t){t=Tt(t),t.stopPropagation(),t.which!==1||this.isMoreThanFirstClick()||(this.startMoving(t),this.delegateDocumentEvents())},onControlPointPointerDown:function(t){t=Tt(t),t.stopPropagation(),t.which!==1||this.isMoreThanFirstClick()||(this.startMoving(t),this.delegateDocumentEvents())},onSegmentPathPointerDown:function(t){t=Tt(t),t.stopPropagation(),t.which!==1||this.isMoreThanFirstClick()||(this.startMoving(t),this.delegateDocumentEvents())},onPointerMove:function(t){t=Tt(t),t.stopPropagation(),this.move(t)},onPointerUp:function(t){this.undelegateDocumentEvents(),t=Tt(t),t.stopPropagation(),this.stopMoving(t)},onAnchorPointDoubleClick:function(t){t=Tt(t),t.stopPropagation(),t.preventDefault(),t.which===1&&this.removeAnchorPoint(t)},onControlPointDoubleClick:function(t){t=Tt(t),t.stopPropagation(),t.preventDefault(),t.which===1&&this.lockControlPoint(t)},onSegmentPathDoubleClick:function(t){t=Tt(t),t.stopPropagation(),t.preventDefault(),t.which===1&&this.createAnchorPoint(t)}}),fe=Oi.extend({className:"popup",eventNamespace:"popup",events:{},beforeMount:function(){var e=this.options,t=e.anchor,e=e.arrowPosition;this.$el.removeClass("left right top bottom top-left top-right bottom-left bottom-right"),e?this.$el.addClass(e==="none"?"":e):this.$el.addClass(t==="center"?"":t)},renderContent:function(){var e=this.options,i=e.content,t=e.arrowPosition,e=e.anchor,i=Rt(i)?i(this.el):i;i&&this.$el.html(i),t==="none"&&e!=="center"||((i=document.createElement("div")).classList.add("popup-arrow"),(t=document.createElement("div")).classList.add("popup-arrow-mask"),this.el.append(i,t))}}),eh={NONE:"none",SUBGRAPH:"subgraph",ALL:"all"},Ji=ke.extend({options:{paperScroller:void 0,paper:void 0,graph:void 0,boxContent:function(t){return Li("<%= length %> elements selected.")({length:this.model.length})},handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElements"}},{name:"rotate",position:"sw",events:{pointerdown:"startRotating",pointermove:"doRotate",pointerup:"stopBatch"}},{name:"resize",position:"se",events:{pointerdown:"startResizing",pointermove:"doResize",pointerup:"stopBatch"}}],useModelGeometry:!1,strictSelection:!1,rotateAngleGrid:15,allowTranslate:!0,translateConnectedLinks:eh.ALL,allowCellInteraction:!1},className:"selection",events:{"mousedown .selection-box":"onSelectionBoxPointerDown","touchstart .selection-box":"onSelectionBoxPointerDown","mousedown .handle":"onHandlePointerDown","touchstart .handle":"onHandlePointerDown",mousewheel:"onMousewheel"},documentEvents:{mousemove:"adjustSelection",touchmove:"adjustSelection",mouseup:"pointerup",touchend:"pointerup",touchcancel:"pointerup"},_action:null,init:function(){this.options.model&&(this.options.collection=this.options.model);var t=this.collection=this.options.collection||this.collection||new R.Collection,t=(t.comparator||(t.comparator=this.constructor.depthComparator,t.sort()),this.model=t,this.options.paper);if(t instanceof ki)Jt(this.options,{graph:t.model});else{if(!(typeof La=="function"&&t instanceof La))throw new Error("Selection: paper required");this.options.paperScroller=t,this.options.paper=t.options.paper,this.options.graph=t.options.paper.model}yi(this,"startSelecting","stopSelecting","adjustSelection","pointerup"),this.options.paper.$el.append(this.$el),this._boxCount=0,this.$selectionWrapper=this.createSelectionWrapper(),this.handles=[],kt(this.options.handles).forEach(this.addHandle,this),this.startListening()},onCellPointerdown:function(t,e){var i=this.collection;i.length!==0&&i.has(t.model)&&(1<i.length&&t.preventDefaultInteraction(e),this.startSelectionInteraction(e,t))},startListening:function(){var t=this.options.paper,t=(this.listenTo(t,"scale translate",this.onPaperTransformation),this.options.allowCellInteraction&&this.listenTo(t,"cell:pointerdown",this.onCellPointerdown,this),this.options.graph),t=(this.listenTo(t,"reset",this.cancelSelection),this.listenTo(t,"change remove",this.onGraphChange),this.collection);this.listenTo(t,"remove",this.onRemoveElement),this.listenTo(t,"reset",this.onResetElements),this.listenTo(t,"add",this.onAddElement)},onPaperTransformation:function(){this.updateSelectionBoxes({async:!1})},onGraphChange:function(t,e){e.selection!==this.cid&&this.updateSelectionBoxes()},cancelSelection:function(){this.model.reset([],{ui:!0})},addHandle:function(t){this.handles.push(t);var e=P("<div/>",{class:"handle "+(t.position||"")+" "+(t.name||""),"data-action":t.name});return t.icon&&e.css("background-image","url("+t.icon+")"),e.html(t.content||""),Bo(e,t.attrs),this.$selectionWrapper.append(e),Se(t.events,(function(i,n){Ft(i)?this.on("action:"+t.name+":"+n,this[i],this):this.on("action:"+t.name+":"+n,i)}).bind(this)),this},stopSelecting:function(t){var e=this.options.paper,i=this.eventData(t),n=i.action;switch(n){case"selecting":var r=this.$el.offset(),s=this.$el.width(),l=this.$el.height(),r=e.pageToLocalPoint(r.left,r.top),o=e.scale(),o=(s/=o.sx,l/=o.sy,It(r.x,r.y,s,l)),s=this.getElementsInSelectedArea(o),a=this.options.filter,l=(Array.isArray(a)?s=s.filter(function(h){return!a.includes(h.model)&&!a.includes(h.model.get("type"))}):Rt(a)&&(s=s.filter(function(h){return!a(h.model)})),s.map(function(h){return h.model}));this.model.reset(l,{ui:!0});break;case"translating":i.interactionPrevented||this.options.graph.stopBatch("selection-translate"),r=e.snapToGrid(t.clientX,t.clientY),this.notify("selection-box:pointerup",t,r.x,r.y);break;default:n||this.cancelSelection()}this._action=null},removeHandle:function(t){var e=kt(this.handles).findIndex(function(n){return n.name===t}),i=this.handles[e];return i&&(Se(i.events,(function(n,r){this.off("action:"+t+":"+r)}).bind(this)),this.$(".handle."+t).remove(),this.handles.splice(e,1)),this},startSelecting:function(t){t=Tt(t),this.cancelSelection();var e=this.options,i=e.paperScroller,e=e.paper,e=e.localToPaperPoint(e.clientToLocalPoint({x:t.clientX,y:t.clientY})),i=(this.$el.css({width:0,height:0,left:e.x,top:e.y}),this.showLasso(),i&&i.options.scrollWhileDragging);this.eventData(t,{action:"selecting",clientX:t.clientX,clientY:t.clientY,origin:e,scrollWhileDragging:i}),this.delegateDocumentEvents(null,t.data),this._action="selecting"},changeHandle:function(t,e){var i=kt(this.handles).find(function(n){return n&&n.name===t});return i&&(this.removeHandle(t),this.addHandle(ze({name:t},i,e))),this},onMousewheel:function(t){t.preventDefault()},onSelectionBoxPointerDown:function(t){t.stopPropagation(),t=Tt(t);var e=this.getCellView(t.target);this.startSelectionInteraction(t,e)},startSelectionInteraction:function(t,e){var n=this.options,i=n.paper,n=(!n.allowTranslate||e&&!e.can("elementMove")?this.eventData(t,{action:"translating",interactionPrevented:!0}):this.startTranslatingSelection(t),this.eventData(t,{activeElementView:e}),i.snapToGrid(t.clientX,t.clientY));this.notify("selection-box:pointerdown",t,n.x,n.y),this.delegateDocumentEvents(null,t.data)},startTranslatingSelection:function(t){var i=this.options,e=i.paperScroller,n=i.paper,i=(i.graph.startBatch("selection-translate"),n.snapToGrid(t.clientX,t.clientY)),n=e&&e.options.scrollWhileDragging;this.eventData(t,{action:"translating",snappedClientX:i.x,snappedClientY:i.y,scrollWhileDragging:n}),this._action="translating"},adjustSelection:function(t){t=Tt(t);var a=this.options,e=a.paperScroller,i=a.paper,n=a.graph,r=i.clientToLocalPoint({x:t.clientX,y:t.clientY}),o=this.eventData(t),s=o.action,a=o.scrollWhileDragging,l=o.interactionPrevented;switch(l===void 0&&(l=!1),s){case"selecting":var k=i.localToPaperPoint(r),h=k.x-o.origin.x,u=k.y-o.origin.y,I=Math.abs(h),N=Math.abs(u),d=parseFloat(window.getComputedStyle(this.el).getPropertyValue("border-width"));this.$el.css({left:(h<0?k:o.origin).x,top:(u<0?k:o.origin).y,width:I-2*d,height:N-2*d});break;case"translating":var p,m,v,k=i.snapToGrid(t.clientX,t.clientY),I=k.x,N=k.y;l?this.notify("selection-box:pointermove",t,I,N):(h=I-o.snappedClientX,u=N-o.snappedClientY,(d=i.getRestrictedArea())&&(k=this.model.toArray(),k=n.getCellsBBox(k),m=d.x-k.x,p=d.y-k.y,(v=d.x+d.width-(k.x+k.width))<(h=h<m?m:h)&&(h=v),(m=d.y+d.height-(k.y+k.height))<(u=u<p?p:u)&&(u=m)),(h||u)&&(this.translateSelectedElements(h,u),this.boxesUpdated?(1<this.model.length||this.options.allowCellInteraction)&&this.updateSelectionBoxes():(v=i.scale(),this.$el.children(".selection-box").add(this.$selectionWrapper).css({left:"+="+h*v.sx,top:"+="+u*v.sy})),o.snappedClientX=I,o.snappedClientY=N),this.notify("selection-box:pointermove",t,I,N));break;default:s&&this.pointermove(t)}this.boxesUpdated=!1,a&&e.scrollWhileDragging(t,r.x,r.y,a)},translateSelectedElements:function(t,e){var i=this,n={},r=this.collection,o=this.options,s=o.graph,a=o.translateConnectedLinks;r.each(function(l){var h;n[l.id]||(h={selection:i.cid},l.translate(t,e,h),n[l.id]=!0,l.getEmbeddedCells({deep:!0}).forEach(function(u){n[u.id]=!0}),a!==eh.NONE&&s.getConnectedLinks(l).forEach(function(u){if(!n[u.id]){if(a===eh.SUBGRAPH){var d=u.getSourceCell();if(d&&!r.get(d))return;var p=u.getTargetCell();if(p&&!r.get(p)||!d||!p)return}u.translate(t,e,h),n[u.id]=!0}}))})},notify:function(t,i){var i=this.eventData(i),n=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t,i.activeElementView].concat(n))},getElementsInSelectedArea:function(t){var e=this.options.paper,i={strict:this.options.strictSelection};return this.options.useModelGeometry?e.model.findModelsInArea(t,i).map(e.findViewByModel,e).filter(function(n){return!!n}):e.findViewsInArea(t,i)},pointerup:function(t){var e,i,n,o=this.eventData(t),r=o.action,o=o.scrollWhileDragging;r&&(t=Tt(t),n=(e=this.options).paper,e=e.paperScroller,i=(n=n.snapToGrid({x:t.clientX,y:t.clientY})).x,n=n.y,r!=="selecting"&&r!=="translating"&&this.triggerAction(r,"pointerup",t,i,n),o&&e.stopScrollWhileDragging(t),this.stopSelecting(t),this.undelegateDocumentEvents(),this._action=null)},destroySelectionBox:function(t){this.$('[data-model="'+t.get("id")+'"]').remove(),this.$el.children(".selection-box").length===0&&this.hide(),this._boxCount=Math.max(0,this._boxCount-1)},hide:function(){this.$el.removeClass("lasso selected")},showSelected:function(){this.$el.addClass("selected")},showLasso:function(){this.$el.addClass("lasso")},destroyAllSelectionBoxes:function(){this.hide(),this.$el.children(".selection-box").remove(),this._boxCount=0},createSelectionBox:function(t){var e=this.getCellBBox(t);e&&(t=P("<div/>").addClass("selection-box").attr("data-model",t.get("id")).css({left:e.x,top:e.y,width:e.width,height:e.height}).appendTo(this.el),this.options.allowCellInteraction&&t.addClass("selection-box-no-events"),this.showSelected(),this._boxCount++)},createSelectionWrapper:function(){var t=P("<div/>",{class:"selection-wrapper"}),e=P("<div/>",{class:"box"});return t.append(e),t.attr("data-selection-length",this.model.length),this.$el.prepend(t),t},getCellBBox:function(t){var e=this.options,i=e.paper,e=e.useModelGeometry,i=i.findViewByModel(t);return i?i.getBBox({useModelGeometry:e}):null},getWrapperBBox:function(){var t=this,e=[];return this.collection.models.forEach(function(i){i=t.getCellBBox(i),i&&e.push(i)}),nt.fromRectUnion.apply(nt,e)},updateSelectionWrapper:function(){var t,e,i,n=this.collection,r=this.$selectionWrapper,o=this.getWrapperBBox(),o=o?(t=o.x,e=o.y,i=o.width,o.height):(e=t="",i=0);r.css({left:t,top:e,width:i,height:o}),r.attr("data-selection-length",n.length),this.updateBoxContent()},updateBoxContent:function(){var t,e=this.options.boxContent;Rt(e)&&(t=this.$(".box"),(e=e.call(this,t[0]))&&t.html(e))},updateSelectionBoxes:function(t){this.collection.length!==0&&(this.boxesUpdated=!0,this.options.paper.requestViewUpdate(this,1,this.UPDATE_PRIORITY,t))},confirmUpdate:function(){this._updateSelectionBoxes()},_updateSelectionBoxes:function(){if(this._boxCount){this.hide();for(var t=this.$el.children(".selection-box"),e=0,i=t.length;e<i;e++){var n=t[e],n=P(n).remove().attr("data-model"),n=this.model.get(n);n&&this.createSelectionBox(n)}this.updateSelectionWrapper()}},onHandlePointerDown:function(t){var e,i,n,r=t.currentTarget.dataset.action;r&&(e=(i=this.options).paperScroller,i=i.paper,t.preventDefault(),t.stopPropagation(),t=Tt(t),n=(i=i.snapToGrid({x:t.clientX,y:t.clientY})).x,i=i.y,t.type==="mousedown"&&t.button===2?this.triggerAction(r,"contextmenu",t,n,i):(this.triggerAction(r,"pointerdown",t,n,i),n=e&&e.options.scrollWhileDragging,this.eventData(t,{action:r,clientX:t.clientX,clientY:t.clientY,startClientX:t.clientX,startClientY:t.clientY,scrollWhileDragging:n}),this.delegateDocumentEvents(null,t.data)),this._action=r)},getCellView:function(t){return t=this.model.get(t.getAttribute("data-model")),t&&t.findView(this.options.paper)},pointermove:function(t){var e,i,n,r,o,s,a=this.eventData(t),l=a.action;l&&(e=t.clientX,i=t.clientY,n=(r=(s=this.options.paper).snapToGrid(e,i)).x,r=r.y,o=(s=s.snapToGrid(a.clientX,a.clientY)).x,s=s.y,this.triggerAction(l,"pointermove",t,n,r,n-o,r-s),a.clientX=e,a.clientY=i)},triggerAction:function(t,e,i){var n=Array.prototype.slice.call(arguments,2);n.unshift("action:"+t+":"+e),this.trigger.apply(this,n)},onRemoveElement:function(t){this.destroySelectionBox(t),this.updateSelectionWrapper()},onResetElements:function(t){this.destroyAllSelectionBoxes(),t.each(this.createSelectionBox.bind(this)),this.updateSelectionWrapper()},onAddElement:function(t){this.createSelectionBox(t),this.updateSelectionWrapper()},removeElements:function(t){var e=this.collection.toArray();this.cancelSelection(),this.options.graph.removeCells(e,{selection:this.cid})},startRotating:function(t){var e=this.options,i=e.paper,e=e.graph,r=(e.trigger("batch:start"),this.collection.toArray()),e=e.getCellsBBox(this.model.models).center(),i=i.snapToGrid(t.clientX,t.clientY),n=r.reduce(function(o,s){return o[s.id]=s.angle(),o},{}),r=r.reduce(function(o,s){return s.isLink()&&(o[s.id]={source:s.getSourceCell()?null:s.get("source"),target:s.getTargetCell()?null:s.get("target"),vertices:s.vertices()}),o},{});this.eventData(t,{center:e,clientAngle:i.theta(e),initialAngles:n,initialPoints:r})},startResizing:function(t){var e=this.options,n=this.collection,v=e.paperScroller,a=e.paper,e=e.graph,i=a.options.gridSize,n=n.toArray(),o=e.getCellsBBox(n),r=o.width,o=o.height,a=a.snapToGrid(t.clientX,t.clientY),s=a.x,a=a.y,l=n.map(function(N){var I=N.angle(),N=N.getBBox(),G=N.bbox(I),F=I<=90?I/90:I<=270?Math.abs(180-I)/90:Math.abs(I-360)/90;return{angle:I,unrotatedBBox:N,bbox:G,factor:F,center:G.center()}}),h=l.reduce(function(k,I){return I=I.unrotatedBBox,I.width<k?I.width:k},1/0),u=l.reduce(function(k,I){return I=I.unrotatedBBox,I.height<k?I.height:k},1/0),m=e.getSubgraph(n),d=m.filter(function(k){return k.isLink()}),p=d.map(function(k){return{source:k.getSourceCell()?null:k.get("source"),target:k.getTargetCell()?null:k.get("target"),vertices:k.vertices()}}),m=e.getCellsBBox(m),v=v&&v.options.scrollWhileDragging;this.eventData(t,{size:{width:r,height:o},rotatedBBox:e.getCellsBBox(n),minWidth:i*r/h,minHeight:i*o/u,x0:s,y0:a,pointerX:s,pointerY:a,elements:n,elementsRecords:l,links:d,linksRecords:p,cellsBBox:m,scrollWhileDragging:v}),e.trigger("batch:start")},doResize:function(I){var e=this.eventData(I),i=e.size,n=e.rotatedBBox,r=e.minWidth,o=e.minHeight,s=e.x0,a=e.y0,l=e.pointerX,h=e.pointerY,u=e.elements,d=e.elementsRecords,p=e.links,m=e.linksRecords,v=e.cellsBBox,I=this.options.paper.snapToGrid(I.clientX,I.clientY),k=I.x,I=I.y;if(k!==l||I!==h){e.lastX=k,e.lastY=I;for(var l=i.width,h=i.height,e=Math.max(l+k-s,r),i=Math.max(h+I-a,o),N=(this.options.preserveAspectRatio&&(e<(k=l*i/h)?i=h*e/l:e=k),Math.max(e/l,0)),G=Math.max(i/h,0),F=0,H=u.length;F<H;F++){var Y=u[F],K=d[F],tt=K.bbox,_=K.unrotatedBBox,vt=K.factor,b=K.center,K=K.angle,vt=new Q(N,G).lerp(new Q(G,N),vt),_=_.clone().scale(vt.x,vt.y,b),vt=_.bbox(K),b=vt.width-tt.width,K=vt.height-tt.height,vt=(Math.abs(b)<.001&&(b=0),Math.abs(K)<.001&&(K=0),new Q(n.x,0).distance(new Q(tt.x,0))),tt=new Q(0,n.y).distance(new Q(0,tt.y)),b=b/2+vt*N-vt,vt=K/2+tt*G-tt;if(Math.abs(b)<.001&&(b=0),Math.abs(vt)<.001&&(vt=0),_.translate(b,vt),F===0&&Y.getBBox().equals(_))return;Y.set({position:{x:_.x,y:_.y},size:{width:_.width,height:_.height}},{selection:this.cid})}for(var O=0,M=p.length;O<M;O++){var T=p[O],x=m[O],j=x.source,f=x.target,x=x.vertices,C={};0<x.length&&(C.vertices=x.map(function(D){return D=new Q(D),D.scale(N,G,v.origin()),D.toJSON()})),j&&((x=new Q(j)).scale(N,G,v.origin()),C.source=x.toJSON()),f&&((j=new Q(f)).scale(N,G,v.origin()),C.target=j.toJSON()),T.set(C,{selection:this.cid})}this.updateSelectionBoxes()}},doRotate:function(r){var e=this,i=this.eventData(r),n=this.options.rotateAngleGrid,r=this.options.paper.snapToGrid(r.clientX,r.clientY),o=i.clientAngle-se(r).theta(i.center);.001<Math.abs(o)&&(this.collection.each(function(s){var a,l,h,u,d,p=Ce(i.initialAngles[s.id]+o,n);if(s.isLink())return a=(h=i.initialPoints[s.id]).source,l=h.target,h=h.vertices,u=function(m){return Q(m).rotate(i.center,-p)},d={},a&&(d.source=u(a)),l&&(d.target=u(l)),0<h.length&&(d.vertices=h.map(u)),s.set(d,{selection:e.cid});s.rotate(p,!0,i.center,{selection:e.cid})}),this.updateSelectionBoxes())},stopBatch:function(){this.options.graph.trigger("batch:stop")},getAction:function(){return this._action}},{depthComparator:function(t){return t.getAncestors().length},HandlePosition:{N:"n",NW:"nw",W:"w",SW:"sw",S:"s",SE:"se",E:"e",NE:"ne"},ConnectedLinksTranslation:eh}),Da=Ji,Be=ke.extend({options:{paper:void 0,usePaperGrid:!1,distance:10,canSnap:null,additionalSnapPoints:null},className:"snaplines",documentEvents:{mouseup:"hide",touchend:"hide"},init:function(){yi(this,"hide"),this.render(),this.enable(),this.prepareFilters()},render:function(){var t=this.$el,e=this.options,i=this.$horizontal=P("<div>").addClass("snapline horizontal"),n=this.$vertical=P("<div>").addClass("snapline vertical");t.hide().append([i,n]).appendTo(e.paper.el)},startListening:function(){this.enable()},_isEnabled:!1,enable:function(){var t=this.options.paper;this.disable(),this.listenTo(t,"element:pointerdown",this.captureCursorOffset),this.listenTo(t,"element:pointermove",this.snapWhileMoving),this.listenTo(t.model,"batch:stop",this.onBatchStop),this.delegateDocumentEvents(),this._isEnabled=!0},disable:function(){var t=this.options.paper;this.stopListening(t,"element:pointerdown",this.captureCursorOffset),this.stopListening(t,"element:pointermove",this.snapWhileMoving),this.stopListening(t.model,"batch:stop",this.onBatchStop),this.undelegateDocumentEvents(),this._isEnabled=!1},isDisabled:function(){return!this._isEnabled},prepareFilters:function(){this.filterTypes={},this.filterCells={},this.filterFunction=void 0,Array.isArray(this.options.filter)?this.options.filter.forEach(function(t){Ft(t)?this.filterTypes[t]=!0:this.filterCells[t.id]=!0},this):Rt(this.options.filter)&&(this.filterFunction=this.options.filter)},onBatchStop:function(t){(t=t||{}).batchName==="resize"&&this.snapWhileResizing(t.cell,t)},captureCursorOffset:function(t,e,i,n){var r,o=t.getDelegatedView();o&&(o=o.model.get("position"),Rt(this.options.additionalSnapPoints)&&(r=this.options.additionalSnapPoints.call(this,t,{type:"move"})),this.eventData(e,{cursorOffset:{x:i-o.x,y:n-o.y},points:r}))},snapWhileResizing:function(t,e){if(e.ui&&!e.snapped&&e.direction&&e.trueDirection){var i=this.options,n=i.paper,r=n.findViewByModel(t);if(r&&r.model.isElement()&&this.canElementSnap(r)){var o=t.getBBox(),s=o.bbox(t.get("angle")),a=s.origin(),l=s.corner(),h=Xe(t.get("angle")),u=i.distance,d=null,p=null,m=n.options.gridSize,v={vertical:0,horizontal:0},k=e.direction,I=e.trueDirection,N=e.relativeDirection;if(I.indexOf("right")!==-1?v.vertical=l.x:v.vertical=a.x,I.indexOf("bottom")!==-1?v.horizontal=l.y:v.horizontal=a.y,Rt(this.options.additionalSnapPoints))for(var G=this.options.additionalSnapPoints.call(this,r,{type:"resize"}),F=0;F<G.length;F++){var H=G[F];if(d===null&&Math.abs(H.x-v.vertical)<u&&(d=H.x),p===null&&Math.abs(H.y-v.horizontal)<u&&(p=H.y),Nt(d)&&Nt(p))break}if(Nt(d)&&Nt(p)||n.model.getElements().find(function(O){var M,T;return!(O.id===t.id||O.isEmbeddedIn(t)||this.filterTypes[O.get("type")]||this.filterCells[O.id]||this.filterFunction&&this.filterFunction(O))&&(M=(O=O.getBBox().bbox(O.get("angle"))).origin(),O=O.corner(),i.usePaperGrid&&(M.snapToGrid(m),O.snapToGrid(m)),T={vertical:[M.x,O.x],horizontal:[M.y,O.y]},Se(T,function(j,f){j=(j=j.map(function(x){return{position:x,distance:Math.abs(x-v[f])}})).filter(function(x){return x.distance<u}),j=vi(j,function(x){return x.distance}),T[f]=j}),d===null&&0<T.vertical.length&&(d=T.vertical[0].position),p===null&&0<T.horizontal.length&&(p=T.horizontal[0].position),Nt(d)&&Nt(p))},this),this.hide(),Nt(d)||Nt(p)){var Y=0,_=(Nt(d)&&(Y=I.indexOf("right")!==-1?d-s.corner().x:s.origin().x-d),0),K=(Nt(p)&&(_=I.indexOf("bottom")!==-1?p-s.corner().y:s.origin().y-p),0),tt=0;if(!(h%90))tt=h===90||h===270?(K=_,Y):(K=Y,_);else{var l=0<=h&&h<90?1:90<=h&&h<180?4:180<=h&&h<270?3:2,b=(p&&d&&(Y<_?(_=0,p=null):(Y=0,d=null)),Qe(h%90)),vt=(Y&&(K=l===3?Y/Math.cos(b):Y/Math.sin(b)),_&&(tt=l===3?_/Math.cos(b):_/Math.sin(b)),l===1||l===3);switch(N){case"top":case"bottom":tt=_?_/(vt?Math.cos(b):Math.sin(b)):Y/(vt?Math.sin(b):Math.cos(b));break;case"left":case"right":K=Y?Y/(vt?Math.cos(b):Math.sin(b)):_/(vt?Math.sin(b):Math.cos(b))}}switch(N){case"top":case"bottom":K=0;break;case"left":case"right":tt=0}a=Math.max(o.width+K,m),r=Math.max(o.height+tt,m),n=(e.minWidth&&e.minWidth>m&&(a=Math.max(a,e.minWidth)),e.minHeight&&e.minHeight>m&&(r=Math.max(r,e.minHeight)),e.maxWidth&&(a=Math.min(a,e.maxWidth)),e.maxHeight&&(r=Math.min(r,e.maxHeight)),e.preserveAspectRatio&&(tt<K?r=a*(o.height/o.width):a=r*(o.width/o.height)),a===o.width&&r===o.height||t.resize(a,r,{snaplines:this.cid,direction:k,relativeDirection:N,trueDirection:I,snapped:!0}),t.getBBox().bbox(h)),d&&1<Math.abs(n.x-d)&&1<Math.abs(n.width+n.x-d)&&(d=null),p&&1<Math.abs(n.y-p)&&1<Math.abs(n.height+n.y-p)&&(p=null),this.show({vertical:d,horizontal:p})}}}},canElementSnap:function(t,e){var i=!0,n=!1;return Rt(this.options.canSnap)&&(i=this.options.canSnap.call(this,t)),e&&(n=t.isDefaultInteractionPrevented(e)),i&&this.canElementMove(t)&&!n},canElementMove:function(t){return t&&t.model.isElement()&&t.can("elementMove")},snapWhileMoving:function(t,e,i,n){var o=t.eventData(e),r=this.eventData(e),o=o.delegatedView||t;if(this.canElementSnap(o,e)){var s=o.model,t=s.get("size"),e=It(ct({x:i-r.cursorOffset.x,y:n-r.cursorOffset.y},t)),a=e.center(),t=e.bbox(s.get("angle")),l=t.origin(),h=t.corner(),u=this.options,d=u.paper,p=u.distance,m=null,v=null,k=0,I=0;if(r.points)for(var N=r.points,G=0;G<N.length;G++){var F=N[G];if(m===null&&(Math.abs(F.x-a.x)<p?(m=F.x,k=.5):Math.abs(F.x-l.x)<p?m=F.x:Math.abs(F.x-h.x)<p&&(m=F.x,k=1)),v===null&&(Math.abs(F.y-a.y)<p?(v=F.y,I=.5):Math.abs(F.y-l.y)<p?v=F.y:Math.abs(F.y-h.y)<p&&(v=F.y,I=1)),Nt(m)&&Nt(v))break}Nt(m)&&Nt(v)||d.model.getElements().find(function(_){var K,tt;return!(_===s||_.isEmbeddedIn(s)||this.filterTypes[_.get("type")]||this.filterCells[_.id]||this.filterFunction&&this.filterFunction(_))&&(K=(_=_.getBBox().bbox(_.get("angle"))).center(),tt=_.origin(),_=_.corner(),m===null&&(Math.abs(K.x-a.x)<p?(m=K.x,k=.5):Math.abs(tt.x-l.x)<p?m=tt.x:Math.abs(tt.x-h.x)<p?(m=tt.x,k=1):Math.abs(_.x-h.x)<p?(m=_.x,k=1):Math.abs(_.x-l.x)<p&&(m=_.x)),v===null&&(Math.abs(K.y-a.y)<p?(v=K.y,I=.5):Math.abs(tt.y-l.y)<p?v=tt.y:Math.abs(tt.y-h.y)<p?(v=tt.y,I=1):Math.abs(_.y-h.y)<p?(v=_.y,I=1):Math.abs(_.y-l.y)<p&&(v=_.y)),Nt(m)&&Nt(v))},this),this.hide(),(Nt(m)||Nt(v))&&(Nt(m)&&(t.x=m-k*t.width),Nt(v)&&(t.y=v-I*t.height),t=(r=t.center()).x-e.width/2,r=r.y-e.height/2,e=new Q(t,r),u.usePaperGrid&&e.snapToGrid(d.options.gridSize),s.position(e.x,e.y,{restrictedArea:d.getRestrictedArea(o,i,n),deep:!0,snapped:!0}),this.show({vertical:m,horizontal:v}))}},show:function(i){var e=(i=i===void 0?{}:i).vertical,i=i.horizontal,h=this.options,n=this.$horizontal,r=this.$vertical,o=this.$el,h=h.paper.matrix(),s=h.a,a=h.d,l=h.e,h=h.f;Nt(i)?n.css("top",i*a+h).show():n.hide(),Nt(e)?r.css("left",e*s+l).show():r.hide(),o.show()},hide:function(){this.$el.hide()}},{HandlePosition:{N:"n",NW:"nw",W:"w",SW:"sw",S:"s",SE:"se",E:"e",NE:"ne"}}),Sg={options:function(){return{columnWidth:this.options.width/2-10,columns:2,rowHeight:80,resizeToFit:!0,dy:10,dx:10}},layoutGroup:function(t,e){var i=this.options.layout;if(e=e||{},!xc)throw new Error("ui.Stencil: joint.layout.GridLayout is not available.");xc.layout(t,ct({},i,e.layout))}},Bn=ke.extend({className:"stencil",events:{"click .btn-expand":"openGroups","click .btn-collapse":"closeGroups","click .groups-toggle > .group-label":"openGroups","click .group > .group-label":"onGroupLabelClick","touchstart .group > .group-label":"onGroupLabelClick","input .search":"onSearch","focusin .search":"pointerFocusIn","focusout .search":"pointerFocusOut"},documentEvents:{mousemove:"onDrag",touchmove:"onDrag",mouseup:"onDragEnd",touchend:"onDragEnd",touchcancel:"onDragEnd"},options:{width:200,height:800,label:"Stencil",groups:null,groupsToggleButtons:!1,dropAnimation:!1,search:null,layout:null,snaplines:null,scaleClones:!1,usePaperGrid:!1,dragStartClone:function(t){return t.clone()},dragEndClone:function(t){return t.clone()},canDrag:null,layoutGroup:null,paperOptions:null,paperDragOptions:null,paperPadding:10,contentOptions:null,container:null},DEFAULT_GROUP:"__default__",init:function(){this.setPaper(this.options.paperScroller||this.options.paper),this.graphs={},this.papers={},this.$groups={},this.onSearch=Vn(this.onSearch,200),this.delegateEvents(),this.initializeLayout()},initializeLayout:function(){var t=this.options.layout;t&&(Rt(t)?this.layoutGroup=t:(this.layoutGroup=Sg.layoutGroup.bind(this),this.options.layout=Dt(t)?t:{},Jt(this.options.layout,Sg.options.call(this))))},setPaper:function(t){var e=this.options;if(t instanceof ki)e.paperScroller=null,e.paper=t,e.graph=t.model;else{if(!(typeof La=="function"&&t instanceof La))throw new Error("ui.Stencil: paper required");e.paperScroller=t,e.paper=t.options.paper,e.graph=t.options.paper.model}},freeze:function(t){var e=this.papers;Object.keys(e).forEach(function(i){e[i].freeze(t)})},unfreeze:function(t){var e=this.papers;Object.keys(e).forEach(function(i){e[i].unfreeze(t)})},renderContent:function(){return P("<div/>").addClass("content")},createDraggingPaper:function(){var t,e,i;this._paperDrag||(i=this.options,(t=document.createElement("div")).classList.add("stencil-paper-drag"),e=Fe(i,"paperOptions")||{},i=Fe(i,"paperDragOptions")||{},e=this._graphDrag=i.model||e.model||new wi({},{cellNamespace:this.defaultCellNamespace}),i=ct({cellViewNamespace:this.defaultCellViewNamespace},i,{el:t,width:1,height:1,model:e,sorting:ki.sorting.NONE}),this._paperDrag=new ki(i))},renderSearch:function(){return P("<div/>").addClass("search-wrap").append(P("<input/>",{type:"search",placeholder:"search"}).addClass("search"))},renderToggleAll:function(){return[P("<div/>").addClass("groups-toggle").append(P("<label/>").addClass("group-label").html(this.options.label)).append(P("<button/>",{text:"+"}).addClass("btn btn-expand")).append(P("<button/>",{text:"-"}).addClass("btn btn-collapse"))]},renderElementsContainer:function(){return P("<div/>").addClass("elements")},renderGroup:function(i){i=i||{};var e=P("<div/>").addClass("group").attr("data-name",i.name).toggleClass("closed",!!i.closed),i=P("<h3/>").addClass("group-label").html(i.label||i.name),n=this.renderElementsContainer();return e.append(i,n)},render:function(){this.dispose();var t,e=this.options,i=(this.$content=this.renderContent(),this.$el.empty().append(this.$content),e.search&&this.$el.addClass("searchable").prepend(this.renderSearch()),e.groupsToggleButtons&&this.$el.addClass("collapsible").prepend(this.renderToggleAll()),this.el.dataset.textNoMatchesFound="No matches found",Object.keys(e.groups||{})),n=0<i.length;if(e.paperOptions&&!Rt(e.paperOptions)&&e.paperOptions.model)throw new Error("ui.Stencil: the `paperOptions` has to be a function if there is the property `model` defined.");return n?vi(i,(function(r){return this[r].index}).bind(e.groups)).forEach(function(r){var o=this.options.groups[r],l=this.$groups[r]=this.renderGroup({name:r,label:o.label,closed:o.closed}).appendTo(this.$content);if(o.paperOptions&&o.paperOptions.model)throw new Error("ui.Stencil: the `model` property is not allowed in the `paperOptions` for the groups.");var l=l.find(".elements")[0],a=this.getGroupPaperOptions(r),s=this.createGroupGraph(r,a),a=ct({cellViewNamespace:this.defaultCellViewNamespace},a,{el:l,model:s,interactive:!1,preventDefaultBlankAction:!1,width:o.width||e.width,height:o.height||e.height}),l=new ki(a);this.graphs[r]=s,this.papers[r]=l},this):(n=this.renderElementsContainer().appendTo(this.$content)[0],i=this.getGroupPaperOptions(null),t=this.createGroupGraph(null,i),i=ct({cellViewNamespace:this.defaultCellViewNamespace},i,{el:n,model:t,width:e.width,height:e.height,interactive:!1,preventDefaultBlankAction:!1}),n=new ki(i),this.graphs[this.DEFAULT_GROUP]=t,this.papers[this.DEFAULT_GROUP]=n),this.createDraggingPaper(),this.startListening(),this},getGroupPaperOptions:function(t){var e=this.options,e=[{},Fe(e,"paperOptions")];return t&&(t=Fe(this.getGroup(t),"paperOptions"),e.push(t)),ct.apply(ld,e)},createGroupGraph:function(t,e){return e=e.model||new wi({},{cellNamespace:this.defaultCellNamespace}),e.set("group",t),e},paperEvents:{"cell:pointerdown":"onDragStart"},startListening:function(){var t,e=this,i=(this.stopListening(),this.paperEvents),n=this.papers;for(t in i)(function(r){var o=i[r];(o=typeof o!="function"?e[o]:o)&&Se(n,function(s){e.listenTo(s,r,o)})})(t)},load:function(t,e){Array.isArray(t)?this.loadGroup(t,e):Dt(t)&&Se(this.options.groups,(function(i,n){t[n]&&this.loadGroup(t[n],n)}).bind(this))},loadGroup:function(r,e){var i=this.options,n=this.getGraph(e),r=(n.resetCells(r),i.height);e&&(r=this.getGroup(e).height),this.isLayoutEnabled()&&this.layoutGroup(n,this.getGroup(e)),r||this.fitPaperToContent(this.getPaper(e))},isLayoutEnabled:function(){return!!this.options.layout},getGraph:function(t){var e=this.graphs[t||this.DEFAULT_GROUP];if(e)return e;throw new Error("ui.Stencil: group "+t+" does not exist.")},getPaper:function(t){return this.papers[t||this.DEFAULT_GROUP]},hasSnaplinesEnabled:function(){var t=this.options.snaplines;return!!t&&!t.isDisabled()},preparePaperForDragging:function(t,e,i){var h=this._paperDrag,r=this._graphDrag,n=this.options,s=n.snaplines,a=n.usePaperGrid,l=n.scaleClones,o=n.paper,n=n.container,r=(this.stopListening(r),h.$el.stop(!0,!0),h.$el.addClass("dragging").appendTo(n||document.body),this.positionCell(t,0,0),r.resetCells([t]),5),o=(s&&(r+=s.options.distance),s||a||l?(a=(s=o.scale()).sx,l=s.sy,h.scale(a,l),r*=Math.max(a,l)):h.scale(1,1),h.fitToContent({padding:r,allowNewOrigin:"any"}),t.findView(h)),s=o.getBBox({useModelGeometry:!0}),a=s.origin().difference(o.getBBox().origin()),l=this.setPaperDragOffset(e,i,{cloneGeometryBBox:s,cloneViewDeltaOrigin:a,paperDragPadding:r}),h=P(n).offset();return h&&(l.left-=h.left,l.top-=h.top),{clone:t,cloneView:o,cloneBBox:t.getBBox(),cloneGeometryBBox:s,cloneViewDeltaOrigin:a,paperDragPadding:r,paperDragInitialOffset:l}},removePaperAfterDragging:function(){var t=this._paperDrag;this._graphDrag.resetCells([]),this.$el.append(t.$el).removeClass("dragging"),t.$el.removeClass("dragging")},setPaperDragOffset:function(l,e,o){var n=o.cloneViewDeltaOrigin,r=o.cloneGeometryBBox,o=o.paperDragPadding,s=document.body,a=document.documentElement,s=s.scrollTop||a.scrollTop,a=l-n.x-r.width/2-o,l=e-n.y-r.height/2-o+s;return this._paperDrag.$el.offset({left:a,top:l}),{left:a,top:l}},onCloneSnapped:function(t,e,i){var n,r,o,s=this._dragging;s&&(r=i.snapped,n=i.tx,i=i.ty,r?(r=s.cloneBBox,o=s.cloneView,this.positionCell(t,r.x+n,r.y+i,{silent:!0}),o.translate(),t.set("position",e,{silent:!0}),s.snapOffset={x:n,y:i}):s.snapOffset=null)},_dragging:null,onDragStart:function(t,e){var n=this.options,i=n.canDrag,n=n.dragStartClone,r=t.model,o=r.graph.attributes.group;if(o===void 0&&(o=null),typeof i!="function"||i.call(this,t,e,o)){if(i=n(r),r===i||!(i instanceof bi))throw new Error("ui.Stencil: `dragStartClone` must return a clone of the cell");this.startDragging(i,e)}},startDragging:function(t,e){var r=this.options,i=this._graphDrag,n=r.snaplines,r=(r.usePaperGrid,this.createDraggingPaper(),this.$el.addClass("dragging"),e.clientX),o=e.clientY,l=this.preparePaperForDragging(t,r=r===void 0?0:r,o=o===void 0?0:o),s=l.cloneView,a=(this._dragging=l,this.getCloneArea(s,e,!1)),l=(ct(l,{clientX:r,clientY:o,validDropTarget:!1,cloneArea:a}),this.positionCell(t,a.x,a.y,{silent:!0}),t.isElement()&&this.hasSnaplinesEnabled()&&(n.captureCursorOffset(s,e,a.x,a.y),this.listenTo(i,"change:position",this.onCloneSnapped.bind(this))),e.data||(e.data={}));this.delegateDocumentEvents(null,l),this.trigger("element:dragstart",s,e,a.clone(),!1),s.stopListening(),this.isDragCanceled()&&(this.notifyDragEnd(s,e,a,!1),this._dragging=null)},onDrag:function(t){var e,i,n,r,o,s,a,l,h,u,d=this._dragging,p=this.options;d&&(t.preventDefault(),e=Tt(t),this.isDragCanceled()?(i=d.cloneView,r=d.validDropTarget,n=d.cloneArea,this.notifyDragEnd(i,e,n,r),this._dragging=null):(i=d.clone,n=d.cloneView,r=p.paper,o=p.snaplines,p=p.usePaperGrid,s=this.insideValidArea({x:e.clientX,y:e.clientY}),a=(l=(p=this.getCloneArea(n,e,s&&p)).center()).x,l=l.y,u=(h=r.localToClientPoint(a,l)).x,h=h.y,ct(d,{clientX:u,clientY:h,validDropTarget:s,cloneArea:p}),this.setPaperDragOffset(u,h,d),this.positionCell(i,0,0,{silent:!0}),n.translate(),this.positionCell(i,p.x,p.y,{stencil:this.cid}),this.hasSnaplinesEnabled()&&(s?o.snapWhileMoving(n,e,p.x,p.y):o.hide()),r.options.embeddingMode&&i.isElement()&&(n.eventData(e,{paper:r}),u=d.cloneViewEventData=n.eventData(e),s?n.processEmbedding(u,t,a,l):n.clearEmbedding(u)),n.startListening(),this.trigger("element:drag",n,e,p.clone(),s),n.stopListening(),this.isDragCanceled()&&(this.notifyDragEnd(n,e,p,s),this._dragging=null)))},onDragEnd:function(t){var e,i,n,r,o,s,a,l,h=this._dragging,u=this.options;h&&(t=Tt(t),a=h.clone,e=h.clientX,i=h.clientY,n=h.validDropTarget,r=h.cloneArea,o=h.cloneView,s=h.cloneBBox,h=h.snapOffset,l=s.x,s=s.y,h&&(l+=h.x,s+=h.y),this.positionCell(a,l,s,{silent:!0}),this.notifyDragEnd(o,t,r,n),this.isDragCanceled()||(a=u.paper.clientToLocalPoint(e,i),l=!h,n?this.onDrop(o,t,a,l):this.onDropInvalid(o,t,a,l)),this._dragging=null)},notifyDragEnd:function(t,e,i,n){t.startListening(),this.trigger("element:dragend",t,e,i.clone(),n),t.stopListening(),this.undelegateDocumentEvents()},onDrop:function(t,e,i,n){var l=this.options,r=l.paper,o=l.graph,s=r.options.embeddingMode,a=t.model,l=(o.startBatch("stencil-drag"),l.dragEndClone(a));if(a===l||!(l instanceof bi))throw new Error("ui.Stencil: `dragEndClone` must return a clone of the cell");this.drop(l,i,n),s&&a.isElement()&&(t.eventData(e,{model:l,paper:r,initialParentId:Ml(),whenNotAllowed:"remove"}),t.finalizeEmbedding(t.eventData(e))),o.getCell(l)?(this.trigger("element:drop",l.findView(r),e,i.x,i.y),this.removePaperAfterDragging(a)):this.onDropInvalid(t,e,i,n),o.stopBatch("stencil-drag")},onDropInvalid:function(t,e,i,n){t=t.model,t=this.options.dragEndClone(t),this.trigger("drop:invalid",e,t,i.x,i.y),this.cancelDrag()},cancelDrag:function(s){var e,i,n,r,o,s=(s=s===void 0?this.options:s).dropAnimation,a=this._dragging,l=this.options,h=this._paperDrag;a&&(e=a.clone,o=a.cloneView,i=a.cloneViewEventData,n=a.paperDragInitialOffset,r=l.paper,l=l.snaplines,r.options.embeddingMode&&i&&e.isElement()&&o.clearEmbedding(i),this.hasSnaplinesEnabled()&&l.hide(),a.canceled=!0,s?(r=s.duration,o=s.easing,h.$el.animate(n,r=r===void 0?150:r,o=o===void 0?"swing":o,this.removePaperAfterDragging.bind(this,e))):this.removePaperAfterDragging(e))},isDragCanceled:function(){var t=this._dragging;return!!t&&!!t.canceled},drop:function(t,s,i){var r=this.options,n=r.paper,r=r.graph,o=t.getBBox(),s=new Q({x:s.x+o.x-o.width/2,y:s.y+o.y-o.height/2});i&&s.snapToGrid(n.options.gridSize),t.unset("z"),this.positionCell(t,s.x,s.y),r.addCell(t,{stencil:this.cid})},insideValidArea:function(t){var i=this.options,e=i.paper,i=i.paperScroller,n=this.getDropArea(this.$el);return!(!(i=i?i.options.autoResizePaper?this.getDropArea(i.$el):(i=this.getDropArea(i.$el),this.getDropArea(e.$el).intersect(i)):this.getDropArea(e.$el))||!i.containsPoint(t)||n.containsPoint(t))},getDropArea:function(e){var e=P(e),n=e.offset(),i=n.left,n=n.top,o=document.body,s=document.documentElement,r=o.scrollTop||s.scrollTop,o=o.scrollLeft||s.scrollLeft,s=parseInt(e.css("border-left-width"),10),a=parseInt(e.css("border-top-width"),10);return new nt({x:i+s-o,y:n+a-r,width:e.innerWidth(),height:e.innerHeight()})},getCloneArea:function(o,s,i){var n=this.options.paper,o=o.model,a=s.clientX,s=s.clientY,a=n.clientToLocalPoint(a,s),s=a.x,a=a.y,o=o.getBBox(),r=o.width,o=o.height,s=s-r/2,a=a-o/2;return i&&(s=(i=n.snapToGrid(n.localToClientPoint(s,a))).x,a=i.y),new nt(s,a,r,o)},filter:function(t,e){var i=this,n=(e===void 0&&(e=this.options.search),Object.keys(this.papers).reduce(function(r,o){var s=i.papers[o],a=o===i.DEFAULT_GROUP?null:o,l=s.model.getCells().filter(function(m){var p=!1,m=(e&&(p=Rt(e)?e.call(i,m,t,a,i):i.isCellMatched(m,t,e,t.toLowerCase()!==t)),s.findViewByModel(m));return m&&m.vel.toggleClass("unmatched",!p),p}),h=!pt(l),u=i.getGroupPaperOptions(a),u=i.createGroupGraph(a,u);return u.resetCells(l),i.trigger("filter",u,o,t),i.isLayoutEnabled()&&i.layoutGroup(u,i.getGroup(o)),i.$groups[o]&&i.$groups[o].toggleClass("unmatched",!h),i.fitPaperToContent(s),r||h},!1));this.$el.toggleClass("not-found",!n)},isCellMatched:function(t,e,i,n){return!e||Object.keys(i).some(function(r){var o=i[r];return(r=="*"||t.get("type")==r)&&o.some(function(s){return s=Vi(t.attributes,s,"/"),s!=null&&(s=s.toString(),0<=(s=n?s:s.toLowerCase()).indexOf(e))})})},fitPaperToContent:function(t){var e=this.options,i=t.getComputedSize().width,i=ct({minWidth:i,padding:e.paperPadding},e.contentOptions);t.fitToContent(i)},getGroup:function(t){return this.options.groups&&this.options.groups[t]||{}},onSearch:function(t){t=t.target.value,this.$el.toggleClass("stencil-filtered",0<t.length),this.filter(t,this.options.search)},pointerFocusIn:function(){this.$el.addClass("is-focused")},pointerFocusOut:function(){this.$el.removeClass("is-focused")},onGroupLabelClick:function(t){if(t.type==="touchstart")this._groupLabelClicked=!0;else if(this._groupLabelClicked&&t.type==="click")return void(this._groupLabelClicked=!1);t=P(t.target).closest(".group"),this.toggleGroup(t.data("name"))},toggleGroup:function(t){this.isGroupOpen(t)?this.closeGroup(t):this.openGroup(t)},closeGroup:function(t){var e=this.$groups[t];e&&this.isGroupOpen(t)&&(this.trigger("group:close",t),e.addClass("closed"))},openGroup:function(t){var e=this.$groups[t];e&&!this.isGroupOpen(t)&&(this.trigger("group:open",t),e.removeClass("closed"))},isGroupOpen:function(t){return t=this.$groups[t],!!t&&!t.hasClass("closed")},closeGroups:function(){Object.keys(this.$groups).forEach(function(t){this.closeGroup(t)},this)},openGroups:function(){Object.keys(this.$groups).forEach(function(t){this.openGroup(t)},this)},positionCell:function(t,e,i,n){var r;t.isElement()?t.position(e,i,n):(r=t.getBBox(),t.translate(e-r.x,i-r.y,n))},onRemove:function(){this.dispose()},dispose:function(){qe(this.papers,"remove"),this.papers={},this._paperDrag&&(this._paperDrag.remove(),this._paperDrag=null),this.undelegateDocumentEvents()}}),kg=(Object.defineProperty(Bn.prototype,"defaultCellNamespace",{enumerable:!0,get:function(){return this.options.paper.model.get("cells").cellNamespace}}),Object.defineProperty(Bn.prototype,"defaultCellViewNamespace",{enumerable:!0,get:function(){return this.options.paper.options.cellViewNamespace}}),X.mergeAttrs),Tg=yt,Ng=pt,Pg=Il,gm=Qr;function Ds(t,e,i){var n=(i=i===void 0?{}:i).merge,r=(n===void 0&&(n=kg),{});return t.forEach(function(l){var s=l.start,a=l.end,l=l.attrs;(s===void 0&&a===void 0||s<=e&&e<a)&&n(r,l)}),r}function Mc(t,e,i,n){var r=(n=n===void 0?{}:n).delim,o=(r===void 0&&(r="/"),n.merge),s=(o===void 0&&(o=kg),X.findAnnotationsBetweenIndexes(t,e,i));if(e===i)return Ds(s,e,n);for(var a=e;a<i;a++){var l=Ds(s,a,n);if(u&&!Tg(u,l)){var h,u=Pg(o({},u),r),d={};for(h in l=Pg(o({},l),r))u[h]===l[h]&&gm(d,h,l[h],r);u=d}else u=l}return u}var Bs=ke.extend({options:{text:void 0,newlineCharacterBBoxWidth:10,placeholder:void 0,focus:!0,debug:!1,selectAllThreshold:20,useNativeSelection:!0,annotateUrls:!1,urlAnnotation:{attrs:{class:"url-annotation",fill:"lightblue","text-decoration":"underline"}},textareaAttributes:{autocorrect:"off",autocomplete:"off",autocapitalize:"off",spellcheck:"false",tabindex:"0"}},className:"text-editor",events:{"keyup textarea":"onKeyup","input textarea":"onInput","copy textarea":"onCopy","cut textarea":"onCut","paste textarea":"onPaste","mousedown .char-selection-box":"onMousedown","dblclick .char-selection-box":"onDoubleClick","click .char-selection-box":"onTripleClick"},selection:{start:null,end:null},selecting:!1,_textCursor:null,AFTER_KEYDOWN_DELAY:10,DEFAULT_FONT_SIZE:12,init:function(){yi(this,"onMousedown","onMousemove","onMouseup","onDoubleClick","onTripleClick","onKeydown","onAfterPaste","onAfterKeydown","onDocumentPointerdown");var t=this.options.text;if(!t)throw new Error("ui.TextEditor: text option is mandatory");this.setTextElement(t),document.addEventListener("pointerdown",this.onDocumentPointerdown,{capture:!0}),P(document.body).on("mousemove",this.onMousemove),P(document.body).on("mouseup",this.onMouseup),P(document.body).on("keydown",this.onKeydown),this.$viewport=P(t),this.options.annotations&&this.setAnnotations(this.options.annotations)},setTextElement:function(t){this.options.text=t,this.bindTextElement(t)},bindTextElement:function(t){var e;this.unbindTextElement(),t&&((e=P(t)).on("mousedown",this.onMousedown),e.on("dblclick",this.onDoubleClick),e.on("click",this.onTripleClick),this.elText=t)},unbindTextElement:function(){var t=this.elText;t&&((t=P(t)).off("mousedown",this.onMousedown),t.off("dblclick",this.onDoubleClick),t.off("click",this.onTripleClick),this.elText=null)},render:function(e){this.$caret=P("<div>",{class:"caret"}),this.$selection=P("<div>"),this.$selectionBox=P("<div>",{class:"char-selection-box"}),this.$el.append(this.$caret,this.$selection),this.$textareaContainer=P("<div>",{class:"textarea-container"}),this.$textarea=P("<textarea>",this.options.textareaAttributes),this.textarea=this.$textarea[0],this._textContent=this.textarea.value=this.getTextContent(),this._textareaValueBeforeInput=this.textarea.value,this.$textareaContainer.append(this.textarea),this.options.focus&&this.$el.append(this.$textareaContainer),P(e||document.body).append(this.$el);var e=X(this.options.text),i=e.bbox();return this.$textareaContainer.css({left:i.x,top:i.y}),this.focus(),this._textCursor=e.attr("cursor"),e.attr("cursor","text"),this.selectAll(),this},annotateURLBeforeCaret:function(t){var e,i;return t!==0&&(t=Math.max(t-1,0),e=this.getURLBoundary(t),i=this.getAnnotations()||[],e?(this.annotateURL(i,e[0],e[1]),!0):!!X.findAnnotationsAtIndex(i,t).some(function(n){return n.url}))},hasSelection:function(){return Nt(this.selection.start)&&Nt(this.selection.end)&&this.selection.start!==this.selection.end},textContentHasChanged:function(){return this._textContent!==this.textarea.value},restoreTextAreaSelectionDirection:function(){this._selectionDirection&&(this.textarea.selectionDirection=this._selectionDirection)},storeSelectionDirection:function(){this._selectionDirection=this.textarea.selectionDirection},updateSelectionFromTextarea:function(){var e=this.textarea,t=e.selectionStart,e=e.selectionEnd;t===e?this.setCaret(t):this.select(t,e)},textSelectionHasChanged:function(){var t=this.selection,e=this.textarea;return!(!t||!e)&&(t.start!==e.selectionStart||t.end!==e.selectionEnd)},isModifierKey:function(t){return[16,18,17,91].some(function(e){return t.which===e})},isArrowKey:function(t){return 37<=t.which&&t.which<=40},copyToClipboard:function(){document.queryCommandSupported&&document.queryCommandSupported("copy")&&(this._copied=!0,document.execCommand("copy"))},findAnnotationsUnderCursor:function(t,e){return X.findAnnotationsAtIndex(t,e)},findAnnotationsInSelection:function(t,e,i){return X.findAnnotationsBetweenIndexes(t,e,i)},inferTextOperationType:function(t,e,i){return t.start===t.end&&e.start===e.end&&0<i?"insert":t.start===t.end&&e.start===e.end&&i<=0?"delete-single":t.start!==t.end&&e.start===e.end&&e.start===t.start?"delete":t.start!==t.end&&e.start!==t.start?"delete-insert":void 0},annotate:function(t,e,i,n){var r=[],o=this.inferTextOperationType(e,i,n);return kt(t).forEach(function(s){var a,l,h;switch(o){case"insert":s.start<e.start&&e.start<=s.end?s.end+=n:s.start>=e.start&&(s.start+=n,s.end+=n);break;case"delete-single":s.start<e.start&&e.start<=s.end&&e.start!==i.start||s.start<=e.start&&e.start<s.end&&e.start===i.start?s.end+=n:s.start>=e.start&&(s.start+=n,s.end+=n);break;case"delete":s.start<=e.start&&e.start<=s.end?e.end<=s.end?s.end+=n:s.end+=i.start-s.end:s.start>=e.start&&s.start<e.end?(h=s.end-s.start,l=e.end-s.start,s.start=e.start,s.end=s.start+h-l):s.start>=e.end&&(s.start+=n,s.end+=n);break;case"delete-insert":s.start<=e.start&&e.start<=s.end?e.start<s.end&&(e.end>s.end?s.end=i.end:s.end=i.end+(s.end-e.end)):s.start>=e.start&&s.start<=e.end?(a=i.start-e.start,l=e.end-s.start,h=s.end-s.start,s.start=e.start+a,s.end=s.start+h-l):s.start>=e.start&&s.end<=e.end?s.start=s.end=0:s.start>=e.end&&(s.start+=n,s.end+=n);break;default:this.options.debug&&console.log("ui.TextEditor: Unknown text operation.")}s.end>s.start&&r.push(s)},this),r},shiftAnnotations:function(t,e,i){return X.shiftAnnotations(t,e,i)},setCurrentAnnotation:function(t){this._currentAnnotationAttributes=t},setAnnotations:function(t){this._annotations=t},getAnnotations:function(){return this._annotations},getCombinedAnnotationAttrsAtIndex:function(t,e){return Ds(kt(e),t)},getSelectionAttrs:function(n,e){var i=n.start,n=n.end;return i===(n=n===void 0?i:n)?Ds(e,i-1):Mc(e,i,n)},getTextContent:function(){var t=this.options.text,e=X(t).find(".v-line");return e.length===0?t.textContent:e.reduce(function(i,n,r,o){var s=n.node.textContent;return n.hasClass("v-empty-line")&&(s=""),r===o.length-1?i+s:i+s+`
`},"")},startSelecting:function(){this.selecting=!0},stopSelecting:function(){this.selecting=!1},selectionInProgress:function(){return this.selecting===!0},selectAll:function(){return this.select(0,this.getNumberOfChars())},select:function(o,s){var n=this.options,i=this.selection,n=(n.debug&&console.log("select(",o,s,")"),i.start),r=i.end,o=(s===void 0&&(s=o),Nt(o)&&(i.start=o),Nt(s)&&(i.end=s),Nt(i.end)||(i.end=i.start),i.start),s=i.end;return Nt(o)&&Nt(s)&&(n===o&&r===s||this.setCurrentAnnotation(null),o===s?(this.clearSelection(),this.focus(),this.setCaret(o)):(this.hideCaret(),this.setTextAreaSelection(o,s),i=this.textarea.value,s<o&&this.constructor.isLineEnding(i,s)?this.constructor.isLineStart(i,o)&&s!==o-1?this.renderSelection(s,o-2):this.renderSelection(s,o-1):this.renderSelection(o,s)),this.trigger("select:change",o,s)),this},setTextAreaSelection:function(t,e){t=this.normalizeSelectionRange({start:t,end:e}),this.textarea.focus(),this.textarea.selectionStart=t.start,this.textarea.selectionEnd=t.end},renderSelection:function(t,e){this.options.debug&&console.log("renderSelection()"),t=this.normalizeSelectionRange({start:t,end:e}),this.clearSelection(),this.options.useNativeSelection?(this.$viewport&&(this._viewportUserSelectBefore=this.$viewport.css("user-select"),this.$viewport.css({"-webkit-user-select":"all","-moz-user-select":"all","user-select":"all"})),e=t.end-t.start,this.selectTextInElement(this.options.text,t.start,e)):this.renderSelectionBoxes(t.start,t.end)},normalizeSelectionStartAndLength:function(n,e,i){var r=n.substr(0,e),n=n.substr(e,i),r=(e-=this.countLineBreaks(r),i-=this.countLineBreaks(n),this.countEmptyLines(r));return{start:e+=r,length:i=(i+=r)-r+this.countEmptyLines(n)}},selectTextInElement:function(t,e,i){if(Rt(t.selectSubString)&&this.selectTextInElementUsingSelectSubString(t,e,i),!this.actualSelectionMatchesExpectedSelection(e,i))try{this.selectTextInElementUsingRanges(t,e,i)}catch(n){this.options.debug&&console.log(n),Rt(t.selectSubString)&&this.selectTextInElementUsingSelectSubString(t,e,i)}},selectTextInElementUsingSelectSubString:function(t,e,i){e=this.normalizeSelectionStartAndLength(this.getTextContent(),e,i);try{t.selectSubString(e.start,e.length)}catch(n){this.options.debug&&console.log(n)}},selectTextInElementUsingRanges:function(t,e,i){for(var n,r,o,s=window.getSelection(),a=(s.removeAllRanges(),this.normalizeSelectionStartAndLength(this.getTextContent(),e,i)),l=(e=0+a.start,i=0+a.length,this.getTextNodesFromDomElement(t)),h=0,u=e+i,d=document.createRange();0<i&&0<l.length;)o=(r=h)+(n=l.shift()).length,(e<=r&&r<u||e<o&&o<=u||r<=e&&e<o||r<u&&u<=o)&&(r=Math.max(e-r,0),o=Math.min(r+Math.min(i,n.length),o),d.collapsed&&d.setStart(n,r),d.setEnd(n,o),i-=o-r),h+=n.length;d.collapsed||s.addRange(d)},actualSelectionMatchesExpectedSelection:function(t,e){var i=window.getSelection().toString();return this.getExpectedSelectedContent(t,e)===(i=i.replace(/\s/g," "))},getExpectedSelectedContent:function(t,e){return t=this.getTextContent().substr(t,e),t=(t=(t=(t=t.search(/(\n\r|\r|\n)/)===0?"-"+t:t).replace(/(\n\r|\r|\n){2,}/g,function(i){return Array.from({length:i.length-1},function(){return"-"}).join("")})).replace(/\n\r|\r|\n/g,"")).replace(/\s/g," ")},getTextNodesFromDomElement:function(t){for(var e=[],i=0,n=t.childNodes.length;i<n;i++){var r=t.childNodes[i];r.tagName!==void 0?e=e.concat(this.getTextNodesFromDomElement(r)):e.push(r)}return e},renderSelectionBoxes:function(t,e){this.options.debug&&console.log("renderSelectionBoxes()"),this.$selection.empty();for(var i,n,r,o=this.getFontSize(),s=this.getTextTransforms(),a=s.rotation,l=t;l<e;l++){var h=this.$selectionBox.clone();try{r=this.getCharBBox(l)}catch{this.trigger("select:out-of-range",t,e);break}n&&a===0&&Math.round(r.y)===Math.round(n.y)&&Math.round(r.height)===Math.round(n.height)&&Math.round(r.x)===Math.round(n.x+n.width)?i.css({width:"+="+r.width}):(h.css({left:r.x,top:r.y-r.height,width:r.width,height:r.height,"-webkit-transform":"rotate("+a+"deg)","-webkit-transform-origin":"0% 100%","-moz-transform":"rotate("+a+"deg)","-moz-transform-origin":"0% 100%"}),this.$selection.append(h),i=h),n=r}r&&this.$textareaContainer.css({left:r.x,top:r.y-o*s.scaleY})},clearSelection:function(){return this.options.debug&&console.log("clearSelection()"),this.$selection.empty(),this.options.text.selectSubString&&(this.$viewport&&this._viewportUserSelectBefore&&this.$viewport.css({"-webkit-user-select":this._viewportUserSelectBefore,"-moz-user-select":this._viewportUserSelectBefore,"user-select":this._viewportUserSelectBefore}),window.getSelection().removeAllRanges()),this},deselect:function(){return this.options.debug&&console.log("deselect()"),this.stopSelecting(),this.clearSelection(),this.setTextAreaSelection(this.selection.start,this.selection.end),this},getSelectionStart:function(){return this.selection.start},getSelectionEnd:function(){return this.selection.end},getSelectionRange:function(){return this.normalizeSelectionRange(this.selection)},normalizeSelectionRange:function(t){return(t=ot(t)).start>t.end&&(t.end=[t.start,t.start=t.end][0]),t},getSelectionLength:function(){var t=this.getSelectionRange();return t.end-t.start},getSelection:function(){var t=this.getSelectionRange();return this.getTextContent().slice(t.start,t.end)},getWordBoundary:function(t){for(var e=this.textarea.value,i=/\W/,n=t;n;){if(i.test(e[n])){n+=1;break}--n}for(var r=this.getNumberOfChars(),o=t;o<r&&!i.test(e[o]);)o+=1;return n<o?[n,o]:[o,n]},getURLBoundary:function(t){for(var e=this.textarea.value,i=/\s/,n=t;-1<n;){if(i.test(e[n])){n+=1;break}--n}for(var n=Math.max(n,0),r=this.getNumberOfChars(),o=Math.max(n,t);o<=r&&!i.test(e[o]);)o+=1;if(o=Math.min(o,r),/[-a-zA-Z0-9@:%_+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_+.~#?&//=]*)?/.test(e.substring(n,o)))return[n,o]},annotateURL:function(t,e,i){var n=this.textarea.value.substring(e,i);if(!t.some(function(s){return s.url===n&&s.start===e&&s.end===i})){var r,o=this.options.urlAnnotation;if(typeof o=="function"){if(!(r=o(n)))return t}else r=ct({},o);ct(r,{url:n,start:e,end:i}),t.push(r)}return t},getCharBBox:function(e){if(this.isLineEnding(e))return(r=this.getCharBBox(e-1)).x=r.x2,r.y=r.y2,r.width=this.options.newlineCharacterBBoxWidth||10,r;this.ensureTextVisibility();var r=this.realToSvgCharNum(e),e=this.options.text,i=e.getStartPositionOfChar(r),n=e.getEndPositionOfChar(r),e=e.getExtentOfChar(r),i=this.localToScreenCoordinates(i),n=this.localToScreenCoordinates(n),r=this.getTextTransforms();return{x:i.x,y:i.y,width:e.width*r.scaleX,height:e.height*r.scaleY,x2:n.x,y2:n.y}},realToSvgCharNum:function(t){for(var e=0,i=0;i<=t;i++)this.isLineEnding(i)&&(e+=1);return t-e},selectionStartToSvgCharNum:function(t){return t-this.nonEmptyLinesBefore(t)},svgToRealCharNum:function(t){for(var e=0,i=0;i<=t+e;i++)this.isLineEnding(i)&&(e+=1);return t+e},ensureTextVisibility:function(){P(this.options.text).show()},localToScreenCoordinates:function(t){return X.transformPoint(t,this.options.text.getCTM())},getNumberOfChars:function(){return this.getTextContent().length},getCharNumFromEvent:function(t){var e=this.options.text,e=X(e).toLocalPoint(t.clientX,t.clientY);return this.getCharNumAtPosition(e)},getCharNumAtPosition:function(t){this.ensureTextVisibility();var e=this.options.text,i=e.getCharNumAtPosition(t);if(i<0){var n=X(e).getBBox(),r=(n.inflate(-1),n.containsPoint(t));if(!r&&this.hasSelection()&&n.clone().inflate(this.options.selectAllThreshold).containsPoint(t))return this.selection.end;var r=r?t:n.pointNearestToPoint(t),o=X.createSVGPoint(r.x,r.y),s=e.getCharNumAtPosition(o),a=t.x>n.x;if(s===-1){var l,h=n.x,u=n.x+n.width,d=(h+u)/2;do{o.x=d;var p=e.getCharNumAtPosition(o)}while(-1<p&&(s=p),l=d,a&&-1<p||!a&&p===-1?(d=(d+u)/2,h=l):(d=(h+d)/2,u=l),1<Math.abs(l-d))}return-1<s?(r=this.svgToRealCharNum(s),a&&this.getTextContent()[r]!==`
`?r+1:r):t.x<n.x&&t.y<n.y+n.height?0:this.getNumberOfChars()}return r=this.localToScreenCoordinates(t),n=this.getCharBBox(this.svgToRealCharNum(i)),Math.abs(n.x-r.x)<Math.abs(n.x+n.width-r.x)?this.svgToRealCharNum(i):this.svgToRealCharNum(i)+1},lineNumber:function(t){return t=this.textarea.value.substr(0,t),this.countLineBreaks(t)},emptyLinesBefore:function(t){for(var e=this.textarea.value.split(/\n\r|\r|\n/g),i=0,n=this.lineNumber(t)-1;0<=n;n--)e[n]||(i+=1);return i},countLineBreaks:function(t){return(t.match(/\n\r|\r|\n/g)||[]).length},countEmptyLines:function(t){var e=(t.match(/(\n\r|\r|\n){2,}/g)||[]).reduce(function(i,n){return i+(n.length-1)},0);return t.search(/(\n\r|\r|\n)/)===0&&e++,e},nonEmptyLinesBefore:function(t){return this.lineNumber(t)-this.emptyLinesBefore(t)},isEmptyLine:function(t){return!this.textarea.value.split(/\n\r|\r|\n/g)[t]},isEmptyLineUnderSelection:function(t){return t=this.lineNumber(t),this.isEmptyLine(t)},isLineEnding:function(t){return this.constructor.isLineEnding(this.textarea.value,t)},getTextTransforms:function(){var t=this.options.text.getCTM();return X.decomposeMatrix(t)},getFontSize:function(){var t=this.DEFAULT_FONT_SIZE,e=this.options,e=parseFloat(e.text.getAttribute("font-size"));return Number.isNaN(e)?t:e},getFontFill:function(){return this.options.text.getAttribute("fill")||""},getTextAnchor:function(){return this.options.text.getAttribute("text-anchor")||""},getCaretAttrs:function(t){var e=this.getAnnotations()||[],i=this._currentAnnotationAttributes;return e.length!==0||i?(e=Ds(e.concat([{attrs:i}]),t-1),i=parseFloat(e["font-size"]),t=e.fill,{"font-size":Number.isNaN(i)?this.getFontSize():i,fill:t||this.getFontFill()}):{"font-size":this.getFontSize(),fill:this.getFontFill()}},setCaret:function(t,e){this.ensureTextVisibility(),Dt(t)&&(e=t,t=void 0),e=e||{};var i=this.getNumberOfChars(),n=this.selection.start;return t!==void 0&&(t=Math.min(Math.max(t,0),i),n=this.selection.start=this.selection.end=t),e.silent||this.trigger("caret:change",n),this.options.debug&&console.log("setCaret(",t,e,")","selectionStart",n,"isLineEnding",this.isLineEnding(n),"isEmptyLineUnderSelection",this.isEmptyLineUnderSelection(n),"svgCharNum",this.selectionStartToSvgCharNum(n),"nonEmptyLinesBefore",this.nonEmptyLinesBefore(n)),this.updateCaret(),this.setTextAreaSelection(n,n),this.focus(),this},updateCaret:function(){var t=this.$caret,e=this.$textareaContainer,l=this.selection,i=this.options,s=this.textarea,l=l.start,r=i.text,i=i.placeholder,n=this.getNumberOfChars();try{var a=this.isEmptyLineUnderSelection(l)||!this.isLineEnding(l)&&s.value.length!==l?(o=this.selectionStartToSvgCharNum(l),r.getStartPositionOfChar(o)):(o=this.selectionStartToSvgCharNum(l)-1,r.getEndPositionOfChar(o))}catch{this.trigger("caret:out-of-range",l),a={x:0,y:0}}var s=this.localToScreenCoordinates(a),r=s.x,o=s.y,a=this.getTextTransforms(),s=a.rotation,a=a.scaleY,l=this.getCaretAttrs(l),a=l["font-size"]*a,l=l.fill;i&&(t.attr("data-placeholder-text",typeof i=="string"?i:"Enter text..."),t.toggleClass("placeholder",n===0)),t.css({left:r,top:o-a,height:a,"line-height":a+"px","font-size":a+"px","-webkit-transform":"rotate("+s+"deg)","-webkit-transform-origin":"0% 100%","-moz-transform":"rotate("+s+"deg)","-moz-transform-origin":"0% 100%","background-color":l}).attr({"text-anchor":this.getTextAnchor()}).show(),e.css({left:r,top:o-a})},focus:function(){return this.options.debug&&console.log("focus()"),this.showCaret(),this},blur:function(){return this.options.debug&&console.log("blur()"),this.hideCaret(),this},showCaret:function(){return this.options.debug&&console.log("showCaret()"),this.$caret.show(),this},hideCaret:function(){return this.options.debug&&console.log("hideCaret()"),this.$caret.hide(),this},onRemove:function(){var e=this.options,t=e.text,e=e.cellView;e===void 0&&(e=null),this.deselect(),this.unbindTextElement(),document.removeEventListener("pointerdown",this.onDocumentPointerdown,{capture:!0}),P(document.body).off("mousemove",this.onMousemove),P(document.body).off("mouseup",this.onMouseup),P(document.body).off("keydown",this.onKeydown),X(t).attr("cursor",this._textCursor),this.trigger("close",t,e)},onDocumentPointerdown:function(t){var i=this.options,e=i.text,i=i.onOutsidePointerdown,n=t.target;e===n||e.contains(n)||typeof i=="function"&&i.call(this,t,this)},onKeydown:function(t){this.options.debug&&console.log("onKeydown(): ",t.keyCode);var e=this.options.onKeydown;typeof e=="function"&&(e.call(this,t,this),t.isPropagationStopped())||this.isModifierKey(t)||(this.hasSelection()&&(this.deselect(),this.restoreTextAreaSelectionDirection()),setTimeout(this.onAfterKeydown,this.AFTER_KEYDOWN_DELAY),this._copied=!1,this._selectionStartBeforeInput=this.textarea.selectionStart,this._selectionEndBeforeInput=this.textarea.selectionEnd)},onAfterKeydown:function(){this.textarea===document.activeElement&&(this.storeSelectionDirection(),this.setCurrentAnnotation(null),this.updateSelectionFromTextarea())},onKeyup:function(t){this.textContentHasChanged()&&this.onInput(t),this.textSelectionHasChanged()&&!this.isArrowKey(t)&&(t=this.textarea).selectionEnd!==t.selectionStart&&this.updateSelectionFromTextarea()},onCopy:function(t){this._copied||this.copyToClipboard()},onCut:function(t){this._copied||this.copyToClipboard()},onInput:function(t){var e,i,n,r,o,s;this.textContentHasChanged()&&(e=this.textarea.value.length-this._textareaValueBeforeInput.length,i={start:this._selectionStartBeforeInput,end:this._selectionEndBeforeInput},n={start:this.textarea.selectionStart,end:this.textarea.selectionEnd},this.selection.start=this.textarea.selectionStart,this.selection.end=this.textarea.selectionEnd,this.options.debug&&console.log("onInput()",t,"selectionBeforeInput",i,"selectionAfterInput",n,"diffLength",e),t=this.inferTextOperationType(i,n,e),r=!1,o=this.getAnnotations(),this.options.annotateUrls&&t==="insert"&&(s=this.textarea.value.substr(i.start,e),this.options.debug&&console.log("onInput()","inserted text",s),/\s/.test(s)&&(r=this.annotateURLBeforeCaret(i.start))&&(o=this.shiftAnnotations(o,n.end,e))),o&&(r||(o=this.annotate(o,i,n,e)),this.options.debug&&console.log("onInput()","modified annotations",o),this._currentAnnotationAttributes&&t==="insert"&&(s={start:i.start,end:n.end,attrs:this._currentAnnotationAttributes},o.push(s),this.setCurrentAnnotation(null),this.options.debug&&console.log("onInput()","insert annotation",s,"final annotations",o))),this._annotations=o,this.trigger("text:change",this.textarea.value,this._textareaValueBeforeInput,o,i,n),this._selectionBeforeInput=n,this._textareaValueBeforeInput=this.textarea.value,this._textContent=this.textarea.value)},onPaste:function(t){this.options.debug&&console.log("onPaste()"),this._textareaValueBeforeInput=this.textarea.value,setTimeout(this.onAfterPaste,0)},onAfterPaste:function(){this.setCaret(this.textarea.selectionStart)},onMousedown:function(t){var e;t.originalEvent.detail!==3&&(this.options.debug&&console.log("onMousedown()"),e=this.getCharNumFromEvent(t),this.startSelecting(),this.select(e),t.preventDefault(),t.stopPropagation())},onMousemove:function(t){var e;this.selectionInProgress()&&(this.options.debug&&console.log("onMousemove()"),e=this.getCharNumFromEvent(t),this.storeSelectionDirection(),this.select(null,e),t.preventDefault(),t.stopPropagation())},onMouseup:function(t){this.selectionInProgress()&&(this.options.debug&&console.log("onMouseup()"),this.stopSelecting(),this.trigger("select:changed",this.selection.start,this.selection.end))},onDoubleClick:function(t){this.options.debug&&console.log("onDoubleClick()");var e=this.getCharNumFromEvent(t),e=this.getWordBoundary(e);this.select(e[0],e[1]),t.preventDefault(),t.stopPropagation()},onTripleClick:function(t){t.originalEvent.detail===3&&(this.options.debug&&console.log("onTripleClick()"),this.hideCaret(),this.selectAll(),t.preventDefault(),t.stopPropagation())}},ct({getTextElement:function(t){var e=t.tagName.toUpperCase();if(e==="TEXT"||e==="TSPAN"||e==="TEXTPATH")return e==="TEXT"?t:this.getTextElement(t.parentNode)},edit:function(t,e){var i,n,r=this,o=(e=e||{}).update!==!1,s=(this.options=ct({},e,{update:o}),this.getTextElement(t));if(s)return this.close(),this.ed=new Bs(ct({text:s},e)),this.ed.on("all",this.trigger,this),(i=e.cellView)===void 0&&(i=null),this.trigger("open",s,i),i?(n=i.paper.el,this.cellViewUnderEdit=i,this.cellViewUnderEditInteractiveOption=this.cellViewUnderEdit.options.interactive,this.cellViewUnderEdit.options.interactive=!1,e.annotationsProperty&&!this.ed.getAnnotations()&&(t=this.cellViewUnderEdit.model.prop(e.annotationsProperty))&&this.ed.setAnnotations(Sc(t))):n=X(s).svg().parentNode,o&&this.ed.on("text:change",function(a,l,h){i?r.updateCellView(i,a,h):r.updateSVGTextNode(s,a,h)}),this.ed.render(n),this;this.options.debug&&console.log("ui.TextEditor: cannot find a text element.")},updateCellView:function(s,e,i){var r=this.options,n=r.textProperty,r=r.annotationsProperty,o=this.ed.cid,s=s.model;n&&s.prop(n,e,{textEditor:o,async:!1}),r&&s.prop(r,Sc(i),{rewrite:!0,textEditor:o,async:!1})},updateSVGTextNode:function(t,e,i){X(t).text(e,{annotations:i})},close:function(){var t;this.ed&&(this.ed.options.annotateUrls&&(t=this.ed.getSelectionStart(),this.findAnnotationsUnderCursor().find(function(e){return!!e.url&&e})||this.ed.annotateURLBeforeCaret(t)&&this.applyAnnotations(this.getAnnotations())),this.ed.remove(),this.cellViewUnderEdit&&(this.cellViewUnderEdit.options.interactive=this.cellViewUnderEditInteractiveOption),this.ed=this.cellViewUnderEdit=this.cellViewUnderEditInteractiveOption=void 0)},applyAnnotations:function(t){var e=this.options,i=this.ed;i&&e.update&&(e.cellView&&e.annotationsProperty?(e.cellView.model.prop(e.annotationsProperty,Sc(t),{rewrite:!0,textEditor:i.cid}),i.setAnnotations(t)):X(i.options.text).text(i.getTextContent(),{annotations:t}),e=this.getSelectionRange(),0<this.getSelectionLength()?i.select(e.start,e.end):i.setCaret())},proxy:function(t,e){var i=this.ed;if(i)return i[t].apply(i,e)},isEmptyLine:function(t,e){var i=t[e-1],n=t[e];return e===0&&n===`
`||n===`
`&&i===`
`||e===t.length&&i===`
`},isLineEnding:function(t,e){return t[e]===`
`&&0<e&&t[e-1]!==`
`},isLineStart:function(t,e){return t[e]!==`
`&&(e===0||t[e-1]===`
`)},getCombinedAnnotationAttrsAtIndex:Ds,getCombinedAnnotationAttrsBetweenIndexes:Mc,normalizeAnnotations:function(t,e){for(var i=(e=e===void 0?{}:e).compare,n=(i===void 0&&(i=Tg),[]),r=-1,o=t.reduce(function(h,u){return u=u.end,u===void 0?h:Math.max(h,u)},0);r<o;r++){for(var s=null,a=r+1;a<=o;a++){var l=Mc(t,a-1,a,e);s?i(l,s)||(a--,Ng(s)||n.push({start:r,end:a,attrs:s}),s=null,r=a):s=l}if(s){r<o&&!Ng(s)&&n.push({start:r,end:o,attrs:s});break}}return n}},R.Events));function Sc(t){try{return JSON.parse(JSON.stringify(t))}catch{}}Bs.findAnnotationsUnderCursor=function(){var t=this.ed;return t?this.proxy("findAnnotationsUnderCursor",[t.getAnnotations(),t.getSelectionStart()]):null},Bs.findAnnotationsInSelection=function(){var t,e,i=this.ed;return i?(t=(e=i.getSelectionRange()).start,e=e.end,this.proxy("findAnnotationsInSelection",[i.getAnnotations(),t,e])):null},Bs.getSelectionAttrs=function(t){var e=this.ed;return e?this.proxy("getSelectionAttrs",[e.getSelectionRange(),t]):null},["setCurrentAnnotation","getAnnotations","setCaret","deselect","selectAll","select","getNumberOfChars","getCharNumFromEvent","getWordBoundary","getSelectionLength","getSelectionRange"].forEach(function(t){Bs[t]=function(){return this.proxy(t,arguments)}});function pm(r,i){var i=i.model.direction,n=r.targetStack,r=r.invalid,o=X("path",{stroke:r?"#ccc":"#333","stroke-width":2});switch(i){case Ti.Directions.RightLeft:case Ti.Directions.LeftRight:var s=n.bbox.height;o.attr("d","M 0 "+-s/2+" v "+s);break;case Ti.Directions.TopBottom:case Ti.Directions.BottomTop:default:s=n.bbox.width,o.attr("d","M "+-s/2+" 0 h "+s)}return o.node}function fm(t,e){return!0}function mm(t,e,i){return t.insertElementIndex}function vm(t,e){return e.model.hasElement(t.model)}var pn=ke.extend({className:"widget",references:[],constructor:function(t,e){this.availableReferences=e||{},ke.prototype.constructor.call(this,t)},updateAttrs:function(t){Bo(this.$el,t)},bindEvents:function(){},validateReferences:function(){var t=this.references||[],e=[];return t.forEach(function(i){this.availableReferences[i]===void 0&&e.push(i)},this),e},getReference:function(t){return this.availableReferences[t]},getReferences:function(){return this.availableReferences},enable:function(){},disable:function(){},isDisabled:function(){return!1}},{create:function(t,e,i){i===void 0&&(i={});var n=ca(Ft(t)?t:t.type);if(!Rt(i[n]))throw new Error('Widget: unable to find widget: "'+n+'"');if(i=new i[n](t,e),e=i.validateReferences(e),0<e.length)throw new Error('Widget: "'+n+'" missing dependency: '+e.join(", "));return i.render(),i.updateAttrs(t.attrs),i.bindEvents(),i.$el.attr("data-type",n),t.name&&i.$el.attr("data-name",t.name),i}}),fn=pn.extend({tagName:"label",events:{"input .input":"onInput","change .input":"onChange",mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick"},documentEvents:{mouseup:"pointerup",touchend:"pointerup"},init:function(){yi(this,"pointerup")},render:function(){var t=this.options,e=P("<span/>").text(t.label||"");return this.$input=P("<input/>",{type:"checkbox",class:"input"}).prop("checked",!!t.value),this.$span=P("<span/>"),this.$el.append([e,this.$input,this.$span]),this},onChange:function(t){this.trigger("change",!!t.target.checked,t)},onInput:function(t){this.trigger("input",!!t.target.checked,t)},pointerdown:function(t){t=Tt(t),this.$el.addClass("is-in-action"),this.trigger("pointerdown",t),this.delegateDocumentEvents()},pointerclick:function(t){t=Tt(t),this.trigger("pointerclick",t)},pointerup:function(t){t=Tt(t),this.undelegateDocumentEvents(),this.trigger("pointerup",t),this.$el.removeClass("is-in-action"),t.type==="touchend"&&(this.$input.trigger("click"),t.preventDefault())},isDisabled:function(){return this.$input.prop("disabled")},enable:function(){this.$el.removeClass("disabled"),this.$input.prop("disabled",!1)},disable:function(){this.$el.addClass("disabled"),this.$input.prop("disabled",!0)}}),Rc=pn.extend({tagName:"label",events:{"input input.toggle":"onInput","change input.toggle":"onChange","click input.toggle":"pointerclick",mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup"},documentEvents:{mouseup:"pointerup",touchend:"pointerup"},init:function(){yi(this,"pointerup")},render:function(){var i=this.options,t=P("<span/>").text(i.label||""),e=P("<span><i/></span>"),i=(this.$input=P("<input/>",{type:"checkbox",class:"toggle"}).prop("checked",!!i.value),P("<div/>").addClass(i.type));return this.$el.append([t,i.append(this.$input,e)]),this},onInput:function(t){this.trigger("input",!!t.target.checked,t)},onChange:function(t){this.trigger("change",!!t.target.checked,t)},pointerclick:function(t){t=Tt(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=Tt(t),this.$el.addClass("is-in-action"),this.trigger("pointerdown",t),this.delegateDocumentEvents()},pointerup:function(t){t=Tt(t),this.undelegateDocumentEvents(),this.$el.removeClass("is-in-action"),this.trigger("pointerup",t),t.type==="touchend"&&(this.$input.trigger("click"),t.preventDefault())},isDisabled:function(){return this.$input.prop("disabled")},enable:function(){this.$el.removeClass("disabled"),this.$input.prop("disabled",!1)},disable:function(){this.$el.addClass("disabled"),this.$input.prop("disabled",!0)}}),jc=pn.extend({render:function(){return this.options.width&&this.$el.css({width:this.options.width}),this}}),Gc=pn.extend({tagName:"label",render:function(){return this.$el.text(this.options.text),this}}),ih=pn.extend({events:{"change .input":"onChange","input .input":"onChange"},render:function(){var t,e=this.options;return this.$output=P("<output/>").text(e.value),t=P("<span/>").addClass("units").text(e.unit),this.$input=P("<input/>",{type:"range",name:e.type,min:e.min,max:e.max,step:e.step,class:"input"}).val(e.value),this.$el.append([this.$input,this.$output,t]),this},onChange:function(t){var e=this.getValue();e!==this.currentValue&&(this.currentValue=e,this.$output.text(e),this.trigger("change",e,t))},getValue:function(){return parseInt(this.$input.val(),10)},setValue:function(t,e){e===void 0&&(e={}),this.$input.val(t),e.silent?(t=this.getValue(),this.currentValue=t,this.$output.text(t)):this.$input.trigger("change")},isDisabled:function(){return this.$input.prop("disabled")},enable:function(){this.$input.prop("disabled",!1)},disable:function(){this.$input.prop("disabled",!0)}}),kc=pn.extend({render:function(){var t=ai(this.options,"type","group","index");return this.selectBox=new Pa(t),this.selectBox.render().$el.appendTo(this.el),this},bindEvents:function(){this.selectBox.on("all",this.trigger,this)},isDisabled:function(){return this.selectBox.isDisabled()},enable:function(){this.selectBox.enable()},disable:function(){this.selectBox.disable()}}),fr=pn.extend({events:{mousedown:"pointerdown",mouseup:"pointerup",touchend:"pointerup",touchstart:"pointerdown",click:"pointerclick"},tagName:"button",render:function(){var t=this.options;return this.$el.text(t.text),this},pointerclick:function(t){t=Tt(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=Tt(t),this.trigger("pointerdown",t)},pointerup:function(t){t=Tt(t),this.trigger("pointerup",t),t.type==="touchend"&&(this.$el.trigger("click"),t.preventDefault())},isDisabled:function(){return this.$el.prop("disabled")},enable:function(){this.$el.prop("disabled",!1)},disable:function(){this.$el.prop("disabled",!0)}}),Tc=pn.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout",input:"onInput",change:"onChange"},tagName:"div",render:function(){var t=this.options;return this.$label=P("<label/>").text(t.label),this.$text=P("<input/>",{type:"text",class:"input"}).val(t.value),this.$input=P("<div/>").addClass("input-wrapper").append(this.$text),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t=Tt(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=Tt(t),this.trigger("pointerdown",t),t.type==="touchstart"&&this.$text.trigger("focus")},pointerup:function(t){t=Tt(t),this.trigger("pointerup",t),t.type==="touchend"&&(this.$text.trigger("click"),t.preventDefault())},pointerfocusin:function(t){t=Tt(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=Tt(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)},onInput:function(t){this.trigger("input",t.target.value,t)},onChange:function(t){this.trigger("change",t.target.value,t)},isDisabled:function(){return this.$text.prop("disabled")},enable:function(){this.$text.prop("disabled",!1)},disable:function(){this.$text.prop("disabled",!0)}}),Nc=pn.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout",input:"onInput",change:"onChange"},tagName:"div",render:function(){var t=this.options;return this.$label=P("<label/>").text(t.label),this.$number=P("<input/>",{type:"number",class:"number",max:t.max,min:t.min}).val(t.value),this.$input=P("<div/>").addClass("input-wrapper").append(this.$number),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t=Tt(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=Tt(t),this.trigger("pointerdown",t),t.type==="touchstart"&&this.$number.trigger("focus")},pointerup:function(t){t=Tt(t),this.trigger("pointerup",t),t.type==="touchend"&&(this.$number.trigger("click"),t.preventDefault())},pointerfocusin:function(t){t=Tt(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=Tt(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)},onInput:function(t){this.trigger("input",t.target.value,t)},onChange:function(t){this.trigger("change",t.target.value,t)},isDisabled:function(){return this.$number.prop("disabled")},enable:function(){this.$number.prop("disabled",!1)},disable:function(){this.$number.prop("disabled",!0)}}),Pc=pn.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout",input:"onInput",change:"onChange"},tagName:"div",render:function(){var t=this.options;return this.$label=P("<label/>").text(t.label),this.$textarea=P("<textarea/>",{class:"textarea"}).text(t.value),this.$input=P("<div/>").addClass("input-wrapper").append(this.$textarea),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t.preventDefault(),t=Tt(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=Tt(t),this.trigger("pointerdown",t),t.type==="touchstart"&&this.$textarea.focus()},pointerup:function(t){t=Tt(t),this.trigger("pointerup",t),t.type==="touchend"&&(this.$textarea.trigger("click"),t.preventDefault())},pointerfocusin:function(t){t=Tt(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=Tt(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)},onInput:function(t){this.trigger("input",t.target.value,t)},onChange:function(t){this.trigger("change",t.target.value,t)},isDisabled:function(){return this.$textarea.prop("disabled")},enable:function(){this.$textarea.prop("disabled",!1)},disable:function(){this.$textarea.prop("disabled",!0)}}),zs=pn.extend({render:function(){var t=ai(this.options,"type","group","index");return this.selectButtonGroup=new Ac(t),this.selectButtonGroup.render().$el.appendTo(this.el),this},bindEvents:function(){this.selectButtonGroup.on("all",this.trigger,this)},isDisabled:function(){return this.selectButtonGroup.isDisabled()},enable:function(){this.selectButtonGroup.enable()},disable:function(){this.selectButtonGroup.disable()}}),Ec=fr.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2},bindEvents:function(){var t,e=this;this.options.autoToggle&&(t=this.getReferences().paperScroller,this.updateAvailability(t),this.listenTo(t.options.paper,"scale",function(){return e.updateAvailability(t)}))},pointerdown:function(t){var e=this.options;this.getReferences().paperScroller.zoom(e.step,{max:e.max,grid:e.step}),fr.prototype.pointerdown.call(this,t)},updateAvailability:function(t){t.zoom()<this.options.max?this.enable():this.disable()}}),Lc=fr.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2},bindEvents:function(){var t,e=this;this.options.autoToggle&&(t=this.getReferences().paperScroller,this.updateAvailability(t),this.listenTo(t.options.paper,"scale",function(){return e.updateAvailability(t)}))},pointerdown:function(t){var e=this.options;this.getReferences().paperScroller.zoom(-e.step,{min:e.min,grid:e.step}),fr.prototype.pointerdown.call(this,t)},updateAvailability:function(t){t.zoom()>this.options.min?this.enable():this.disable()}}),Dc=fr.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2,useModelGeometry:!1,padding:20},pointerdown:function(t){var e=this.options;this.getReferences().paperScroller.zoomToFit({padding:e.padding,scaleGrid:e.step,minScale:e.min,maxScale:e.max,useModelGeometry:e.useModelGeometry}),fr.prototype.pointerdown.call(this,t)}}),Bc=ih.extend({references:["paperScroller"],options:{min:20,max:500,step:20,value:100,unit:" %"},bindEvents:function(){var t=this,e=this.getReferences().paperScroller;this.on("change",function(i){e.zoom(i/100,{absolute:!0,grid:this.options.step/100})},this),this.listenTo(e.options.paper,"scale",function(i){t.setValue(Math.floor(100*i),{silent:!0})})}}),zc=fr.extend({references:["commandManager"],bindEvents:function(){var t,e=this;this.options.autoToggle&&(t=this.getReferences().commandManager,this.updateAvailability(t),this.listenTo(t,"stack",function(){return e.updateAvailability(t)}))},pointerclick:function(){this.getReferences().commandManager.undo()},updateAvailability:function(t){t.hasUndo()?this.enable():this.disable()}}),Ba=fr.extend({references:["commandManager"],bindEvents:function(){var t,e=this;this.options.autoToggle&&(t=this.getReferences().commandManager,this.updateAvailability(t),this.listenTo(t,"stack",function(){return e.updateAvailability(t)}))},pointerclick:function(){this.getReferences().commandManager.redo()},updateAvailability:function(t){t.hasRedo()?this.enable():this.disable()}}),za=fr.extend({onRender:function(){var t=this.target=P(this.options.target)[0];t&&!P.contains(window.top.document,t)&&this.$el.hide()},pointerclick:function(){Hu(this.target)}}),Oc=pn.extend({events:{"change .input ":"change","input .input ":"input"},render:function(){var t=this.options;return this.inputEl=document.createElement("input"),this.inputEl.classList.add("input"),this.inputEl.setAttribute("type","color"),t.value?this.setValue(t.value):this.inputEl.value="#FFFFFF",this.el.appendChild(this.inputEl),this},_validateHexCode:function(t){return/^#(?:[0-9a-fA-F]{6})$/.test(t)},change:function(t){t=Tt(t),this.trigger("change",t.target.value,t)},input:function(t){t=Tt(t),this.trigger("input",t.target.value,t)},disable:function(){this.el.classList.add("disabled"),this.inputEl.disabled=!0},enable:function(){this.el.classList.remove("disabled"),this.inputEl.disabled=!1},setValue:function(t,e){e===void 0&&(e={}),this._validateHexCode(t)&&(this.inputEl.value=t,e.silent||this.trigger("change"))}}),Eg={__proto__:null,checkbox:fn,toggle:Rc,separator:jc,label:Gc,range:ih,selectBox:kc,button:fr,inputText:Tc,inputNumber:Nc,textarea:Pc,selectButtonGroup:zs,zoomIn:Ec,zoomOut:Lc,zoomToFit:Dc,zoomSlider:Bc,undo:zc,redo:Ba,fullscreen:za,colorPicker:Oc},fn=ke.extend({options:{autoToggle:!1,widgetNamespace:null},align:["left","right"],className:"toolbar",defaultGroup:"default",widgets:[],groupViews:[],init:function(){this.tools=kt(this.options.tools),this.groups=this.options.groups||{}},getWidgetByName:function(t){return this.widgets.find(function(e){return e.options.name===t})},getWidgets:function(){return this.widgets},groupsWithItemsPairs:function(){for(var t={},e=(this.tools.forEach(function(a){var l=a.group||this.defaultGroup;t[l]=t[l]||{items:[],group:{}},t[l].items.push(a),t[l].group=this.groups[l]||{}},this),Object.keys(t)),i=[],n=0,r=e.length;n<r;n++){var o=e[n];i.push([o,t[o]])}var s=vi(i,function(a){return a[1].group.index});return vi(s,function(a){return a[1].group.align||"left"})},render:function(){var t=this.groupsWithItemsPairs(),e=!1;return t.forEach(function(n){var r=n[0],n=n[1],r=this.renderGroup(r,n);!e&&n.group.align&&n.group.align==="right"&&(e=!0,r.addClass("group-first")),r.appendTo(this.el)},this),this},renderGroup:function(o,e){var r=this.options,i=r.references,n=r.autoToggle,r=r.widgetNamespace,o=new ym({name:o,align:e.group.align,items:e.items,references:i,autoToggle:n,widgetNamespace:r});return this.groupViews.push(o),o.on("all",(function(){this.trigger.apply(this,arguments)}).bind(this)),o.render(),this.widgets=this.widgets.concat(o.widgets),o.$el},onRemove:function(){qe(this.groupViews,"off"),qe(this.groupViews,"remove")}},{Align:{Left:"left",Right:"right"}}),ym=ke.extend({className:"toolbar-group",init:function(){this.widgets=[]},onRender:function(){this.$el.attr("data-group",this.options.name),this.$el.addClass(this.options.align),this.renderItems()},renderItems:function(){kt(this.options.items).forEach(function(t){t=this.createWidget(t),this.$el.append(t.$el)},this)},createWidget:function(t){var i=this.options,e=i.references,n=i.autoToggle,i=i.widgetNamespace,n=Ft(t)?{autoToggle:n,type:t}:ct({autoToggle:n},t),n=pn.create(n,e,i||Eg);return t.name!==void 0&&n.on("all",(function(r){var o=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t.name+":"+r].concat(o))}).bind(this)),this.widgets.push(n),n},onRemove:function(){qe(this.widgets,"off"),qe(this.widgets,"remove")}}),Rc=ke.extend({className:"tooltip",options:{left:void 0,right:void 0,top:void 0,bottom:void 0,position:void 0,positionSelector:void 0,direction:"auto",minResizedWidth:100,padding:0,rootTarget:null,target:null,container:null,trigger:"hover",viewport:{selector:null,padding:0},dataAttributePrefix:"tooltip",template:'<div class="tooltip-arrow"></div><div class="tooltip-arrow-mask"></div><div class="tooltip-content"></div>',animation:!1},init:function(){this.eventNamespace=("."+this.className+this.cid).replace(/ /g,"_"),this.settings={};var t,o=this.options,e=o.trigger,i=o.rootTarget,n=o.target,r=o.animation,o=(r===void 0&&(r=!1),o.container),o=(o&&(t=P(o)[0]),o||(t=document.body),this.container=t,e.split(" "));yi(this,"render","hide","show","toggle","isVisible","position"),i?(this.$rootTarget=P(i),o.forEach(function(s){switch(s){case"click":this.$rootTarget.on("click"+this.eventNamespace,this.options.target,this.toggle);break;case"hover":this.$rootTarget.on("mouseover"+this.eventNamespace,this.options.target,this.render);break;case"focus":this.$rootTarget.on("focusin"+this.eventNamespace,this.options.target,this.render)}},this)):(this.$target=P(n),o.forEach(function(s){switch(s){case"click":this.$target.on("click"+this.eventNamespace,this.toggle);break;case"hover":this.$target.on("mouseover"+this.eventNamespace,this.render);break;case"focus":this.$target.on("focusin"+this.eventNamespace,this.render)}},this)),r&&this.animate(r),this.$el.append(this.options.template)},animate:function(n){var e=(n=n===void 0?{}:n).duration,i=(e===void 0&&(e="500ms"),n.delay),n=(i===void 0&&(i="400ms"),n.timingFunction);n===void 0&&(n="ease"),this.$el.addClass("animated").css({animationDelay:i,animationDuration:e,animationTimingFunction:n})},onRemove:function(){(this.options.rootTarget?this.$rootTarget:this.$target).off(this.eventNamespace)},hide:function(){var t=this.settings;t&&(t.currentTarget&&this.unbindHideActions(t.currentTarget),this.$el.removeClass(t.className),this.$el.remove(),this.trigger("close"))},show:function(t){this.render(t||{target:this.options.target})},toggle:function(t){this.isVisible()?this.hide():this.show(t)},isVisible:function(){return document.body.contains(this.el)},render:function(n){var e,r=null,i=(n.x!==void 0&&n.y!==void 0&&(r={x:n.x,y:n.y}),null),n=(n.target&&(i=P(n.target).closest(this.options.target)[0]),this.settings=this.getTooltipSettings(i)),r=(this.$(".tooltip-content").html(n.calculatedContent),i?(n.currentTarget=i,this.bindHideActions(i)):n.currentTarget=null,e=r?{x:r.x,y:r.y,width:1,height:1}:Do(i),this.$el.hide(),this.$el.removeClass("left right top bottom"),this.$el.addClass(n.className),n.shouldRender&&P(this.container).append(this.$el),this.$("img"));r.length?r.on("load",(function(){this.position(e),this.$el.addClass("rendered")}).bind(this)):(this.position(e),this.$el.addClass("rendered"))},unbindHideActions:function(t){var e=this.eventNamespace+".remove";P(t).off(e),clearInterval(this.interval)},bindHideOnRemoveTarget:function(t){clearInterval(this.interval),this.interval=setInterval((function(){P.contains(document,t)||(clearInterval(this.interval),this.hide())}).bind(this),500)},bindHideActions:function(t){var e=this.settings,i=P(t),n=this.eventNamespace+".remove";this.bindHideOnRemoveTarget(t),this.options.trigger.split(" ").forEach(function(r){r={hover:["mouseout","mousedown"],focus:["focusout"]}[r]||[],(r=e.hideTrigger?e.hideTrigger.split(" ")||[]:r).forEach(function(o){i.on(o+n,this.hide)},this)},this)},getTooltipSettings:function(t){var e=this.loadDefinitionFromElementData(t);return this.evaluateOptions(t,e)},evaluateOptions:function(t,e){var i=this,n=(e===void 0&&(e={}),this.settings=ct({},e,this.options)),r=!0,o=n.dataAttributeContent;return Se(n,function(s,a){var l;a==="content"?Rt(s)?(l=n.content.call(i,t,i))!=null&&(l===!1?r=!1:o=l):o=s:(l=Rt(s)?s(t):s,n[a]=l??e[a])}),n.shouldRender=r,n.calculatedContent=o,this.normalizePosition(n),n},loadDefinitionFromElementData:function(t){var e;return t?(t=this.getAllAttrs(t,"data-"+this.options.dataAttributePrefix),e={},Se(t,function(i,n){var r;(r=n=n===""?"dataAttributeContent":n)!=="left"&&r!=="bottom"&&r!=="top"&&r!=="right"&&(e[n]=i)}),e):{}},getAllAttrs:function(t,e){for(var i=e||"",n=t.attributes,r={},o=0,s=n.length;o<s;o++){var a=n[o];a&&a.name.startsWith(i)&&(r[ca(a.name.slice(i.length))]=a.value)}return r},normalizePosition:function(t){var e=t.left||t.right||t.top||t.bottom;!t.position&&e&&(t.left&&(t.position="left"),t.right&&(t.position="right"),t.top&&(t.position="top"),t.bottom&&(t.position="bottom")),!t.positionSelector&&e&&(t.positionSelector=e)},position:function(t){var e=this.settings,i=(this.$el.show(),this.$el.css("width","auto"),Do(this.container)),n=this.getTooltipBBox(t,i),r=(this.$el.css({left:n.x,top:n.y,width:n.width||"auto"}),{});e.position!=="left"&&e.position!=="right"&&(e.position==="top"||e.position==="bottom")?r.left=t.x+t.width/2-n.x:r.top=t.y+t.height/2-n.y,r.top-=i.y,r.left-=i.x,this.$(".tooltip-arrow, .tooltip-arrow-mask").removeAttr("style").css(r),e.direction&&e.direction!=="off"&&this.$el.addClass(e.direction==="auto"?e.position||"left":e.direction)},getViewportViewBBox:function(){var t=this.settings,e=t.viewport.selector?P(t.currentTarget).closest(t.viewport.selector):"html",e=Do(e),i=(t.viewport.selector||(i=P(window),e.width=i.width()+i.scrollLeft(),e.height=i.height()+i.scrollTop()),t.viewport.padding||0);return e.x+=i,e.y+=i,e.width-=2*i,e.height-=2*i,e},basePositions:{left:function(t,e){var i={x:e.positionedBBox.x+e.positionedBBox.width+e.padding,y:e.targetBBox.y+e.targetBBox.height/2-e.tooltipBBox.height/2};return t&&(t=e.viewport.x+e.viewport.width-i.x,t>e.minWidth&&t<e.tooltipBBox.width+e.padding&&(i.width=t),t<e.minWidth)?(this.settings.position="right",this.basePositions.right(!1,e)):i},right:function(t,e){var i={x:e.positionedBBox.x-e.tooltipBBox.width-e.padding,y:e.targetBBox.y+e.targetBBox.height/2-e.tooltipBBox.height/2};return t&&(t=e.positionedBBox.x-e.padding-e.viewport.x,t>e.minWidth&&t<e.tooltipBBox.width+e.padding&&(i.width=t,i.x=e.viewport.x),t<e.minWidth)?(this.settings.position="left",this.basePositions.left(!1,e)):i},top:function(t,e){var i={x:e.targetBBox.x+e.targetBBox.width/2-e.tooltipBBox.width/2,y:e.positionedBBox.y+e.positionedBBox.height+e.padding};return t&&e.viewport.y+e.viewport.height-(e.positionedBBox.y+e.positionedBBox.height+e.padding)<e.tooltipBBox.height?(this.settings.position="bottom",this.basePositions.bottom(!1,e)):i},bottom:function(t,e){var i={x:e.targetBBox.x+e.targetBBox.width/2-e.tooltipBBox.width/2,y:e.positionedBBox.y-e.tooltipBBox.height-e.padding};return t&&e.positionedBBox.y-e.padding-e.viewport.y<e.tooltipBBox.height?(this.settings.position="top",this.basePositions.top(!1,e)):i}},getTooltipBBox:function(t,e){var s=this.settings,i=P(s.positionSelector),i=i[0]?Do(i[0]):t,n=this.measureTooltipElement(),r=this.getViewportViewBBox(),a=s.position||"left",o=s.padding,s=Math.min(s.minResizedWidth,n.width+o),a=this.basePositions[a].call(this,0<s,{padding:o,targetBBox:t,positionedBBox:i,tooltipBBox:n,viewport:r,minWidth:s});return a.x-=e.x,a.y-=e.y,a.y<r.y?a.y=r.y:a.y+n.height>r.y+r.height&&(a.y=r.y+r.height-n.height),a.x<r.x?a.x=r.x:a.x+n.width>r.x+r.width&&(a.x=r.x+r.width-n.width),a},measureTooltipElement:function(){var t=this.$el.clone().appendTo(P("body")).css({left:-1e3,top:-500}),e={width:t.outerWidth(),height:t.outerHeight()};return t.remove(),e}},{TooltipPosition:{Left:"left",Top:"top",Bottom:"bottom",Right:"right"},TooltipArrowPosition:{Left:"left",Top:"top",Bottom:"bottom",Right:"right",Auto:"auto",Off:"off"}}),jc=ke.extend({MINIMAL_PREVIEW_SIZE:10,className:"tree-layout",documentEvents:{mousemove:"onPointermove",touchmove:"onPointermove",mouseup:"onPointerup",touchend:"onPointerup"},options:{previewAttrs:{parent:{rx:2,ry:2}},useModelGeometry:!1,clone:function(t){return t.clone()},canInteract:function(){return!0},validateConnection:null,validatePosition:null,paperConstructor:ki,paperOptions:null,reconnectElements:null,translateElements:null,layoutFunction:null},init:function(){this.toggleDefaultInteraction(!1),this.startListening(),this.render(),this.onSetTheme(null,this.theme)},startListening:function(){this.enable()},_isEnabled:!1,_onPointerdown:null,enable:function(){var t=this.options.paper,e=(this.disable(),this.canInteract(this.onPointerdown));this._isEnabled=!0,this.listenTo(t,"element:pointerdown",e),this._onPointerdown=e},disable:function(){var t=this._onPointerdown,e=this.options.paper;this._isEnabled=!1,t&&(this.stopListening(e,"element:pointerdown",t),this._onPointerdown=null)},isDisabled:function(){return!this._isEnabled},toggleDefaultInteraction:function(t){this.options.paper.setInteractivity(t)},render:function(){var t=this.options.paper,i=(this.$activeBox=P("<div>").addClass("tree-layout-box active hidden").appendTo(this.el),this.options.paperOptions||{}),e=i.model||new wi({},{cellNamespace:t.model.get("cells").cellNamespace}),i=ct({cellViewNamespace:t.options.cellViewNamespace},i,{interactive:!1,width:"100%",height:"100%",model:e});return this.draggingPaper=new this.options.paperConstructor(i),this.draggingPaper.undelegateEvents(),this.$translateBox=P("<div>").addClass("tree-layout-box translate hidden").append(this.draggingPaper.render().el).appendTo(this.el),this.$mask=P("<div>").addClass("tree-layout-mask"),this.svgViewport=X(t.cells),this.svgPreviewChild=X(this.renderChildPreview()).attr(this.options.previewAttrs.child||{}).addClass("tree-layout-preview child"),this.svgPreviewConnection=X(this.renderConnectionPreview()).attr(this.options.previewAttrs.link||{}).addClass("tree-layout-preview link"),this.svgPreviewParent=X(this.renderParentPreview()).attr(this.options.previewAttrs.parent||{}).addClass("tree-layout-preview parent"),this.svgPreview=X("g").addClass("tree-layout-preview-group").append([this.svgPreviewConnection,this.svgPreviewParent,this.svgPreviewChild]),this.$el.appendTo(t.el),this},renderChildPreview:function(){return X("circle")},renderParentPreview:function(){return X("rect")},renderConnectionPreview:function(){return X("path")},onSetTheme:function(t,e){[this.svgPreview,this.$mask].forEach(function(i){i&&(t&&i.removeClass(this.themeClassNamePrefix+t),i.addClass(this.themeClassNamePrefix+e))},this)},onRemove:function(){this.svgPreview.remove(),this.$mask.remove()},toggleDropping:function(t){this.$mask.toggleClass("dropping-not-allowed",!t),this.$translateBox.toggleClass("no-drop",!t)},canDrop:function(){return this.isActive()&&!this.$translateBox.hasClass("no-drop")},isActive:function(){return!this.$translateBox.hasClass("hidden")},updateBox:function(t,e){t.css({width:e.width,height:e.height,left:e.x,top:e.y})},positionTranslateBox:function(t){t=X.transformPoint(t,this.ctm),this.$translateBox.css({left:t.x,top:t.y})},prepareDraggingPaper:function(t){t=this.options.clone(t).position(0,0),this.draggingPaper.scale(this.ctm.a,this.ctm.d),this.draggingPaper.model.resetCells([t])},dragstart:function(s,e,i){var n=this.$translateBox,r=this.$activeBox,o=this.options,a=o.paper,o=o.useModelGeometry,s=(this.toggleDropping(!1),this.ctm=a.matrix(),s[0]),a=s.findView(a);a?(a=a.getBBox({useModelGeometry:o}),this.updateBox(n,Jt({x:e,y:i},a)),this.updateBox(r,a),r.removeClass("external")):(o=X.transformRect(s.getBBox(),this.ctm),this.updateBox(n,Jt({x:e,y:i},o)),r.addClass("external")),this.positionTranslateBox({x:e,y:i}),this.show(),this.prepareDraggingPaper(s)},drag:function(t,e,i){var n,r,o,s,a,l=this,h=this.model,u={x:e,y:i};this.candidate&&(this.candidate=null,this.hidePreview()),this.positionTranslateBox(u),(n=(r=h.getMinimalRootAreaByPoint(u))?r.findMinimalAreaByPoint(u,{expandBy:Math.min(h.get("siblingGap"),h.get("gap"))/2}):n)?(r=this.findDirection(n,u),o=n.getLayoutSiblings(r),s=o.getSiblingRankByPoint(u),kt(t).every(function(d){return this.isConnectionValid(d,o,s)},this)?(this.candidate={id:n.root.id,direction:r,siblingRank:s},this.updatePreview(o,s),this.showPreview(),this.toggleDropping(!0)):this.toggleDropping(!1)):(h=!0,typeof(a=this.options.validatePosition)=="function"&&(h=kt(t).every(function(d){return a.call(l,d,e,i,l)})),this.toggleDropping(h))},dragend:function(t,e,i){var n,r=this.candidate,o=this.options;this.canDrop()&&(r?(typeof(n=o.reconnectElements)=="function"?n.apply(this,[t,o.paper.getModelById(r.id),r.siblingRank,r.direction,this]):this.reconnectElements(t,r),this.candidate=null):typeof(n=o.translateElements)=="function"?n.call(this,t,e,i,this):this.translateElements(t,e,i)),this.hide()},show:function(){var t=this.$mask,e=this.$activeBox,i=this.$translateBox,n=this.options.paper.$el;n.is(t.parent())||t.appendTo(n),e.toggleClass("hidden",e.hasClass("external")),i.removeClass("hidden")},hide:function(){this.$mask.remove().removeClass("dropping-not-allowed"),this.$activeBox.addClass("hidden"),this.$translateBox.addClass("hidden"),this.hidePreview()},cancelDrag:function(){this.candidate=null,this.undelegateDocumentEvents(),this.hide()},reconnectElement:function(t,e){var i,n=this.model,r=this.options,o=n.graph,o=(o.getCell(t)||(o.addCell(t),n.layoutTree(t)),e.siblingRank+.5),s={direction:e.direction,siblingRank:o,ui:!0,treeLayoutView:this.cid};n.reconnectElement(t,e.id,s)||((i=(r=r.paper).getDefaultLink(t.findView(r))).set({source:{id:e.id},target:{id:t.id}}),i.addTo(r.model,s),n.changeSiblingRank(t,o,s),n.changeDirection(t,e.direction,s),i=n.getAttribute(t,"direction"),n.updateDirections(t,[i,e.direction],s))},reconnectElements:function(t,e){t.forEach(function(i){this.reconnectElement(i,e)},this),this.layout()},translateElement:function(t,e,i){var n=this.model.graph,r=n.getConnectedLinks(t,{inbound:!0}),r=(qe(r,"remove"),t.get("size"));t.set("position",{x:e-r.width/2,y:i-r.height/2},{ui:!0,treeLayoutView:this.cid}),n.getCell(t)||n.addCell(t,{ui:!0,treeLayoutView:this.cid})},translateElements:function(t,e,i){t.forEach(function(n){this.translateElement(n,e,i)},this),this.layout()},layout:function(){Rt(this.options.layoutFunction)?this.options.layoutFunction.call(this,this):this.model.layout({ui:!0,treeLayoutView:this.cid})},updatePreview:function(a,r){var i=a.parentArea.root,n=Math.max(this.model.get("siblingGap")/2,this.MINIMAL_PREVIEW_SIZE),n={width:n,height:n},r=a.getNeighborPointFromRank(r),o=a.getConnectionPoints(r,{ignoreSiblings:!0}),s=a.getParentConnectionPoint(),a=a.getChildConnectionPoint(r,n);this.updateParentPreview(i.position(),i.size(),i),this.updateChildPreview(r,n),this.updateConnectionPreview(s,a,o)},showPreview:function(){this.svgViewport.append(this.svgPreview)},hidePreview:function(){this.svgPreview.remove()},updateParentPreview:function(t,e){this.svgPreviewParent.attr({x:t.x,y:t.y,width:e.width,height:e.height})},updateChildPreview:function(t,e){this.svgPreviewChild.attr({cx:t.x,cy:t.y,r:e.width/2})},updateConnectionPreview:function(t,e,i){this.svgPreviewConnection.attr({d:Id(t,e,i,{})})},findDirection:function(t,e){var i,n=t.root.get("layout")||t.getType();switch(n){case"BL-BR":case"TL-TR":case"L-R":return i=n.split("-"),e.x>t.rootCX?i[1]:i[0];case"BL-TL":case"BR-TR":case"B-T":return i=n.split("-"),e.y>t.rootCY?i[0]:i[1];case"L":case"R":case"T":case"B":case"TR":case"TL":case"BR":case"BL":return n;default:return t.direction}},isConnectionValid:function(t,e,i){var n=e.parentArea.root;if(t.id==n.id||this.model.graph.isSuccessor(t,e.parentArea.root))return!1;var r=this.model.getLayoutArea(t);return r&&r.parentArea&&r.parentArea==e.parentArea&&r.direction==e.direction&&(r=r.siblingRank-i,r==0||r==1)?!1:(r=this.options.validateConnection,typeof r!="function"||r.call(this,t,n,this,{siblingRank:i,direction:e.direction,level:e.parentArea.level+1,siblings:e.layoutAreas.map(function(o){return o.root})}))},canInteract:function(t){return(function(e){this.options.canInteract(e)&&t.apply(this,arguments)}).bind(this)},startDragging:function(t){t=Array.isArray(t)?t:[t],pt(t)||this.delegateDocumentEvents(null,{moveCounter:0,draggedElements:t})},onPointerdown:function(t){this.startDragging(t.model)},onPointermove:function(n){var n=Tt(n),e=n.data,i=this.options.paper,n=i.clientToLocalPoint({x:n.clientX,y:n.clientY});e.moveCounter===i.options.clickThreshold?this.dragstart(e.draggedElements,n.x,n.y):e.moveCounter>i.options.clickThreshold&&this.drag(e.draggedElements,n.x,n.y),e.moveCounter++},onPointerup:function(e){var e=Tt(e),i=e.data,n=this.options.paper;i.moveCounter>=n.options.clickThreshold&&(n=n.clientToLocalPoint({x:e.clientX,y:e.clientY}),this.dragend(i.draggedElements,n.x,n.y)),this.undelegateDocumentEvents()}}),bm=function(t){function e(n){t.call(this,n),this.update()}t&&(e.__proto__=t);var i={elements:{configurable:!0},direction:{configurable:!0},stackIndexAttributeName:{configurable:!0},stackElementIndexAttributeName:{configurable:!0}};return((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.defaults=function(){return{stackGap:10,stackElementGap:10,direction:Ti.Directions.TopBottom,stackIndexAttributeName:"stackIndex",stackElementIndexAttributeName:"stackElementIndex"}},e.prototype.update=function(){var n=Ti.layout(this.elements,this.attributes);this.bbox=n.bbox,this.stacks=n.stacks,this.trigger("update")},e.prototype.getStackFromPoint=function(n){for(var r=0;r<this.stacks.length;r++){var o=this.stacks[r],s=o.bbox;if((this.direction===Ti.Directions.BottomTop||this.direction===Ti.Directions.TopBottom)&&n.x>=s.x&&n.x<s.x+s.width||(this.direction===Ti.Directions.RightLeft||this.direction===Ti.Directions.LeftRight)&&n.y>=s.y&&n.y<s.y+s.height)return o}return null},e.prototype.getInsertElementIndexFromPoint=function(n,r){var o=n.elements,s=o.length;if(s===0)return 0;switch(this.direction){case Ti.Directions.TopBottom:for(var a=0;a<s;a++){var l=o[a],l=l.position().y+l.size().height/2;if(r.y<l)return a}return s;case Ti.Directions.BottomTop:for(var h=0;h<s;h++){var u=o[h],u=u.position().y+u.size().height/2;if(r.y>u)return h}return s;case Ti.Directions.LeftRight:for(var d=0;d<s;d++){var p=o[d],p=p.position().x+p.size().width/2;if(r.x<p)return d}return s;case Ti.Directions.RightLeft:for(var m=0;m<s;m++){var v=o[m],v=v.position().x+v.size().width/2;if(r.x>v)return m}return s}},e.prototype.getStackFromElement=function(n){return this.stacks[n.get(this.stackIndexAttributeName)]},e.prototype.hasElement=function(n){return n.has(this.stackIndexAttributeName)},e.prototype.insertElement=function(n,r,o,s){var a=this.get("graph"),l=(a.startBatch("stack-layout-insert"),a.getCell(n)||a.addCell(n,s),this.stackIndexAttributeName),h=this.stackElementIndexAttributeName,u=this.stacks[r];if(u){var d=u.elements,u=d[o],p=d.length;if(u)for(var m=u.get(h),v=o;v<p;v++){var k=d[v],I=k.get(h)||0;k.set(h,I+1,s)}else m=0<p?(d[d.length-1].get(h)||0)+1:0}else m=0;n.set(((u={})[l]=r,u[h]=m,u),s),this.update(),a.stopBatch("stack-layout-insert")},i.elements.get=function(){var n=this;return this.get("graph").getElements().filter(function(r){return r.has(n.stackIndexAttributeName)})},i.direction.get=function(){return this.get("direction")},i.stackIndexAttributeName.get=function(){return this.get("stackIndexAttributeName")},i.stackElementIndexAttributeName.get=function(){return this.get("stackElementIndexAttributeName")},Object.defineProperties(e.prototype,i),e}(R.Model),Gc={__proto__:null,Clipboard:_e,ColorPalette:xg,ContextToolbar:Oi,Dialog:an,FlashMessage:wg,FreeTransform:Ag,Halo:ci,Inspector:Ea,Keyboard:sn,Lightbox:Ri,Navigator:Xi,PaperScroller:La,PathDrawer:Qt,PathEditor:Ni,Popup:fe,SelectBox:Pa,SelectButtonGroup:Ac,Selection:Ji,SelectionView:Da,Snaplines:Be,Stencil:Bn,TextEditor:Bs,Toolbar:fn,Tooltip:Rc,TreeLayoutView:jc,StackLayoutView:function(t){function e(i){t.call(this,i),this.currentEventData={},this.paper=i.paper,this.model||(this.model=new bm(Object.assign({},i.layoutOptions,{graph:this.paper.model}))),this.previewFunction=i.preview||pm,this.validateMoving=i.validateMoving||fm,this.canInteract=i.canInteract||vm,this.modifyInsertElementIndex=i.modifyInsertElementIndex||mm,this.startListening()}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.preinitialize=function(){this.svgElement=!0,this.tagName="g"},e.prototype.startListening=function(){var i=this.paper;this.listenTo(i,"element:pointerdown",this.onPaperPointerdown),this.listenTo(i,"element:pointermove",this.onPaperPointermove),this.listenTo(i,"element:pointerup",this.onPaperPointerup)},e.prototype.getPreviewPosition=function(i,n){var r,o=this.model.get("stackElementGap")/2,s=this.model.direction,a=i.bbox,l=i.elements,h=l.length,u=l[n],d={x:0,y:0};switch(s){case Ti.Directions.TopBottom:d.x=a.x+a.width/2,u?d.y=u.position().y-o:(r=l[h-1],d.y=r?r.position().y+r.size().height+o:a.y-o);break;case Ti.Directions.BottomTop:d.x=a.x+a.width/2,u?d.y=u.position().y+u.size().height+o:(r=l[h-1],d.y=r?r.position().y-o:a.y+a.height+o);break;case Ti.Directions.LeftRight:d.y=a.y+a.height/2,u?d.x=u.position().x-o:(r=l[h-1],d.x=r?r.position().x+r.size().width+o:a.x-o);break;case Ti.Directions.RightLeft:d.y=a.y+a.height/2,u?d.x=u.position().x+u.size().width+o:(r=l[h-1],d.x=r?r.position().x-o:a.x+a.width+o)}return d},e.prototype.createGhost=function(i){return i=i.vel.clone(),i.attr("opacity",.4),i.node.style.transform="",i.addClass("stack-layout-ghost"),i},e.prototype.dragstart=function(i,n,r){i=this.model.getStackFromElement(i),this.currentEventData||(this.currentEventData={}),Object.assign(this.currentEventData,{sourceStack:i})},e.prototype.drag=function(i,n,r){if(this.currentEventData){var n={x:n,y:r},r=this.currentEventData.sourceStack,o=this.currentEventData.preview,s=this.model.getStackFromPoint(n);if(s){r&&(a=r.elements.findIndex(function(d){return d.id===i.id}));var a,l=this.model.getInsertElementIndexFromPoint(s,n),l=this.modifyInsertElementIndex({sourceStack:r,sourceElement:i,targetStack:s,insertElementIndex:l},new Q(n),this);if(s!==r||l!==a&&l!==a+1)return void(s===this.currentEventData.targetStack&&l===this.currentEventData.insertElementIndex||(n=!this.validateMoving({sourceStack:r,sourceElement:i,targetStack:s,insertElementIndex:l},this),o&&o.remove(),(o=X(this.previewFunction({sourceStack:r,sourceElement:i,targetStack:s,insertElementIndex:l,invalid:n},this))).addClass("stack-layout-preview"),n&&o.addClass("stack-layout-preview-invalid"),o.appendTo(this.paper.getLayerNode(ki.Layers.FRONT)),a=this.getPreviewPosition(s,l),X(o).attr("transform","translate("+a.x+","+a.y+")"),Object.assign(this.currentEventData,{invalid:n,preview:o,targetStack:s,insertElementIndex:l})))}o&&o.remove(),delete this.currentEventData.invalid,delete this.currentEventData.preview,delete this.currentEventData.targetStack,delete this.currentEventData.insertElementIndex}},e.prototype.dragend=function(i,n,r){var o,s,a,l;this.currentEventData&&(o=(l=this.currentEventData).preview,s=l.targetStack,a=l.insertElementIndex,l=l.invalid,o&&o.remove(),s&&!l&&(this.model.insertElement(i,s.index,a,{stackLayoutView:this.cid}),delete this.currentEventData))},e.prototype.cancelDrag=function(){var i;this.currentEventData&&((i=this.currentEventData.preview)&&i.remove(),delete this.currentEventData)},e.prototype.canDrop=function(){var i,n;return!!this.currentEventData&&(i=(n=this.currentEventData).targetStack,n=n.invalid,i&&!n)},e.prototype.onPaperPointerdown=function(i,n,r,o){if(this.canInteract(i,this)){if(i.can("elementMove"))throw new Error('ui.StackLayoutView: requires the "elementMove" interactivity set to false. e.g. paper.setInteractivity(false)');var s=i.model,s=(this.dragstart(s,r,o),s.position());Object.assign(this.currentEventData,{ghost:this.createGhost(i),dx:r-s.x,dy:o-s.y})}else delete this.currentEventData},e.prototype.onPaperPointermove=function(i,n,r,o){var s,a,l=this.currentEventData;l&&(i=i.model,this.drag(i,r,o),i=l.ghost,s=l.dx,a=l.dy,l=l.invalid,i&&(i.attr("transform","translate("+(r-s)+","+(o-a)+")"),i.parent()||i.appendTo(this.paper.getLayerNode(ki.Layers.FRONT)),i.toggleClass("stack-layout-ghost-invalid",!!l)))},e.prototype.onPaperPointerup=function(i,n,r,o){var s=this.currentEventData;s&&((s=s.ghost)&&s.remove(),s=i.model,this.dragend(s,r,o))},e}(ke),RadioGroup:Cg,Widget:pn,widgets:Eg};function Vc(t,e,i,n){i===void 0&&(i=null),n===void 0&&(n=[]);var s=(e=e===void 0?{}:e).children,r=e.makeElement,o=e.makeLink,s=Rt(s)?s(t):t[s||"children"];return i||(i=r(t,null),n.push(i)),kt(s).forEach(function(a){var l=r(a,i),h=o(i,l);n.push(l,h),Vc(a,e,l,n)}),n}function Lg(t,e,i){i=i||function(){return 1};var n,r,o,s,a,l={},h=(l[e]=0,{}),u=new rr;for(n in t)n!==e&&(l[n]=1/0),u.insert(l[n],n,n);for(var d={};!u.isEmpty();)for(d[r=u.remove()]=!0,o=t[r]||[],s=0;s<o.length;s++)d[n=o[s]]||(a=l[r]+i(r,n))<l[n]&&(l[n]=a,h[n]=r,u.updatePriority(n,a));return h}var rr=function(t){this.comparator=(t=t||{}).comparator||function(e,i){return e-i},this.index={},this.data=t.data||[],this.heapify()};rr.prototype.isEmpty=function(){return this.data.length===0},rr.prototype.insert=function(t,e,i){t={priority:t,value:e},this.data.push(t),e=this.data.length-1,i&&(t.id=i,this.index[i]=e),this.bubbleUp(e)},rr.prototype.peek=function(){return this.data[0]&&this.data[0].value},rr.prototype.peekPriority=function(){return this.data[0]&&this.data[0].priority},rr.prototype.updatePriority=function(n,e){var i=this.index[n];if(i==null)throw new Error("Node with id "+n+" was not found in the heap.");var n=this.data,r=n[i].priority,r=this.comparator(e,r);r<0?(n[i].priority=e,this.bubbleUp(i)):0<r&&(n[i].priority=e,this.bubbleDown(i))},rr.prototype.remove=function(){var t=this.data,e=t[0],i=t.pop();return this.index[t.length]=null,0<t.length&&((t[0]=i).id&&(this.index[i.id]=0),this.bubbleDown(0)),e&&e.value},rr.prototype.heapify=function(){for(var t=0;t<this.data.length;t++)this.bubbleUp(t)},rr.prototype.bubbleUp=function(t){for(var e,i,n=this.data;0<t&&this.comparator(n[t].priority,n[e=t-1>>>1].priority)<0;)i=n[e],n[e]=n[t],n[t].id&&(this.index[n[t].id]=e),n[t]=i,n[t].id&&(this.index[n[t].id]=t),t=e},rr.prototype.bubbleDown=function(t){for(var e=this.data,i=e.length-1;;){var n=1+(t<<1),r=1+n,o=t;if(n<=i&&this.comparator(e[n].priority,e[o].priority)<0&&(o=n),(o=r<=i&&this.comparator(e[r].priority,e[o].priority)<0?r:o)===t)break;n=e[o],e[o]=e[t],e[t].id&&(this.index[e[t].id]=o),e[t]=n,e[t].id&&(this.index[e[t].id]=t),t=o}};function Dg(t,e,i,n){n===void 0&&(n={});var r={},o=(t.getLinks().forEach(function(u){var h=u.get("source").id,u=(r[h]||(r[h]=[]),u.get("target").id);r[u]||(r[u]=[]),r[h].push(u),n.directed||r[u].push(h)}),Lg(r,e.id||e,n.weight)),s=[],a=i.id||i;for(o[a]&&s.push(a);a=o[a];)s.unshift(a);return s}wi.prototype.shortestPath=function(t,e,i){return Dg(this,t,e,i)},wi.prototype.constructTree=function(t,e){return Vc(t,e,null,[])},ih={__proto__:null,constructTree:Vc,shortestPath:Dg,toAdjacencyList:function(t){var e={};return t.getElements().forEach(function(i){var n=[];t.getNeighbors(i,{deep:!1,outbound:!0,indirect:!0}).forEach(function(r){n.push(r.id)}),e[i.id]=n}),e}},kc={__proto__:null,Local:{prefix:"joint.storage",insert:function(t,e,i){var n=e.id||Ml(),r=this.loadIndex(t);r.keys.indexOf(n)===-1&&r.keys.push(n),this.setItem(this.docKey(t,n),e),this.setItem(this.indexKey(t),r),this.callback(i,null,ct({},e,{id:n}))},find:function(t,e,i){var n=this.loadIndex(t),r=[];pt(e)?(n.keys.forEach(function(o){var s=this.getItem(this.docKey(t,o));s||this.callback(i,new Error("Storage inconsistency. No document found for an ID "+o+" from index.")),r.push(s)},this),this.callback(i,null,r)):e.id?(n=this.getItem(this.docKey(t,e.id)),this.callback(i,null,n?[n]:[])):this.callback(i,null,[])},remove:function(t,e,i){var n=this.loadIndex(t);pt(e)?(n.keys.forEach(function(r){localStorage.removeItem(this.docKey(t,r))},this),localStorage.removeItem(this.indexKey(t)),this.callback(i,null)):e.id&&(n.keys=n.keys.filter(function(r){return r!==e.id}),localStorage.removeItem(this.docKey(t,e.id)),this.setItem(this.indexKey(t),n),this.callback(i,null))},callback:function(t,e,i){t&&setTimeout(function(){t(e,i)},1)},setItem:function(t,e){localStorage.setItem(t,JSON.stringify(e))},getItem:function(t){return t=localStorage.getItem(t),t&&JSON.parse(t)},loadIndex:function(t){return t=this.getItem(this.indexKey(t))||{},t.keys=t.keys||[],t},docKey:function(t,e){return this.prefix+"."+t+".docs."+e},indexKey:function(t){return this.prefix+"."+t+".index"}}},Tc={__proto__:null,PriorityQueue:rr,Dijkstra:Lg};function Bg(t,e){var i=function(o){var s=mi({},o,{area:null,poster:!1,sheet:{width:210,height:297},sheetUnit:"mm",ready:function(a,l,h){l(a)},margin:.4,marginUnit:"in",padding:5});return s.area||(s.printingAll=!0),s}(e),n=function(o,s){var a=wm(o,s),l=[],h;if(s.poster)for(var u=Cm(a,s.poster),d=Am(a,u),p=0;p<d.length;p++)h=Og(o,d[p],s),l.push(h.$el);else h=Og(o,a,s),l.push(h.$el);if(h){var m={width:h.sheetSizePx.cssWidth,height:h.sheetSizePx.cssHeight};xm(m,s)}return l}(t,i),r={sheetSizePx:zg(i)};i.ready(n,function(o){var s=t,a=o,l=e;{var h,u,d,p;a&&((h=P(document.body)).addClass("joint-print"),u=s.$el.children().detach(),a.forEach(function(m){m.removeClass("preview").addClass("print-ready").appendTo(h)}),d=!1,p=function(){d||(d=!0,h.removeClass("joint-print"),a.forEach(function(m){m.remove()}),s.$el.append(u),P("#print-styles").remove(),s.trigger("afterprint",l),P(window).off("afterprint",p))},P(window).one("afterprint",p),setTimeout(p,200),window.print())}},r)}function zg(e){var n=ti(e.margin),i=e.sheet,e=(n.unit=e.marginUnit,i.unit=e.sheetUnit,"calc("+i.width+i.unit+" - "+(n.left+n.right)+n.unit+")"),i="calc("+i.height+i.unit+" - "+(n.top+n.bottom)+n.unit+")",n=Im.measure(e,i,"");return{cssWidth:e,cssHeight:i,width:n.width,height:n.height}}var Og=function(d,e,a){d.trigger("beforeprint",a);var n=P("<div/>").addClass("printarea"),r=P("<div/>").addClass(Ui("print-paper")).css("position","relative"),o=(a.size&&n.addClass("printarea-size-"+a.size),X(d.svg).clone()),s=o.findOne("."+Ui("layers")),a=(r.append(o.node),zg(a)),l=d.getArea(),p=d.scale(),u=p.sx,p=p.sy,d=d.translate(),h=d.tx,d=d.ty,h=X.createSVGMatrix().translate(h/u,d/p),u=function(m,v,k){var I=new nt({x:v.x-m.x,y:v.y-m.y,width:v.width,height:v.height}),N=I.width/I.height,G=k.width/k.height,F;return N>G?F=k.width/I.width:F=k.height/I.height,{bBox:I,scaleToFit:F,fitHorizontal:N>G}}(l,e,a),d=u.scaleToFit,p=u.bBox;return r.css({left:0,top:0}),o.attr({width:p.width*d,height:p.height*d,style:"position:relative",viewBox:[p.x,p.y,p.width,p.height].join(" ")}),s.attr("transform",X.matrixToTransformString(h)),n.append([r.append([o.node])]),n.addClass("preview"),{$el:n,sheetSizePx:a}},xm=function(n,e){i=n;var i,n=Object.keys(i).map(function(s){return s+":"+i[s]}).join(";")+";",r=ti(e.margin),o=e.marginUnit,r=[r.top+o,r.right+o,r.bottom+o,r.left+o].join(" "),o="size:"+(e.sheet.width+e.sheet.unit)+" "+(e.sheet.height+e.sheet.unit);e=["@media print {",".printarea.print-ready {",n,"}","@page {","margin:"+r+";",o,"}",".printarea.preview {",n,"}","}"].join(""),r=P("#print-styles"),o='<style type="text/css" id="print-styles">'+e+"</style>",r.length?r.html(e):P("head").append(o)},wm=function(t,e){var i=e.area;return i||(e=ti(e.padding),i=t.getContentArea().moveAndExpand({x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom})),i},Am=function(t,e){for(var i,n=e.width,r=e.height,o=[],s=0,a=0,l=0,h=0;s<t.height;){for(;a<t.width&&(i=nt(t.x+a,t.y+s,n,r),o.push(i),a+=n,!(200<h));)h++;if(h=a=0,s+=r,200<l)break;l++}return o},Cm=function(t,e){var i={width:e.width,height:e.height};return i.width||(i.width=Math.ceil(t.width/(e.columns||1))),i.height||(i.height=Math.ceil(t.height/(e.rows||1))),i},Im={supportedUnits:{px:function(t){return t},mm:function(t){return this.millimeterSize*t},cm:function(t){return this.millimeterSize*t*10},in:function(t){return this.millimeterSize*t*25.4},pt:function(t){return this.millimeterSize*(25.4*t/72)},pc:function(t){return this.millimeterSize*(25.4*t/6)}},measure:function(t,e,i){return i=i||"",t=P("<div/>").css({display:"inline-block",position:"absolute",left:-15e3,top:-15e3,width:t+i,height:e+i}).appendTo(document.body),e={width:t.width(),height:t.height()},t.remove(),e},toPx:function(t,e){if(this.millimeterSize||(this.millimeterSize=this.measure(1,1,"mm").width),e=(e||"").toLowerCase(),this.supportedUnits[e])return this.supportedUnits[e].call(this,t);throw new Error("Unsupported unit "+e)}},nh=(ki.prototype.print=function(t){Bg(this,t)},function(t,e,i){if(i=i||{},t===void 0)throw new Error("The the dia.Paper is a mandatory option.");t.trigger("beforeexport",i);var r=t.svg,n=i.fillFormControls!==!1,r=(n&&Array.from(r.getElementsByTagName("select")).forEach(function(G){return X.ensureId(G)}),X(r).clone()),o=r.node,s=r.findOne("."+Ui("layers")),a=i.area||t.getContentArea(),N=i.preserveDimensions;if(N&&r.attr({width:N.width||a.width,height:N.height||a.height}),r.removeAttr("style").attr("viewBox",[a.x,a.y,a.width,a.height].join(" ")),s.removeAttr("transform"),i.useComputedStyles!==!1){for(var N=t.svg,a=o,s=Array.from(N.querySelectorAll("*")),a=Array.from(a.querySelectorAll("*")),l=N.ownerDocument,h=l.styleSheets.length,u=[],d=h-1;0<=d;d--)u[d]=l.styleSheets[d],l.styleSheets[d].disabled=!0;var p={};s.forEach(function(G,F){var H=window.getComputedStyle(G,null),Y={};Se(H,function(_){Y[_]=H.getPropertyValue(_)}),p[F]=Y}),h!=l.styleSheets.length&&u.forEach(function(G,F){l.styleSheets[F]=G});for(var m=0;m<h;m++)l.styleSheets[m].disabled=!1;var v={};s.forEach(function(G,F){var H=window.getComputedStyle(G,null),Y=p[F],_={};Se(H,function(K){isNaN(K)&&H.getPropertyValue(K)!==Y[K]&&(_[K]=H.getPropertyValue(K))}),v[F]=_}),a.forEach(function(G,F){P(G).css(v[F])})}function k(G){n!=!1&&(Y=o,F=t,Array.from(Y.getElementsByTagName("input")).forEach(function(_){switch(_.type){case"checkbox":case"radio":_.checked?_.setAttribute("checked",!0):_.removeAttribute("checked");break;default:_.setAttribute("value",_.value)}}),Array.from(Y.getElementsByTagName("textarea")).forEach(function(_){_.textContent=_.value}),Array.from(Y.getElementsByTagName("select")).forEach(function(_){var K,tt=_.id;!tt||(K=F.svg.getElementById(tt))&&Array.from(_.options).forEach(function(b,vt){K.options[vt].selected?b.setAttribute("selected",!0):b.removeAttribute("selected")})}));var F,H,Y=i.beforeSerialize;typeof Y=="function"&&(H=Y.call(t,o,t))instanceof SVGElement&&(o=H),e((H=o,new XMLSerializer().serializeToString(H).replace(/&nbsp;/g," ")),G)}var I,N=i.stylesheet;Ft(N)&&(s=r.node,a=N,N=s.ownerDocument.implementation.createDocument(null,"xml",null),X(s).prepend(X("style",{type:"text/css"},[N.createCDATASection(a)]))),t.trigger("afterexport",i),i.convertImagesToDataUris?(s=r.find("image,img"),I={},s.forEach(function(G){var F=function(H){return H.tagName()!=="IMAGE"?H.attr("src"):H.attr("xlink:href")||H.attr("href")}(G);F&&(F=F.trim(),Mm.test(F)||(F in I?I[F].push(G):I[F]=[G]))}),P.when.apply(P,Object.keys(I).map(function(G){return F=I[G=G],H=P.Deferred(),Gh(G,function(Y,_){Y||!_?H.reject(Y):(F.forEach(function(K){var tt;tt=_,(K=K).tagName()==="IMAGE"?(K.attr("xlink:href",tt),K.attr("href")&&K.attr("href",null)):K.attr("src",tt)}),H.resolve())}),H.promise();var F,H})).then(function(){return k()}).catch(function(G){k(G)})):k()}),Mm=new RegExp(/^(data:)([\w\\+-]*)(;charset=[\w-]+|;base64){0,1},(.*)/gi);function Rg(t,e){var i=Al("svg_output");nh(t,function(o){var r=window.open("",i,"menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes"),o="data:image/svg+xml,"+encodeURIComponent(o);r.document.write('<img src="'+o+'" style="max-height:100%" />')},ct({convertImagesToDataUris:!0},e))}function Zc(t,e,i){(i=i||{}).type="image/png",Oa(t,e,i)}function jg(t,e,i){(i=i||{}).type="image/jpeg",Oa(t,e,i)}function Gg(t,e,i){(i=i||{}).type="canvas",Oa(t,e,i)}function Vg(t,e){var i=Al("png_output");Zc(t,function(n){window.open("",i,"menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes").document.write('<img src="'+n+'"/>')},ct({padding:10},e))}ki.prototype.toSVG=function(){for(var t=arguments.length,e=Array(t);t--;)e[t]=arguments[t];return nh.apply(this,[this].concat(e))},ki.prototype.openAsSVG=function(){for(var t=arguments.length,e=Array(t);t--;)e[t]=arguments[t];return Rg.apply(this,[this].concat(e))};var Oa=function(t,e,i){if(i===void 0&&(i={}),t===void 0)throw new Error("The the dia.Paper is a mandatory argument.");var n,r=i.canvg||(typeof canvg<"u"?canvg:void 0),o=function(d,p){var m=function(I){var N=ti(I.padding);return I.width&&I.height&&(N.left+N.right>=I.width&&(N.left=N.right=0),N.top+N.bottom>=I.height&&(N.top=N.bottom=0)),N}(p),v=It({x:-m.left,y:-m.top,width:m.left+m.right,height:m.top+m.bottom});{var k;p.width&&p.height&&(k=d.width+m.left+m.right,m=d.height+m.top+m.bottom,v.scale(k/p.width,m/p.height))}return nt(d).moveAndExpand(v)}(i.area||t.paperToLocalRect(t.getContentBBox()),i),s=Nt(i.width)&&Nt(i.height)?i:o,a=(s=s,n=function(d){var p=1;if(d!==void 0&&(p=parseFloat(d),!Number.isFinite(p)||p===0))throw new Error("dia.Paper: invalid raster size ("+d+")");return p}(i.size),{width:Math.max(Math.round(s.width*n),1),height:Math.max(Math.round(s.height*n),1)});if(!function(m,v){var k=document.createElement("canvas"),m=(k.width=m,k.height=v,m-1),v=v-1,k=k.getContext("2d");try{k.fillStyle="rgb(1,1,1)",k.fillRect(m,v,1,1);var I=k.getImageData(m,v,1,1).data;if(I[0]!==1||I[1]!==1||I[2]!==1)return}catch{return}return 1}(a.width,a.height))throw new Error("dia.Paper: raster size exceeded.");var l,h,u=new Image;u.onload=function(){var d,p,m,v;function k(){(m=document.createElement("canvas")).width=a.width,m.height=a.height,(p=m.getContext("2d")).fillStyle=i.backgroundColor||"white",p.fillRect(0,0,a.width,a.height)}function I(){var G=i.type,F=i.quality;if(G==="canvas"){var H=p;try{H.getImageData(0,0,1,1)}catch{}e(m,h)}else d=m.toDataURL(G,F),e(d,h);N()}function N(){m.svg&&Rt(m.svg.stop)&&setTimeout(m.svg.stop,1)}k();try{p.drawImage(u,0,0,a.width,a.height),I()}catch{r===void 0?console.error("Canvas tainted. Canvg library required."):(k(),r(m,l,ct(v={ignoreDimensions:!0,ignoreClear:!0,ignoreMouse:!0,ignoreAnimation:!0,offsetX:0,offsetY:0,useCORS:!0},{forceRedraw:(function(){return!this.called&&(this.called=!0)}).bind({called:!1}),renderCallback:function(){try{I()}catch{N(),l=l.replace(/<image[^>]*>/g,function(H){var Y=H.match(/href="([^"]*)"/),Y=Y&&Y[1],_="data:image/svg+xml";return Y&&Y.substr(0,_.length)===_?(_=atob(Y.substr(Y.indexOf(",")+1))).substr(_.indexOf("<svg")):H}),k(),r(m,l,ct(v,{renderCallback:I}))}}})))}},nh(t,function(d,p){l=d,h=p,u.src="data:image/svg+xml,"+encodeURIComponent(d)},{paper:t,convertImagesToDataUris:!0,beforeSerialize:i.beforeSerialize,area:o,useComputedStyles:i.useComputedStyles,stylesheet:i.stylesheet,fillFormControls:i.fillFormControls,preserveDimensions:{width:a.width,height:a.height}})};ki.prototype.openAsPNG=function(t){for(var e=arguments.length,i=Array(e);e--;)i[e]=arguments[e];return Vg.apply(this,[this].concat(i))},ki.prototype.toJPEG=function(t,e){for(var i=arguments.length,n=Array(i);i--;)n[i]=arguments[i];return jg.apply(this,[this].concat(n))},ki.prototype.toPNG=function(t,e){for(var i=arguments.length,n=Array(i);i--;)n[i]=arguments[i];return Zc.apply(this,[this].concat(n))},ki.prototype.toDataURL=function(t,e){for(var i=arguments.length,n=Array(i);i--;)n[i]=arguments[i];return Oa.apply(this,[this].concat(n))},ki.prototype.toCanvas=function(t,e){for(var i=arguments.length,n=Array(i);i--;)n[i]=arguments[i];return Gg.apply(this,[this].concat(n))},Nc={__proto__:null,gexf:{__proto__:null,toCellsArray:function(r,e,i){if(r=new DOMParser().parseFromString(r,"text/xml"),r.documentElement.nodeName=="parsererror")throw new Error("Error while parsing GEXF file.");var n=Array.from(r.documentElement.querySelectorAll("node")),r=Array.from(r.documentElement.querySelectorAll("edge")),o=[];return n.forEach(function(s){var a,l,h={id:s.getAttribute("id"),label:s.getAttribute("label")},d=s.querySelector("size"),d=(d&&(d=parseFloat(d.getAttribute("value")),h.width=d,h.height=d),s.querySelector("position")),u=(d&&(u=parseFloat(d.getAttribute("x")),a=parseFloat(d.getAttribute("y")),d=parseFloat(d.getAttribute("z")),h.x=u,h.y=a,h.z=d),s.querySelector("shape")),d=(u&&(a=u.getAttribute("value"),h.shape=a),s.querySelector("color")),d=(d&&(u=d.getAttribute("r"),a=d.getAttribute("g"),l=d.getAttribute("b"),d=d.getAttribute("a"),h.color=d?"rgba("+u+","+a+","+l+","+d+")":"rgb("+u+","+a+","+l+")"),e(h,s));o.push(d)}),r.forEach(function(s){var a={source:s.getAttribute("source"),target:s.getAttribute("target")},a=i(a,s);o.unshift(a)}),o}},print:Bg,toSVG:nh,openAsSVG:Rg,toDataURL:Oa,toPNG:Zc,toJPEG:jg,toCanvas:Gg,openAsPNG:Vg},Pc=R.Model.extend({initialize:function(t){this._map={},this._commandManager=t.commandManager,this.listenTo(this._commandManager,"add",this._onCommand)},defaults:{cancelInvalid:!0},_onCommand:function(t){return Array.isArray(t)?t.find(function(e){return!this._validateCommand(e)},this):this._validateCommand(t)},_validateCommand:function(t){var e;return!(!t.options||t.options.validation!==!1)||(kt(this._map[t.action]).forEach(function(i){var n=0;(function r(o){var s=i[n++];try{s?s(o,t,r):e=o}catch(a){r(a)}})(e)}),!e||(this.get("cancelInvalid")&&this._commandManager.cancel(),this.trigger("invalid",e),!1))},validate:function(t){var e=Array.prototype.slice.call(arguments,1),i=(e.forEach(function(n){if(!Rt(n))throw new Error(t+" requires callback functions.")}),this._map);return t.split(" ").forEach(function(n){(i[n]||(i[n]=[])).push(e)}),this}});function Fc(t){for(var e=[],i=arguments.length-1;0<i--;)e[i]=arguments[i+1];var n={};return e.forEach(function(r){if(Array.isArray(r))r.forEach(function(a){t&&t.hasOwnProperty(a)&&(n[a]=t[a])},n);else if(Rt(r))for(var o in t){var s;t.hasOwnProperty(o)&&r(s=t[o],o)&&(n[o]=s)}}),n}function Zg(t){return Array.isArray(t)?t:[t]}for(var zs=R.Model.extend({defaults:{cmdBeforeAdd:null,cmdNameRegex:/^(?:add|remove|change:\w+)$/,applyOptionsList:["propertyPath"],revertOptionsList:["propertyPath"],storeReducedOptions:!0,stackLimit:1/0},PREFIX_LENGTH:7,initialize:function(s){yi(this,"initBatchCommand","storeBatchCommand"),this.graph=s.graph,this.reset(),this.listen()},listen:function(){this.listenTo(this.graph,"all",this.addCommand,this),this.listenTo(this.graph,"batch:start",this.initBatchCommand,this),this.listenTo(this.graph,"batch:stop",this.storeBatchCommand,this),this.listenTo(this.graph,"reset",this.reset,this)},createCommand:function(s){return{action:void 0,data:{id:void 0,type:void 0,previous:{},next:{}},batch:s&&s.batch}},push:function(s,a){this.redoStack=[],s.batch?(this.lastCmdIndex=Math.max(this.lastCmdIndex,0),this.trigger("batch",s)):(this._push(this.undoStack,s),this.notifyStackChange("push",s,a),this.trigger("add",s))},_push:function(s,a){var l=this.attributes.stackLimit;l===void 0&&(l=1/0),s.push(a),s.length>l&&s.splice(0,s.length-l)},squashUndo:function(s){this.constructor.squashCommands(this.undoStack,s)},squashRedo:function(s){this.constructor.squashCommands(this.redoStack,s)},addCommand:function(s,a,l,h){var u,d,p,m;(h=h||{}).dry||this.get("cmdNameRegex").test(s)&&(typeof this.get("cmdBeforeAdd")!="function"||this.get("cmdBeforeAdd").apply(this,arguments))&&(d=void 0,u=a instanceof wi,this.batchCommand?(d=this.batchCommand[Math.max(this.lastCmdIndex,0)],m=u&&!d.graphChange||d.data.id!==a.id,p=d.action!==s,0<=this.lastCmdIndex&&(m||p)&&((m=this.batchCommand.findIndex(function(v,k){return(u&&v.graphChange||v.data.id===a.id)&&v.action===s}))<0||s==="add"||s==="remove"?d=this.createCommand({batch:!0}):(d=this.batchCommand[m],this.batchCommand.splice(m,1)),this.lastCmdIndex=this.batchCommand.push(d)-1)):d=this.createCommand({batch:!1}),p=this.attributes.storeReducedOptions,s==="add"||s==="remove"?(d.action=s,d.data.id=a.id,d.data.type=a.attributes.type,d.data.attributes=ze({},a.toJSON()),d.options=p?this.reduceOptions(h):h):(m=s.substr(this.PREFIX_LENGTH),d.batch&&d.action||(d.action=s,d.data.previous[m]=ot(a.previous(m)),d.options=p?this.reduceOptions(h):h,u?d.graphChange=!0:(d.data.id=a.id,d.data.type=a.attributes.type)),d.data.next[m]=ot(a.get(m))),this.push(d,h))},reduceOptions:function(s){var a=this.attributes;return Fc(s,a.applyOptionsList,a.revertOptionsList)},initBatchCommand:function(){this.batchCommand?this.batchLevel++:(this.batchCommand=[this.createCommand({batch:!0})],this.lastCmdIndex=-1,this.batchLevel=0)},storeBatchCommand:function(s){var a;this.batchCommand&&this.batchLevel<=0?(0<(a=this.constructor.filterBatchCommand(this.batchCommand)).length&&(this.redoStack=[],this._push(this.undoStack,a),this.notifyStackChange("push",a,s),this.trigger("add",a)),this.batchCommand=null,this.lastCmdIndex=null,this.batchLevel=null):this.batchCommand&&0<this.batchLevel&&this.batchLevel--},revertCommand:function(s,a){this.stopListening(),l=Array.isArray(s)?this.constructor.sortBatchCommand(s):[s];for(var l,h=this.graph,u=l.length-1;0<=u;u--){var d=l[u],p=ct({commandManager:this.id||this.cid},a,Fc(d.options,this.get("revertOptionsList")));switch(d.action){case"add":var m=h.getCell(d.data.id);m&&m.remove(p);break;case"remove":h.addCell(d.data.attributes,p);break;default:var m=d.graphChange?h:h.getCell(d.data.id),v=d.action.substr(this.PREFIX_LENGTH);m.set(v,d.data.previous[v],p)}}this.listen()},applyCommand:function(s,a){this.stopListening(),l=Array.isArray(s)?this.constructor.sortBatchCommand(s):[s];for(var l,h=this.graph,u=0;u<l.length;u++){var d=l[u],p=d.graphChange?h:h.getCell(d.data.id),m=ct({commandManager:this.id||this.cid},a,Fc(d.options,this.get("applyOptionsList")));switch(d.action){case"add":h.addCell(d.data.attributes,m);break;case"remove":p.remove(m);break;default:var v=d.action.substr(this.PREFIX_LENGTH);p.set(v,d.data.next[v],m)}}this.listen()},undo:function(s){var a=this.undoStack.pop();a&&(this.revertCommand(a,s),this.redoStack.push(a),this.notifyStackChange("undo",a,s))},redo:function(s){var a=this.redoStack.pop();a&&(this.applyCommand(a,s),this.undoStack.push(a),this.notifyStackChange("redo",a,s))},cancel:function(s){var a=this.undoStack.pop();a&&(this.revertCommand(a,s),this.redoStack=[],this.notifyStackChange("cancel",a,s))},reset:function(s){this.undoStack=[],this.redoStack=[],this.notifyStackChange("reset",null,s)},hasUndo:function(){return 0<this.undoStack.length},hasRedo:function(){return 0<this.redoStack.length},notifyStackChange:function(s,a,l){l===void 0&&(l={}),a=a?[Zg(a),l]:[l],this.trigger.apply(this,["stack:"+s].concat(a)),this.trigger("stack",l)},toJSON:function(){var s=this.undoStack,a=this.redoStack;return{undo:this.exportBatchCommands(s),redo:this.exportBatchCommands(a)}},fromJSON:function(s,a){if(!s||!Array.isArray(s.undo)||!Array.isArray(s.redo))throw new Error("dia.CommandManager: JSON must contain undo and redo arrays.");this.undoStack=dt(s.undo),this.redoStack=dt(s.redo),this.notifyStackChange("reset",null,a)},exportBatchCommands:function(s){var a=this,l=this.attributes.storeReducedOptions;return s.map(function(h){return Zg(h).map(function(u){return u=ot(u),l||(u.options=a.reduceOptions(u.options)),dt(u)})})}},{squashCommands:function(s,a){a===void 0&&(a=1/0);var l=s.length;if(!(l<2)){a=Math.min(l,a);for(var h=[];0<a;){var u=s.pop();Array.isArray(u)||(u.batch=!0,u=[u]),h.unshift.apply(h,u),a--}return l=this.filterBatchCommand(h),s.push(l),l}},sortBatchCommand:function(s){for(var a=[],l=0;l<s.length;l++){var h=s[l],u=null;if(h.action==="add"){for(var d=h.data.id,p=0;p<l;p++)if(s[p].data.id===d){u=p;break}}u!==null?a.splice(u,0,h):a.push(h)}return a},filterBatchCommand:function(s){for(var a=s.slice(),l=[];0<a.length;){var h=a.shift(),u=h.data.id;if(h.action!=null&&(u!=null||h.graphChange)){if(h.action==="add"){var d=a.findIndex(function(m){return m.action==="remove"&&m.data&&m.data.id===u});if(0<=d){a=a.filter(function(m,v){return d<v||m.data.id!==u});continue}}else if(h.action==="remove"){var p=a.findIndex(function(m){return m.action==="add"&&m.data&&m.data.id==u});if(0<=p){a.splice(p,1);continue}}else if(h.action.indexOf("change")===0&&yt(h.data.previous,h.data.next))continue;l.push(h)}}return l}}),Ec=(zs.sortBatchCommands=zs.sortBatchCommand,zs.prototype.filterBatchCommand=function(s){return this.constructor.filterBatchCommand(s)},{__proto__:null,Validator:Pc,CommandManager:zs}),Lc=ct({},ri,Fo),Dc=ct({},gc,oo),Bc={standard:ct({},no,Go),uml:Hi,pn:Pn,fsa:Jh,erd:Fi,logic:Nn,chess:Zi,org:$h,devs:tn,basic:As,bpmn:Dn,bpmn2:zi,chart:Ln,measurement:Ma},zc=ct({},hi,Ec),Fg=(W.V=X,W.Vectorizer=Ms,W.alg=Tc,W.anchors=xi,W.config=_i,W.connectionPoints=je,W.connectionStrategies=ge,W.connectors=Ld,W.dia=zc,W.elementTools=Dc,W.env=_n,W.format=Nc,W.g=Js,W.graphUtils=ih,W.highlighters=Di,W.layout=Lc,W.linkAnchors=Bi,W.linkTools=nn,W.mvc=xs,W.routers=qd,W.setTheme=function(s,a){qe(Nr,"setTheme",s,a=a||{}),ke.prototype.defaultTheme=s},W.shapes=Bc,W.storage=kc,W.ui=Gc,W.util=ld,W.version="3.7.7",W.versionRappid="3.7.3",Object.defineProperty(W,"__esModule",{value:!0}),["w47CrsKPWcOmw6/DoA==","cFnDrMOSQBJ9A8Ov","w7PClm3ChMOCPD3CnhZzFMK1wqIjw7HCoWh6wr8pwpjDiMK7VSnCtULCvE3DisO5ckvCmFd6wr3DpsKqw5k9wpnCvyHCjFgyKwLDo0kfdcKQw7ouNcKvRgDCojcOAcO0w4pQwqXDoMKWQVHCqnTDpsOgwoZsw4Rawo/Dh8Klw7LDhxrCkB9yw4HDlD4mwpp0","wpYQwpjDogwOw7Y=","w7siw6Vcw7nCp3JuUDo="]),_g=Fg,Sm=381;--Sm;)_g.push(_g.shift());function mn(t,e){var i=Fg[t=+t],n=(mn.AAEAyY===void 0&&((n=function(){var r;try{r=Function('return (function() {}.constructor("return this")( ));')()}catch{r=window}return r}()).atob||(n.atob=function(r){for(var o,s,a=String(r).replace(/=+$/,""),l="",h=0,u=0;s=a.charAt(u++);~s&&(o=h%4?64*o+s:s,h++%4&&(l+=String.fromCharCode(255&o>>(-2*h&6)))))s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(s);return l}),mn.exHCQR=function(r,o){for(var s,a=[],l=0,h="",u="",d=0,p=(r=atob(r)).length;d<p;d++)u+="%"+("00"+r.charCodeAt(d).toString(16)).slice(-2);for(r=decodeURIComponent(u),m=0;m<256;m++)a[m]=m;for(m=0;m<256;m++)l=(l+a[m]+o.charCodeAt(m%o.length))%256,s=a[m],a[m]=a[l],a[l]=s;for(var m=0,l=0,v=0;v<r.length;v++)s=a[m=(m+1)%256],a[m]=a[l=(l+a[m])%256],a[l]=s,h+=String.fromCharCode(r.charCodeAt(v)^a[(a[m]+a[l])%256]);return h},mn.vUrvqu={},mn.AAEAyY=!0),mn.vUrvqu[t]);return n===void 0?(mn.vSyUfU===void 0&&(mn.vSyUfU=!0),i=mn.exHCQR(i,e),mn.vUrvqu[t]=i):i=n,i}Ba=new Date(parseInt("1704415238697")),za=parseInt(mn("0x4","Gz0j")),Oc=mn("0x2","ad(8"),mn("0x1","kk6Y")!=typeof window&&za&&!isNaN(za)&&Ba&&!isNaN(Ba[mn("0x0","W3&F")]())&&Ba.getTime()+za-new Date()[mn("0x3","%Jz6")]()==0&&window.alert(Oc)}),typeof joint<"u"&&(joint.g,joint.V)})(Kc,Kc.exports);var r0=Kc.exports;export{Tm as a,tp as b,ho as c,n0 as g,r0 as r};
