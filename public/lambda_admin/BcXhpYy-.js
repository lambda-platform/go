import{B as os,w as jr,x as Ur,E as Mt,p as Ct,G as $n,H as Ba,J as yi,K as ss,N as us,O as ls,Q as hs,R as fs,U as cs,W as ps,X as ds,Y as gi,Z as ne,_ as me,$ as Vr,a0 as St,a1 as or,a2 as sr,a3 as en,j as ur,L as He,P as Re,a4 as ms,a5 as B,a6 as Xa,a7 as ys,a8 as gs,a9 as ia,aa as ei,ab as vs,ac as Br,ad as _s,ae as bs,D as Zt,af as Wa,ag as vi,T as K,ah as xs,ai as ws,e as Cs,c as Ya,aj as Es,ak as Ts,al as aa,am as wr,an as Cr,ao as ks,ap as Fs,aq as oa,ar as Ps,as as Ms,at as Ss,au as sa,av as Ha,aw as Is,ax as Yt,ay as Gs,az as Ls,aA as Za,aB as Rs,aC as zs,aD as Ka,aE as Ja,aF as ua,aG as la,aH as ha,aI as Ns,aJ as fa,aK as As,aL as Os,aM as Qa,aN as Ds,aO as ce,aP as Xr,aQ as qs,aR as ti,aS as js,aT as Us,aU as he,aV as Vs,aW as be,aX as Wr,aY as ca,aZ as Bs,a_ as $a,a$ as eo,b0 as Xs,b1 as Ws,a as Gn,q as Ys,b as Er,F as Tr,b2 as Hs,b3 as Zs,b4 as Ks,b5 as Js,S as gt,I as pa,C as Qs,b6 as $s,M as eu,V as tu,b7 as ru,b8 as nu,b9 as iu,h as da,ba as au,bb as ou,bc as su,bd as uu,be as Ln,bf as Be,bg as ri,bh as lu,bi as hu}from"./DvEm5K3n.js";class ee extends os{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new ee(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const n=this.getStyle();return n&&e.setStyle(n),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(jr(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=Ur(e,Mt.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?fu(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function fu(r){if(typeof r=="function")return r;let e;return Array.isArray(r)?e=r:(Ct(typeof r.getZIndex=="function",41),e=[r]),function(){return e}}class tn extends $n{constructor(e,t,n){super(),n!==void 0&&t===void 0?this.setFlatCoordinates(n,e):(t=t||0,this.setCenterAndRadius(e,t,n))}clone(){const e=new tn(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,t,n,i){const a=this.flatCoordinates,o=e-a[0],s=t-a[1],u=o*o+s*s;if(u<i){if(u===0)for(let l=0;l<this.stride;++l)n[l]=a[l];else{const l=this.getRadius()/Math.sqrt(u);n[0]=a[0]+l*o,n[1]=a[1]+l*s;for(let h=2;h<this.stride;++h)n[h]=a[h]}return n.length=this.stride,u}return i}containsXY(e,t){const n=this.flatCoordinates,i=e-n[0],a=t-n[1];return i*i+a*a<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const t=this.flatCoordinates,n=t[this.stride]-t[0];return Ba(t[0]-n,t[1]-n,t[0]+n,t[1]+n,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}getType(){return"Circle"}intersectsExtent(e){const t=this.getExtent();if(yi(e,t)){const n=this.getCenter();return e[0]<=n[0]&&e[2]>=n[0]||e[1]<=n[1]&&e[3]>=n[1]?!0:ss(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const t=this.stride,n=this.flatCoordinates[t]-this.flatCoordinates[0],i=e.slice();i[t]=i[0]+n;for(let a=1;a<t;++a)i[t+a]=e[a];this.setFlatCoordinates(this.layout,i),this.changed()}setCenterAndRadius(e,t,n){this.setLayout(n,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const i=this.flatCoordinates;let a=us(i,0,e,this.stride);i[a++]=i[0]+t;for(let o=1,s=this.stride;o<s;++o)i[a++]=i[o];i.length=a,this.changed()}getCoordinates(){return null}setCoordinates(e,t){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,t){const n=this.getCenter(),i=this.getStride();this.setCenter(ls(n,0,n.length,i,e,t,n)),this.changed()}}tn.prototype.transform;class ae extends hs{constructor(e){super(),this.geometries_=e||null,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(jr),this.changeEventsKeys_.length=0}listenGeometriesChange_(){if(this.geometries_)for(let e=0,t=this.geometries_.length;e<t;++e)this.changeEventsKeys_.push(Ur(this.geometries_[e],Mt.CHANGE,this.changed,this))}clone(){const e=new ae(null);return e.setGeometries(this.geometries_),e.applyProperties(this),e}closestPointXY(e,t,n,i){if(i<fs(this.getExtent(),e,t))return i;const a=this.geometries_;for(let o=0,s=a.length;o<s;++o)i=a[o].closestPointXY(e,t,n,i);return i}containsXY(e,t){const n=this.geometries_;for(let i=0,a=n.length;i<a;++i)if(n[i].containsXY(e,t))return!0;return!1}computeExtent(e){cs(e);const t=this.geometries_;for(let n=0,i=t.length;n<i;++n)ps(e,t[n].getExtent());return e}getGeometries(){return ma(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let n=0,i=t.length;n<i;++n)t[n].getType()===this.getType()?e=e.concat(t[n].getGeometriesArrayRecursive()):e.push(t[n]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],n=this.geometries_;let i=!1;for(let a=0,o=n.length;a<o;++a){const s=n[a],u=s.getSimplifiedGeometry(e);t.push(u),u!==s&&(i=!0)}if(i){const a=new ae(null);return a.setGeometriesArray(t),a}return this.simplifiedGeometryMaxMinSquaredTolerance=e,this}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let n=0,i=t.length;n<i;++n)if(t[n].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const n=this.geometries_;for(let i=0,a=n.length;i<a;++i)n[i].rotate(e,t);this.changed()}scale(e,t,n){n||(n=ds(this.getExtent()));const i=this.geometries_;for(let a=0,o=i.length;a<o;++a)i[a].scale(e,t,n);this.changed()}setGeometries(e){this.setGeometriesArray(ma(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let n=0,i=t.length;n<i;++n)t[n].applyTransform(e);this.changed()}translate(e,t){const n=this.geometries_;for(let i=0,a=n.length;i<a;++i)n[i].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function ma(r){const e=[];for(let t=0,n=r.length;t<n;++t)e.push(r[t].clone());return e}class cu extends gi{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(kr(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(kr(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return ne()}readFeaturesFromObject(e,t){return ne()}readGeometry(e,t){return this.readGeometryFromObject(kr(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return ne()}readProjection(e){return this.readProjectionFromObject(kr(e))}readProjectionFromObject(e){return ne()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return ne()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return ne()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return ne()}}function kr(r){if(typeof r=="string"){const e=JSON.parse(r);return e||null}return r!==null?r:null}class ya extends cu{constructor(e){e=e||{},super(),this.dataProjection=me(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=me(e.featureProjection)),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let n=null;e.type==="Feature"?n=e:n={type:"Feature",geometry:e,properties:null};const i=ni(n.geometry,t),a=new ee;return this.geometryName_?a.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in n!==void 0&&a.setGeometryName(n.geometry_name),a.setGeometry(i),"id"in n&&a.setId(n.id),n.properties&&a.setProperties(n.properties,!0),a}readFeaturesFromObject(e,t){const n=e;let i=null;if(n.type==="FeatureCollection"){const a=e;i=[];const o=a.features;for(let s=0,u=o.length;s<u;++s)i.push(this.readFeatureFromObject(o[s],t))}else i=[this.readFeatureFromObject(e,t)];return i}readGeometryFromObject(e,t){return ni(e,t)}readProjectionFromObject(e){const t=e.crs;let n;return t?t.type=="name"?n=me(t.properties.name):t.type==="EPSG"?n=me("EPSG:"+t.properties.code):Ct(!1,36):n=this.dataProjection,n}writeFeatureObject(e,t){t=this.adaptOptions(t);const n={type:"Feature",geometry:null,properties:null},i=e.getId();if(i!==void 0&&(n.id=i),!e.hasProperties())return n;const a=e.getProperties(),o=e.getGeometry();return o&&(n.geometry=ii(o,t),delete a[e.getGeometryName()]),Vr(a)||(n.properties=a),n}writeFeaturesObject(e,t){t=this.adaptOptions(t);const n=[];for(let i=0,a=e.length;i<a;++i)n.push(this.writeFeatureObject(e[i],t));return{type:"FeatureCollection",features:n}}writeGeometryObject(e,t){return ii(e,this.adaptOptions(t))}}function ni(r,e){if(!r)return null;let t;switch(r.type){case"Point":{t=du(r);break}case"LineString":{t=mu(r);break}case"Polygon":{t=_u(r);break}case"MultiPoint":{t=gu(r);break}case"MultiLineString":{t=yu(r);break}case"MultiPolygon":{t=vu(r);break}case"GeometryCollection":{t=pu(r);break}default:throw new Error("Unsupported GeoJSON type: "+r.type)}return St(t,!1,e)}function pu(r,e){const t=r.geometries.map(function(n){return ni(n,e)});return new ae(t)}function du(r){return new Re(r.coordinates)}function mu(r){return new He(r.coordinates)}function yu(r){return new sr(r.coordinates)}function gu(r){return new en(r.coordinates)}function vu(r){return new or(r.coordinates)}function _u(r){return new ur(r.coordinates)}function ii(r,e){r=St(r,!0,e);const t=r.getType();let n;switch(t){case"Point":{n=Tu(r);break}case"LineString":{n=xu(r);break}case"Polygon":{n=ku(r,e);break}case"MultiPoint":{n=Cu(r);break}case"MultiLineString":{n=wu(r);break}case"MultiPolygon":{n=Eu(r,e);break}case"GeometryCollection":{n=bu(r,e);break}case"Circle":{n={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return n}function bu(r,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:r.getGeometriesArray().map(function(n){return ii(n,e)})}}function xu(r,e){return{type:"LineString",coordinates:r.getCoordinates()}}function wu(r,e){return{type:"MultiLineString",coordinates:r.getCoordinates()}}function Cu(r,e){return{type:"MultiPoint",coordinates:r.getCoordinates()}}function Eu(r,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:r.getCoordinates(t)}}function Tu(r,e){return{type:"Point",coordinates:r.getCoordinates()}}function ku(r,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:r.getCoordinates(t)}}class Fu extends gi{constructor(){super()}getType(){return"text"}readFeature(e,t){return this.readFeatureFromText(Fr(e),this.adaptOptions(t))}readFeatureFromText(e,t){return ne()}readFeatures(e,t){return this.readFeaturesFromText(Fr(e),this.adaptOptions(t))}readFeaturesFromText(e,t){return ne()}readGeometry(e,t){return this.readGeometryFromText(Fr(e),this.adaptOptions(t))}readGeometryFromText(e,t){return ne()}readProjection(e){return this.readProjectionFromText(Fr(e))}readProjectionFromText(e){return this.dataProjection}writeFeature(e,t){return this.writeFeatureText(e,this.adaptOptions(t))}writeFeatureText(e,t){return ne()}writeFeatures(e,t){return this.writeFeaturesText(e,this.adaptOptions(t))}writeFeaturesText(e,t){return ne()}writeGeometry(e,t){return this.writeGeometryText(e,this.adaptOptions(t))}writeGeometryText(e,t){return ne()}}function Fr(r){return typeof r=="string"?r:""}const R={POINT:1,LINE_STRING:2,POLYGON:3,MULTI_POINT:4,MULTI_LINE_STRING:5,MULTI_POLYGON:6,GEOMETRY_COLLECTION:7,POLYHEDRAL_SURFACE:15,TIN:16,TRIANGLE:17};class ga{constructor(e){this.view_=e,this.pos_=0,this.initialized_=!1,this.isLittleEndian_=!1,this.hasZ_=!1,this.hasM_=!1,this.srid_=null,this.layout_="XY"}readUint8(){return this.view_.getUint8(this.pos_++)}readUint32(e){return this.view_.getUint32((this.pos_+=4)-4,e!==void 0?e:this.isLittleEndian_)}readDouble(e){return this.view_.getFloat64((this.pos_+=8)-8,e!==void 0?e:this.isLittleEndian_)}readPoint(){const e=[];return e.push(this.readDouble()),e.push(this.readDouble()),this.hasZ_&&e.push(this.readDouble()),this.hasM_&&e.push(this.readDouble()),e}readLineString(){const e=this.readUint32(),t=[];for(let n=0;n<e;n++)t.push(this.readPoint());return t}readPolygon(){const e=this.readUint32(),t=[];for(let n=0;n<e;n++)t.push(this.readLineString());return t}readWkbHeader(e){const n=this.readUint8()>0,i=this.readUint32(n),a=Math.floor((i&268435455)/1e3),o=!!(i&2147483648)||a===1||a===3,s=!!(i&1073741824)||a===2||a===3,u=!!(i&536870912),l=(i&268435455)%1e3,h=["XY",o?"Z":"",s?"M":""].join(""),f=u?this.readUint32(n):null;if(e!==void 0&&e!==l)throw new Error("Unexpected WKB geometry type "+l);if(this.initialized_){if(this.isLittleEndian_!==n)throw new Error("Inconsistent endian");if(this.layout_!==h)throw new Error("Inconsistent geometry layout");if(f&&this.srid_!==f)throw new Error("Inconsistent coordinate system (SRID)")}else this.isLittleEndian_=n,this.hasZ_=o,this.hasM_=s,this.layout_=h,this.srid_=f,this.initialized_=!0;return l}readWkbPayload(e){switch(e){case R.POINT:return this.readPoint();case R.LINE_STRING:return this.readLineString();case R.POLYGON:case R.TRIANGLE:return this.readPolygon();case R.MULTI_POINT:return this.readMultiPoint();case R.MULTI_LINE_STRING:return this.readMultiLineString();case R.MULTI_POLYGON:case R.POLYHEDRAL_SURFACE:case R.TIN:return this.readMultiPolygon();case R.GEOMETRY_COLLECTION:return this.readGeometryCollection();default:throw new Error("Unsupported WKB geometry type "+e+" is found")}}readWkbBlock(e){return this.readWkbPayload(this.readWkbHeader(e))}readWkbCollection(e,t){const n=this.readUint32(),i=[];for(let a=0;a<n;a++){const o=e.call(this,t);o&&i.push(o)}return i}readMultiPoint(){return this.readWkbCollection(this.readWkbBlock,R.POINT)}readMultiLineString(){return this.readWkbCollection(this.readWkbBlock,R.LINE_STRING)}readMultiPolygon(){return this.readWkbCollection(this.readWkbBlock,R.POLYGON)}readGeometryCollection(){return this.readWkbCollection(this.readGeometry)}readGeometry(){const e=this.readWkbHeader(),t=this.readWkbPayload(e);switch(e){case R.POINT:return new Re(t,this.layout_);case R.LINE_STRING:return new He(t,this.layout_);case R.POLYGON:case R.TRIANGLE:return new ur(t,this.layout_);case R.MULTI_POINT:return new en(t,this.layout_);case R.MULTI_LINE_STRING:return new sr(t,this.layout_);case R.MULTI_POLYGON:case R.POLYHEDRAL_SURFACE:case R.TIN:return new or(t,this.layout_);case R.GEOMETRY_COLLECTION:return new ae(t);default:return null}}getSrid(){return this.srid_}}class Pu{constructor(e){e=e||{},this.layout_=e.layout,this.isLittleEndian_=e.littleEndian!==!1,this.isEWKB_=e.ewkb!==!1,this.writeQueue_=[],this.nodata_=Object.assign({X:0,Y:0,Z:0,M:0},e.nodata)}writeUint8(e){this.writeQueue_.push([1,e])}writeUint32(e){this.writeQueue_.push([4,e])}writeDouble(e){this.writeQueue_.push([8,e])}writePoint(e,t){const n=Object.assign.apply(null,t.split("").map((i,a)=>({[i]:e[a]})));for(const i of this.layout_)this.writeDouble(i in n?n[i]:this.nodata_[i])}writeLineString(e,t){this.writeUint32(e.length);for(let n=0;n<e.length;n++)this.writePoint(e[n],t)}writePolygon(e,t){this.writeUint32(e.length);for(let n=0;n<e.length;n++)this.writeLineString(e[n],t)}writeWkbHeader(e,t){e%=1e3,this.layout_.includes("Z")&&(e+=this.isEWKB_?2147483648:1e3),this.layout_.includes("M")&&(e+=this.isEWKB_?1073741824:2e3),this.isEWKB_&&Number.isInteger(t)&&(e|=536870912),this.writeUint8(this.isLittleEndian_?1:0),this.writeUint32(e),this.isEWKB_&&Number.isInteger(t)&&this.writeUint32(t)}writeMultiPoint(e,t){this.writeUint32(e.length);for(let n=0;n<e.length;n++)this.writeWkbHeader(1),this.writePoint(e[n],t)}writeMultiLineString(e,t){this.writeUint32(e.length);for(let n=0;n<e.length;n++)this.writeWkbHeader(2),this.writeLineString(e[n],t)}writeMultiPolygon(e,t){this.writeUint32(e.length);for(let n=0;n<e.length;n++)this.writeWkbHeader(3),this.writePolygon(e[n],t)}writeGeometryCollection(e){this.writeUint32(e.length);for(let t=0;t<e.length;t++)this.writeGeometry(e[t])}findMinimumLayout(e,t="XYZM"){const n=(i,a)=>i===a?i:i==="XYZM"?a:a==="XYZM"?i:"XY";if(e instanceof $n)return n(e.getLayout(),t);if(e instanceof ae){const i=e.getGeometriesArray();for(let a=0;a<i.length&&t!=="XY";a++)t=this.findMinimumLayout(i[a],t)}return t}writeGeometry(e,t){const n={Point:R.POINT,LineString:R.LINE_STRING,Polygon:R.POLYGON,MultiPoint:R.MULTI_POINT,MultiLineString:R.MULTI_LINE_STRING,MultiPolygon:R.MULTI_POLYGON,GeometryCollection:R.GEOMETRY_COLLECTION},i=e.getType(),a=n[i];if(!a)throw new Error("GeometryType "+i+" is not supported");this.layout_||(this.layout_=this.findMinimumLayout(e)),this.writeWkbHeader(a,t),e instanceof $n?{Point:this.writePoint,LineString:this.writeLineString,Polygon:this.writePolygon,MultiPoint:this.writeMultiPoint,MultiLineString:this.writeMultiLineString,MultiPolygon:this.writeMultiPolygon}[i].call(this,e.getCoordinates(),e.getLayout()):e instanceof ae&&this.writeGeometryCollection(e.getGeometriesArray())}getBuffer(){const e=this.writeQueue_.reduce((a,o)=>a+o[0],0),t=new ArrayBuffer(e),n=new DataView(t);let i=0;return this.writeQueue_.forEach(a=>{switch(a[0]){case 1:n.setUint8(i,a[1]);break;case 4:n.setUint32(i,a[1],this.isLittleEndian_);break;case 8:n.setFloat64(i,a[1],this.isLittleEndian_);break}i+=a[0]}),t}}class to extends gi{constructor(e){super(),e=e||{},this.splitCollection=!!e.splitCollection,this.viewCache_=null,this.hex_=e.hex!==!1,this.littleEndian_=e.littleEndian!==!1,this.ewkb_=e.ewkb!==!1,this.layout_=e.geometryLayout,this.nodataZ_=e.nodataZ||0,this.nodataM_=e.nodataM||0,this.srid_=e.srid}getType(){return this.hex_?"text":"arraybuffer"}readFeature(e,t){return new ee({geometry:this.readGeometry(e,t)})}readFeatures(e,t){let n=[];const i=this.readGeometry(e,t);return this.splitCollection&&i instanceof ae?n=i.getGeometriesArray():n=[i],n.map(a=>new ee({geometry:a}))}readGeometry(e,t){const n=va(e);if(!n)return null;const a=new ga(n).readGeometry();return this.viewCache_=n,t=this.getReadOptions(e,t),this.viewCache_=null,St(a,!1,t)}readProjection(e){const t=this.viewCache_||va(e);if(!t)return;const n=new ga(t);return n.readWkbHeader(),n.getSrid()&&me("EPSG:"+n.getSrid())||void 0}writeFeature(e,t){return this.writeGeometry(e.getGeometry(),t)}writeFeatures(e,t){return this.writeGeometry(new ae(e.map(n=>n.getGeometry())),t)}writeGeometry(e,t){t=this.adaptOptions(t);const n=new Pu({layout:this.layout_,littleEndian:this.littleEndian_,ewkb:this.ewkb_,nodata:{Z:this.nodataZ_,M:this.nodataM_}});let i=Number.isInteger(this.srid_)?Number(this.srid_):null;if(this.srid_!==!1&&!Number.isInteger(this.srid_)){const o=t.dataProjection&&me(t.dataProjection);if(o){const s=o.getCode();s.startsWith("EPSG:")&&(i=Number(s.substring(5)))}}n.writeGeometry(St(e,!0,t),i);const a=n.getBuffer();return this.hex_?Mu(a):a}}function Mu(r){const e=new Uint8Array(r);return Array.from(e.values()).map(t=>(t<16?"0":"")+Number(t).toString(16).toUpperCase()).join("")}function Su(r){const e=new Uint8Array(r.length/2);for(let t=0;t<r.length/2;t++)e[t]=parseInt(r.substr(t*2,2),16);return new DataView(e.buffer)}function va(r){return typeof r=="string"?Su(r):ArrayBuffer.isView(r)?r instanceof DataView?r:new DataView(r.buffer,r.byteOffset,r.byteLength):r instanceof ArrayBuffer?new DataView(r):null}const Iu={POINT:Re,LINESTRING:He,POLYGON:ur,MULTIPOINT:en,MULTILINESTRING:sr,MULTIPOLYGON:or},ro="EMPTY",no="Z",io="M",Gu="ZM",L={START:0,TEXT:1,LEFT_PAREN:2,RIGHT_PAREN:3,NUMBER:4,COMMA:5,EOF:6},Lu={Point:"POINT",LineString:"LINESTRING",Polygon:"POLYGON",MultiPoint:"MULTIPOINT",MultiLineString:"MULTILINESTRING",MultiPolygon:"MULTIPOLYGON",GeometryCollection:"GEOMETRYCOLLECTION",Circle:"CIRCLE"};class Ru{constructor(e){this.wkt=e,this.index_=-1}isAlpha_(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}isNumeric_(e,t){return t=t!==void 0?t:!1,e>="0"&&e<="9"||e=="."&&!t}isWhiteSpace_(e){return e==" "||e=="	"||e=="\r"||e==`
`}nextChar_(){return this.wkt.charAt(++this.index_)}nextToken(){const e=this.nextChar_(),t=this.index_;let n=e,i;if(e=="(")i=L.LEFT_PAREN;else if(e==",")i=L.COMMA;else if(e==")")i=L.RIGHT_PAREN;else if(this.isNumeric_(e)||e=="-")i=L.NUMBER,n=this.readNumber_();else if(this.isAlpha_(e))i=L.TEXT,n=this.readText_();else{if(this.isWhiteSpace_(e))return this.nextToken();if(e==="")i=L.EOF;else throw new Error("Unexpected character: "+e)}return{position:t,value:n,type:i}}readNumber_(){let e;const t=this.index_;let n=!1,i=!1;do e=="."?n=!0:(e=="e"||e=="E")&&(i=!0),e=this.nextChar_();while(this.isNumeric_(e,n)||!i&&(e=="e"||e=="E")||i&&(e=="-"||e=="+"));return parseFloat(this.wkt.substring(t,this.index_--))}readText_(){let e;const t=this.index_;do e=this.nextChar_();while(this.isAlpha_(e));return this.wkt.substring(t,this.index_--).toUpperCase()}}class zu{constructor(e){this.lexer_=e,this.token_={position:0,type:L.START},this.layout_="XY"}consume_(){this.token_=this.lexer_.nextToken()}isTokenType(e){return this.token_.type==e}match(e){const t=this.isTokenType(e);return t&&this.consume_(),t}parse(){return this.consume_(),this.parseGeometry_()}parseGeometryLayout_(){let e="XY";const t=this.token_;if(this.isTokenType(L.TEXT)){const n=t.value;n===no?e="XYZ":n===io?e="XYM":n===Gu&&(e="XYZM"),e!=="XY"&&this.consume_()}return e}parseGeometryCollectionText_(){if(this.match(L.LEFT_PAREN)){const e=[];do e.push(this.parseGeometry_());while(this.match(L.COMMA));if(this.match(L.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parsePointText_(){if(this.match(L.LEFT_PAREN)){const e=this.parsePoint_();if(this.match(L.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parseLineStringText_(){if(this.match(L.LEFT_PAREN)){const e=this.parsePointList_();if(this.match(L.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parsePolygonText_(){if(this.match(L.LEFT_PAREN)){const e=this.parseLineStringTextList_();if(this.match(L.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parseMultiPointText_(){if(this.match(L.LEFT_PAREN)){let e;if(this.token_.type==L.LEFT_PAREN?e=this.parsePointTextList_():e=this.parsePointList_(),this.match(L.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parseMultiLineStringText_(){if(this.match(L.LEFT_PAREN)){const e=this.parseLineStringTextList_();if(this.match(L.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parseMultiPolygonText_(){if(this.match(L.LEFT_PAREN)){const e=this.parsePolygonTextList_();if(this.match(L.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parsePoint_(){const e=[],t=this.layout_.length;for(let n=0;n<t;++n){const i=this.token_;if(this.match(L.NUMBER))e.push(i.value);else break}if(e.length==t)return e;throw new Error(this.formatErrorMessage_())}parsePointList_(){const e=[this.parsePoint_()];for(;this.match(L.COMMA);)e.push(this.parsePoint_());return e}parsePointTextList_(){const e=[this.parsePointText_()];for(;this.match(L.COMMA);)e.push(this.parsePointText_());return e}parseLineStringTextList_(){const e=[this.parseLineStringText_()];for(;this.match(L.COMMA);)e.push(this.parseLineStringText_());return e}parsePolygonTextList_(){const e=[this.parsePolygonText_()];for(;this.match(L.COMMA);)e.push(this.parsePolygonText_());return e}isEmptyGeometry_(){const e=this.isTokenType(L.TEXT)&&this.token_.value==ro;return e&&this.consume_(),e}formatErrorMessage_(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}parseGeometry_(){const e=this.token_;if(this.match(L.TEXT)){const t=e.value;this.layout_=this.parseGeometryLayout_();const n=this.isEmptyGeometry_();if(t=="GEOMETRYCOLLECTION"){if(n)return new ae([]);const o=this.parseGeometryCollectionText_();return new ae(o)}const i=Iu[t];if(!i)throw new Error("Invalid geometry type: "+t);let a;if(n)t=="POINT"?a=[NaN,NaN]:a=[];else switch(t){case"POINT":{a=this.parsePointText_();break}case"LINESTRING":{a=this.parseLineStringText_();break}case"POLYGON":{a=this.parsePolygonText_();break}case"MULTIPOINT":{a=this.parseMultiPointText_();break}case"MULTILINESTRING":{a=this.parseMultiLineStringText_();break}case"MULTIPOLYGON":{a=this.parseMultiPolygonText_();break}}return new i(a,this.layout_)}throw new Error(this.formatErrorMessage_())}}class ao extends Fu{constructor(e){super(),e=e||{},this.splitCollection_=e.splitCollection!==void 0?e.splitCollection:!1}parse_(e){const t=new Ru(e);return new zu(t).parse()}readFeatureFromText(e,t){const n=this.readGeometryFromText(e,t),i=new ee;return i.setGeometry(n),i}readFeaturesFromText(e,t){let n=[];const i=this.readGeometryFromText(e,t);this.splitCollection_&&i.getType()=="GeometryCollection"?n=i.getGeometriesArray():n=[i];const a=[];for(let o=0,s=n.length;o<s;++o){const u=new ee;u.setGeometry(n[o]),a.push(u)}return a}readGeometryFromText(e,t){const n=this.parse_(e);return St(n,!1,t)}writeFeatureText(e,t){const n=e.getGeometry();return n?this.writeGeometryText(n,t):""}writeFeaturesText(e,t){if(e.length==1)return this.writeFeatureText(e[0],t);const n=[];for(let a=0,o=e.length;a<o;++a)n.push(e[a].getGeometry());const i=new ae(n);return this.writeGeometryText(i,t)}writeGeometryText(e,t){return uo(St(e,!0,t))}}function oo(r){const e=r.getCoordinates();return e.length===0?"":e.join(" ")}function Nu(r){const e=[],t=r.getPoints();for(let n=0,i=t.length;n<i;++n)e.push("("+oo(t[n])+")");return e.join(",")}function Au(r){const e=[],t=r.getGeometries();for(let n=0,i=t.length;n<i;++n)e.push(uo(t[n]));return e.join(",")}function _i(r){const e=r.getCoordinates(),t=[];for(let n=0,i=e.length;n<i;++n)t.push(e[n].join(" "));return t.join(",")}function Ou(r){const e=[],t=r.getLineStrings();for(let n=0,i=t.length;n<i;++n)e.push("("+_i(t[n])+")");return e.join(",")}function so(r){const e=[],t=r.getLinearRings();for(let n=0,i=t.length;n<i;++n)e.push("("+_i(t[n])+")");return e.join(",")}function Du(r){const e=[],t=r.getPolygons();for(let n=0,i=t.length;n<i;++n)e.push("("+so(t[n])+")");return e.join(",")}function qu(r){const e=r.getLayout();let t="";return(e==="XYZ"||e==="XYZM")&&(t+=no),(e==="XYM"||e==="XYZM")&&(t+=io),t}const ju={Point:oo,LineString:_i,Polygon:so,MultiPoint:Nu,MultiLineString:Ou,MultiPolygon:Du,GeometryCollection:Au};function uo(r){const e=r.getType(),t=ju[e],n=t(r);let i=Lu[e];if(typeof r.getFlatCoordinates=="function"){const a=qu(r);a.length>0&&(i+=" "+a)}return n.length===0?i+" "+ro:i+"("+n+")"}class ai{constructor(e){this.rbush_=new ms(e),this.items_={}}insert(e,t){const n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(n),this.items_[B(t)]=n}load(e,t){const n=new Array(t.length);for(let i=0,a=t.length;i<a;i++){const o=e[i],s=t[i],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};n[i]=u,this.items_[B(s)]=u}this.rbush_.load(n)}remove(e){const t=B(e),n=this.items_[t];return delete this.items_[t],this.rbush_.remove(n)!==null}update(e,t){const n=this.items_[B(t)],i=[n.minX,n.minY,n.maxX,n.maxY];Xa(i,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let n;for(let i=0,a=e.length;i<a;i++)if(n=t(e[i]),n)return n;return n}isEmpty(){return Vr(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return Ba(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}const re={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function Uu(r,e){return[[-1/0,-1/0,1/0,1/0]]}function Vu(r,e){return[r]}class Le extends vi{constructor(e,t,n){super(e),this.feature=t,this.features=n}}class Kt extends ys{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=gs,this.format_=e.format,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(Ct(this.format_,7),this.loader_=ia(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:Uu;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new ai:null,this.loadedExtentsRtree_=new ai,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let n,i;Array.isArray(e.features)?i=e.features:e.features&&(n=e.features,i=n.getArray()),!t&&n===void 0&&(n=new ei(i)),i!==void 0&&this.addFeaturesInternal(i),n!==void 0&&this.bindFeaturesCollection_(n)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=B(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const n=e.getGeometry();if(n){const i=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new Le(re.ADDFEATURE,e))}setupChangeEvents_(e,t){this.featureChangeKeys_[e]=[Ur(t,Mt.CHANGE,this.handleFeatureChange_,this),Ur(t,vs.PROPERTYCHANGE,this.handleFeatureChange_,this)]}addToIndex_(e,t){let n=!0;const i=t.getId();return i!==void 0&&(i.toString()in this.idIndex_?n=!1:this.idIndex_[i.toString()]=t),n&&(Ct(!(e in this.uidIndex_),30),this.uidIndex_[e]=t),n}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],n=[],i=[];for(let a=0,o=e.length;a<o;a++){const s=e[a],u=B(s);this.addToIndex_(u,s)&&n.push(s)}for(let a=0,o=n.length;a<o;a++){const s=n[a],u=B(s);this.setupChangeEvents_(u,s);const l=s.getGeometry();if(l){const h=l.getExtent();t.push(h),i.push(s)}else this.nullGeometryFeatures_[u]=s}if(this.featuresRtree_&&this.featuresRtree_.load(t,i),this.hasListener(re.ADDFEATURE))for(let a=0,o=n.length;a<o;a++)this.dispatchEvent(new Le(re.ADDFEATURE,n[a]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(re.ADDFEATURE,function(n){t||(t=!0,e.push(n.feature),t=!1)}),this.addEventListener(re.REMOVEFEATURE,function(n){t||(t=!0,e.remove(n.feature),t=!1)}),e.addEventListener(Br.ADD,n=>{t||(t=!0,this.addFeature(n.element),t=!1)}),e.addEventListener(Br.REMOVE,n=>{t||(t=!0,this.removeFeature(n.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const n in this.featureChangeKeys_)this.featureChangeKeys_[n].forEach(jr);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const n=i=>{this.removeFeatureInternal(i)};this.featuresRtree_.forEach(n);for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new Le(re.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const n=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(n,function(i){if(i.getGeometry().intersectsCoordinate(e))return t(i)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(n){if(n.getGeometry().intersectsExtent(e)){const a=t(n);if(a)return a}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),Vr(this.nullGeometryFeatures_)||_s(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(n){t.push(n)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=bs(e,t);return[].concat(...i.map(a=>this.featuresRtree_.getInExtent(a)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const n=e[0],i=e[1];let a=null;const o=[NaN,NaN];let s=1/0;const u=[-1/0,-1/0,1/0,1/0];return t=t||Wa,this.featuresRtree_.forEachInExtent(u,function(l){if(t(l)){const h=l.getGeometry(),f=s;if(s=h.closestPointXY(n,i,o,s),s<f){a=l;const p=Math.sqrt(s);u[0]=n-p,u[1]=i-p,u[2]=n+p,u[3]=i+p}}}),a}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,n=B(t),i=t.getGeometry();if(!i)n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[n]=t);else{const o=i.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const a=t.getId();if(a!==void 0){const o=a.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[n]=t;this.changed(),this.dispatchEvent(new Le(re.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:B(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Vr(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,n){const i=this.loadedExtentsRtree_,a=this.strategy_(e,t,n);for(let o=0,s=a.length;o<s;++o){const u=a[o];i.forEachInExtent(u,function(h){return Zt(h.extent,u)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Le(re.FEATURESLOADSTART)),this.loader_.call(this,u,t,n,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new Le(re.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Le(re.FEATURESLOADERROR))}),i.insert(u,{extent:u.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_;let n;t.forEachInExtent(e,function(i){if(Xa(i.extent,e))return n=i,!0}),n&&t.remove(n)}removeFeature(e){if(!e)return;const t=B(e);t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=B(e),n=this.featureChangeKeys_[t];if(!n)return;n.forEach(jr),delete this.featureChangeKeys_[t];const i=e.getId();return i!==void 0&&delete this.idIndex_[i.toString()],delete this.uidIndex_[t],this.dispatchEvent(new Le(re.REMOVEFEATURE,e)),e}removeFromIdIndex_(e){let t=!1;for(const n in this.idIndex_)if(this.idIndex_[n]===e){delete this.idIndex_[n],t=!0;break}return t}setLoader(e){this.loader_=e}setUrl(e){Ct(this.format_,7),this.url_=e,this.setLoader(ia(e,this.format_))}}function Bu(r,e,t,n){const i=document.createElement("script"),a="olc_"+B(e);function o(){delete window[a],i.parentNode.removeChild(i)}i.async=!0,i.src=r+(r.includes("?")?"&":"?")+"callback="+a;const s=setTimeout(function(){o(),t&&t()},1e4);window[a]=function(u){clearTimeout(s),o(),e(u)},document.head.appendChild(i)}class Xu extends K{constructor(e){if(super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:me("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.tileJSON_=null,this.tileSize_=e.tileSize,e.url)if(e.jsonp)Bu(e.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const t=new XMLHttpRequest;t.addEventListener("load",this.onXHRLoad_.bind(this)),t.addEventListener("error",this.onXHRError_.bind(this)),t.open("GET",e.url),t.send()}else e.tileJSON?this.handleTileJSONResponse(e.tileJSON):Ct(!1,51)}onXHRLoad_(e){const t=e.target;if(!t.status||t.status>=200&&t.status<300){let n;try{n=JSON.parse(t.responseText)}catch{this.handleTileJSONError();return}this.handleTileJSONResponse(n)}else this.handleTileJSONError()}onXHRError_(e){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(e){const t=me("EPSG:4326"),n=this.getProjection();let i;if(e.bounds!==void 0){const l=xs(t,n);i=ws(e.bounds,l)}const a=Cs(n),o=e.minzoom||0,s=e.maxzoom||22,u=Ya({extent:a,maxZoom:s,minZoom:o,tileSize:this.tileSize_});if(this.tileGrid=u,this.tileUrlFunction=Es(e.tiles,u),e.attribution&&!this.getAttributions()){const l=i!==void 0?i:a;this.setAttributions(function(h){return yi(l,h.extent)?[e.attribution]:null})}this.tileJSON_=e,this.setState("ready")}handleTileJSONError(){this.setState("error")}}const cf=r=>{const e=new to,t=new ao,n=new Uint8Array(r.match(/[\da-f]{2}/gi).map(a=>parseInt(a,16))),i=e.readGeometry(n);return t.writeGeometry(i)},pf={googleLayerRoadmap:new K({url:"https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}"}),googleLayerSatellite:new K({url:"https://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}"}),googleLayerRoadNames:new K({url:"https://mt1.google.com/vt/lyrs=h&x={x}&y={y}&z={z}"}),osm:new K({url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),otm:new K({url:"https://{a-c}.tile.opentopomap.org/{z}/{x}/{y}.png"}),esriLayerStreet:new K({url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}"}),esriLayerTopo:new K({url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}"}),iMap:new K({url:"https://cloudgis.mn/map01/Tilemap/demo/{z}/{x}/{y}.png?mskey=12345"})};var Wu=/\{ *([\w_-]+) *\}/g;function df(r,e){return r.replace(Wu,function(t,n){var i=e[n];return i===void 0?i="-":typeof i=="function"&&(i=i(e)),i})}function mf(r,e){const n=document.createElement("canvas").getContext("2d");n.fillStyle=r,n.fillRect(0,0,1,1);const i=n.getImageData(0,0,1,1).data;return`rgba(${i[0]}, ${i[1]}, ${i[2]}, ${e})`}class Yu extends Ts{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=aa(),this.wrappedRenderedExtent_=aa(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.declutterExecutorGroup=null,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(e,t,n){const i=t.extent,a=t.viewState,o=a.center,s=a.resolution,u=a.projection,l=a.rotation,h=u.getExtent(),f=this.getLayer().getSource(),p=t.pixelRatio,c=t.viewHints,d=!(c[wr.ANIMATING]||c[wr.INTERACTING]),m=this.compositionContext_,v=Math.round(t.size[0]*p),x=Math.round(t.size[1]*p),y=f.getWrapX()&&u.canWrapX(),S=y?Cr(h):null,C=y?Math.ceil((i[2]-h[2])/S)+1:1;let I=y?Math.floor((i[0]-h[0])/S):0;do{const j=this.getRenderTransform(o,s,l,p,v,x,I*S);e.execute(m,1,j,l,d,void 0,n)}while(++I<C)}setupCompositionContext_(){if(this.opacity_!==1){const e=ks(this.context.canvas.width,this.context.canvas.height,oa);this.compositionContext_=e}else this.compositionContext_=this.context}releaseCompositionContext_(){if(this.opacity_!==1){const e=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=e,Fs(this.compositionContext_),oa.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(e){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,e,e.declutterTree),this.releaseCompositionContext_())}renderFrame(e,t){const n=e.pixelRatio,i=e.layerStatesArray[e.layerIndex];Ps(this.pixelTransform,1/n,1/n),Ms(this.inversePixelTransform,this.pixelTransform);const a=Ss(this.pixelTransform);this.useContainer(t,a,this.getBackground(e));const o=this.context,s=o.canvas,u=this.replayGroup_,l=this.declutterExecutorGroup;let h=u&&!u.isEmpty()||l&&!l.isEmpty();if(!h&&!(this.getLayer().hasListener(sa.PRERENDER)||this.getLayer().hasListener(sa.POSTRENDER)))return null;const f=Math.round(e.size[0]*n),p=Math.round(e.size[1]*n);s.width!=f||s.height!=p?(s.width=f,s.height=p,s.style.transform!==a&&(s.style.transform=a)):this.containerReused||o.clearRect(0,0,f,p),this.preRender(o,e);const c=e.viewState;c.projection,this.opacity_=i.opacity,this.setupCompositionContext_();let d=!1;if(h&&i.extent&&this.clipping){const m=Ha(i.extent);h=yi(m,e.extent),d=h&&!Zt(m,e.extent),d&&this.clipUnrotated(this.compositionContext_,e,m)}return h&&this.renderWorlds(u,e),d&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(o,e),this.renderedRotation_!==c.rotation&&(this.renderedRotation_=c.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(e){return new Promise(t=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const n=[this.context.canvas.width,this.context.canvas.height];Is(this.pixelTransform,n);const i=this.renderedCenter_,a=this.renderedResolution_,o=this.renderedRotation_,s=this.renderedProjection_,u=this.wrappedRenderedExtent_,l=this.getLayer(),h=[],f=n[0]*Yt,p=n[1]*Yt;h.push(this.getRenderTransform(i,a,o,Yt,f,p,0).slice());const c=l.getSource(),d=s.getExtent();if(c.getWrapX()&&s.canWrapX()&&!Zt(d,u)){let m=u[0];const v=Cr(d);let x=0,y;for(;m<d[0];)--x,y=v*x,h.push(this.getRenderTransform(i,a,o,Yt,f,p,y).slice()),m+=v;for(x=0,m=u[2];m>d[2];)++x,y=v*x,h.push(this.getRenderTransform(i,a,o,Yt,f,p,y).slice()),m-=v}this.hitDetectionImageData_=Gs(n,h,this.renderedFeatures_,l.getStyleFunction(),u,a,o)}t(Ls(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,n,i,a){if(!this.replayGroup_)return;const o=t.viewState.resolution,s=t.viewState.rotation,u=this.getLayer(),l={},h=function(c,d,m){const v=B(c),x=l[v];if(x){if(x!==!0&&m<x.distanceSq){if(m===0)return l[v]=!0,a.splice(a.lastIndexOf(x),1),i(c,u,d);x.geometry=d,x.distanceSq=m}}else{if(m===0)return l[v]=!0,i(c,u,d);a.push(l[v]={feature:c,layer:u,geometry:d,distanceSq:m,callback:i})}};let f;const p=[this.replayGroup_];return this.declutterExecutorGroup&&p.push(this.declutterExecutorGroup),p.some(c=>f=c.forEachFeatureAtCoordinate(e,o,s,n,h,c===this.declutterExecutorGroup&&t.declutterTree?t.declutterTree.all().map(d=>d.value):null)),f}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),n=t.getSource();if(!n)return!1;const i=e.viewHints[wr.ANIMATING],a=e.viewHints[wr.INTERACTING],o=t.getUpdateWhileAnimating(),s=t.getUpdateWhileInteracting();if(this.ready&&!o&&i||!s&&a)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=e.extent,l=e.viewState,h=l.projection,f=l.resolution,p=e.pixelRatio,c=t.getRevision(),d=t.getRenderBuffer();let m=t.getRenderOrder();m===void 0&&(m=Ns);const v=l.center.slice(),x=Za(u,d*f),y=x.slice(),S=[x.slice()],C=h.getExtent();if(n.getWrapX()&&h.canWrapX()&&!Zt(C,e.extent)){const G=Cr(C),te=Math.max(Cr(x)/2,G);x[0]=C[0]-te,x[2]=C[2]+te,Rs(v,h);const V=zs(S[0],h);V[0]<C[0]&&V[2]<C[2]?S.push([V[0]+G,V[1],V[2]+G,V[3]]):V[0]>C[0]&&V[2]>C[2]&&S.push([V[0]-G,V[1],V[2]-G,V[3]])}if(this.ready&&this.renderedResolution_==f&&this.renderedRevision_==c&&this.renderedRenderOrder_==m&&Zt(this.wrappedRenderedExtent_,x))return Ka(this.renderedExtent_,y)||(this.hitDetectionImageData_=null,this.renderedExtent_=y),this.renderedCenter_=v,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const I=new ua(fa(f,p),x,f,p);let j;this.getLayer().getDeclutter()&&(j=new ua(fa(f,p),x,f,p));let z;for(let G=0,te=S.length;G<te;++G)n.loadFeatures(S[G],f,h);const N=As(f,p);let A=!0;const U=G=>{let te;const V=G.getStyleFunction()||t.getStyleFunction();if(V&&(te=V(G,f)),te){const ge=this.renderFeature(G,N,te,I,z,j);A=A&&!ge}},O=Ja(x),Y=n.getFeaturesInExtent(O);m&&Y.sort(m);for(let G=0,te=Y.length;G<te;++G)U(Y[G]);this.renderedFeatures_=Y,this.ready=A;const se=I.finish(),ue=new la(x,f,p,n.getOverlaps(),se,t.getRenderBuffer());return j&&(this.declutterExecutorGroup=new la(x,f,p,n.getOverlaps(),j.finish(),t.getRenderBuffer())),this.renderedResolution_=f,this.renderedRevision_=c,this.renderedRenderOrder_=m,this.renderedExtent_=y,this.wrappedRenderedExtent_=x,this.renderedCenter_=v,this.renderedProjection_=h,this.replayGroup_=ue,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,n,i,a,o){if(!n)return!1;let s=!1;if(Array.isArray(n))for(let u=0,l=n.length;u<l;++u)s=ha(i,e,n[u],t,this.boundHandleStyleImageChange_,a,o)||s;else s=ha(i,e,n,t,this.boundHandleStyleImageChange_,a,o);return s}}class bi extends Os{constructor(e){super(e)}createRenderer(){return new Yu(this)}}const Pr={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class Mr extends vi{constructor(e,t){super(e),this.feature=t}}function Hu(r,e){const t=[];for(let n=0;n<e.length;++n){const a=e[n].getGeometry();lo(r,a,t)}return t}function Sr(r,e){return eo(r[0],r[1],e[0],e[1])}function bt(r,e){const t=r.length;return e<0?r[e+t]:e>=t?r[e-t]:r[e]}function Ir(r,e,t){let n,i;e<t?(n=e,i=t):(n=t,i=e);const a=Math.ceil(n),o=Math.floor(i);if(a>o){const u=xt(r,n),l=xt(r,i);return Sr(u,l)}let s=0;if(n<a){const u=xt(r,n),l=bt(r,a);s+=Sr(u,l)}if(o<i){const u=bt(r,o),l=xt(r,i);s+=Sr(u,l)}for(let u=a;u<o-1;++u){const l=bt(r,u),h=bt(r,u+1);s+=Sr(l,h)}return s}function lo(r,e,t){if(e instanceof He){Gr(r,e.getCoordinates(),!1,t);return}if(e instanceof sr){const n=e.getCoordinates();for(let i=0,a=n.length;i<a;++i)Gr(r,n[i],!1,t);return}if(e instanceof ur){const n=e.getCoordinates();for(let i=0,a=n.length;i<a;++i)Gr(r,n[i],!0,t);return}if(e instanceof or){const n=e.getCoordinates();for(let i=0,a=n.length;i<a;++i){const o=n[i];for(let s=0,u=o.length;s<u;++s)Gr(r,o[s],!0,t)}return}if(e instanceof ae){const n=e.getGeometries();for(let i=0;i<n.length;++i)lo(r,n[i],t);return}}const Rn={index:-1,endIndex:NaN};function Zu(r,e,t,n){const i=r[0],a=r[1];let o=1/0,s=-1,u=NaN;for(let f=0;f<e.targets.length;++f){const p=e.targets[f],c=p.coordinates;let d=1/0,m;for(let v=0;v<c.length-1;++v){const x=c[v],y=c[v+1],S=ho(i,a,x,y);S.squaredDistance<d&&(d=S.squaredDistance,m=v+S.along)}d<o&&(o=d,p.ring&&e.targetIndex===f&&(p.endIndex>p.startIndex?m<p.startIndex&&(m+=c.length):p.endIndex<p.startIndex&&m>p.startIndex&&(m-=c.length)),u=m,s=f)}const l=e.targets[s];let h=l.ring;if(e.targetIndex===s&&h){const f=xt(l.coordinates,u),p=t.getPixelFromCoordinate(f);Wr(p,e.startPx)>n&&(h=!1)}if(h){const f=l.coordinates,p=f.length,c=l.startIndex,d=u;if(c<d){const m=Ir(f,c,d);Ir(f,c,d-p)<m&&(u-=p)}else{const m=Ir(f,c,d);Ir(f,c,d+p)<m&&(u+=p)}}return Rn.index=s,Rn.endIndex=u,Rn}function Gr(r,e,t,n){const i=r[0],a=r[1];for(let o=0,s=e.length-1;o<s;++o){const u=e[o],l=e[o+1],h=ho(i,a,u,l);if(h.squaredDistance===0){const f=o+h.along;n.push({coordinates:e,ring:t,startIndex:f,endIndex:f});return}}}const zn={along:0,squaredDistance:0};function ho(r,e,t,n){const i=t[0],a=t[1],o=n[0],s=n[1],u=o-i,l=s-a;let h=0,f=i,p=a;return(u!==0||l!==0)&&(h=Ws(((r-i)*u+(e-a)*l)/(u*u+l*l),0,1),f+=u*h,p+=l*h),zn.along=h,zn.squaredDistance=Xs(eo(r,e,f,p),10),zn}function xt(r,e){const t=r.length;let n=Math.floor(e);const i=e-n;n>=t?n-=t:n<0&&(n+=t);let a=n+1;a>=t&&(a-=t);const o=r[n],s=o[0],u=o[1],l=r[a],h=l[0]-s,f=l[1]-u;return[s+h*i,u+f*i]}class yf extends Qa{constructor(e){const t=e;t.stopDown||(t.stopDown=Ds),super(t),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=Ju(this.type_),this.stopClick_=!!e.stopClick,this.minPoints_=e.minPoints?e.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:Wa,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let n=e.geometryFunction;if(!n){const i=this.mode_;if(i==="Circle")n=function(a,o,s){const u=o||new tn([NaN,NaN]),l=ce(a[0]),h=Xr(l,ce(a[a.length-1]));return u.setCenterAndRadius(l,Math.sqrt(h),this.geometryLayout_),u};else{let a;i==="Point"?a=Re:i==="LineString"?a=He:i==="Polygon"&&(a=ur),n=function(o,s,u){return s?i==="Polygon"?o[0].length?s.setCoordinates([o[0].concat([o[0][0]])],this.geometryLayout_):s.setCoordinates([],this.geometryLayout_):s.setCoordinates(o,this.geometryLayout_):s=new a(o,this.geometryLayout_),s}}}this.geometryFunction_=n,this.dragVertexDelay_=e.dragVertexDelay!==void 0?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new bi({source:new Kt({useSpatialIndex:!1,wrapX:e.wrapX?e.wrapX:!1}),style:e.style?e.style:Ku(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:qs,this.freehandCondition_,e.freehand?this.freehandCondition_=ti:this.freehandCondition_=e.freehandCondition?e.freehandCondition:js,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(Us.ACTIVE,this.updateState_)}setTrace(e){let t;e?e===!0?t=ti:t=e:t=Bs,this.traceCondition_=t}setMap(e){super.setMap(e),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(e){e.originalEvent.type===Mt.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(e);let t=e.type===he.POINTERMOVE,n=!0;return!this.freehand_&&this.lastDragTime_&&e.type===he.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===he.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(e.coordinate),n=!1):this.freehand_&&e.type===he.POINTERDOWN?n=!1:t&&this.getPointerCount()<2?(n=e.type===he.POINTERMOVE,n&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):(e.originalEvent.pointerType==="mouse"||e.type===he.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(e)):e.type===he.DBLCLICK&&(n=!1),super.handleEvent(e)&&n}handleDownEvent(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new Vs(he.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_();return}const t=this.getMap(),n=t.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),i=t.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),a=be([n,i]),o=this.traceSource_.getFeaturesInExtent(a);if(o.length===0)return;const s=Hu(e.coordinate,o);s.length&&(this.traceState_={active:!0,startPx:e.pixel.slice(),targets:s,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){const n=e.startIndex<=e.endIndex,i=e.startIndex<=t;n===i?n&&t>e.endIndex||!n&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(n&&t<e.endIndex||!n&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let n=0;if(e<t){const i=Math.ceil(e);let a=Math.floor(t);a===t&&(a-=1),n=a-i+1}else{const i=Math.floor(e);let a=Math.ceil(t);a===t&&(a+=1),n=i-a+1}n>0&&this.removeLastPoints_(n)}addTracedCoordinates_(e,t,n){if(t===n)return;const i=[];if(t<n){const a=Math.ceil(t);let o=Math.floor(n);o===n&&(o-=1);for(let s=a;s<=o;++s)i.push(bt(e.coordinates,s))}else{const a=Math.floor(t);let o=Math.ceil(n);o===n&&(o+=1);for(let s=a;s>=o;--s)i.push(bt(e.coordinates,s))}i.length&&this.appendCoordinates(i)}updateTrace_(e){const t=this.traceState_;if(!t.active||t.targetIndex===-1&&Wr(t.startPx,e.pixel)<this.snapTolerance_)return;const n=Zu(e.coordinate,t,this.getMap(),this.snapTolerance_);if(t.targetIndex!==n.index){if(t.targetIndex!==-1){const u=t.targets[t.targetIndex];this.removeTracedCoordinates_(u.startIndex,u.endIndex)}const s=t.targets[n.index];this.addTracedCoordinates_(s,s.startIndex,n.endIndex)}else{const s=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(s,n.endIndex)}t.targetIndex=n.index;const i=t.targets[t.targetIndex];i.endIndex=n.endIndex;const a=xt(i.coordinates,i.endIndex),o=this.getMap().getPixelFromCoordinate(a);e.coordinate=a,e.pixel=[Math.round(o[0]),Math.round(o[1])]}handleUpEvent(e){let t=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);const n=this.traceState_.active;if(this.toggleTraceState_(e),this.shouldHandle_){const i=!this.finishCoordinate_;i&&this.startDrawing_(e.coordinate),!i&&this.freehand_?this.finishDrawing():!this.freehand_&&(!i||this.mode_==="Point")&&(this.atFinish_(e.pixel,n)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing()}return!t&&this.stopClick_&&e.preventDefault(),t}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const t=this.downPx_,n=e.pixel,i=t[0]-n[0],a=t[1]-n[1],o=i*i+a*a;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(e.coordinate.slice());return}this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,t){let n=!1;if(this.sketchFeature_){let i=!1,a=[this.finishCoordinate_];const o=this.mode_;if(o==="Point")n=!0;else if(o==="Circle")n=this.sketchCoords_.length===2;else if(o==="LineString")i=!t&&this.sketchCoords_.length>this.minPoints_;else if(o==="Polygon"){const s=this.sketchCoords_;i=s[0].length>this.minPoints_,a=[s[0][0],s[0][s[0].length-2]],t?a=[s[0][0]]:a=[s[0][0],s[0][s[0].length-2]]}if(i){const s=this.getMap();for(let u=0,l=a.length;u<l;u++){const h=a[u],f=s.getPixelFromCoordinate(h),p=e[0]-f[0],c=e[1]-f[1],d=this.freehand_?1:this.snapTolerance_;if(n=Math.sqrt(p*p+c*c)<=d,n){this.finishCoordinate_=h;break}}}}return n}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new ee(new Re(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new ee);const t=e.getLinearRing(0);let n=this.sketchLine_.getGeometry();n?(n.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),n.changed()):(n=new He(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(n))}startDrawing_(e){const t=this.getMap().getView().getProjection(),n=ca(this.geometryLayout_);for(;e.length<n;)e.push(0);this.finishCoordinate_=e,this.mode_==="Point"?this.sketchCoords_=e.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new ee(new He(this.sketchLineCoords_)));const i=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new ee,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new Mr(Pr.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){const t=this.getMap(),n=this.sketchFeature_.getGeometry(),i=t.getView().getProjection(),a=ca(this.geometryLayout_);let o,s;for(;e.length<a;)e.push(0);this.mode_==="Point"?s=this.sketchCoords_:this.mode_==="Polygon"?(o=this.sketchCoords_[0],s=o[o.length-1],this.atFinish_(t.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):(o=this.sketchCoords_,s=o[o.length-1]),s[0]=e[0],s[1]=e[1],this.geometryFunction_(this.sketchCoords_,n,i),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),n.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(n):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){const t=this.sketchFeature_.getGeometry(),n=this.getMap().getView().getProjection();let i,a;const o=this.mode_;o==="LineString"||o==="Circle"?(this.finishCoordinate_=e.slice(),a=this.sketchCoords_,a.length>=this.maxPoints_&&(this.freehand_?a.pop():i=!0),a.push(e.slice()),this.geometryFunction_(a,t,n)):o==="Polygon"&&(a=this.sketchCoords_[0],a.length>=this.maxPoints_&&(this.freehand_?a.pop():i=!0),a.push(e.slice()),i&&(this.finishCoordinate_=a[0]),this.geometryFunction_(this.sketchCoords_,t,n)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),i&&this.finishDrawing()}removeLastPoints_(e){if(!this.sketchFeature_)return;const t=this.sketchFeature_.getGeometry(),n=this.getMap().getView().getProjection(),i=this.mode_;for(let a=0;a<e;++a){let o;if(i==="LineString"||i==="Circle"){if(o=this.sketchCoords_,o.splice(-2,1),o.length>=2){this.finishCoordinate_=o[o.length-2].slice();const s=this.finishCoordinate_.slice();o[o.length-1]=s,this.createOrUpdateSketchPoint_(s)}this.geometryFunction_(o,t,n),t.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(t)}else if(i==="Polygon"){o=this.sketchCoords_[0],o.splice(-2,1);const s=this.sketchLine_.getGeometry();if(o.length>=2){const u=o[o.length-2].slice();o[o.length-1]=u,this.createOrUpdateSketchPoint_(u)}s.setCoordinates(o),this.geometryFunction_(this.sketchCoords_,t,n)}if(o.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const e=this.abortDrawing_();if(!e)return;let t=this.sketchCoords_;const n=e.getGeometry(),i=this.getMap().getView().getProjection();this.mode_==="LineString"?(t.pop(),this.geometryFunction_(t,n,i)):this.mode_==="Polygon"&&(t[0].pop(),this.geometryFunction_(t,n,i),t=n.getCoordinates()),this.type_==="MultiPoint"?e.setGeometry(new en([t])):this.type_==="MultiLineString"?e.setGeometry(new sr([t])):this.type_==="MultiPolygon"&&e.setGeometry(new or([t])),this.dispatchEvent(new Mr(Pr.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e)}abortDrawing_(){this.finishCoordinate_=null;const e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){const e=this.abortDrawing_();e&&this.dispatchEvent(new Mr(Pr.DRAWABORT,e))}appendCoordinates(e){const t=this.mode_,n=!this.sketchFeature_;n&&this.startDrawing_(e[0]);let i;if(t==="LineString"||t==="Circle")i=this.sketchCoords_;else if(t==="Polygon")i=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;n&&i.shift(),i.pop();for(let o=0;o<e.length;o++)this.addToDrawing_(e[o]);const a=e[e.length-1];this.addToDrawing_(a),this.modifyDrawing_(a)}extend(e){const n=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=n.getCoordinates();const i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.sketchPoint_=new ee(new Re(i)),this.updateSketchFeatures_(),this.dispatchEvent(new Mr(Pr.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);const t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)}updateState_(){const e=this.getMap(),t=this.getActive();(!e||!t)&&this.abortDrawing(),this.overlay_.setMap(t?e:null)}}function Ku(){const r=$a();return function(e,t){return r[e.getGeometry().getType()]}}function Ju(r){switch(r){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+r)}}function fo(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Qu={},co,_a={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Jt(r){return r=Math.round(r),r<0?0:r>255?255:r}function ba(r){return r<0?0:r>1?1:r}function Nn(r){return r[r.length-1]==="%"?Jt(parseFloat(r)/100*255):Jt(parseInt(r))}function Lr(r){return r[r.length-1]==="%"?ba(parseFloat(r)/100):ba(parseFloat(r))}function An(r,e,t){return t<0?t+=1:t>1&&(t-=1),t*6<1?r+(e-r)*t*6:t*2<1?e:t*3<2?r+(e-r)*(2/3-t)*6:r}function $u(r){var e=r.replace(/ /g,"").toLowerCase();if(e in _a)return _a[e].slice();if(e[0]==="#"){if(e.length===4){var t=parseInt(e.substr(1),16);return t>=0&&t<=4095?[(t&3840)>>4|(t&3840)>>8,t&240|(t&240)>>4,t&15|(t&15)<<4,1]:null}else if(e.length===7){var t=parseInt(e.substr(1),16);return t>=0&&t<=16777215?[(t&16711680)>>16,(t&65280)>>8,t&255,1]:null}return null}var n=e.indexOf("("),i=e.indexOf(")");if(n!==-1&&i+1===e.length){var a=e.substr(0,n),o=e.substr(n+1,i-(n+1)).split(","),s=1;switch(a){case"rgba":if(o.length!==4)return null;s=Lr(o.pop());case"rgb":return o.length!==3?null:[Nn(o[0]),Nn(o[1]),Nn(o[2]),s];case"hsla":if(o.length!==4)return null;s=Lr(o.pop());case"hsl":if(o.length!==3)return null;var u=(parseFloat(o[0])%360+360)%360/360,l=Lr(o[1]),h=Lr(o[2]),f=h<=.5?h*(l+1):h+l-h*l,p=h*2-f;return[Jt(An(p,f,u+1/3)*255),Jt(An(p,f,u)*255),Jt(An(p,f,u-1/3)*255),s];default:return null}}return null}try{co=Qu.parseCSSColor=$u}catch{}var H=function(e,t,n,i){i===void 0&&(i=1),this.r=e,this.g=t,this.b=n,this.a=i};H.parse=function(e){if(e){if(e instanceof H)return e;if(typeof e=="string"){var t=co(e);if(t)return new H(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}};H.prototype.toString=function(){var e=this.toArray(),t=e[0],n=e[1],i=e[2],a=e[3];return"rgba("+Math.round(t)+","+Math.round(n)+","+Math.round(i)+","+a+")"};H.prototype.toArray=function(){var e=this,t=e.r,n=e.g,i=e.b,a=e.a;return a===0?[0,0,0,0]:[t*255/a,n*255/a,i*255/a,a]};H.prototype.toArray01=function(){var e=this,t=e.r,n=e.g,i=e.b,a=e.a;return a===0?[0,0,0,0]:[t/a,n/a,i/a,a]};H.prototype.toArray01PremultipliedAlpha=function(){var e=this,t=e.r,n=e.g,i=e.b,a=e.a;return[t,n,i,a]};H.black=new H(0,0,0,1);H.white=new H(1,1,1,1);H.transparent=new H(0,0,0,0);H.red=new H(1,0,0,1);H.blue=new H(0,0,1,1);var oe=H;function er(r){return typeof r=="object"?["literal",r]:r}function el(r,e){var t=r.stops;if(!t)return tl(r,e);var n=t&&typeof t[0][0]=="object",i=n||r.property!==void 0,a=n||!i;return t=t.map(function(o){return!i&&e.tokens&&typeof o[1]=="string"?[o[0],al(o[1])]:[o[0],er(o[1])]}),n?rl(r,e,t):a?il(r,e,t):oi(r,e,t)}function tl(r,e){var t=["get",r.property];if(r.default===void 0)return e.type==="string"?["string",t]:t;if(e.type==="enum")return["match",t,Object.keys(e.values),t,r.default];var n=[e.type==="color"?"to-color":e.type,t,er(r.default)];return e.type==="array"&&n.splice(1,0,e.value,e.length||null),n}function xi(r){switch(r.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function rl(r,e,t){for(var n={},i={},a=[],o=0;o<t.length;o++){var s=t[o],u=s[0].zoom;n[u]===void 0&&(n[u]={zoom:u,type:r.type,property:r.property,default:r.default},i[u]=[],a.push(u)),i[u].push([s[0].value,s[1]])}var l=Ci({},e);if(l==="exponential"){for(var h=[xi(r),["linear"],["zoom"]],f=0,p=a;f<p.length;f+=1){var c=p[f],d=oi(n[c],e,i[c]);Et(h,c,d,!1)}return h}else{for(var m=["step",["zoom"]],v=0,x=a;v<x.length;v+=1){var y=x[v],S=oi(n[y],e,i[y]);Et(m,y,S,!0)}return wi(m),m}}function nl(r,e){if(r!==void 0)return r;if(e!==void 0)return e}function xa(r,e){var t=er(nl(r.default,e.default));return t===void 0&&e.type==="resolvedImage"?"":t}function oi(r,e,t){var n=Ci(r,e),i=["get",r.property];if(n==="categorical"&&typeof t[0][0]=="boolean"){for(var a=["case"],o=0,s=t;o<s.length;o+=1){var u=s[o];a.push(["==",i,u[0]],u[1])}return a.push(xa(r,e)),a}else if(n==="categorical"){for(var l=["match",i],h=0,f=t;h<f.length;h+=1){var p=f[h];Et(l,p[0],p[1],!1)}return l.push(xa(r,e)),l}else if(n==="interval"){for(var c=["step",["number",i]],d=0,m=t;d<m.length;d+=1){var v=m[d];Et(c,v[0],v[1],!0)}return wi(c),r.default===void 0?c:["case",["==",["typeof",i],"number"],c,er(r.default)]}else if(n==="exponential"){for(var x=r.base!==void 0?r.base:1,y=[xi(r),x===1?["linear"]:["exponential",x],["number",i]],S=0,C=t;S<C.length;S+=1){var I=C[S];Et(y,I[0],I[1],!1)}return r.default===void 0?y:["case",["==",["typeof",i],"number"],y,er(r.default)]}else throw new Error("Unknown property function type "+n)}function il(r,e,t,n){n===void 0&&(n=["zoom"]);var i=Ci(r,e),a,o=!1;if(i==="interval")a=["step",n],o=!0;else if(i==="exponential"){var s=r.base!==void 0?r.base:1;a=[xi(r),s===1?["linear"]:["exponential",s],n]}else throw new Error('Unknown zoom function type "'+i+'"');for(var u=0,l=t;u<l.length;u+=1){var h=l[u];Et(a,h[0],h[1],o)}return wi(a),a}function wi(r){r[0]==="step"&&r.length===3&&(r.push(0),r.push(r[3]))}function Et(r,e,t,n){r.length>3&&e===r[r.length-2]||(n&&r.length===2||r.push(e),r.push(t))}function Ci(r,e){return r.type?r.type:e.expression.interpolated?"exponential":"interval"}function al(r){for(var e=["concat"],t=/{([^{}]+)}/g,n=0,i=t.exec(r);i!==null;i=t.exec(r)){var a=r.slice(n,t.lastIndex-i[0].length);n=t.lastIndex,a.length>0&&e.push(a),e.push(["get",i[1]])}if(e.length===1)return r;if(n<r.length)e.push(r.slice(n));else if(e.length===2)return["to-string",e[1]];return e}var ol=function(r){function e(t,n){r.call(this,n),this.message=n,this.key=t}return r&&(e.__proto__=r),e.prototype=Object.create(r&&r.prototype),e.prototype.constructor=e,e}(Error),xe=ol,tr=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var n=0,i=t;n<i.length;n+=1){var a=i[n],o=a[0],s=a[1];this.bindings[o]=s}};tr.prototype.concat=function(e){return new tr(this,e)};tr.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")};tr.prototype.has=function(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1};var sl=tr,rn={kind:"null"},g={kind:"number"},M={kind:"string"},F={kind:"boolean"},ke={kind:"color"},Tt={kind:"object"},P={kind:"value"},ul={kind:"error"},nn={kind:"collator"},an={kind:"formatted"},lr={kind:"resolvedImage"};function fe(r,e){return{kind:"array",itemType:r,N:e}}function q(r){if(r.kind==="array"){var e=q(r.itemType);return typeof r.N=="number"?"array<"+e+", "+r.N+">":r.itemType.kind==="value"?"array":"array<"+e+">"}else return r.kind}var ll=[rn,g,M,F,ke,an,Tt,fe(P),lr];function rr(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!rr(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value")for(var t=0,n=ll;t<n.length;t+=1){var i=n[t];if(!rr(i,e))return null}}return"Expected "+q(r)+" but found "+q(e)+" instead."}function Ei(r,e){return e.some(function(t){return t.kind===r.kind})}function nr(r,e){return e.some(function(t){return t==="null"?r===null:t==="array"?Array.isArray(r):t==="object"?r&&!Array.isArray(r)&&typeof r=="object":t===typeof r})}var Ti=function(e,t,n){e?this.sensitivity=t?"variant":"case":this.sensitivity=t?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Ti.prototype.compare=function(e,t){return this.collator.compare(e,t)};Ti.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ki=Ti,si=function(e,t,n,i,a){this.text=e.normalize?e.normalize():e,this.image=t,this.scale=n,this.fontStack=i,this.textColor=a},Fe=function(e){this.sections=e};Fe.fromString=function(e){return new Fe([new si(e,null,null,null,null)])};Fe.prototype.isEmpty=function(){return this.sections.length===0?!0:!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})};Fe.factory=function(e){return e instanceof Fe?e:Fe.fromString(e)};Fe.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")};Fe.prototype.serialize=function(){for(var e=["format"],t=0,n=this.sections;t<n.length;t+=1){var i=n[t];if(i.image){e.push(["image",i.image.name]);continue}e.push(i.text);var a={};i.fontStack&&(a["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(a["font-scale"]=i.scale),i.textColor&&(a["text-color"]=["rgba"].concat(i.textColor.toArray())),e.push(a)}return e};var It=Fe,ir=function(e){this.name=e.name,this.available=e.available};ir.prototype.toString=function(){return this.name};ir.fromString=function(e){return e?new ir({name:e,available:!1}):null};ir.prototype.serialize=function(){return["image",this.name]};var Gt=ir;function po(r,e,t,n){if(!(typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255)){var i=typeof n=="number"?[r,e,t,n]:[r,e,t];return"Invalid rgba value ["+i.join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}return typeof n>"u"||typeof n=="number"&&n>=0&&n<=1?null:"Invalid rgba value ["+[r,e,t,n].join(", ")+"]: 'a' must be between 0 and 1."}function Yr(r){if(r===null)return!0;if(typeof r=="string")return!0;if(typeof r=="boolean")return!0;if(typeof r=="number")return!0;if(r instanceof oe)return!0;if(r instanceof ki)return!0;if(r instanceof It)return!0;if(r instanceof Gt)return!0;if(Array.isArray(r)){for(var e=0,t=r;e<t.length;e+=1){var n=t[e];if(!Yr(n))return!1}return!0}else if(typeof r=="object"){for(var i in r)if(!Yr(r[i]))return!1;return!0}else return!1}function W(r){if(r===null)return rn;if(typeof r=="string")return M;if(typeof r=="boolean")return F;if(typeof r=="number")return g;if(r instanceof oe)return ke;if(r instanceof ki)return nn;if(r instanceof It)return an;if(r instanceof Gt)return lr;if(Array.isArray(r)){for(var e=r.length,t,n=0,i=r;n<i.length;n+=1){var a=i[n],o=W(a);if(!t)t=o;else{if(t===o)continue;t=P;break}}return fe(t||P,e)}else return Tt}function Qt(r){var e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof oe||r instanceof It||r instanceof Gt?r.toString():JSON.stringify(r)}var Ke=function(e,t){this.type=e,this.value=t};Ke.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Yr(e[1]))return t.error("invalid value");var n=e[1],i=W(n),a=t.expectedType;return i.kind==="array"&&i.N===0&&a&&a.kind==="array"&&(typeof a.N!="number"||a.N===0)&&(i=a),new Ke(i,n)};Ke.prototype.evaluate=function(){return this.value};Ke.prototype.eachChild=function(){};Ke.prototype.outputDefined=function(){return!0};Ke.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof oe?["rgba"].concat(this.value.toArray()):this.value instanceof It?this.value.serialize():this.value};var Hr=Ke,mo=function(e){this.name="ExpressionEvaluationError",this.message=e};mo.prototype.toJSON=function(){return this.message};var J=mo,On={string:M,number:g,boolean:F,object:Tt},Je=function(e,t){this.type=e,this.args=t};Je.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var n=1,i,a=e[0];if(a==="array"){var o;if(e.length>2){var s=e[1];if(typeof s!="string"||!(s in On)||s==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);o=On[s],n++}else o=P;var u;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);u=e[2],n++}i=fe(o,u)}else i=On[a];for(var l=[];n<e.length;n++){var h=t.parse(e[n],n,P);if(!h)return null;l.push(h)}return new Je(i,l)};Je.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var n=this.args[t].evaluate(e),i=rr(this.type,W(n));if(i){if(t===this.args.length-1)throw new J("Expected value to be of type "+q(this.type)+", but found "+q(W(n))+" instead.")}else return n}return null};Je.prototype.eachChild=function(e){this.args.forEach(e)};Je.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})};Je.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var n=e.itemType;if(n.kind==="string"||n.kind==="number"||n.kind==="boolean"){t.push(n.kind);var i=e.N;(typeof i=="number"||this.args.length>1)&&t.push(i)}}return t.concat(this.args.map(function(a){return a.serialize()}))};var Ee=Je,Qe=function(e){this.type=an,this.sections=e};Qe.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var n=e[1];if(!Array.isArray(n)&&typeof n=="object")return t.error("First argument must be an image or text section.");for(var i=[],a=!1,o=1;o<=e.length-1;++o){var s=e[o];if(a&&typeof s=="object"&&!Array.isArray(s)){a=!1;var u=null;if(s["font-scale"]&&(u=t.parse(s["font-scale"],1,g),!u))return null;var l=null;if(s["text-font"]&&(l=t.parse(s["text-font"],1,fe(M)),!l))return null;var h=null;if(s["text-color"]&&(h=t.parse(s["text-color"],1,ke),!h))return null;var f=i[i.length-1];f.scale=u,f.font=l,f.textColor=h}else{var p=t.parse(e[o],1,P);if(!p)return null;var c=p.type.kind;if(c!=="string"&&c!=="value"&&c!=="null"&&c!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,i.push({content:p,scale:null,font:null,textColor:null})}}return new Qe(i)};Qe.prototype.evaluate=function(e){var t=function(n){var i=n.content.evaluate(e);return W(i)===lr?new si("",i,null,null,null):new si(Qt(i),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)};return new It(this.sections.map(t))};Qe.prototype.eachChild=function(e){for(var t=0,n=this.sections;t<n.length;t+=1){var i=n[t];e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}};Qe.prototype.outputDefined=function(){return!1};Qe.prototype.serialize=function(){for(var e=["format"],t=0,n=this.sections;t<n.length;t+=1){var i=n[t];e.push(i.content.serialize());var a={};i.scale&&(a["font-scale"]=i.scale.serialize()),i.font&&(a["text-font"]=i.font.serialize()),i.textColor&&(a["text-color"]=i.textColor.serialize()),e.push(a)}return e};var yo=Qe,$e=function(e){this.type=lr,this.input=e};$e.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var n=t.parse(e[1],1,M);return n?new $e(n):t.error("No image name provided.")};$e.prototype.evaluate=function(e){var t=this.input.evaluate(e),n=Gt.fromString(t);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(t)>-1),n};$e.prototype.eachChild=function(e){e(this.input)};$e.prototype.outputDefined=function(){return!1};$e.prototype.serialize=function(){return["image",this.input.serialize()]};var go=$e,hl={"to-boolean":F,"to-color":ke,"to-number":g,"to-string":M},et=function(e,t){this.type=e,this.args=t};et.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var n=e[0];if((n==="to-boolean"||n==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var i=hl[n],a=[],o=1;o<e.length;o++){var s=t.parse(e[o],o,P);if(!s)return null;a.push(s)}return new et(i,a)};et.prototype.evaluate=function(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){for(var t,n,i=0,a=this.args;i<a.length;i+=1){var o=a[i];if(t=o.evaluate(e),n=null,t instanceof oe)return t;if(typeof t=="string"){var s=e.parseColor(t);if(s)return s}else if(Array.isArray(t)&&(t.length<3||t.length>4?n="Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":n=po(t[0],t[1],t[2],t[3]),!n))return new oe(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new J(n||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}else if(this.type.kind==="number"){for(var u=null,l=0,h=this.args;l<h.length;l+=1){var f=h[l];if(u=f.evaluate(e),u===null)return 0;var p=Number(u);if(!isNaN(p))return p}throw new J("Could not convert "+JSON.stringify(u)+" to number.")}else return this.type.kind==="formatted"?It.fromString(Qt(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Gt.fromString(Qt(this.args[0].evaluate(e))):Qt(this.args[0].evaluate(e))};et.prototype.eachChild=function(e){this.args.forEach(e)};et.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})};et.prototype.serialize=function(){if(this.type.kind==="formatted")return new yo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new go(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var wt=et,fl=["Unknown","Point","LineString","Polygon"],De=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null};De.prototype.id=function(){return this.feature&&this.feature.id!==void 0?this.feature.id:null};De.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?fl[this.feature.type]:this.feature.type:null};De.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null};De.prototype.canonicalID=function(){return this.canonical};De.prototype.properties=function(){return this.feature&&this.feature.properties||{}};De.prototype.distanceFromCenter=function(){if(this.featureTileCoord&&this.featureDistanceData){var e=this.featureDistanceData.center,t=this.featureDistanceData.scale,n=this.featureTileCoord,i=n.x,a=n.y,o=i*t-e[0],s=a*t-e[1],u=this.featureDistanceData.bearing[0],l=this.featureDistanceData.bearing[1],h=u*o+l*s;return h}return 0};De.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=oe.parse(e)),t};var vo=De,ye=function(e,t,n,i){this.name=e,this.type=t,this._evaluate=n,this.args=i};ye.prototype.evaluate=function(e){return this._evaluate(e,this.args)};ye.prototype.eachChild=function(e){this.args.forEach(e)};ye.prototype.outputDefined=function(){return!1};ye.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))};ye.parse=function(e,t){var n,i=e[0],a=ye.definitions[i];if(!a)return t.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(a)?a[0]:a.type,s=Array.isArray(a)?[[a[1],a[2]]]:a.overloads,u=s.filter(function(se){var ue=se[0];return!Array.isArray(ue)||ue.length===e.length-1}),l=null,h=0,f=u;h<f.length;h+=1){var p=f[h],c=p[0],d=p[1];l=new Eo(t.registry,t.path,null,t.scope);for(var m=[],v=!1,x=1;x<e.length;x++){var y=e[x],S=Array.isArray(c)?c[x-1]:c.type,C=l.parse(y,1+m.length,S);if(!C){v=!0;break}m.push(C)}if(!v){if(Array.isArray(c)&&c.length!==m.length){l.error("Expected "+c.length+" arguments, but found "+m.length+" instead.");continue}for(var I=0;I<m.length;I++){var j=Array.isArray(c)?c[I]:c.type,z=m[I];l.concat(I+1).checkSubtype(j,z.type)}if(l.errors.length===0)return new ye(i,o,d,m)}}if(u.length===1)(n=t.errors).push.apply(n,l.errors);else{for(var N=u.length?u:s,A=N.map(function(se){var ue=se[0];return cl(ue)}).join(" | "),U=[],O=1;O<e.length;O++){var Y=t.parse(e[O],1+U.length);if(!Y)return null;U.push(q(Y.type))}t.error("Expected arguments of type "+A+", but found ("+U.join(", ")+") instead.")}return null};ye.register=function(e,t){ye.definitions=t;for(var n in t)e[n]=ye};function cl(r){return Array.isArray(r)?"("+r.map(q).join(", ")+")":"("+q(r.type)+"...)"}var Lt=ye,tt=function(e,t,n){this.type=nn,this.locale=n,this.caseSensitive=e,this.diacriticSensitive=t};tt.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var n=e[1];if(typeof n!="object"||Array.isArray(n))return t.error("Collator options argument must be an object.");var i=t.parse(n["case-sensitive"]===void 0?!1:n["case-sensitive"],1,F);if(!i)return null;var a=t.parse(n["diacritic-sensitive"]===void 0?!1:n["diacritic-sensitive"],1,F);if(!a)return null;var o=null;return n.locale&&(o=t.parse(n.locale,1,M),!o)?null:new tt(i,a,o)};tt.prototype.evaluate=function(e){return new ki(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)};tt.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)};tt.prototype.outputDefined=function(){return!1};tt.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var _o=tt,ze=8192;function Fi(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function pl(r){return(180+r)/360}function dl(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Zr(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function ml(r,e){var t=pl(r[0]),n=dl(r[1]),i=Math.pow(2,e.z);return[Math.round(t*i*ze),Math.round(n*i*ze)]}function yl(r,e,t){var n=r[0]-e[0],i=r[1]-e[1],a=r[0]-t[0],o=r[1]-t[1];return n*o-a*i===0&&n*a<=0&&i*o<=0}function gl(r,e,t){return e[1]>r[1]!=t[1]>r[1]&&r[0]<(t[0]-e[0])*(r[1]-e[1])/(t[1]-e[1])+e[0]}function Pi(r,e){for(var t=!1,n=0,i=e.length;n<i;n++)for(var a=e[n],o=0,s=a.length;o<s-1;o++){if(yl(r,a[o],a[o+1]))return!1;gl(r,a[o],a[o+1])&&(t=!t)}return t}function vl(r,e){for(var t=0;t<e.length;t++)if(Pi(r,e[t]))return!0;return!1}function _l(r,e){return r[0]*e[1]-r[1]*e[0]}function wa(r,e,t,n){var i=r[0]-t[0],a=r[1]-t[1],o=e[0]-t[0],s=e[1]-t[1],u=n[0]-t[0],l=n[1]-t[1],h=i*l-u*a,f=o*l-u*s;return h>0&&f<0||h<0&&f>0}function bl(r,e,t,n){var i=[e[0]-r[0],e[1]-r[1]],a=[n[0]-t[0],n[1]-t[1]];return _l(a,i)===0?!1:!!(wa(r,e,t,n)&&wa(t,n,r,e))}function xl(r,e,t){for(var n=0,i=t;n<i.length;n+=1)for(var a=i[n],o=0;o<a.length-1;++o)if(bl(r,e,a[o],a[o+1]))return!0;return!1}function bo(r,e){for(var t=0;t<r.length;++t)if(!Pi(r[t],e))return!1;for(var n=0;n<r.length-1;++n)if(xl(r[n],r[n+1],e))return!1;return!0}function wl(r,e){for(var t=0;t<e.length;t++)if(bo(r,e[t]))return!0;return!1}function Mi(r,e,t){for(var n=[],i=0;i<r.length;i++){for(var a=[],o=0;o<r[i].length;o++){var s=ml(r[i][o],t);Fi(e,s),a.push(s)}n.push(a)}return n}function xo(r,e,t){for(var n=[],i=0;i<r.length;i++){var a=Mi(r[i],e,t);n.push(a)}return n}function wo(r,e,t,n){if(r[0]<t[0]||r[0]>t[2]){var i=n*.5,a=r[0]-t[0]>i?-n:t[0]-r[0]>i?n:0;a===0&&(a=r[0]-t[2]>i?-n:t[2]-r[0]>i?n:0),r[0]+=a}Fi(e,r)}function Cl(r){r[0]=r[1]=1/0,r[2]=r[3]=-1/0}function Ca(r,e,t,n){var i=Math.pow(2,n.z)*ze,a=[n.x*ze,n.y*ze],o=[];if(!r)return o;for(var s=0,u=r;s<u.length;s+=1)for(var l=u[s],h=0,f=l;h<f.length;h+=1){var p=f[h],c=[p.x+a[0],p.y+a[1]];wo(c,e,t,i),o.push(c)}return o}function Ea(r,e,t,n){var i=Math.pow(2,n.z)*ze,a=[n.x*ze,n.y*ze],o=[];if(!r)return o;for(var s=0,u=r;s<u.length;s+=1){for(var l=u[s],h=[],f=0,p=l;f<p.length;f+=1){var c=p[f],d=[c.x+a[0],c.y+a[1]];Fi(e,d),h.push(d)}o.push(h)}if(e[2]-e[0]<=i/2){Cl(e);for(var m=0,v=o;m<v.length;m+=1)for(var x=v[m],y=0,S=x;y<S.length;y+=1){var C=S[y];wo(C,e,t,i)}}return o}function El(r,e){var t=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=r.canonicalID();if(!i)return!1;if(e.type==="Polygon"){var a=Mi(e.coordinates,n,i),o=Ca(r.geometry(),t,n,i);if(!Zr(t,n))return!1;for(var s=0,u=o;s<u.length;s+=1){var l=u[s];if(!Pi(l,a))return!1}}if(e.type==="MultiPolygon"){var h=xo(e.coordinates,n,i),f=Ca(r.geometry(),t,n,i);if(!Zr(t,n))return!1;for(var p=0,c=f;p<c.length;p+=1){var d=c[p];if(!vl(d,h))return!1}}return!0}function Tl(r,e){var t=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=r.canonicalID();if(!i)return!1;if(e.type==="Polygon"){var a=Mi(e.coordinates,n,i),o=Ea(r.geometry(),t,n,i);if(!Zr(t,n))return!1;for(var s=0,u=o;s<u.length;s+=1){var l=u[s];if(!bo(l,a))return!1}}if(e.type==="MultiPolygon"){var h=xo(e.coordinates,n,i),f=Ea(r.geometry(),t,n,i);if(!Zr(t,n))return!1;for(var p=0,c=f;p<c.length;p+=1){var d=c[p];if(!wl(d,h))return!1}}return!0}var Te=function(e,t){this.type=F,this.geojson=e,this.geometries=t};Te.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Yr(e[1])){var n=e[1];if(n.type==="FeatureCollection")for(var i=0;i<n.features.length;++i){var a=n.features[i].geometry.type;if(a==="Polygon"||a==="MultiPolygon")return new Te(n,n.features[i].geometry)}else if(n.type==="Feature"){var o=n.geometry.type;if(o==="Polygon"||o==="MultiPolygon")return new Te(n,n.geometry)}else if(n.type==="Polygon"||n.type==="MultiPolygon")return new Te(n,n)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")};Te.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return El(e,this.geometries);if(e.geometryType()==="LineString")return Tl(e,this.geometries)}return!1};Te.prototype.eachChild=function(){};Te.prototype.outputDefined=function(){return!0};Te.prototype.serialize=function(){return["within",this.geojson]};var Si=Te;function on(r){if(r instanceof Lt){if(r.name==="get"&&r.args.length===1)return!1;if(r.name==="feature-state")return!1;if(r.name==="has"&&r.args.length===1)return!1;if(r.name==="properties"||r.name==="geometry-type"||r.name==="id")return!1;if(/^filter-/.test(r.name))return!1}if(r instanceof Si)return!1;var e=!0;return r.eachChild(function(t){e&&!on(t)&&(e=!1)}),e}function Ii(r){if(r instanceof Lt&&r.name==="feature-state")return!1;var e=!0;return r.eachChild(function(t){e&&!Ii(t)&&(e=!1)}),e}function Gi(r,e){if(r instanceof Lt&&e.indexOf(r.name)>=0)return!1;var t=!0;return r.eachChild(function(n){t&&!Gi(n,e)&&(t=!1)}),t}var rt=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};rt.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var n=e[1];return t.scope.has(n)?new rt(n,t.scope.get(n)):t.error('Unknown variable "'+n+'". Make sure "'+n+'" has been bound in an enclosing "let" expression before using it.',1)};rt.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)};rt.prototype.eachChild=function(){};rt.prototype.outputDefined=function(){return!1};rt.prototype.serialize=function(){return["var",this.name]};var Co=rt,nt=function(e,t,n,i,a){t===void 0&&(t=[]),i===void 0&&(i=new sl),a===void 0&&(a=[]),this.registry=e,this.path=t,this.key=t.map(function(o){return"["+o+"]"}).join(""),this.scope=i,this.errors=a,this.expectedType=n};nt.prototype.parse=function(e,t,n,i,a){return a===void 0&&(a={}),t?this.concat(t,n,i)._parse(e,a):this._parse(e,a)};nt.prototype._parse=function(e,t){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function n(h,f,p){return p==="assert"?new Ee(f,[h]):p==="coerce"?new wt(f,[h]):h}if(Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var i=e[0];if(typeof i!="string")return this.error("Expression name must be a string, but found "+typeof i+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var a=this.registry[i];if(a){var o=a.parse(e,this);if(!o)return null;if(this.expectedType){var s=this.expectedType,u=o.type;if((s.kind==="string"||s.kind==="number"||s.kind==="boolean"||s.kind==="object"||s.kind==="array")&&u.kind==="value")o=n(o,s,t.typeAnnotation||"assert");else if((s.kind==="color"||s.kind==="formatted"||s.kind==="resolvedImage")&&(u.kind==="value"||u.kind==="string"))o=n(o,s,t.typeAnnotation||"coerce");else if(this.checkSubtype(s,u))return null}if(!(o instanceof Hr)&&o.type.kind!=="resolvedImage"&&ui(o)){var l=new vo;try{o=new Hr(o.type,o.evaluate(l))}catch(h){return this.error(h.message),null}}return o}return this.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof e+" instead.")};nt.prototype.concat=function(e,t,n){var i=typeof e=="number"?this.path.concat(e):this.path,a=n?this.scope.concat(n):this.scope;return new nt(this.registry,i,t||null,a,this.errors)};nt.prototype.error=function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];var i=""+this.key+t.map(function(a){return"["+a+"]"}).join("");this.errors.push(new xe(i,e))};nt.prototype.checkSubtype=function(e,t){var n=rr(e,t);return n&&this.error(n),n};var Eo=nt;function ui(r){if(r instanceof Co)return ui(r.boundExpression);if(r instanceof Lt&&r.name==="error")return!1;if(r instanceof _o)return!1;if(r instanceof Si)return!1;var e=r instanceof wt||r instanceof Ee,t=!0;return r.eachChild(function(n){e?t=t&&ui(n):t=t&&n instanceof Hr}),t?on(r)&&Gi(r,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"]):!1}function To(r,e){for(var t=r.length-1,n=0,i=t,a=0,o,s;n<=i;)if(a=Math.floor((n+i)/2),o=r[a],s=r[a+1],o<=e){if(a===t||e<s)return a;n=a+1}else if(o>e)i=a-1;else throw new J("Input is not a number.");return 0}var it=function(e,t,n){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var i=0,a=n;i<a.length;i+=1){var o=a[i],s=o[0],u=o[1];this.labels.push(s),this.outputs.push(u)}};it.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");var n=t.parse(e[1],1,g);if(!n)return null;var i=[],a=null;t.expectedType&&t.expectedType.kind!=="value"&&(a=t.expectedType);for(var o=1;o<e.length;o+=2){var s=o===1?-1/0:e[o],u=e[o+1],l=o,h=o+1;if(typeof s!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',l);if(i.length&&i[i.length-1][0]>=s)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',l);var f=t.parse(u,h,a);if(!f)return null;a=a||f.type,i.push([s,f])}return new it(a,n,i)};it.prototype.evaluate=function(e){var t=this.labels,n=this.outputs;if(t.length===1)return n[0].evaluate(e);var i=this.input.evaluate(e);if(i<=t[0])return n[0].evaluate(e);var a=t.length;if(i>=t[a-1])return n[a-1].evaluate(e);var o=To(t,i);return n[o].evaluate(e)};it.prototype.eachChild=function(e){e(this.input);for(var t=0,n=this.outputs;t<n.length;t+=1){var i=n[t];e(i)}};it.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})};it.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var ko=it,kl=Rt;function Rt(r,e,t,n){this.cx=3*r,this.bx=3*(t-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=n,this.p2x=t,this.p2y=n}Rt.prototype.sampleCurveX=function(r){return((this.ax*r+this.bx)*r+this.cx)*r};Rt.prototype.sampleCurveY=function(r){return((this.ay*r+this.by)*r+this.cy)*r};Rt.prototype.sampleCurveDerivativeX=function(r){return(3*this.ax*r+2*this.bx)*r+this.cx};Rt.prototype.solveCurveX=function(r,e){typeof e>"u"&&(e=1e-6);var t,n,i,a,o;for(i=r,o=0;o<8;o++){if(a=this.sampleCurveX(i)-r,Math.abs(a)<e)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i=i-a/s}if(t=0,n=1,i=r,i<t)return t;if(i>n)return n;for(;t<n;){if(a=this.sampleCurveX(i),Math.abs(a-r)<e)return i;r>a?t=i:n=i,i=(n-t)*.5+t}return i};Rt.prototype.solve=function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))};var Fl=fo(kl);function ie(r,e,t){return r*(1-t)+e*t}function Pl(r,e,t){return new oe(ie(r.r,e.r,t),ie(r.g,e.g,t),ie(r.b,e.b,t),ie(r.a,e.a,t))}function Ml(r,e,t){return r.map(function(n,i){return ie(n,e[i],t)})}var Sl=Object.freeze({__proto__:null,number:ie,color:Pl,array:Ml}),Fo=.95047,Po=1,Mo=1.08883,So=4/29,kt=6/29,Io=3*kt*kt,Il=kt*kt*kt,Gl=Math.PI/180,Ll=180/Math.PI;function Dn(r){return r>Il?Math.pow(r,1/3):r/Io+So}function qn(r){return r>kt?r*r*r:Io*(r-So)}function jn(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function Un(r){return r/=255,r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Go(r){var e=Un(r.r),t=Un(r.g),n=Un(r.b),i=Dn((.4124564*e+.3575761*t+.1804375*n)/Fo),a=Dn((.2126729*e+.7151522*t+.072175*n)/Po),o=Dn((.0193339*e+.119192*t+.9503041*n)/Mo);return{l:116*a-16,a:500*(i-a),b:200*(a-o),alpha:r.a}}function Lo(r){var e=(r.l+16)/116,t=isNaN(r.a)?e:e+r.a/500,n=isNaN(r.b)?e:e-r.b/200;return e=Po*qn(e),t=Fo*qn(t),n=Mo*qn(n),new oe(jn(3.2404542*t-1.5371385*e-.4985314*n),jn(-.969266*t+1.8760108*e+.041556*n),jn(.0556434*t-.2040259*e+1.0572252*n),r.alpha)}function Rl(r,e,t){return{l:ie(r.l,e.l,t),a:ie(r.a,e.a,t),b:ie(r.b,e.b,t),alpha:ie(r.alpha,e.alpha,t)}}function zl(r){var e=Go(r),t=e.l,n=e.a,i=e.b,a=Math.atan2(i,n)*Ll;return{h:a<0?a+360:a,c:Math.sqrt(n*n+i*i),l:t,alpha:r.a}}function Nl(r){var e=r.h*Gl,t=r.c,n=r.l;return Lo({l:n,a:Math.cos(e)*t,b:Math.sin(e)*t,alpha:r.alpha})}function Al(r,e,t){var n=e-r;return r+t*(n>180||n<-180?n-360*Math.round(n/360):n)}function Ol(r,e,t){return{h:Al(r.h,e.h,t),c:ie(r.c,e.c,t),l:ie(r.l,e.l,t),alpha:ie(r.alpha,e.alpha,t)}}var Rr={forward:Go,reverse:Lo,interpolate:Rl},zr={forward:zl,reverse:Nl,interpolate:Ol},Pe=function(e,t,n,i,a){this.type=e,this.operator=t,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(var o=0,s=a;o<s.length;o+=1){var u=s[o],l=u[0],h=u[1];this.labels.push(l),this.outputs.push(h)}};Pe.interpolationFactor=function(e,t,n,i){var a=0;if(e.name==="exponential")a=Vn(t,e.base,n,i);else if(e.name==="linear")a=Vn(t,1,n,i);else if(e.name==="cubic-bezier"){var o=e.controlPoints,s=new Fl(o[0],o[1],o[2],o[3]);a=s.solve(Vn(t,1,n,i))}return a};Pe.parse=function(e,t){var n=e[0],i=e[1],a=e[2],o=e.slice(3);if(!Array.isArray(i)||i.length===0)return t.error("Expected an interpolation type expression.",1);if(i[0]==="linear")i={name:"linear"};else if(i[0]==="exponential"){var s=i[1];if(typeof s!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:s}}else if(i[0]==="cubic-bezier"){var u=i.slice(1);if(u.length!==4||u.some(function(x){return typeof x!="number"||x<0||x>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:u}}else return t.error("Unknown interpolation type "+String(i[0]),1,0);if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");if(a=t.parse(a,2,g),!a)return null;var l=[],h=null;n==="interpolate-hcl"||n==="interpolate-lab"?h=ke:t.expectedType&&t.expectedType.kind!=="value"&&(h=t.expectedType);for(var f=0;f<o.length;f+=2){var p=o[f],c=o[f+1],d=f+3,m=f+4;if(typeof p!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d);if(l.length&&l[l.length-1][0]>=p)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d);var v=t.parse(c,m,h);if(!v)return null;h=h||v.type,l.push([p,v])}return h.kind!=="number"&&h.kind!=="color"&&!(h.kind==="array"&&h.itemType.kind==="number"&&typeof h.N=="number")?t.error("Type "+q(h)+" is not interpolatable."):new Pe(h,n,i,a,l)};Pe.prototype.evaluate=function(e){var t=this.labels,n=this.outputs;if(t.length===1)return n[0].evaluate(e);var i=this.input.evaluate(e);if(i<=t[0])return n[0].evaluate(e);var a=t.length;if(i>=t[a-1])return n[a-1].evaluate(e);var o=To(t,i),s=t[o],u=t[o+1],l=Pe.interpolationFactor(this.interpolation,i,s,u),h=n[o].evaluate(e),f=n[o+1].evaluate(e);return this.operator==="interpolate"?Sl[this.type.kind.toLowerCase()](h,f,l):this.operator==="interpolate-hcl"?zr.reverse(zr.interpolate(zr.forward(h),zr.forward(f),l)):Rr.reverse(Rr.interpolate(Rr.forward(h),Rr.forward(f),l))};Pe.prototype.eachChild=function(e){e(this.input);for(var t=0,n=this.outputs;t<n.length;t+=1){var i=n[t];e(i)}};Pe.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})};Pe.prototype.serialize=function(){var e;this.interpolation.name==="linear"?e=["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?e=["linear"]:e=["exponential",this.interpolation.base]:e=["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],n=0;n<this.labels.length;n++)t.push(this.labels[n],this.outputs[n].serialize());return t};function Vn(r,e,t,n){var i=n-t,a=r-t;return i===0?0:e===1?a/i:(Math.pow(e,a)-1)/(Math.pow(e,i)-1)}var Ze=Pe,Ne=function(e,t){this.type=e,this.args=t};Ne.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var n=null,i=t.expectedType;i&&i.kind!=="value"&&(n=i);for(var a=[],o=0,s=e.slice(1);o<s.length;o+=1){var u=s[o],l=t.parse(u,1+a.length,n,void 0,{typeAnnotation:"omit"});if(!l)return null;n=n||l.type,a.push(l)}var h=i&&a.some(function(f){return rr(i,f.type)});return h?new Ne(P,a):new Ne(n,a)};Ne.prototype.evaluate=function(e){for(var t=null,n=0,i,a=0,o=this.args;a<o.length;a+=1){var s=o[a];if(n++,t=s.evaluate(e),t&&t instanceof Gt&&!t.available&&(i||(i=t),t=null,n===this.args.length))return i;if(t!==null)break}return t};Ne.prototype.eachChild=function(e){this.args.forEach(e)};Ne.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})};Ne.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ro=Ne,at=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};at.prototype.evaluate=function(e){return this.result.evaluate(e)};at.prototype.eachChild=function(e){for(var t=0,n=this.bindings;t<n.length;t+=1){var i=n[t];e(i[1])}e(this.result)};at.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var n=[],i=1;i<e.length-1;i+=2){var a=e[i];if(typeof a!="string")return t.error("Expected string, but found "+typeof a+" instead.",i);if(/[^a-zA-Z0-9_]/.test(a))return t.error("Variable names must contain only alphanumeric characters or '_'.",i);var o=t.parse(e[i+1],i+1);if(!o)return null;n.push([a,o])}var s=t.parse(e[e.length-1],e.length-1,t.expectedType,n);return s?new at(n,s):null};at.prototype.outputDefined=function(){return this.result.outputDefined()};at.prototype.serialize=function(){for(var e=["let"],t=0,n=this.bindings;t<n.length;t+=1){var i=n[t],a=i[0],o=i[1];e.push(a,o.serialize())}return e.push(this.result.serialize()),e};var zo=at,ot=function(e,t,n){this.type=e,this.index=t,this.input=n};ot.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var n=t.parse(e[1],1,g),i=t.parse(e[2],2,fe(t.expectedType||P));if(!n||!i)return null;var a=i.type;return new ot(a.itemType,n,i)};ot.prototype.evaluate=function(e){var t=this.index.evaluate(e),n=this.input.evaluate(e);if(t<0)throw new J("Array index out of bounds: "+t+" < 0.");if(t>=n.length)throw new J("Array index out of bounds: "+t+" > "+(n.length-1)+".");if(t!==Math.floor(t))throw new J("Array index must be an integer, but found "+t+" instead.");return n[t]};ot.prototype.eachChild=function(e){e(this.index),e(this.input)};ot.prototype.outputDefined=function(){return!1};ot.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Dl=ot,st=function(e,t){this.type=F,this.needle=e,this.haystack=t};st.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var n=t.parse(e[1],1,P),i=t.parse(e[2],2,P);return!n||!i?null:Ei(n.type,[F,M,g,rn,P])?new st(n,i):t.error("Expected first argument to be of type boolean, string, number or null, but found "+q(n.type)+" instead")};st.prototype.evaluate=function(e){var t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(n==null)return!1;if(!nr(t,["boolean","string","number","null"]))throw new J("Expected first argument to be of type boolean, string, number or null, but found "+q(W(t))+" instead.");if(!nr(n,["string","array"]))throw new J("Expected second argument to be of type array or string, but found "+q(W(n))+" instead.");return n.indexOf(t)>=0};st.prototype.eachChild=function(e){e(this.needle),e(this.haystack)};st.prototype.outputDefined=function(){return!0};st.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var ql=st,Ae=function(e,t,n){this.type=g,this.needle=e,this.haystack=t,this.fromIndex=n};Ae.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var n=t.parse(e[1],1,P),i=t.parse(e[2],2,P);if(!n||!i)return null;if(!Ei(n.type,[F,M,g,rn,P]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+q(n.type)+" instead");if(e.length===4){var a=t.parse(e[3],3,g);return a?new Ae(n,i,a):null}else return new Ae(n,i)};Ae.prototype.evaluate=function(e){var t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!nr(t,["boolean","string","number","null"]))throw new J("Expected first argument to be of type boolean, string, number or null, but found "+q(W(t))+" instead.");if(!nr(n,["string","array"]))throw new J("Expected second argument to be of type array or string, but found "+q(W(n))+" instead.");if(this.fromIndex){var i=this.fromIndex.evaluate(e);return n.indexOf(t,i)}return n.indexOf(t)};Ae.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)};Ae.prototype.outputDefined=function(){return!1};Ae.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var jl=Ae,ut=function(e,t,n,i,a,o){this.inputType=e,this.type=t,this.input=n,this.cases=i,this.outputs=a,this.otherwise=o};ut.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!==1)return t.error("Expected an even number of arguments.");var n,i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var a={},o=[],s=2;s<e.length-1;s+=2){var u=e[s],l=e[s+1];Array.isArray(u)||(u=[u]);var h=t.concat(s);if(u.length===0)return h.error("Expected at least one branch label.");for(var f=0,p=u;f<p.length;f+=1){var c=p[f];if(typeof c!="number"&&typeof c!="string")return h.error("Branch labels must be numbers or strings.");if(typeof c=="number"&&Math.abs(c)>Number.MAX_SAFE_INTEGER)return h.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof c=="number"&&Math.floor(c)!==c)return h.error("Numeric branch labels must be integer values.");if(!n)n=W(c);else if(h.checkSubtype(n,W(c)))return null;if(typeof a[String(c)]<"u")return h.error("Branch labels must be unique.");a[String(c)]=o.length}var d=t.parse(l,s,i);if(!d)return null;i=i||d.type,o.push(d)}var m=t.parse(e[1],1,P);if(!m)return null;var v=t.parse(e[e.length-1],e.length-1,i);return!v||m.type.kind!=="value"&&t.concat(1).checkSubtype(n,m.type)?null:new ut(n,i,m,a,o,v)};ut.prototype.evaluate=function(e){var t=this.input.evaluate(e),n=W(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise;return n.evaluate(e)};ut.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)};ut.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()};ut.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),i=[],a={},o=0,s=n;o<s.length;o+=1){var u=s[o],l=a[this.cases[u]];l===void 0?(a[this.cases[u]]=i.length,i.push([this.cases[u],[u]])):i[l][1].push(u)}for(var h=function(m){return e.inputType.kind==="number"?Number(m):m},f=0,p=i;f<p.length;f+=1){var c=p[f],l=c[0],d=c[1];d.length===1?t.push(h(d[0])):t.push(d.map(h)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var Ul=ut,lt=function(e,t,n){this.type=e,this.branches=t,this.otherwise=n};lt.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!==0)return t.error("Expected an odd number of arguments.");var n;t.expectedType&&t.expectedType.kind!=="value"&&(n=t.expectedType);for(var i=[],a=1;a<e.length-1;a+=2){var o=t.parse(e[a],a,F);if(!o)return null;var s=t.parse(e[a+1],a+1,n);if(!s)return null;i.push([o,s]),n=n||s.type}var u=t.parse(e[e.length-1],e.length-1,n);return u?new lt(n,i,u):null};lt.prototype.evaluate=function(e){for(var t=0,n=this.branches;t<n.length;t+=1){var i=n[t],a=i[0],o=i[1];if(a.evaluate(e))return o.evaluate(e)}return this.otherwise.evaluate(e)};lt.prototype.eachChild=function(e){for(var t=0,n=this.branches;t<n.length;t+=1){var i=n[t],a=i[0],o=i[1];e(a),e(o)}e(this.otherwise)};lt.prototype.outputDefined=function(){return this.branches.every(function(e){e[0];var t=e[1];return t.outputDefined()})&&this.otherwise.outputDefined()};lt.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Vl=lt,Oe=function(e,t,n,i){this.type=e,this.input=t,this.beginIndex=n,this.endIndex=i};Oe.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var n=t.parse(e[1],1,P),i=t.parse(e[2],2,g);if(!n||!i)return null;if(!Ei(n.type,[fe(P),M,P]))return t.error("Expected first argument to be of type array or string, but found "+q(n.type)+" instead");if(e.length===4){var a=t.parse(e[3],3,g);return a?new Oe(n.type,n,i,a):null}else return new Oe(n.type,n,i)};Oe.prototype.evaluate=function(e){var t=this.input.evaluate(e),n=this.beginIndex.evaluate(e);if(!nr(t,["string","array"]))throw new J("Expected first argument to be of type array or string, but found "+q(W(t))+" instead.");if(this.endIndex){var i=this.endIndex.evaluate(e);return t.slice(n,i)}return t.slice(n)};Oe.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)};Oe.prototype.outputDefined=function(){return!1};Oe.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Bl=Oe;function Ta(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Xl(r,e,t){return e===t}function Wl(r,e,t){return e!==t}function Yl(r,e,t){return e<t}function Hl(r,e,t){return e>t}function Zl(r,e,t){return e<=t}function Kl(r,e,t){return e>=t}function No(r,e,t,n){return n.compare(e,t)===0}function Jl(r,e,t,n){return!No(r,e,t,n)}function Ql(r,e,t,n){return n.compare(e,t)<0}function $l(r,e,t,n){return n.compare(e,t)>0}function eh(r,e,t,n){return n.compare(e,t)<=0}function th(r,e,t,n){return n.compare(e,t)>=0}function zt(r,e,t){var n=r!=="=="&&r!=="!=";return function(){function i(a,o,s){this.type=F,this.lhs=a,this.rhs=o,this.collator=s,this.hasUntypedArgument=a.type.kind==="value"||o.type.kind==="value"}return i.parse=function(o,s){if(o.length!==3&&o.length!==4)return s.error("Expected two or three arguments.");var u=o[0],l=s.parse(o[1],1,P);if(!l)return null;if(!Ta(u,l.type))return s.concat(1).error('"'+u+`" comparisons are not supported for type '`+q(l.type)+"'.");var h=s.parse(o[2],2,P);if(!h)return null;if(!Ta(u,h.type))return s.concat(2).error('"'+u+`" comparisons are not supported for type '`+q(h.type)+"'.");if(l.type.kind!==h.type.kind&&l.type.kind!=="value"&&h.type.kind!=="value")return s.error("Cannot compare types '"+q(l.type)+"' and '"+q(h.type)+"'.");n&&(l.type.kind==="value"&&h.type.kind!=="value"?l=new Ee(h.type,[l]):l.type.kind!=="value"&&h.type.kind==="value"&&(h=new Ee(l.type,[h])));var f=null;if(o.length===4){if(l.type.kind!=="string"&&h.type.kind!=="string"&&l.type.kind!=="value"&&h.type.kind!=="value")return s.error("Cannot use collator to compare non-string types.");if(f=s.parse(o[3],3,nn),!f)return null}return new i(l,h,f)},i.prototype.evaluate=function(o){var s=this.lhs.evaluate(o),u=this.rhs.evaluate(o);if(n&&this.hasUntypedArgument){var l=W(s),h=W(u);if(l.kind!==h.kind||!(l.kind==="string"||l.kind==="number"))throw new J('Expected arguments for "'+r+'" to be (string, string) or (number, number), but found ('+l.kind+", "+h.kind+") instead.")}if(this.collator&&!n&&this.hasUntypedArgument){var f=W(s),p=W(u);if(f.kind!=="string"||p.kind!=="string")return e(o,s,u)}return this.collator?t(o,s,u,this.collator.evaluate(o)):e(o,s,u)},i.prototype.eachChild=function(o){o(this.lhs),o(this.rhs),this.collator&&o(this.collator)},i.prototype.outputDefined=function(){return!0},i.prototype.serialize=function(){var o=[r];return this.eachChild(function(s){o.push(s.serialize())}),o},i}()}var rh=zt("==",Xl,No),nh=zt("!=",Wl,Jl),ih=zt("<",Yl,Ql),ah=zt(">",Hl,$l),oh=zt("<=",Zl,eh),sh=zt(">=",Kl,th),ht=function(e,t,n,i,a,o){this.type=M,this.number=e,this.locale=t,this.currency=n,this.unit=i,this.minFractionDigits=a,this.maxFractionDigits=o};ht.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var n=t.parse(e[1],1,g);if(!n)return null;var i=e[2];if(typeof i!="object"||Array.isArray(i))return t.error("NumberFormat options argument must be an object.");var a=null;if(i.locale&&(a=t.parse(i.locale,1,M),!a))return null;var o=null;if(i.currency&&(o=t.parse(i.currency,1,M),!o))return null;var s=null;if(i.unit&&(s=t.parse(i.unit,1,M),!s))return null;var u=null;if(i["min-fraction-digits"]&&(u=t.parse(i["min-fraction-digits"],1,g),!u))return null;var l=null;return i["max-fraction-digits"]&&(l=t.parse(i["max-fraction-digits"],1,g),!l)?null:new ht(n,a,o,s,u,l)};ht.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency&&"currency"||this.unit&&"unit"||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))};ht.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)};ht.prototype.outputDefined=function(){return!1};ht.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var uh=ht,ft=function(e){this.type=g,this.input=e};ft.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var n=t.parse(e[1],1);return n?n.type.kind!=="array"&&n.type.kind!=="string"&&n.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+q(n.type)+" instead."):new ft(n):null};ft.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string")return t.length;if(Array.isArray(t))return t.length;throw new J("Expected value to be of type string or array, but found "+q(W(t))+" instead.")};ft.prototype.eachChild=function(e){e(this.input)};ft.prototype.outputDefined=function(){return!1};ft.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var lh=ft,Ao={"==":rh,"!=":nh,">":ah,"<":ih,">=":sh,"<=":oh,array:Ee,at:Dl,boolean:Ee,case:Vl,coalesce:Ro,collator:_o,format:yo,image:go,in:ql,"index-of":jl,interpolate:Ze,"interpolate-hcl":Ze,"interpolate-lab":Ze,length:lh,let:zo,literal:Hr,match:Ul,number:Ee,"number-format":uh,object:Ee,slice:Bl,step:ko,string:Ee,"to-boolean":wt,"to-color":wt,"to-number":wt,"to-string":wt,var:Co,within:Si};function ka(r,e){var t=e[0],n=e[1],i=e[2],a=e[3];t=t.evaluate(r),n=n.evaluate(r),i=i.evaluate(r);var o=a?a.evaluate(r):1,s=po(t,n,i,o);if(s)throw new J(s);return new oe(t/255*o,n/255*o,i/255*o,o)}function Fa(r,e){return r in e}function Bn(r,e){var t=e[r];return typeof t>"u"?null:t}function hh(r,e,t,n){for(;t<=n;){var i=t+n>>1;if(e[i]===r)return!0;e[i]>r?n=i-1:t=i+1}return!1}function Xe(r){return{type:r}}Lt.register(Ao,{error:[ul,[M],function(r,e){var t=e[0];throw new J(t.evaluate(r))}],typeof:[M,[P],function(r,e){var t=e[0];return q(W(t.evaluate(r)))}],"to-rgba":[fe(g,4),[ke],function(r,e){var t=e[0];return t.evaluate(r).toArray()}],rgb:[ke,[g,g,g],ka],rgba:[ke,[g,g,g,g],ka],has:{type:F,overloads:[[[M],function(r,e){var t=e[0];return Fa(t.evaluate(r),r.properties())}],[[M,Tt],function(r,e){var t=e[0],n=e[1];return Fa(t.evaluate(r),n.evaluate(r))}]]},get:{type:P,overloads:[[[M],function(r,e){var t=e[0];return Bn(t.evaluate(r),r.properties())}],[[M,Tt],function(r,e){var t=e[0],n=e[1];return Bn(t.evaluate(r),n.evaluate(r))}]]},"feature-state":[P,[M],function(r,e){var t=e[0];return Bn(t.evaluate(r),r.featureState||{})}],properties:[Tt,[],function(r){return r.properties()}],"geometry-type":[M,[],function(r){return r.geometryType()}],id:[P,[],function(r){return r.id()}],zoom:[g,[],function(r){return r.globals.zoom}],pitch:[g,[],function(r){return r.globals.pitch||0}],"distance-from-center":[g,[],function(r){return r.distanceFromCenter()}],"heatmap-density":[g,[],function(r){return r.globals.heatmapDensity||0}],"line-progress":[g,[],function(r){return r.globals.lineProgress||0}],"sky-radial-progress":[g,[],function(r){return r.globals.skyRadialProgress||0}],accumulated:[P,[],function(r){return r.globals.accumulated===void 0?null:r.globals.accumulated}],"+":[g,Xe(g),function(r,e){for(var t=0,n=0,i=e;n<i.length;n+=1){var a=i[n];t+=a.evaluate(r)}return t}],"*":[g,Xe(g),function(r,e){for(var t=1,n=0,i=e;n<i.length;n+=1){var a=i[n];t*=a.evaluate(r)}return t}],"-":{type:g,overloads:[[[g,g],function(r,e){var t=e[0],n=e[1];return t.evaluate(r)-n.evaluate(r)}],[[g],function(r,e){var t=e[0];return-t.evaluate(r)}]]},"/":[g,[g,g],function(r,e){var t=e[0],n=e[1];return t.evaluate(r)/n.evaluate(r)}],"%":[g,[g,g],function(r,e){var t=e[0],n=e[1];return t.evaluate(r)%n.evaluate(r)}],ln2:[g,[],function(){return Math.LN2}],pi:[g,[],function(){return Math.PI}],e:[g,[],function(){return Math.E}],"^":[g,[g,g],function(r,e){var t=e[0],n=e[1];return Math.pow(t.evaluate(r),n.evaluate(r))}],sqrt:[g,[g],function(r,e){var t=e[0];return Math.sqrt(t.evaluate(r))}],log10:[g,[g],function(r,e){var t=e[0];return Math.log(t.evaluate(r))/Math.LN10}],ln:[g,[g],function(r,e){var t=e[0];return Math.log(t.evaluate(r))}],log2:[g,[g],function(r,e){var t=e[0];return Math.log(t.evaluate(r))/Math.LN2}],sin:[g,[g],function(r,e){var t=e[0];return Math.sin(t.evaluate(r))}],cos:[g,[g],function(r,e){var t=e[0];return Math.cos(t.evaluate(r))}],tan:[g,[g],function(r,e){var t=e[0];return Math.tan(t.evaluate(r))}],asin:[g,[g],function(r,e){var t=e[0];return Math.asin(t.evaluate(r))}],acos:[g,[g],function(r,e){var t=e[0];return Math.acos(t.evaluate(r))}],atan:[g,[g],function(r,e){var t=e[0];return Math.atan(t.evaluate(r))}],min:[g,Xe(g),function(r,e){return Math.min.apply(Math,e.map(function(t){return t.evaluate(r)}))}],max:[g,Xe(g),function(r,e){return Math.max.apply(Math,e.map(function(t){return t.evaluate(r)}))}],abs:[g,[g],function(r,e){var t=e[0];return Math.abs(t.evaluate(r))}],round:[g,[g],function(r,e){var t=e[0],n=t.evaluate(r);return n<0?-Math.round(-n):Math.round(n)}],floor:[g,[g],function(r,e){var t=e[0];return Math.floor(t.evaluate(r))}],ceil:[g,[g],function(r,e){var t=e[0];return Math.ceil(t.evaluate(r))}],"filter-==":[F,[M,P],function(r,e){var t=e[0],n=e[1];return r.properties()[t.value]===n.value}],"filter-id-==":[F,[P],function(r,e){var t=e[0];return r.id()===t.value}],"filter-type-==":[F,[M],function(r,e){var t=e[0];return r.geometryType()===t.value}],"filter-<":[F,[M,P],function(r,e){var t=e[0],n=e[1],i=r.properties()[t.value],a=n.value;return typeof i==typeof a&&i<a}],"filter-id-<":[F,[P],function(r,e){var t=e[0],n=r.id(),i=t.value;return typeof n==typeof i&&n<i}],"filter->":[F,[M,P],function(r,e){var t=e[0],n=e[1],i=r.properties()[t.value],a=n.value;return typeof i==typeof a&&i>a}],"filter-id->":[F,[P],function(r,e){var t=e[0],n=r.id(),i=t.value;return typeof n==typeof i&&n>i}],"filter-<=":[F,[M,P],function(r,e){var t=e[0],n=e[1],i=r.properties()[t.value],a=n.value;return typeof i==typeof a&&i<=a}],"filter-id-<=":[F,[P],function(r,e){var t=e[0],n=r.id(),i=t.value;return typeof n==typeof i&&n<=i}],"filter->=":[F,[M,P],function(r,e){var t=e[0],n=e[1],i=r.properties()[t.value],a=n.value;return typeof i==typeof a&&i>=a}],"filter-id->=":[F,[P],function(r,e){var t=e[0],n=r.id(),i=t.value;return typeof n==typeof i&&n>=i}],"filter-has":[F,[P],function(r,e){var t=e[0];return t.value in r.properties()}],"filter-has-id":[F,[],function(r){return r.id()!==null&&r.id()!==void 0}],"filter-type-in":[F,[fe(M)],function(r,e){var t=e[0];return t.value.indexOf(r.geometryType())>=0}],"filter-id-in":[F,[fe(P)],function(r,e){var t=e[0];return t.value.indexOf(r.id())>=0}],"filter-in-small":[F,[M,fe(P)],function(r,e){var t=e[0],n=e[1];return n.value.indexOf(r.properties()[t.value])>=0}],"filter-in-large":[F,[M,fe(P)],function(r,e){var t=e[0],n=e[1];return hh(r.properties()[t.value],n.value,0,n.value.length-1)}],all:{type:F,overloads:[[[F,F],function(r,e){var t=e[0],n=e[1];return t.evaluate(r)&&n.evaluate(r)}],[Xe(F),function(r,e){for(var t=0,n=e;t<n.length;t+=1){var i=n[t];if(!i.evaluate(r))return!1}return!0}]]},any:{type:F,overloads:[[[F,F],function(r,e){var t=e[0],n=e[1];return t.evaluate(r)||n.evaluate(r)}],[Xe(F),function(r,e){for(var t=0,n=e;t<n.length;t+=1){var i=n[t];if(i.evaluate(r))return!0}return!1}]]},"!":[F,[F],function(r,e){var t=e[0];return!t.evaluate(r)}],"is-supported-script":[F,[M],function(r,e){var t=e[0],n=r.globals&&r.globals.isSupportedScript;return n?n(t.evaluate(r)):!0}],upcase:[M,[M],function(r,e){var t=e[0];return t.evaluate(r).toUpperCase()}],downcase:[M,[M],function(r,e){var t=e[0];return t.evaluate(r).toLowerCase()}],concat:[M,Xe(P),function(r,e){return e.map(function(t){return Qt(t.evaluate(r))}).join("")}],"resolved-locale":[M,[nn],function(r,e){var t=e[0];return t.evaluate(r).resolvedLocale()}]});var Oo=Ao;function li(r){return{result:"success",value:r}}function _t(r){return{result:"error",value:r}}function fh(r){return r["property-type"]==="data-driven"}function ch(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function ph(r){return!!r.expression&&r.expression.interpolated}function Do(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}var Li=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new vo,this._defaultValue=t?gh(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};Li.prototype.evaluateWithoutErrorHandling=function(e,t,n,i,a,o,s,u){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=n,this._evaluator.canonical=i||null,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=o,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=u||null,this.expression.evaluate(this._evaluator)};Li.prototype.evaluate=function(e,t,n,i,a,o,s,u){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i||null,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=o||null,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=u||null;try{var l=this.expression.evaluate(this._evaluator);if(l==null||typeof l=="number"&&l!==l)return this._defaultValue;if(this._enumValues&&!(l in this._enumValues))throw new J("Expected value to be one of "+Object.keys(this._enumValues).map(function(h){return JSON.stringify(h)}).join(", ")+", but found "+JSON.stringify(l)+" instead.");return l}catch(h){return this._warningHistory[h.message]||(this._warningHistory[h.message]=!0,typeof console<"u"&&console.warn(h.message)),this._defaultValue}};function dh(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Oo}function hi(r,e){var t=new Eo(Oo,[],e?yh(e):void 0),n=t.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return n?li(new Li(n,e)):_t(t.errors)}var Kr=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!Ii(t.expression)};Kr.prototype.evaluateWithoutErrorHandling=function(e,t,n,i,a,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,i,a,o)};Kr.prototype.evaluate=function(e,t,n,i,a,o){return this._styleExpression.evaluate(e,t,n,i,a,o)};var ar=function(e,t,n,i){this.kind=e,this.zoomStops=n,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!Ii(t.expression),this.interpolationType=i};ar.prototype.evaluateWithoutErrorHandling=function(e,t,n,i,a,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,i,a,o)};ar.prototype.evaluate=function(e,t,n,i,a,o){return this._styleExpression.evaluate(e,t,n,i,a,o)};ar.prototype.interpolationFactor=function(e,t,n){return this.interpolationType?Ze.interpolationFactor(this.interpolationType,e,t,n):0};function mh(r,e){if(r=hi(r,e),r.result==="error")return r;var t=r.value.expression,n=on(t);if(!n&&!fh(e))return _t([new xe("","data expressions not supported")]);var i=Gi(t,["zoom","pitch","distance-from-center"]);if(!i&&!ch(e))return _t([new xe("","zoom expressions not supported")]);var a=Dr(t);if(!a&&!i)return _t([new xe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(a instanceof xe)return _t([a]);if(a instanceof Ze&&!ph(e))return _t([new xe("",'"interpolate" expressions cannot be used with this property')]);if(!a)return li(n?new Kr("constant",r.value):new Kr("source",r.value));var o=a instanceof Ze?a.interpolation:void 0;return li(n?new ar("camera",r.value,a.labels,o):new ar("composite",r.value,a.labels,o))}function Dr(r){var e=null;if(r instanceof zo)e=Dr(r.result);else if(r instanceof Ro)for(var t=0,n=r.args;t<n.length;t+=1){var i=n[t];if(e=Dr(i),e)break}else(r instanceof ko||r instanceof Ze)&&r.input instanceof Lt&&r.input.name==="zoom"&&(e=r);return e instanceof xe||r.eachChild(function(a){var o=Dr(a);o instanceof xe?e=o:!e&&o?e=new xe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&o&&e!==o&&(e=new xe("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function yh(r){var e={color:ke,string:M,number:g,enum:M,boolean:F,formatted:an,resolvedImage:lr};return r.type==="array"?fe(e[r.value]||P,r.length):e[r.type]}function gh(r){return r.type==="color"&&(Do(r.default)||Array.isArray(r.default))?new oe(0,0,0,0):r.type==="color"?oe.parse(r.default)||null:r.default===void 0?null:r.default}function vh(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function fi(r){if(Array.isArray(r))return r.map(fi);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){var e={};for(var t in r)e[t]=fi(r[t]);return e}return vh(r)}var qo={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},projection:{type:"projection"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"},"fill-extrusion-edge-radius":{type:"number",private:!0,default:0,minimum:0,maximum:1,"property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_symbol:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature","pitch","distance-from-center"]}},filter_fill:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_line:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_circle:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},"filter_fill-extrusion":{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_heatmap:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Camera"},pitch:{group:"Camera"},"distance-from-center":{group:"Camera"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},"sky-radial-progress":{group:"sky"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"high-color":{type:"color","property-type":"data-constant",default:"#245cdf",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"space-color":{type:"color","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,.2,7,.1],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"star-intensity":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],5,.35,6,0],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},projection:{name:{type:"enum",values:{albers:{},equalEarth:{},equirectangular:{},lambertConformalConic:{},mercator:{},naturalEarth:{},winkelTripel:{},globe:{}},default:"mercator",required:!0},center:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-180,-90],maximum:[180,90],transition:!1,requires:[{name:["albers","lambertConformalConic"]}]},parallels:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-90,-90],maximum:[90,90],transition:!1,requires:[{name:["albers","lambertConformalConic"]}]}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,requires:["source"]}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant",type:"number",private:!0,default:0,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant",type:"number",private:!0,default:3,minimum:0,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,requires:["fill-extrusion-edge-radius"]}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!1,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{type:"array",value:"number",length:2,default:[0,0],minimum:[0,0],maximum:[1,1],transition:!1,requires:[{source:"geojson",has:{lineMetrics:!0}}],"property-type":"constant"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};function jo(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(var e=0,t=r.slice(1);e<t.length;e+=1){var n=t[e];if(!jo(n)&&typeof n!="boolean")return!1}return!0;default:return!0}}function _h(r,e){if(e===void 0&&(e="fill"),r==null)return{filter:function(){return!0},needGeometry:!1,needFeature:!1};jo(r)||(r=Jr(r));var t=r,n=!0;try{n=bh(t)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
`+JSON.stringify(t,null,2)+`
        `)}var i=qo["filter_"+e],a=hi(n,i),o=null;if(a.result==="error")throw new Error(a.value.map(function(f){return f.key+": "+f.message}).join(", "));o=function(f,p,c){return a.value.evaluate(f,p,{},c)};var s=null,u=null;if(n!==t){var l=hi(t,i);if(l.result==="error")throw new Error(l.value.map(function(f){return f.key+": "+f.message}).join(", "));s=function(f,p,c,d,m){return l.value.evaluate(f,p,{},c,void 0,void 0,d,m)},u=!on(l.value.expression)}o=o;var h=Bo(n);return{filter:o,dynamicFilter:s||void 0,needGeometry:h,needFeature:!!u}}function bh(r){if(!Ft(r))return r;var e=fi(r);return Vo(e),e=Uo(e),e}function Uo(r){if(!Array.isArray(r))return r;var e=Ch(r);return e===!0?e:e.map(function(t){return Uo(t)})}function Vo(r){var e=!1,t=[];if(r[0]==="case"){for(var n=1;n<r.length-1;n+=2)e=e||Ft(r[n]),t.push(r[n+1]);t.push(r[r.length-1])}else if(r[0]==="match"){e=e||Ft(r[1]);for(var i=2;i<r.length-1;i+=2)t.push(r[i+1]);t.push(r[r.length-1])}else if(r[0]==="step"){e=e||Ft(r[1]);for(var a=1;a<r.length-1;a+=2)t.push(r[a+1])}e&&(r.length=0,r.push.apply(r,["any"].concat(t)));for(var o=1;o<r.length;o++)Vo(r[o])}function Ft(r){if(!Array.isArray(r))return!1;if(xh(r[0]))return!0;for(var e=1;e<r.length;e++){var t=r[e];if(Ft(t))return!0}return!1}function xh(r){return r==="pitch"||r==="distance-from-center"}var wh=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Ch(r){if(wh.has(r[0]))for(var e=1;e<r.length;e++){var t=r[e];if(Ft(t))return!0}return r}function Eh(r,e){return r<e?-1:r>e?1:0}function Bo(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(var e=1;e<r.length;e++)if(Bo(r[e]))return!0;return!1}function Jr(r){if(!r)return!0;var e=r[0];if(r.length<=1)return e!=="any";var t=e==="=="?Xn(r[1],r[2],"=="):e==="!="?Nr(Xn(r[1],r[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Xn(r[1],r[2],e):e==="any"?Th(r.slice(1)):e==="all"?["all"].concat(r.slice(1).map(Jr)):e==="none"?["all"].concat(r.slice(1).map(Jr).map(Nr)):e==="in"?Pa(r[1],r.slice(2)):e==="!in"?Nr(Pa(r[1],r.slice(2))):e==="has"?Ma(r[1]):e==="!has"?Nr(Ma(r[1])):e==="within"?r:!0;return t}function Xn(r,e,t){switch(r){case"$type":return["filter-type-"+t,e];case"$id":return["filter-id-"+t,e];default:return["filter-"+t,r,e]}}function Th(r){return["any"].concat(r.map(Jr))}function Pa(r,e){if(e.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(function(t){return typeof t!=typeof e[0]})?["filter-in-large",r,["literal",e.sort(Eh)]]:["filter-in-small",r,["literal",e]]}}function Ma(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Nr(r){return["!",r]}var kh=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Fh(r,e){var t={};for(var n in r)n!=="ref"&&(t[n]=r[n]);return kh.forEach(function(i){i in e&&(t[i]=e[i])}),t}function Ph(r){r=r.slice();for(var e=Object.create(null),t=0;t<r.length;t++)e[r[t].id]=r[t];for(var n=0;n<r.length;n++)"ref"in r[n]&&(r[n]=Fh(r[n],e[r[n].ref]));return r}var Sa={thin:100,hairline:100,"ultra-light":100,"extra-light":100,light:200,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,heavy:800,black:800,"extra-bold":800,"ultra-black":900,"extra-black":900,"ultra-bold":900,"heavy-black":900,fat:900,poster:900},Ht=" ",Ia=/(italic|oblique)$/i,Ga={},Mh=function(r,e,t){var n=Ga[r];if(!n){Array.isArray(r)||(r=[r]);for(var i=400,a="normal",o=[],s,u,l=0,h=r.length;l<h;++l){var f=r[l],p=f.split(" "),c=p[p.length-1].toLowerCase();c=="normal"||c=="italic"||c=="oblique"?(a=u?a:c,p.pop(),c=p[p.length-1].toLowerCase()):Ia.test(c)&&(c=c.replace(Ia,""),a=u?a:p[p.length-1].replace(c,""));for(var d in Sa){var m=p.length>1?p[p.length-2].toLowerCase():"";if(c==d||c==d.replace("-","")||m+"-"+c==d){i=s?i:Sa[d],p.pop(),m&&d.startsWith(m)&&p.pop();break}}!s&&typeof c=="number"&&(i=c);var v=p.join(Ht).replace("Klokantech Noto Sans","Noto Sans");v.indexOf(Ht)!==-1&&(v='"'+v+'"'),o.push(v)}n=Ga[r]=[a,i,o]}return n[0]+Ht+n[1]+Ht+e+"px"+(t?"/"+t:"")+Ht+n[2]},ci=fo(Mh),Xo="https://api.mapbox.com";function Ri(r){var e="mapbox://";return r.indexOf(e)!==0?"":r.slice(e.length)}function Sh(r,e,t){var n=Ri(r);if(!n)return decodeURI(new URL(r,t).href);var i="sprites/";if(n.indexOf(i)!==0)throw new Error("unexpected sprites url: "+r);var a=n.slice(i.length);return Xo+"/styles/v1/"+a+"/sprite?access_token="+e}function Wo(r,e){var t=Ri(r);if(!t)return decodeURI(new URL(r,location.href).href);var n="styles/";if(t.indexOf(n)!==0)throw new Error("unexpected style url: "+r);var i=t.slice(n.length);return Xo+"/styles/v1/"+i+"?&access_token="+e}function qr(r,e,t,n){var i=new URL(r,n),a=Ri(r);if(!a)return e&&i.searchParams.set(t,e),decodeURI(i.href);if(a==="mapbox.satellite"){var o=window.devicePixelRatio>=1.5?"@2x":"";return"https://api.mapbox.com/v4/"+a+"/{z}/{x}/{y}"+o+".webp?access_token="+e}return"https://{a-d}.tiles.mapbox.com/v4/"+a+"/{z}/{x}/{y}.vector.pbf?access_token="+e}function Ih(r,e){return e===void 0&&(e=512),r.getExtent()?Ya({extent:r.getExtent(),tileSize:e,maxZoom:22}).getResolutions():Ni}function Gh(r,e){if(!e.accessToken){e=Object.assign({},e);var t=new URL(r).searchParams;t.forEach(function(n,i){e.accessToken=n,e.accessTokenParam=i})}return e}function gf(r,e,t,n,i){t===void 0&&(t=""),n===void 0&&(n={}),i===void 0&&(i=void 0);var a,o,s,u,l=!0;return typeof t!="string"&&!Array.isArray(t)?(s=t,u=s.source||s.layers,n=s):u=t,typeof n=="string"?(a=n,s={}):(a=n.styleUrl,s=n),s.updateSource===!1&&(l=!1),i||(i=s.resolutions),!a&&typeof e=="string"&&!e.trim().startsWith("{")&&(a=e),a&&(a=a.startsWith("data:")?location.href:Wo(a,s.accessToken),s=Gh(a,s)),new Promise(function(h,f){Vh(e,s).then(function(p){if(p.version!=8)return f(new Error("glStyle version 8 required."));if(!(r instanceof bi||r instanceof Gn))return f(new Error("Can only apply to VectorLayer or VectorTileLayer"));var c=r instanceof Gn?"vector":"geojson";if(u?Array.isArray(u)?o=p.layers.find(function(z){return z.id===u[0]}).source:o=u:(o=Object.keys(p.sources).find(function(z){return p.sources[z].type===c}),u=o),!o)return f(new Error("No "+c+" source found in the glStyle."));function d(){if(!l)return Promise.resolve();if(r instanceof Gn)return zh(p.sources[o],a,s).then(function(U){var O=r.getSource();if(O?U!==O&&(O.setTileUrlFunction(U.getTileUrlFunction()),typeof O.setUrls=="function"&&typeof U.getUrls=="function"&&O.setUrls(U.getUrls()),O.format_||(O.format_=U.format_),O.getAttributions()||O.setAttributions(U.getAttributions()),O.getTileLoadFunction()===Ks&&O.setTileLoadFunction(U.getTileLoadFunction()),Js(O.getProjection(),U.getProjection())&&(O.tileGrid=U.getTileGrid())):r.setSource(U),!isFinite(r.getMaxResolution())&&!isFinite(r.getMinZoom())){var Y=r.getSource().getTileGrid();r.setMaxResolution(Y.getResolution(Y.getMinZoom()))}});var z=p.sources[o],N=r.getSource();(!N||N.get("mapbox-source")!==z)&&(N=Ah(z,a,s));var A=r.getSource();return A?N!==A&&(A.getAttributions()||A.setAttributions(N.getAttributions()),A.format_||(A.format_=N.getFormat()),A.url_=N.getUrl()):r.setSource(N),Promise.resolve()}var m,v,x,y;function S(){if(!y&&(!p.sprite||v)){if(s.projection&&!i){var z=me(s.projection),N=z.getUnits();N!=="m"&&(i=Ni.map(function(A){return A/Ys[N]}))}y=af(r,p,u,i,v,x,Kh,s.getImage),r.getStyle()?d().then(h).catch(f):f(new Error("Nothing to show for source ["+o+"]"))}else y?(r.setStyle(y),d().then(h).catch(f)):f(new Error("Something went wrong trying to apply style."))}if(p.sprite){var C=new URL(Sh(p.sprite,s.accessToken,a||location.href));m=window.devicePixelRatio>=1.5?.5:1;var I=m==.5?"@2x":"",j=C.origin+C.pathname+I+".json"+C.search;new Promise(function(z,N){Qr("Sprite",j,s).then(z).catch(function(A){j=C.origin+C.pathname+".json"+C.search,Qr("Sprite",j,s).then(z).catch(N)})}).then(function(z){if(z===void 0&&f(new Error("No sprites found.")),v=z,x=C.origin+C.pathname+I+".png"+C.search,s.transformRequest){var N=s.transformRequest(x,"SpriteImage");N instanceof Request&&(x=encodeURI(N.url))}S()}).catch(function(z){f(new Error("Sprites cannot be loaded: "+j+": "+z.message))})}else S()}).catch(f)})}function Lh(r,e){var t=r.bounds;if(t){var n=da([t[0],t[1]],e),i=da([t[2],t[3]],e);return[n[0],n[1],i[0],i[1]]}return me(e).getExtent()}function Rh(r,e,t){var n=new Xu({tileJSON:e,tileSize:r.tileSize||e.tileSize||512}),i=n.getTileJSON(),a=n.getTileGrid(),o=me(t.projection||"EPSG:3857"),s=Lh(i,o),u=o.getExtent(),l=i.minzoom||0,h=i.maxzoom||22,f={attributions:n.getAttributions(),projection:o,tileGrid:new nu({origin:u?iu(u):a.getOrigin(0),extent:s||a.getExtent(),minZoom:l,resolutions:Ih(o,e.tileSize).slice(0,h+1),tileSize:a.getTileSize(0)})};return Array.isArray(i.tiles)?f.urls=i.tiles:f.url=i.tiles,f}function zh(r,e,t){return new Promise(function(n,i){Bh(r,e,t).then(function(a){var o=Rh(r,a,t);o.format=new eu,n(new tu(o))}).catch(i)})}function Nh(r){var e=r?r.getCode():"EPSG:3857";return"{bbox-"+e.toLowerCase().replace(/[^a-z0-9]/g,"-")+"}"}function Ah(r,e,t){var n=t.projection?new ya({dataProjection:t.projection}):new ya,i=r.data,a={};if(typeof i=="string"){var o=qr(i,t.accessToken,t.accessTokenParam||"access_token",e||location.href);if(t.transformRequest){var s=t.transformRequest(o,"GeoJSON");s instanceof Request&&(o=decodeURI(s.url))}if(/\{bbox-[0-9a-z-]+\}/.test(o)){var u=function(f,p,c){var d=Nh(c);return o.replace(d,""+f.join(","))},l=new Kt({attributions:r.attribution,format:n,url:u,strategy:Vu});return l.set("mapbox-source",r),l}return new Kt({attributions:r.attribution,format:n,url:o})}a.features=n.readFeatures(i,{featureProjection:"EPSG:3857"});var h=new Kt(Object.assign({attributions:r.attribution,format:n},a));return h.set("mapbox-source",r),h}var La={},Ra={},Oh=0;function zi(r){return r.id||(r.id=Oh++),r.id}function Dh(r,e){return zi(r)+"."+B(e)}function qh(r){var e=La[r.id];return e||(e={},La[zi(r)]=e),e}function jh(r){var e=Ra[r.id];return e||(e={},Ra[zi(r)]=e),e}function Wn(r){return r*Math.PI/180}var Ni=function(){for(var r=[],e=78271.51696402048;r.length<=24;e/=2)r.push(e);return r}();function Yo(r,e){if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof OffscreenCanvas<"u")return new OffscreenCanvas(r,e);var t=document.createElement("canvas");return t.width=r,t.height=e,t}function Uh(r,e){for(var t=0,n=e.length;t<n;++t){var i=e[t];if(i<r&&t+1<n){var a=e[t]/e[t+1];return t+Math.log(e[t]/r)/Math.log(a)}}return n-1}var vt={};function Qr(r,e,t,n){if(t===void 0&&(t={}),e in vt)return n&&(n.request=vt[e][0]),vt[e][1];var i=t.transformRequest?t.transformRequest(e,r)||new Request(e):new Request(e);i.headers.get("Accept")||i.headers.set("Accept","application/json"),n&&(n.request=i);var a=fetch(i).then(function(o){return delete vt[e],o.ok?o.json():Promise.reject(new Error("Error fetching source "+e))}).catch(function(o){return delete vt[e],Promise.reject(new Error("Error fetching source "+e))});return vt[e]=[i,a],a}function Vh(r,e){if(typeof r=="string")if(r.trim().startsWith("{"))try{var t=JSON.parse(r);return Promise.resolve(t)}catch(n){return Promise.reject(n)}else return r=Wo(r,e.accessToken),Qr("Style",r,e);else return Promise.resolve(r)}function za(r,e){if(e.transformRequest){var t=e.transformRequest(r,"Tiles");if(t instanceof Request)return decodeURI(t.url)}return r}var Na={};function Bh(r,e,t){t===void 0&&(t={});var n=[e,JSON.stringify(r)].toString(),i=Na[n];if(!i||t.transformRequest){var a=r.url;if(a&&!r.tiles){var o=qr(a,t.accessToken,t.accessTokenParam||"access_token",e||location.href);if(a.startsWith("mapbox://"))i=Promise.resolve(Object.assign({},r,{url:void 0,tiles:ru(o)}));else{var s={};i=Qr("Source",o,t,s).then(function(u){return u.tiles=u.tiles.map(function(l){return u.scheme==="tms"&&(l=l.replace("{y}","{-y}")),za(qr(l,t.accessToken,t.accessTokenParam||"access_token",s.request.url),t)}),Promise.resolve(u)})}}else r=Object.assign({},r,{tiles:r.tiles.map(function(u){return r.scheme==="tms"&&(u=u.replace("{y}","{-y}")),za(qr(u,t.accessToken,t.accessTokenParam||"access_token",e||location.href),t)})}),i=Promise.resolve(Object.assign({},r));Na[n]=i}return i}function Aa(r,e,t,n){var i=document.createElement("canvas"),a=[2*t*e.pixelRatio+e.width,2*t*e.pixelRatio+e.height];i.width=a[0],i.height=a[1];var o=i.getContext("2d");o.drawImage(r,e.x,e.y,e.width,e.height,t*e.pixelRatio,t*e.pixelRatio,e.width,e.height);var s=o.getImageData(0,0,a[0],a[1]);o.globalCompositeOperation="destination-over",o.fillStyle="rgba("+n.r*255+","+n.g*255+","+n.b*255+","+n.a+")";for(var u=s.data,l=0,h=s.width;l<h;++l)for(var f=0,p=s.height;f<p;++f){var c=(f*h+l)*4,d=u[c+3];d>0&&o.arc(l,f,t*e.pixelRatio,0,2*Math.PI)}return o.fill(),i}function Xh(r,e,t){var n=Math.max(0,Math.min(1,(t-r)/(e-r)));return n*n*(3-2*n)}function Oa(r,e,t){var n=document.createElement("canvas");n.width=e.width,n.height=e.height;var i=n.getContext("2d");i.drawImage(r,e.x,e.y,e.width,e.height,0,0,e.width,e.height);for(var a=i.getImageData(0,0,e.width,e.height),o=a.data,s=0,u=a.width;s<u;++s)for(var l=0,h=a.height;l<h;++l){var f=(l*u+s)*4,p=o[f+3]/255,c=.75,d=.1,m=Xh(c-d,c+d,p);m>0?(o[f+0]=Math.round(255*t.r*m),o[f+1]=Math.round(255*t.g*m),o[f+2]=Math.round(255*t.b*m),o[f+3]=Math.round(255*m)):o[f+3]=0}return i.putImageData(a,0,0),n}var Wh=Array(256).join("");function pi(r,e){if(e>=.05){for(var t="",n=r.split(`
`),i=Wh.slice(0,Math.round(e/.1)),a=0,o=n.length;a<o;++a)a>0&&(t+=`
`),t+=n[a].split("").join(i);return t}return r}var Yn;function Ho(){return Yn||(Yn=Yo(1,1).getContext("2d")),Yn}function We(r,e){return Ho().measureText(r).width+(r.length-1)*e}var Da={};function di(r,e,t,n){if(r.indexOf(`
`)!==-1){for(var i=r.split(`
`),a=[],o=0,s=i.length;o<s;++o)a.push(di(i[o],e,t,n));return a.join(`
`)}var u=t+","+e+","+r+","+n,l=Da[u];if(!l){var h=r.split(" ");if(h.length>1){var f=Ho();f.font=e;for(var p=f.measureText("M").width,c=p*t,d="",m=[],v=0,x=h.length;v<x;++v){var y=h[v],S=d+(d?" ":"")+y;We(S,n)<=c?d=S:(d&&m.push(d),d=y)}d&&m.push(d);for(var C=0,I=m.length;C<I&&I>1;++C){var j=m[C];if(We(j,n)<c*.35){var z=C>0?We(m[C-1],n):1/0,N=C<I-1?We(m[C+1],n):1/0;m.splice(C,1),I-=1,z<N?(m[C-1]+=" "+j,C-=1):m[C]=j+" "+m[C]}}for(var A=0,U=m.length-1;A<U;++A){var O=m[A],Y=m[A+1];if(We(O,n)>c*.7&&We(Y,n)<c*.6){var se=O.split(" "),ue=se.pop();We(ue,n)<c*.2&&(m[A]=se.join(" "),m[A+1]=ue+" "+Y),U-=1}}l=m.join(`
`)}else l=r;l=pi(l,n),Da[u]=l}return l}var Yh=/font-family: ?([^;]*);/,Hh=/("|')/g,Ar;function Zh(r){if(!Ar){Ar={};for(var e=document.styleSheets,t=0,n=e.length;t<n;++t){var i=e[t];try{var a=i.rules||i.cssRules;if(a)for(var o=0,s=a.length;o<s;++o){var u=a[o];if(u.type==5){var l=u.cssText.match(Yh);Ar[l[1].replace(Hh,"")]=!0}}}catch{}}}return r in Ar}var Hn={};function Kh(r,e){e===void 0&&(e="https://cdn.jsdelivr.net/npm/@fontsource/{font-family}/{fontweight}{-fontstyle}.css");var t=r.toString();if(t in Hn)return Hn[t];for(var n=[],i=0,a=r.length;i<a;++i){r[i]=r[i].replace("Arial Unicode MS","Arial");var o=r[i],s=ci(o,1);Hs(s);var u=s.split(" ");n.push([u.slice(3).join(" ").replace(/"/g,""),u[1],u[0]])}for(var l=0,h=n.length;l<h;++l){var f=n[l],p=f[0];if(!Zh(p)&&Zs.get(f[2]+`
`+f[1]+` 
`+p)!==100){var c=e.replace("{font-family}",p.replace(/ /g,"-").toLowerCase()).replace("{Font+Family}",p.replace(/ /g,"+")).replace("{fontweight}",f[1]).replace("{-fontstyle}",f[2].replace("normal","").replace(/(.+)/,"-$1")).replace("{fontstyle}",f[2]);if(!document.querySelector('link[href="'+c+'"]')){var d=document.createElement("link");d.href=c,d.rel="stylesheet",document.head.appendChild(d)}}}return Hn[t]=r,r}var Jh={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},Qh={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},$h=function(r,e){var t=mh(r,e);if(t.result==="error")throw new Error(t.value.map(function(n){return n.key+": "+n.message}).join(", "));return t.value},mi={},$r={zoom:0},Or,Zn;function T(r,e,t,n,i,a,o){var s=r.id;a||(a={},console.warn("No functionCache provided to getValue()")),a[s]||(a[s]={});var u=a[s];if(!u[t]){var l=(r[e]||mi)[t],h=qo[e+"_"+r.type][t];l===void 0&&(l=h.default);var f=dh(l);if(!f&&Do(l)&&(l=el(l,h),f=!0),f){var p=$h(l,h);u[t]=p.evaluate.bind(p)}else h.type=="color"&&(l=oe.parse(l)),u[t]=function(){return l}}return $r.zoom=n,u[t]($r,i,o)}function ef(r,e,t,n){var i=T(r,"layout","icon-allow-overlap",e,t,n);if(!i)return"declutter";var a=T(r,"layout","icon-ignore-placement",e,t,n);return a?"none":"obstacle"}function tf(r,e,t,n,i){return i||console.warn("No filterCache provided to evaluateFilter()"),r in i||(i[r]=_h(e).filter),$r.zoom=n,i[r]($r,t)}function Ye(r,e){if(r){if(r.a===0||e===0)return;var t=r.a;return e=e===void 0?1:e,t===0?"transparent":"rgba("+Math.round(r.r*255/t)+","+Math.round(r.g*255/t)+","+Math.round(r.b*255/t)+","+t*e+")"}return r}var rf=/\{[^{}}]*\}/g;function Kn(r,e){return r.replace(rf,function(t){return e[t.slice(1,-1)]||""})}var nf={};function af(r,e,t,n,i,a,o,s){if(n===void 0&&(n=Ni),i===void 0&&(i=void 0),a===void 0&&(a=void 0),o===void 0&&(o=void 0),s===void 0&&(s=void 0),typeof e=="string"&&(e=JSON.parse(e)),e.version!=8)throw new Error("glStyle version 8 required.");nf[Dh(e,r)]=Array.from(arguments);var u,l,h;if(a){if(typeof Image<"u"){var f=new Image;f.crossOrigin="anonymous",f.onload=function(){u=f,l=[f.width,f.height],r.changed(),f.onload=null},f.src=a}else if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope){var p=self;p.postMessage({action:"loadImage",src:a}),p.addEventListener("message",function(ge){ge.data.action==="imageLoaded"&&ge.data.src===a&&(u=ge.data.image,l=[u.width,u.height])})}}for(var c=Ph(e.layers),d={},m=[],v={},x={},y=qh(e),S=jh(e),C,I=0,j=c.length;I<j;++I){var z=c[I],N=z.id;if(typeof t=="string"&&z.source==t||t.indexOf(N)!==-1){var A=z["source-layer"];if(C){if(z.source!==C)throw new Error('Layer "'+N+'" does not use source "'+C)}else{C=z.source;var U=e.sources[C];if(!U)throw new Error('Source "'+C+'" is not defined');var O=U.type;if(O!=="vector"&&O!=="geojson")throw new Error('Source "'+C+'" is not of type "vector" or "geojson", but "'+O+'"')}var Y=d[A];Y||(Y=[],d[A]=Y),Y.push({layer:z,index:I}),m.push(N)}}var se=new Er,ue=new Tr,G=[],te=function(V,ge,Ai){var Nt=V.getProperties(),sn=d[Nt.layer];if(sn){var w=n.indexOf(ge);w==-1&&(w=Uh(ge,n));for(var pe=Jh[V.getGeometry().getType()],E={id:V.getId(),properties:Nt,type:pe},k=r.get("mapbox-featurestate")[V.getId()],X=-1,un=0,Zo=sn.length;un<Zo;++un){var Oi=sn[un],_=Oi.layer,Di=_.id;if(!(Ai!==void 0&&Ai!==Di)){var At=_.layout||mi,qe=_.paint||mi;if(!(At.visibility==="none"||"minzoom"in _&&w<_.minzoom||"maxzoom"in _&&w>=_.maxzoom)){var qi=_.filter;if(!qi||tf(Di,qi,E,w,S)){var de=void 0,we=void 0,hr=void 0,ve=void 0,Ce=void 0,b=void 0,ct=Oi.index;if(pe==3&&(_.type=="fill"||_.type=="fill-extrusion"))if(we=T(_,"paint",_.type+"-opacity",w,E,y,k),_.type+"-pattern"in qe){var fr=T(_,"paint",_.type+"-pattern",w,E,y,k);if(fr){var ln=typeof fr=="string"?Kn(fr,Nt):fr.toString();if(u&&i&&i[ln]){++X,b=G[X],(!b||!b.getFill()||b.getStroke()||b.getText())&&(b=new gt({fill:new Tr}),G[X]=b),hr=b.getFill(),b.setZIndex(ct);var ji=ln+"."+we,cr=x[ji];if(!cr){var Me=i[ln],Ui=Yo(Me.width,Me.height),hn=Ui.getContext("2d");hn.globalAlpha=we,hn.drawImage(u,Me.x,Me.y,Me.width,Me.height,0,0,Me.width,Me.height),cr=hn.createPattern(Ui,"repeat"),x[ji]=cr}hr.setColor(cr)}}}else de=Ye(T(_,"paint",_.type+"-color",w,E,y,k),we),_.type+"-outline-color"in qe&&(Ce=Ye(T(_,"paint",_.type+"-outline-color",w,E,y,k),we)),Ce||(Ce=de),(de||Ce)&&(++X,b=G[X],(!b||de&&!b.getFill()||!de&&b.getFill()||Ce&&!b.getStroke()||!Ce&&b.getStroke()||b.getText())&&(b=new gt({fill:de?new Tr:void 0,stroke:Ce?new Er:void 0}),G[X]=b),de&&(hr=b.getFill(),hr.setColor(de)),Ce&&(ve=b.getStroke(),ve.setColor(Ce),ve.setWidth(.5)),b.setZIndex(ct));if(pe!=1&&_.type=="line"){de=!("line-pattern"in qe)&&"line-color"in qe?Ye(T(_,"paint","line-color",w,E,y,k),T(_,"paint","line-opacity",w,E,y,k)):void 0;var fn=T(_,"paint","line-width",w,E,y,k);de&&fn>0&&(++X,b=G[X],(!b||!b.getStroke()||b.getFill()||b.getText())&&(b=new gt({stroke:new Er}),G[X]=b),ve=b.getStroke(),ve.setLineCap(T(_,"layout","line-cap",w,E,y,k)),ve.setLineJoin(T(_,"layout","line-join",w,E,y,k)),ve.setMiterLimit(T(_,"layout","line-miter-limit",w,E,y,k)),ve.setColor(de),ve.setWidth(fn),ve.setLineDash(qe["line-dasharray"]?T(_,"paint","line-dasharray",w,E,y,k).map(function($){return $*fn}):null),b.setZIndex(ct))}var pr=!1,D=null,Vi=0,Ot=void 0,Q=void 0,cn=void 0;if((pe==1||pe==2)&&"icon-image"in At){var dr=T(_,"layout","icon-image",w,E,y,k);if(dr){Ot=typeof dr=="string"?Kn(dr,Nt):dr.toString();var pn=void 0,je=s?s(r,Ot):void 0;if(u&&i&&i[Ot]||je){var dn=T(_,"layout","icon-rotation-alignment",w,E,y,k);if(pe==2){var Se=V.getGeometry();if(Se.getFlatMidpoint||Se.getFlatMidpoints){var mr=Se.getExtent(),Ko=Math.sqrt(Math.max(Math.pow((mr[2]-mr[0])/ge,2),Math.pow((mr[3]-mr[1])/ge,2)));if(Ko>150){var pt=Se.getType()==="MultiLineString"?Se.getFlatMidpoints():Se.getFlatMidpoint();Zn||(Or=[NaN,NaN],Zn=new au("Point",Or,[],{},null)),pn=Zn,Or[0]=pt[0],Or[1]=pt[1];var Jo=T(_,"layout","symbol-placement",w,E,y,k);if(Jo==="line"&&dn==="map")for(var yr=Se.getStride(),Dt=Se.getFlatCoordinates(),dt=0,Qo=Dt.length-yr;dt<Qo;dt+=yr){var mn=Dt[dt],yn=Dt[dt+1],gn=Dt[dt+yr],vn=Dt[dt+yr+1],$o=Math.min(mn,gn),es=Math.min(yn,vn),ts=Math.max(mn,gn),rs=Math.max(yn,vn);if(pt[0]>=$o&&pt[0]<=ts&&pt[1]>=es&&pt[1]<=rs){Vi=Math.atan2(yn-vn,gn-mn);break}}}}}if(pe!==2||pn){var Bi=T(_,"layout","icon-size",w,E,y,k),_e=qe["icon-color"]!==void 0?T(_,"paint","icon-color",w,E,y,k):null;if(!_e||_e.a!==0){var _n=T(_,"paint","icon-halo-color",w,E,y,k),gr=T(_,"paint","icon-halo-width",w,E,y,k),bn=Ot+"."+Bi+"."+gr+"."+_n;if(_e!==null&&(bn+="."+_e),Q=v[bn],!Q){var Xi=ef(_,w,E,y),vr=void 0;"icon-offset"in At&&(vr=T(_,"layout","icon-offset",w,E,y,k).slice(0),vr[1]*=-1);var xn=_e?[_e.r*255,_e.g*255,_e.b*255,_e.a]:void 0;if(je){var _r={color:xn,rotateWithView:dn==="map",displacement:vr,declutterMode:Xi};typeof je=="string"?_r.src=je:(_r.img=je,_r.imgSize=[je.width,je.height]),Q=new pa(_r)}else{var le=i[Ot],Ue=void 0,wn=void 0,Wi=void 0,Yi=void 0;gr?(le.sdf?(Ue=Aa(Oa(u,le,_e),{x:0,y:0,width:le.width,height:le.height,pixelRatio:le.pixelRatio},gr,_n),xn=void 0):Ue=Aa(u,le,gr,_n),wn=[Ue.width,Ue.height]):(le.sdf?(h||(h=Oa(u,{x:0,y:0,width:l[0],height:l[1]},{r:1,g:1,b:1})),Ue=h):Ue=u,wn=l,Wi=[le.width,le.height],Yi=[le.x,le.y]),Q=new pa({color:xn,img:Ue,imgSize:wn,size:Wi,offset:Yi,rotateWithView:dn==="map",scale:Bi/le.pixelRatio,displacement:vr,declutterMode:Xi})}v[bn]=Q}}Q&&(++X,b=G[X],(!b||!b.getImage()||b.getFill()||b.getStroke())&&(b=new gt,G[X]=b),b.setGeometry(pn),Q.setRotation(Vi+Wn(T(_,"layout","icon-rotate",w,E,y,k))),Q.setOpacity(T(_,"paint","icon-opacity",w,E,y,k)),Q.setAnchor(Qh[T(_,"layout","icon-anchor",w,E,y,k)]),b.setImage(Q),D=b.getText(),b.setText(void 0),b.setZIndex(ct),pr=!0,cn=!1)}else cn=!0}}}if(pe==1&&_.type==="circle"){++X,b=G[X],(!b||!b.getImage()||b.getFill()||b.getStroke())&&(b=new gt,G[X]=b);var Hi="circle-radius"in qe?T(_,"paint","circle-radius",w,E,y,k):5,Cn=Ye(T(_,"paint","circle-stroke-color",w,E,y,k),T(_,"paint","circle-stroke-opacity",w,E,y,k)),En=Ye(T(_,"paint","circle-color",w,E,y,k),T(_,"paint","circle-opacity",w,E,y,k)),Tn=T(_,"paint","circle-stroke-width",w,E,y,k),Zi=Hi+"."+Cn+"."+En+"."+Tn;Q=v[Zi],Q||(Q=new Qs({radius:Hi,stroke:Cn&&Tn>0?new Er({width:Tn,color:Cn}):void 0,fill:En?new Tr({color:En}):void 0,declutterMode:"none"}),v[Zi]=Q),b.setImage(Q),D=b.getText(),b.setText(void 0),b.setGeometry(void 0),b.setZIndex(ct),pr=!0}var Z=void 0,qt=void 0,jt=void 0,Ie=void 0,Ut=void 0,kn=void 0;if("text-field"in At){Ie=Math.round(T(_,"layout","text-size",w,E,y,k));var Fn=T(_,"layout","text-font",w,E,y,k);jt=T(_,"layout","text-line-height",w,E,y,k),qt=ci(o?o(Fn,e.metadata?e.metadata["ol:webfonts"]:void 0):Fn,Ie,jt),qt.includes("sans-serif")||(qt+=",sans-serif"),Ut=T(_,"layout","text-letter-spacing",w,E,y,k),kn=T(_,"layout","text-max-width",w,E,y,k);var mt=T(_,"layout","text-field",w,E,y,k);typeof mt=="object"&&mt.sections?mt.sections.length===1?Z=mt.toString():Z=mt.sections.reduce(function($,Ge,hf){var na=Ge.fontStack?Ge.fontStack.split(","):Fn,In=ci(o?o(na):na,Ie*(Ge.scale||1),jt),yt=Ge.text;if(yt===`
`)return $.push(`
`,""),$;if(pe==2){$.push(pi(yt,Ut),In);return}yt=di(yt,In,kn,Ut).split(`
`);for(var xr=0,as=yt.length;xr<as;++xr)xr>0&&$.push(`
`,""),$.push(yt[xr],In);return $},[]):Z=Kn(mt,Nt).trim(),we=T(_,"paint","text-opacity",w,E,y,k)}if(Z&&we&&!cn){pr||(++X,b=G[X],(!b||!b.getText()||b.getFill()||b.getStroke())&&(b=new gt,G[X]=b),b.setImage(void 0),b.setGeometry(void 0)),b.getText()||b.setText(D||new $s({padding:[2,2,2,2]})),D=b.getText();var Ki=At["text-transform"];Ki=="uppercase"?Z=Array.isArray(Z)?Z.map(function($,Ge){return Ge%2?$:$.toUpperCase()}):Z.toUpperCase():Ki=="lowercase"&&(Z=Array.isArray(Z)?Z.map(function($,Ge){return Ge%2?$:$.toLowerCase()}):Z.toLowerCase());var Ji=Array.isArray(Z)?Z:pe==2?pi(Z,Ut):di(Z,qt,kn,Ut);D.setText(Ji),D.setFont(qt),D.setRotation(Wn(T(_,"layout","text-rotate",w,E,y,k)));var br=T(_,"layout","text-anchor",w,E,y,k),Vt=pr||pe==1?"point":T(_,"layout","symbol-placement",w,E,y,k),Bt=void 0;if(Vt==="line-center"?(D.setPlacement("line"),Bt="center"):D.setPlacement(Vt),Vt==="line"&&typeof D.setRepeat=="function"){var ns=T(_,"layout","symbol-spacing",w,E,y,k);D.setRepeat(ns*2)}D.setOverflow(Vt==="point");var Ve=T(_,"paint","text-halo-width",w,E,y,k),Qi=T(_,"layout","text-offset",w,E,y,k),$i=T(_,"paint","text-translate",w,E,y,k),Pn=0,Mn=0;if(Vt=="point"){Bt="center",br.indexOf("left")!==-1?(Bt="left",Mn=Ve):br.indexOf("right")!==-1&&(Bt="right",Mn=-Ve);var is=T(_,"layout","text-rotation-alignment",w,E,y,k);D.setRotateWithView(is=="map")}else D.setMaxAngle(Wn(T(_,"layout","text-max-angle",w,E,y,k))*Z.length/Ji.length),D.setRotateWithView(!1);D.setTextAlign(Bt);var Sn="middle";br.indexOf("bottom")==0?(Sn="bottom",Pn=-Ve-.5*(jt-1)*Ie):br.indexOf("top")==0&&(Sn="top",Pn=Ve+.5*(jt-1)*Ie),D.setTextBaseline(Sn);var ea=T(_,"layout","text-justify",w,E,y,k);D.setJustify(ea==="auto"?void 0:ea),D.setOffsetX(Qi[0]*Ie+Mn+$i[0]),D.setOffsetY(Qi[1]*Ie+Pn+$i[1]),ue.setColor(Ye(T(_,"paint","text-color",w,E,y,k),we)),D.setFill(ue);var ta=Ye(T(_,"paint","text-halo-color",w,E,y,k),we);if(ta){se.setColor(ta),Ve*=2;var ra=.5*Ie;se.setWidth(Ve<=ra?Ve:ra),D.setStroke(se)}else D.setStroke(void 0);var Xt=T(_,"layout","text-padding",w,E,y,k),Wt=D.getPadding();Xt!==Wt[0]&&(Wt[0]=Xt,Wt[1]=Xt,Wt[2]=Xt,Wt[3]=Xt),b.setZIndex(ct)}}}}}if(X>-1)return G.length=X+1,G}};return r.setStyle(te),r.set("mapbox-source",C),r.set("mapbox-layers",m),r.set("mapbox-featurestate",r.get("mapbox-featurestate")||{}),te}const qa=0,$t=1,ja=[0,0,0,0],Pt=[],Jn={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};class Qn extends vi{constructor(e,t,n){super(e),this.features=t,this.mapBrowserEvent=n}}class vf extends Qa{constructor(e){super(e),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=e.condition?e.condition:ou,this.defaultDeleteCondition_=function(n){return su(n)&&uu(n)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:ti,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new ai,this.pixelTolerance_=e.pixelTolerance!==void 0?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new bi({source:new Kt({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:sf(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.hitDetection_=null;let t;if(e.features?t=e.features:e.source&&(this.source_=e.source,t=new ei(this.source_.getFeatures()),this.source_.addEventListener(re.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(re.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!t)throw new Error("The modify interaction requires features, a source or a layer");e.hitDetection&&(this.hitDetection_=e.hitDetection),this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(Br.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(Br.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=e.snapToPointer===void 0?!this.hitDetection_:e.snapToPointer}addFeature_(e){const t=e.getGeometry();if(t){const i=this.SEGMENT_WRITERS_[t.getType()];i&&i(e,t)}const n=this.getMap();n&&n.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,n),e.addEventListener(Mt.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(e,t){if(!this.featuresBeingModified_){this.featuresBeingModified_=new ei;const n=this.featuresBeingModified_.getArray();for(let i=0,a=t.length;i<a;++i){const o=t[i];for(let s=0,u=o.length;s<u;++s){const l=o[s].feature;l&&!n.includes(l)&&this.featuresBeingModified_.push(l)}}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new Qn(Jn.MODIFYSTART,this.featuresBeingModified_,e))}}removeFeature_(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(Mt.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(e){const t=this.rBush_,n=[];t.forEach(function(i){e===i.feature&&n.push(i)});for(let i=n.length-1;i>=0;--i){const a=n[i];for(let o=this.dragSegments_.length-1;o>=0;--o)this.dragSegments_[o][0]===a&&this.dragSegments_.splice(o,1);t.remove(a)}}setActive(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(e)}setMap(e){this.overlay_.setMap(e),super.setMap(e)}getOverlay(){return this.overlay_}handleSourceAdd_(e){e.feature&&this.features_.push(e.feature)}handleSourceRemove_(e){e.feature&&this.features_.remove(e.feature)}handleFeatureAdd_(e){this.addFeature_(e.element)}handleFeatureChange_(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}}handleFeatureRemove_(e){this.removeFeature_(e.element)}writePointGeometry_(e,t){const n=t.getCoordinates(),i={feature:e,geometry:t,segment:[n,n]};this.rBush_.insert(t.getExtent(),i)}writeMultiPointGeometry_(e,t){const n=t.getCoordinates();for(let i=0,a=n.length;i<a;++i){const o=n[i],s={feature:e,geometry:t,depth:[i],index:i,segment:[o,o]};this.rBush_.insert(t.getExtent(),s)}}writeLineStringGeometry_(e,t){const n=t.getCoordinates();for(let i=0,a=n.length-1;i<a;++i){const o=n.slice(i,i+2),s={feature:e,geometry:t,index:i,segment:o};this.rBush_.insert(be(o),s)}}writeMultiLineStringGeometry_(e,t){const n=t.getCoordinates();for(let i=0,a=n.length;i<a;++i){const o=n[i];for(let s=0,u=o.length-1;s<u;++s){const l=o.slice(s,s+2),h={feature:e,geometry:t,depth:[i],index:s,segment:l};this.rBush_.insert(be(l),h)}}}writePolygonGeometry_(e,t){const n=t.getCoordinates();for(let i=0,a=n.length;i<a;++i){const o=n[i];for(let s=0,u=o.length-1;s<u;++s){const l=o.slice(s,s+2),h={feature:e,geometry:t,depth:[i],index:s,segment:l};this.rBush_.insert(be(l),h)}}}writeMultiPolygonGeometry_(e,t){const n=t.getCoordinates();for(let i=0,a=n.length;i<a;++i){const o=n[i];for(let s=0,u=o.length;s<u;++s){const l=o[s];for(let h=0,f=l.length-1;h<f;++h){const p=l.slice(h,h+2),c={feature:e,geometry:t,depth:[s,i],index:h,segment:p};this.rBush_.insert(be(p),c)}}}}writeCircleGeometry_(e,t){const n=t.getCenter(),i={feature:e,geometry:t,index:qa,segment:[n,n]},a={feature:e,geometry:t,index:$t,segment:[n,n]},o=[i,a];i.featureSegments=o,a.featureSegments=o,this.rBush_.insert(Ln(n),i);let s=t;this.rBush_.insert(s.getExtent(),a)}writeGeometryCollectionGeometry_(e,t){const n=t.getGeometriesArray();for(let i=0;i<n.length;++i){const a=n[i],o=this.SEGMENT_WRITERS_[a.getType()];o(e,a)}}createOrUpdateVertexFeature_(e,t,n){let i=this.vertexFeature_;return i?i.getGeometry().setCoordinates(e):(i=new ee(new Re(e)),this.vertexFeature_=i,this.overlay_.getSource().addFeature(i)),i.set("features",t),i.set("geometries",n),i}handleEvent(e){if(!e.originalEvent)return!0;this.lastPointerEvent_=e;let t;return!e.map.getView().getInteracting()&&e.type==he.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(e.type!=he.SINGLECLICK||!this.ignoreNextSingleClick_?t=this.removePoint():t=!0),e.type==he.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(e)&&!t}handleDragEvent(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_);const t=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],n=[],i=[];for(let a=0,o=this.dragSegments_.length;a<o;++a){const s=this.dragSegments_[a],u=s[0],l=u.feature;n.includes(l)||n.push(l);const h=u.geometry;i.includes(h)||i.push(h);const f=u.depth;let p;const c=u.segment,d=s[1];for(;t.length<h.getStride();)t.push(c[d][t.length]);switch(h.getType()){case"Point":p=t,c[0]=t,c[1]=t;break;case"MultiPoint":p=h.getCoordinates(),p[u.index]=t,c[0]=t,c[1]=t;break;case"LineString":p=h.getCoordinates(),p[u.index+d]=t,c[d]=t;break;case"MultiLineString":p=h.getCoordinates(),p[f[0]][u.index+d]=t,c[d]=t;break;case"Polygon":p=h.getCoordinates(),p[f[0]][u.index+d]=t,c[d]=t;break;case"MultiPolygon":p=h.getCoordinates(),p[f[1]][f[0]][u.index+d]=t,c[d]=t;break;case"Circle":if(c[0]=t,c[1]=t,u.index===qa)this.changingFeature_=!0,h.setCenter(t),this.changingFeature_=!1;else{this.changingFeature_=!0,e.map.getView().getProjection();let m=Wr(ce(h.getCenter()),ce(t));h.setRadius(m),this.changingFeature_=!1}break}p&&this.setGeometryCoordinates_(h,p)}this.createOrUpdateVertexFeature_(t,n,i)}handleDownEvent(e){if(!this.condition_(e))return!1;const t=e.coordinate;this.handlePointerAtPixel_(e.pixel,e.map,t),this.dragSegments_.length=0,this.featuresBeingModified_=null;const n=this.vertexFeature_;if(n){e.map.getView().getProjection();const i=[],a=n.getGeometry().getCoordinates(),o=be([a]),s=this.rBush_.getInExtent(o),u={};s.sort(of);for(let l=0,h=s.length;l<h;++l){const f=s[l],p=f.segment;let c=B(f.geometry);const d=f.depth;if(d&&(c+="-"+d.join("-")),u[c]||(u[c]=new Array(2)),f.geometry.getType()==="Circle"&&f.index===$t){const m=Va(t,f);Be(m,a)&&!u[c][0]&&(this.dragSegments_.push([f,0]),u[c][0]=f);continue}if(Be(p[0],a)&&!u[c][0]){this.dragSegments_.push([f,0]),u[c][0]=f;continue}if(Be(p[1],a)&&!u[c][1]){if(u[c][0]&&u[c][0].index===0){let m=f.geometry.getCoordinates();switch(f.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":m=m[d[1]];case"Polygon":if(f.index!==m[d[0]].length-2)continue;break}}this.dragSegments_.push([f,1]),u[c][1]=f;continue}B(p)in this.vertexSegments_&&!u[c][0]&&!u[c][1]&&this.insertVertexCondition_(e)&&i.push(f)}i.length&&this.willModifyFeatures_(e,[i]);for(let l=i.length-1;l>=0;--l)this.insertVertex_(i[l],a)}return!!this.vertexFeature_}handleUpEvent(e){for(let t=this.dragSegments_.length-1;t>=0;--t){const n=this.dragSegments_[t][0],i=n.geometry;if(i.getType()==="Circle"){const a=i.getCenter(),o=n.featureSegments[0],s=n.featureSegments[1];o.segment[0]=a,o.segment[1]=a,s.segment[0]=a,s.segment[1]=a,this.rBush_.update(Ln(a),o);let u=i;this.rBush_.update(u.getExtent(),s)}else this.rBush_.update(be(n.segment),n)}return this.featuresBeingModified_&&(this.dispatchEvent(new Qn(Jn.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}handlePointerMove_(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map,e.coordinate)}handlePointerAtPixel_(e,t,n){const i=n||t.getCoordinateFromPixel(e);t.getView().getProjection();const a=function(u,l){return Ua(i,u)-Ua(i,l)};let o,s;if(this.hitDetection_){const u=typeof this.hitDetection_=="object"?l=>l===this.hitDetection_:void 0;t.forEachFeatureAtPixel(e,(l,h,f)=>{f&&(f=new Re(ri(f.getCoordinates())));const p=f||l.getGeometry();if(p.getType()==="Point"&&l instanceof ee&&this.features_.getArray().includes(l)){s=p;const c=l.getGeometry().getFlatCoordinates().slice(0,2);o=[{feature:l,geometry:s,segment:[c,c]}]}return!0},{layerFilter:u})}if(!o){const u=Ha(Ln(i,ja)),l=t.getView().getResolution()*this.pixelTolerance_,h=Ja(Za(u,l,ja));o=this.rBush_.getInExtent(h)}if(o&&o.length>0){const u=o.sort(a)[0],l=u.segment;let h=Va(i,u);const f=t.getPixelFromCoordinate(h);let p=Wr(e,f);if(s||p<=this.pixelTolerance_){const c={};if(c[B(l)]=!0,this.snapToPointer_||(this.delta_[0]=h[0]-i[0],this.delta_[1]=h[1]-i[1]),u.geometry.getType()==="Circle"&&u.index===$t)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(h,[u.feature],[u.geometry]);else{const d=t.getPixelFromCoordinate(l[0]),m=t.getPixelFromCoordinate(l[1]),v=Xr(f,d),x=Xr(f,m);p=Math.sqrt(Math.min(v,x)),this.snappedToVertex_=p<=this.pixelTolerance_,this.snappedToVertex_&&(h=v>x?l[1]:l[0]),this.createOrUpdateVertexFeature_(h,[u.feature],[u.geometry]);const y={};y[B(u.geometry)]=!0;for(let S=1,C=o.length;S<C;++S){const I=o[S].segment;if(Be(l[0],I[0])&&Be(l[1],I[1])||Be(l[0],I[1])&&Be(l[1],I[0])){const j=B(o[S].geometry);j in y||(y[j]=!0,c[B(I)]=!0)}else break}}this.vertexSegments_=c;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(e,t){const n=e.segment,i=e.feature,a=e.geometry,o=e.depth,s=e.index;let u;for(;t.length<a.getStride();)t.push(0);switch(a.getType()){case"MultiLineString":u=a.getCoordinates(),u[o[0]].splice(s+1,0,t);break;case"Polygon":u=a.getCoordinates(),u[o[0]].splice(s+1,0,t);break;case"MultiPolygon":u=a.getCoordinates(),u[o[1]][o[0]].splice(s+1,0,t);break;case"LineString":u=a.getCoordinates(),u.splice(s+1,0,t);break;default:return}this.setGeometryCoordinates_(a,u);const l=this.rBush_;l.remove(e),this.updateSegmentIndices_(a,s,o,1);const h={segment:[n[0],t],feature:i,geometry:a,depth:o,index:s};l.insert(be(h.segment),h),this.dragSegments_.push([h,1]);const f={segment:[t,n[1]],feature:i,geometry:a,depth:o,index:s+1};l.insert(be(f.segment),f),this.dragSegments_.push([f,0]),this.ignoreNextSingleClick_=!0}removePoint(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=he.POINTERDRAG){const e=this.lastPointerEvent_;this.willModifyFeatures_(e,this.dragSegments_);const t=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new Qn(Jn.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null,t}return!1}removeVertex_(){const e=this.dragSegments_,t={};let n=!1,i,a,o,s,u,l,h,f,p,c,d;for(u=e.length-1;u>=0;--u)o=e[u],c=o[0],d=B(c.feature),c.depth&&(d+="-"+c.depth.join("-")),d in t||(t[d]={}),o[1]===0?(t[d].right=c,t[d].index=c.index):o[1]==1&&(t[d].left=c,t[d].index=c.index+1);for(d in t){switch(p=t[d].right,h=t[d].left,l=t[d].index,f=l-1,h!==void 0?c=h:c=p,f<0&&(f=0),s=c.geometry,a=s.getCoordinates(),i=a,n=!1,s.getType()){case"MultiLineString":a[c.depth[0]].length>2&&(a[c.depth[0]].splice(l,1),n=!0);break;case"LineString":a.length>2&&(a.splice(l,1),n=!0);break;case"MultiPolygon":i=i[c.depth[1]];case"Polygon":i=i[c.depth[0]],i.length>4&&(l==i.length-1&&(l=0),i.splice(l,1),n=!0,l===0&&(i.pop(),i.push(i[0]),f=i.length-1));break}if(n){this.setGeometryCoordinates_(s,a);const m=[];if(h!==void 0&&(this.rBush_.remove(h),m.push(h.segment[0])),p!==void 0&&(this.rBush_.remove(p),m.push(p.segment[1])),h!==void 0&&p!==void 0){const v={depth:c.depth,feature:c.feature,geometry:c.geometry,index:f,segment:m};this.rBush_.insert(be(v.segment),v)}this.updateSegmentIndices_(s,l,c.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return n}setGeometryCoordinates_(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1}updateSegmentIndices_(e,t,n,i){this.rBush_.forEachInExtent(e.getExtent(),function(a){a.geometry===e&&(n===void 0||a.depth===void 0||Ka(a.depth,n))&&a.index>t&&(a.index+=i)})}}function of(r,e){return r.index-e.index}function Ua(r,e,t){const n=e.geometry;if(n.getType()==="Circle"){let a=n;if(e.index===$t){const o=Xr(a.getCenter(),ce(r)),s=Math.sqrt(o)-a.getRadius();return s*s}}const i=ce(r);return Pt[0]=ce(e.segment[0]),Pt[1]=ce(e.segment[1]),hu(i,Pt)}function Va(r,e,t){const n=e.geometry;if(n.getType()==="Circle"&&e.index===$t)return ri(n.getClosestPoint(ce(r)));const i=ce(r);return Pt[0]=ce(e.segment[0]),Pt[1]=ce(e.segment[1]),ri(lu(i,Pt))}function sf(){const r=$a();return function(e,t){return r.Point}}function uf(r){return/^[0-9a-fA-F]+$/.test(r)&&r.length%2===0}function lf(r){const e=["POINT","LINESTRING","MULTILINESTRING","POLYGON","MULTIPOLYGON","GEOMETRYCOLLECTION"],t=r.toUpperCase().trim();return e.some(n=>t.startsWith(n))}function _f(r){return uf(r)?"hexewkb":lf(r)?"wkt":"unknown"}const bf=r=>{const e=new to,t=new ao,n=new Uint8Array(r.match(/[\da-f]{2}/gi).map(a=>parseInt(a,16))),i=e.readGeometry(n);return t.writeGeometry(i)},xf=(r,e)=>r.length===3||!e?r:[...r,0],wf={googleLayerRoadmap:new K({url:"https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}"}),googleLayerSatellite:new K({url:"https://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}"}),googleLayerRoadNames:new K({url:"https://mt1.google.com/vt/lyrs=h&x={x}&y={y}&z={z}"}),osm:new K({url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),otm:new K({url:"https://{a-c}.tile.opentopomap.org/{z}/{x}/{y}.png"}),esriLayerStreet:new K({url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}"}),esriLayerTopo:new K({url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}"}),iMap:new K({url:"https://cloudgis.mn/map01/Tilemap/demo/{z}/{x}/{y}.png?mskey=12345"})};export{yf as D,ee as F,vf as M,bi as V,ao as W,Kt as a,bf as b,gf as c,cf as d,mf as e,df as f,pf as g,wf as h,_f as i,xf as t};
