import{D as f,E as d,F as r,H as c,J as v,L as m,I as l,G as o,O as g,N as h,aa as x,am as U}from"./DXHvmmg6.js";import{_ as k,h as C}from"./BGcy_aHF.js";import"./B4FiMg9Z.js";import{a as b}from"./CByKS65z.js";const w={props:["refresh","exportExcel","print","search","save","options","isExcel","isExcelUpload","excelUploadCustomUrl","excelUploadMethod","isPrint","isRefresh","isSave","isSearch","exportLoading"],data(){return{searchModel:null}},computed:{lang(){const s=["_save","re_call","_print","download_file","excelUpload"];return s.reduce((e,t,p)=>(e[t]=this.$t("crud."+s[p]),e),{})}},methods:{searchGrid(s){s.preventDefault(),this.$props.search(this.searchModel)}}},I={class:"crud-page-header-right-inside action"},L={class:"svg-icon"},E=["href"],S={class:"svg-icon"},M={class:"svg-icon"},D={key:0,class:"btnLine",href:"javascript:void(0)"},$={class:"svg-icon"},N={class:"right-search"},F=["placeholder"];function V(s,e,t,p,i,n){const u=f("a-tooltip"),_=f("inline-svg"),y=f("a-spin");return r(),d("div",I,[c(u,null,{title:l(()=>[g(h(n.lang._save),1)]),default:l(()=>[t.isSave?(r(),d("a",{key:0,onClick:e[0]||(e[0]=(...a)=>s.$props.save&&s.$props.save(...a)),class:"btnLine"},e[7]||(e[7]=[o("i",{class:"ti-save"},null,-1)]))):m("",!0)]),_:1}),c(u,null,{title:l(()=>[g(h(n.lang.re_call),1)]),default:l(()=>[t.isRefresh?(r(),d("a",{key:0,onClick:e[1]||(e[1]=(...a)=>s.$props.refresh&&s.$props.refresh(...a)),class:"btnLine"},e[8]||(e[8]=[o("i",{class:"ti-reload"},null,-1)]))):m("",!0)]),_:1}),t.isPrint?(r(),v(u,{key:0},{title:l(()=>[g(h(n.lang._print),1)]),default:l(()=>[o("span",{class:"btn btn-icon",onClick:e[2]||(e[2]=(...a)=>s.$props.print&&s.$props.print(...a))},[o("span",L,[c(_,{src:"/assets/icons/duotone/Devices/Printer.svg"})])])]),_:1})):m("",!0),t.isExcelUpload?(r(),v(u,{key:1},{title:l(()=>[g(h(n.lang.excelUpload),1)]),default:l(()=>[s.$props.excelUploadCustomUrl?(r(),d("span",{key:0,class:"btn btn-icon",href:s.$props.excelUploadCustomUrl},[o("span",S,[c(_,{src:"/assets/icons/duotone/Files/Upload.svg"})])],8,E)):(r(),d("span",{key:1,class:"btn btn-icon",onClick:e[3]||(e[3]=(...a)=>s.$props.excelUploadMethod&&s.$props.excelUploadMethod(...a))},[o("span",M,[c(_,{src:"/assets/icons/duotone/Files/Upload.svg"})])]))]),_:1})):m("",!0),t.isExcel?(r(),v(u,{key:2},{title:l(()=>[g(h(n.lang.download_file),1)]),default:l(()=>[s.$props.exportLoading?(r(),d("a",D,[c(y)])):(r(),d("span",{key:1,class:"btn btn-icon",onClick:e[4]||(e[4]=(...a)=>s.$props.exportExcel&&s.$props.exportExcel(...a))},[o("span",$,[c(_,{src:"/assets/icons/duotone/Files/Download.svg"})])]))]),_:1})):m("",!0),t.isSearch?(r(),d("form",{key:3,onSubmit:e[6]||(e[6]=(...a)=>n.searchGrid&&n.searchGrid(...a))},[o("div",N,[x(o("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>i.searchModel=a),placeholder:s.$t("dataForm.search"),class:"right-search-input"},null,8,F),[[U,i.searchModel]]),e[9]||(e[9]=o("i",{class:"ti-search"},null,-1))])],32)):m("",!0)])}const J=k(w,[["render",V]]),B={name:"crudLog",props:["form","grid","rowId"],data(){return{logs:[],reads:[],logColumns:[{title:"Бүртгэлийн төрөл",dataIndex:"action",key:"action"},{title:"Хэрэглэгч",dataIndex:"user",key:"user"},{title:"Огноо",dataIndex:"created_at",key:"created_at"}],readColumns:[{title:"Хэрэглэгч",dataIndex:"user",key:"user"},{title:"Огноо",dataIndex:"created_at",key:"created_at"}]}},computed:{lang(){const s=["registration_history","Information_viewing_history"];return s.reduce((e,t,p)=>(e[t]=this.$t("crud."+s[p]),e),{})}},methods:{getLog(){this.logs=[],this.reads=[],C.post("/crud_log/history",{schemaId:this.form,rowId:this.rowId}).then(s=>{s.data.forEach(e=>{let t=b(e.created_at);const p=e.last_name?e.last_name.charAt(0)+".":"";e.action!=="view"&&this.logs.push({action:e.action=="store"?"Бүртгэсэн":"Зассан",user:p+e.first_name,created_at:t}),e.action==="view"&&this.reads.push({user:p+e.first_name,created_at:t})})})}},watch:{rowId(){this.getLog()}},mounted(){this.getLog()}},G={class:"crud-log"},P={class:"fieldset"},T={class:"fieldset"};function z(s,e,t,p,i,n){const u=f("a-table");return r(),d("div",G,[o("div",P,[o("legend",null,h(n.lang.registration_history),1),c(u,{columns:i.logColumns,dataSource:i.logs,size:"small",height:i.logs.length>=3?200:100},null,8,["columns","dataSource","height"])]),o("div",T,[o("legend",null,h(n.lang.Information_viewing_history),1),c(u,{columns:i.readColumns,dataSource:i.reads,size:"small",height:i.reads.length>=3?200:80},null,8,["columns","dataSource","height"])])])}const O=k(B,[["render",z]]);export{J as K,O as c};
