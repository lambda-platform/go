import{h as _e,aV as me}from"./BNUQ0oDs.js";import{c as n,i as Q,f as y,a as we,aN as xe,a6 as C,o as I,q as l,x as d,z as _,A as x,y as a,D,F as P,N as X,C as M,E as U,B as ye}from"./Bb3cLOD_.js";function Fe(t,r,o,u=void 0,m=void 0,p=void 0,w,R){const{proxy:k}=we(),S=n(!0),v=n(""),b=n(""),f=n(!1),j=n(""),E=n(600),A=n(!1),V=n(!1),L=n(!1),z=n(!1),$=n(!1),i=n(null),T=n(null),Y=n(!1),q=n(!1),Z=n(null),G=n(window.init&&window.init.showID?window.init.showID:void 0),ee=Q("screenRecordTargets",[]),te=Q("screenRecordSavePath",""),h=n(null),B=n([]);let g=null;const ne=(e,s)=>{e==="isExcel"?L.value=s:e==="isPrint"?V.value=s:e==="isRefresh"?z.value=s:e==="isSave"?$.value=s:e==="isExcelUpload"&&(q.value=s)},W=()=>new Promise((e,s)=>{xe.confirm({title:"Анхааруулга",content:"Систем таны дэлгэцийг бичиж хадгалах болно. Та зөвшөөрч байна уу?",okText:"Зөвшөөрөх",cancelText:"Цуцлах",onOk(){e(!0)},onCancel(){console.log("Cancelled"),e(!1)}})}),K=async()=>{try{return g=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1}),g.getVideoTracks()[0].getSettings().displaySurface!=="monitor"?(C.error("Бичлэг хийхийн тулд бүтэн дэлгэцийг сонгоно уу."),g.getTracks().forEach(c=>c.stop()),!1):(h.value=new MediaRecorder(g),h.value.ondataavailable=c=>{c.data.size>0&&B.value.push(c.data)},h.value.onstop=async()=>{const c=new Blob(B.value,{type:"video/webm"}),O=new FormData;O.append("file",c,"recording.webm");try{const N=await _e.post(te,O,{headers:{"Content-Type":"multipart/form-data"}});C.success("Амжилттай дэлгэцийн бичлэг"),console.log("Амжилттай орууллаа:",N.data),g.getTracks().forEach(ge=>ge.stop())}catch(N){C.error("Оруулахад алдаа гарлаа"),console.error("Оруулахад алдаа гарлаа:",N)}},h.value.start(),!0)}catch(e){return C.error("Дэлгэцийн медиа руу хандахад алдаа гарлаа."),console.error("Дэлгэцийн медиа руу хандахад алдаа гарлаа.",e),!1}},F=()=>{h.value&&setTimeout(()=>{h.value.stop(),g&&g.getTracks().forEach(e=>e.stop())},300)},oe=async()=>ee.findIndex(s=>s===R)>-1?await W()?await K():!1:!0,se=y(()=>!!k.$slots["v-nav"]),ae=y(()=>!!k.$slots.nav),ie=y(()=>!!k.$slots.left),ce=y(()=>{if(t.projects_id!==null&&t.projects_id!=""&&t.projects_id!=null&&window.init&&window.init.microserviceSettings&&window.init.microserviceSettings.length>=1){let e=window.init.microserviceSettings.findIndex(s=>s.project_id==t.projects_id);if(e>=0)return window.microservice_dev?window.init.microserviceSettings[e].dev_url:window.init.microserviceSettings[e].production_url}return t.base_url?t.base_url:""}),H=["_add","Information_viewing_history","excelUpload"],le=y(()=>H.reduce((e,s,c)=>(e[s]=w("crud."+H[c]),e),{})),re=e=>{i.value=e,f.value=!0,r.value.viewMode=!0,r.value.editModel(e),u&&u()},ue=e=>{i.value=e,f.value=!0,r.value.editModel(e),u&&u(e)},de=e=>{r.value.cloneModel(e),u&&u(e)},ve=e=>{console.log(e)},fe=()=>{j.value=null,o.value.refresh()},he=e=>{o.value.searchData(e,1)},J=e=>{A.value=!1,e||C.error("Татах үед алдаа гарлаа!")};return{closeByBtn:S,gridSrc:v,formSrc:b,editMode:f,searchModel:j,form_width:E,exportLoading:A,isPrint:V,isExcel:L,isRefresh:z,isSave:$,rowId:i,cloneID:T,visibleDataForm:Y,isExcelUpload:q,excelUploadCustomUrl:Z,showID:G,hasVNavSlot:se,hasNavSlot:ae,hasLeftSlot:ie,url:ce,lang:le,view:re,edit:ue,clone:de,quickEdit:ve,refresh:fe,search:he,stopLoading:J,exportExcel:()=>{A.value=!0,o.value.exportExcel(J)},print:()=>{o.value.print()},excelUploadMethod:()=>{o.value.importExcel()},save:()=>{o.value.saveGridData()},onReady:e=>{window.innerWidth-100>=parseInt(e.width)?E.value=e.width:E.value=window.innerWidth,f.value&&i.value!==null&&i.value!==void 0&&T.value===null?r.value.editModel(i.value):f.value&&i.value!==null&&i.value!==void 0&&T.value!==null&&r.value.cloneModel(i.value)},onSuccess:e=>{o&&o.value&&(typeof t.mode<"u"&&t.mode&&t.mode==="refresh"?o.value.refresh():f.value?o.value.update(e):o.value.append(e)),f.value=!1,i.value=null,T.value=null,m&&m(e),t.onPropertySuccess&&t.onPropertySuccess(),F()},onError:()=>{t.onPropertyError&&t.onPropertyError(),p&&p()},mediaRecorder:h,recordedChunks:B,showScreenRecordConfirm:W,startRecording:K,stopRecording:F,recordAndDoAction:oe,changeKrudTool:ne}}const pe={class:"flex"},ke={class:"page-title"},Se={class:"float-left"},be={class:"text-gray-700 dark:text-gray-200 text-base m-0"},Ce={class:"text-gray-400 text-xs m-0"},De={key:0},Re={key:0,class:"ml-3"},Te=a("span",{class:"divider"},null,-1),Ie={class:"anticon align-top ant-btn-svg-icon",style:{"vertical-align":"top"}},Me={class:"page-title mb-3"},Ee={class:"text-gray-700 dark:text-gray-200 text-base m-0"},Ae={class:"text-gray-400 text-xs m-0"},Be={key:0},Ne={class:"fixed bottom-14 right-2"},Pe={class:"settings-btn ant-btn-svg-icon"},He={__name:"common",props:{parent:Object,addAction:Function,title:String,hideAction:Boolean,permissions:Object,CRUD_ID:[Number,String]},setup(t){const{t:r}=me(),o=["_add","Information_viewing_history","excelUpload"],u=y(()=>o.reduce((m,p,w)=>(m[p]=r("crud."+o[w]),m),{}));return(m,p)=>{const w=I("inline-svg"),R=I("a-button"),k=I("portal-target"),S=I("portal");return l(),d(P,null,[_(S,{to:"header-left"},{default:x(()=>[a("div",pe,[a("div",ke,[a("div",Se,[a("h1",be,D(t.title),1),a("h2",Ce,[(l(!0),d(P,null,X(t.parent,(v,b)=>(l(),d("span",{key:v.index},[b>=1?(l(),d("span",De," / ")):M("",!0),U(D(v.title),1)]))),128))])])]),!t.hideAction&&t.permissions.c?(l(),d("div",Re,[Te,_(R,{type:"primary",onClick:t.addAction,shape:"round"},{icon:x(()=>[a("span",Ie,[_(w,{src:"/assets/icons/duotune/general/gen041.svg"})])]),default:x(()=>[U(" "+D(u.value._add),1)]),_:1},8,["onClick"])])):M("",!0),_(k,{name:"grid-left"})])]),_:1}),_(S,{to:"mobile-page-title"},{default:x(()=>[a("div",Me,[a("div",null,[a("h1",Ee,D(t.title),1),a("h2",Ae,[(l(!0),d(P,null,X(t.parent,(v,b)=>(l(),d("span",{key:v.index},[b>=1?(l(),d("span",Be," / ")):M("",!0),U(D(v.title),1)]))),128))])])])]),_:1}),!t.hideAction&&t.permissions.c?(l(),ye(S,{key:0,to:"header-mobile"},{default:x(()=>[a("div",Ne,[_(R,{type:"primary",onClick:t.addAction,shape:"circle",size:"large"},{icon:x(()=>[a("span",Pe,[_(w,{src:"/assets/icons/duotune/general/gen041.svg"})])]),_:1},8,["onClick"])])]),_:1})):M("",!0)],64)}}};export{He as _,Fe as u};
