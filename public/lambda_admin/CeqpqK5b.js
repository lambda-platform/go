import{m as h}from"./DugTeqwv.js";import{_ as u}from"./3ncfVO38.js";import{D as s,E as f,F as _,H as m,I as v,G as p,N as c}from"./DXHvmmg6.js";import"./2tDPZFmp.js";import"./BYTvHWBW.js";import"./CYxtEuKL.js";const C={mixins:[h],data(){return{map:null,center:{lat:47.9197668,lng:106.9183483},zoom:11,marker:null,fromCityCenter:0}},computed:{coordinate(){return this.model.form[this.model.component]},lang(){const t=["fromCityCenter","latitude","longitude"];return t.reduce((e,l,o)=>(e[l]=this.$t("dataGrid."+t[o]),e),{})}},watch:{coordinate(t,e){if((e&&!t||t&&!e)&&t){let l=JSON.parse(t);this.center={lat:parseFloat(l.lat),lng:parseFloat(l.lng)},this.init()}}},mounted(){this.init()},methods:{init(){this.map=new google.maps.Map(this.$el.getElementsByClassName("lambda-map")[0],{zoom:this.zoom,center:this.center}),this.marker=new google.maps.Marker({map:this.map,draggable:!0,animation:google.maps.Animation.DROP,position:this.center}),google.maps.event.addListener(this.map,"click",t=>{this.model.form[this.model.component]=JSON.stringify(t.latLng),this.marker.setPosition(t.latLng)}),this.marker.addListener("position_changed",this.moveEvent.bind(this))},calcDistance(t,e){let l=47.91854,o=106.917658,n=.017453292519943295,a=Math.cos,i=.5-a((t-l)*n)/2+a(l*n)*a(t*n)*(1-a((e-o)*n))/2;this.fromCityCenter=(12742*Math.asin(Math.sqrt(i))).toFixed(2)},moveEvent(){this.center={lat:this.marker.getPosition().lat().toFixed(7),lng:this.marker.getPosition().lng().toFixed(7)},this.calcDistance(this.center.lat,this.center.lng),new google.maps.LatLng(this.center.lat,this.center.lng),this.model.form[this.model.component]=JSON.stringify(this.center)},updateLat(t){this.center.lat=parseFloat(t.target.value).toFixed(7);let e=new google.maps.LatLng(this.center.lat,this.center.lng);this.marker.setPosition(e)},updateLng(t){this.center.lng=parseFloat(t.target.value).toFixed(7);let e=new google.maps.LatLng(this.center.lat,this.center.lng);this.marker.setPosition(e)}}},L={class:"lambda-map-wrapper"},k={class:"lambda-lat-lng"};function b(t,e,l,o,n,a){const i=s("a-input"),d=s("Input"),g=s("lambda-form-item");return _(),f("div",L,[m(g,{label:t.label,name:t.model.component,meta:t.meta},{default:v(()=>[p("div",k,[m(i,{value:n.center.lat,"onUpdate:value":e[0]||(e[0]=r=>n.center.lat=r),placeholder:a.lang.latitude,onOnBlur:a.updateLat},null,8,["value","placeholder","onOnBlur"]),m(d,{value:n.center.lng,"onUpdate:value":e[1]||(e[1]=r=>n.center.lng=r),placeholder:a.lang.longitude},null,8,["value","placeholder"])]),p("span",null,c(a.lang.fromCityCenter)+": "+c(n.fromCityCenter)+" км",1),e[2]||(e[2]=p("div",{class:"lambda-map"},null,-1))]),_:1,__:[2]},8,["label","name","meta"])])}const M=u(C,[["render",b]]);export{M as default};
