import{B as M,r as T,s as $,v as B,w as F,x as V,y as K,z as A,A as R,D as q}from"./Qfm9_UtH.js";import{b as k}from"./Dp5pR5g4.js";import{c as S,o as N,q as o,B as x,A as u,x as c,N as C,y as n,u as O,D as L,F as b,C as P}from"./Bb3cLOD_.js";const r={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class Ee extends M{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+T,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(r.ELEMENT,this.handleElementChanged),this.addChangeListener(r.MAP,this.handleMapChanged),this.addChangeListener(r.OFFSET,this.handleOffsetChanged),this.addChangeListener(r.POSITION,this.handlePositionChanged),this.addChangeListener(r.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(r.ELEMENT)}getId(){return this.id}getMap(){return this.get(r.MAP)||null}getOffset(){return this.get(r.OFFSET)}getPosition(){return this.get(r.POSITION)}getPositioning(){return this.get(r.POSITIONING)}handleElementChanged(){$(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){this.mapPostrenderListenerKey&&(B(this.element),F(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=V(e,K.POSTRENDER,this.render,this),this.updatePixelPosition();const i=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?i.insertBefore(this.element,i.childNodes[0]||null):i.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(r.ELEMENT,e)}setMap(e){this.set(r.MAP,e)}setOffset(e){this.set(r.OFFSET,e)}setPosition(e){this.set(r.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const i=this.getMap();if(!i||!i.getTargetElement()||!this.get(r.POSITION))return;const l=this.getRect(i.getTargetElement(),i.getSize()),h=this.getElement(),s=this.getRect(h,[A(h),R(h)]);e=e||{};const v=e.margin===void 0?20:e.margin;if(!q(l,s)){const w=s[0]-l[0],a=l[2]-s[2],d=s[1]-l[1],y=l[3]-s[3],f=[0,0];if(w<0?f[0]=w-v:a<0&&(f[0]=Math.abs(a)+v),d<0?f[1]=d-v:y<0&&(f[1]=Math.abs(y)+v),f[0]!==0||f[1]!==0){const _=i.getView().getCenterInternal(),g=i.getPixelFromCoordinateInternal(_);if(!g)return;const t=[g[0]+f[0],g[1]+f[1]],m=e.animation||{};i.getView().animateInternal({center:i.getCoordinateFromPixelInternal(t),duration:m.duration,easing:m.easing})}}}getRect(e,i){const l=e.getBoundingClientRect(),h=l.left+window.pageXOffset,s=l.top+window.pageYOffset;return[h,s,h+i[0],s+i[1]]}setPositioning(e){this.set(r.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),i=this.getPosition();if(!e||!e.isRendered()||!i){this.setVisible(!1);return}const l=e.getPixelFromCoordinate(i),h=e.getSize();this.updateRenderedPosition(l,h)}updateRenderedPosition(e,i){const l=this.element.style,h=this.getOffset(),s=this.getPositioning();this.setVisible(!0);const v=Math.round(e[0]+h[0])+"px",w=Math.round(e[1]+h[1])+"px";let a="0%",d="0%";s=="bottom-right"||s=="center-right"||s=="top-right"?a="-100%":(s=="bottom-center"||s=="center-center"||s=="top-center")&&(a="-50%"),s=="bottom-left"||s=="bottom-center"||s=="bottom-right"?d="-100%":(s=="center-left"||s=="center-center"||s=="center-right")&&(d="-50%");const y=`translate(${a}, ${d}) translate(${v}, ${w})`;this.rendered.transform_!=y&&(this.rendered.transform_=y,l.transform=y)}getOptions(){return this.options}}const U={class:"flex"},j=["src"],z={class:"dark:text-white"},D={key:0,width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},G=["fill","stroke"],H={key:1,width:"18",height:"3",viewBox:"0 0 18 3",fill:"none",xmlns:"http://www.w3.org/2000/svg"},X=["fill"],Y=["src"],Z=["onClick"],W={class:"w-52 whitespace-normal",style:{"line-height":"20px !important"}},J={class:"dark:text-white"},Q=["src"],ee={key:0,width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},te=["fill","stroke"],se={key:1,width:"18",height:"3",viewBox:"0 0 18 3",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ie=["fill"],ne=["src"],oe=["onClick"],re={class:"w-52 whitespace-normal",style:{"line-height":"20px !important"}},le={class:"dark:text-white"},ae=["src"],he={key:0,width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ce=["fill","stroke"],de={key:1,width:"18",height:"3",viewBox:"0 0 18 3",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ge=["fill"],me=["src"],ue=["onClick"],fe={class:"w-52 whitespace-normal",style:{"line-height":"20px !important"}},_e={class:"dark:text-white"},pe=["src"],xe={__name:"LayerList",props:{categories:Array,user:null},emits:["changeLayerUniqueVisible","changeLayerVisible"],setup(E,{emit:e}){const i=e,l=S([]),h=S([]);function s(w,a){i("changeLayerVisible",w,a)}function v(w,a,d){i("changeLayerUniqueVisible",w,a,d)}return(w,a)=>{const d=N("a-menu-item"),y=N("a-sub-menu"),f=N("a-menu");return o(),x(f,{openKeys:l.value,"onUpdate:openKeys":a[0]||(a[0]=_=>l.value=_),selectedKeys:h.value,"onUpdate:selectedKeys":a[1]||(a[1]=_=>h.value=_),style:{width:"100%"},mode:"inline",class:"map-layer-list"},{default:u(()=>[(o(!0),c(b,null,C(E.categories,(_,g)=>(o(),x(y,{key:`category-${g}`},{icon:u(()=>[n("div",U,[n("img",{alt:"",class:"w-5 h-5 flex-none text-white transition-all duration-300 group-icon",src:`${O(k)}${_.icon}`},null,8,j)])]),title:u(()=>[n("span",z,L(_.layer_category),1)]),default:u(()=>[(o(!0),c(b,null,C(_.layers.filter(t=>!t.unique_value_field&&t.legends.length&&t.legends.length>0&&(!t.is_permission||t.is_permission&&E.user&&t.permissions.some(m=>m.role_id===E.user.role))),(t,m)=>(o(),x(d,{key:`layer-${g}-${m}`},{icon:u(()=>[t.geometry_type==="Polygon"?(o(),c("svg",D,[n("path",{d:"M14.5 7.31843V14H0.5V0.785098L14.5 7.31843Z",fill:t.legends[0].fill_color,stroke:t.legends[0].stroke_color},null,8,G)])):P("",!0),t.geometry_type==="LineString"?(o(),c("svg",H,[n("rect",{width:"18",height:"3",fill:t.legends[0].fill_color},null,8,X)])):P("",!0),t.geometry_type==="Point"?(o(),c("img",{key:2,alt:"",class:"w-6 h-6",src:`${O(k)}${t.legends[0].marker}`},null,8,Y)):P("",!0)]),default:u(()=>[n("div",{onClick:p=>s(g,t.id),class:"cursor-pointer flex items-center justify-between py-3"},[n("div",W,[n("span",J,L(t.layer_title),1)]),n("img",{alt:"",class:"w-4 h-4",src:t.is_visible?"/otorImage/image/Eye.svg":"/otorImage/image/Eyeclose.svg"},null,8,Q)],8,Z)]),_:2},1024))),128)),(o(!0),c(b,null,C(_.layers.filter(t=>t.unique_value_field&&t.legends.length&&t.legends.length>0&&(!t.is_permission||t.is_permission&&E.user&&t.permissions.some(m=>m.role_id===E.user.role))),(t,m)=>(o(),x(y,{key:`layer-${g}-${m}`},{icon:u(()=>[t.geometry_type==="Polygon"?(o(),c("svg",ee,[n("path",{d:"M14.5 7.31843V14H0.5V0.785098L14.5 7.31843Z",fill:t.legends[0].fill_color,stroke:t.legends[0].stroke_color},null,8,te)])):P("",!0),t.geometry_type==="LineString"?(o(),c("svg",se,[n("rect",{width:"18",height:"3",fill:t.legends[0].fill_color},null,8,ie)])):P("",!0),t.geometry_type==="Point"?(o(),c("img",{key:2,alt:"",class:"w-6 h-6",src:`${O(k)}${t.legends[0].marker}`},null,8,ne)):P("",!0)]),title:u(()=>[n("div",{onClick:p=>s(g,t.id),class:"cursor-pointer flex items-center justify-between py-3 max-w-80px mr-6"},[n("div",re,[n("span",le,L(t.layer_title),1)]),n("img",{alt:"",class:"w-4 h-4 cursor-pointer",src:t.is_visible?"/otorImage/image/Eye.svg":"/otorImage/image/Eyeclose.svg"},null,8,ae)],8,oe)]),default:u(()=>[(o(!0),c(b,null,C(t.legends,(p,I)=>(o(),x(d,{key:`legend-${g}-${m}-${I}`},{icon:u(()=>[p.geometry_type==="Polygon"?(o(),c("svg",he,[n("path",{d:"M14.5 7.31843V14H0.5V0.785098L14.5 7.31843Z",fill:p.fill_color,stroke:p.stroke_color},null,8,ce)])):P("",!0),t.geometry_type==="LineString"?(o(),c("svg",de,[n("rect",{width:"18",height:"3",fill:t.legends[0].fill_color},null,8,ge)])):P("",!0),p.geometry_type==="Point"?(o(),c("img",{key:2,alt:"",class:"w-6 h-6",src:`${O(k)}${p.marker}`},null,8,me)):P("",!0)]),default:u(()=>[n("div",{onClick:we=>v(g,t,p),class:"cursor-pointer flex items-center justify-between py-3"},[n("div",fe,[n("span",_e,L(p.unique_value_label),1)]),n("img",{alt:"",class:"w-4 h-4",src:p.unique_visible?"/otorImage/image/Eye.svg":"/otorImage/image/Eyeclose.svg"},null,8,pe)],8,ue)]),_:2},1024))),128))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1},8,["openKeys","selectedKeys"])}}};export{Ee as O,xe as _};
