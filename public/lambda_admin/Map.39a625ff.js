import{m as h}from"./_mixin.cf6a452e.js";import{_ as u,r,o as f,c as _,b as m,w as v,a as c,t as p}from"./entry.44501f88.js";const C={mixins:[h],data(){return{map:null,center:{lat:47.9197668,lng:106.9183483},zoom:11,marker:null,fromCityCenter:0}},computed:{coordinate(){return this.model.form[this.model.component]},lang(){const t=["fromCityCenter","latitude","longitude"];return t.reduce((e,l,o)=>(e[l]=this.$t("dataGrid."+t[o]),e),{})}},watch:{coordinate(t,e){if((e&&!t||t&&!e)&&t){let l=JSON.parse(t);this.center={lat:parseFloat(l.lat),lng:parseFloat(l.lng)},this.init()}}},mounted(){this.init()},methods:{init(){this.map=new google.maps.Map(this.$el.getElementsByClassName("lambda-map")[0],{zoom:this.zoom,center:this.center}),this.marker=new google.maps.Marker({map:this.map,draggable:!0,animation:google.maps.Animation.DROP,position:this.center}),google.maps.event.addListener(this.map,"click",t=>{this.model.form[this.model.component]=JSON.stringify(t.latLng),this.marker.setPosition(t.latLng)}),this.marker.addListener("position_changed",this.moveEvent.bind(this))},calcDistance(t,e){let l=47.91854,o=106.917658,n=.017453292519943295,a=Math.cos,i=.5-a((t-l)*n)/2+a(l*n)*a(t*n)*(1-a((e-o)*n))/2;this.fromCityCenter=(12742*Math.asin(Math.sqrt(i))).toFixed(2)},moveEvent(){this.center={lat:this.marker.getPosition().lat().toFixed(7),lng:this.marker.getPosition().lng().toFixed(7)},this.calcDistance(this.center.lat,this.center.lng),new google.maps.LatLng(this.center.lat,this.center.lng),this.model.form[this.model.component]=JSON.stringify(this.center)},updateLat(t){this.center.lat=parseFloat(t.target.value).toFixed(7);let e=new google.maps.LatLng(this.center.lat,this.center.lng);this.marker.setPosition(e)},updateLng(t){this.center.lng=parseFloat(t.target.value).toFixed(7);let e=new google.maps.LatLng(this.center.lat,this.center.lng);this.marker.setPosition(e)}}},L={class:"lambda-map-wrapper"},b={class:"lambda-lat-lng"},k=c("div",{class:"lambda-map"},null,-1);function w(t,e,l,o,n,a){const i=r("a-input"),d=r("Input"),g=r("lambda-form-item");return f(),_("div",L,[m(g,{label:t.label,name:t.model.component,meta:t.meta},{default:v(()=>[c("div",b,[m(i,{value:n.center.lat,"onUpdate:value":e[0]||(e[0]=s=>n.center.lat=s),placeholder:a.lang.latitude,onOnBlur:a.updateLat},null,8,["value","placeholder","onOnBlur"]),m(d,{value:n.center.lng,"onUpdate:value":e[1]||(e[1]=s=>n.center.lng=s),placeholder:a.lang.longitude},null,8,["value","placeholder"])]),c("span",null,p(a.lang.fromCityCenter)+": "+p(n.fromCityCenter)+" км",1),k]),_:1},8,["label","name","meta"])])}const x=u(C,[["render",w]]);export{x as default};
