const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DYMqFcfo.js","./Brq43R7p.js","./C_206FfQ.js","./BsiC3VYZ.js","./BgMGjKYI.js","./BYTvHWBW.js","./entry.s4LH81U_.css","./BAGCSjPn.js","./C-pppDRM.js","./DsCDDeZ6.js","./BcsgYuXl.js","./D3IiDQKM.js","./DPZQ_Rts.js","./BcbUFkga.js"])))=>i.map(i=>d[i]);
import{aj as he,j as F,_ as $,p as C,ak as Re,q as S}from"./C_206FfQ.js";import"./Ds1lc8d-.js";import{L as Oe}from"./BtN75uaL.js";import{af as Te,ag as K,ah as xe,a3 as Me}from"./DRcunPOa.js";import{j as pe,C as g,aF as te,l as Le,b as Ve,y as b,z as l,A as h,B as c,H as v,D as f,I as A,E as I,F as D,G as E,aj as R,a8 as M,o as L,x as w,i as Ue,aG as Ne,ag as fe,a9 as z,an as q,a7 as T,a0 as W}from"./BsiC3VYZ.js";import"./BgMGjKYI.js";import{g as ee,a as me,i as ze}from"./CsFp_7X6.js";import{L as qe}from"./DsAggExp.js";import{h as ie}from"./BYTvHWBW.js";import{f as Ge,a as Be}from"./BHcF-zQ5.js";const We=e=>typeof e=="symbol",je=(e,t,i,s=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:s,value:i})};new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(We));function j(e){const t=e&&e.__v_raw;return t?j(t):e}function Y(e){return Object.isExtensible(e)&&je(e,"__v_skip",!0),e}class B{static getComponentDefinition(t,i){let s;return typeof t=="string"?s=this.searchForComponentInstance(i,t):s={extends:pe(Object.assign({},t))},s||console.error(`Could not find component with name of ${t}. Is it in Vue.components?`),s.extends?(s.extends.setup&&(s.setup=s.extends.setup),s.extends.props=this.addParamsToProps(s.extends.props)):s.props=this.addParamsToProps(s.props),s}static addParamsToProps(t){return!t||Array.isArray(t)&&t.indexOf("params")===-1?t=["params",...t||[]]:typeof t=="object"&&!t.params&&(t.params={type:Object}),t}static createAndMountComponent(t,i,s,r){const n=B.getComponentDefinition(t,s);if(!n)return;const{vNode:a,destroy:o,el:u}=this.mount(n,{params:Object.freeze(i)},s,r||{});return{componentInstance:a.component.proxy,element:u,destroy:o}}static mount(t,i,s,r){let n=g(t,i);n.appContext=s.$.appContext,n.appContext.provides=Object.assign(Object.assign(Object.assign({},r),n.appContext.provides?n.appContext.provides:{}),s.$parent.$options.provide?s.$parent.$options.provide:{});let a=document.createElement("div");return te(n,a),{vNode:n,destroy:()=>{a&&te(null,a),a=null,n=null},el:a}}static searchForComponentInstance(t,i,s=10,r=!1){let n=null,a=t.$parent,o=0;for(;!n&&a&&a.$options&&++o<s;){const u=a;n=u.$options&&u.$options.components?u.$options.components[i]:null,a=a.$parent}if(!n){const u=t.$.appContext.components;u&&u[i]&&(n=u[i])}return!n&&!r?(console.error(`Could not find component with name of ${i}. Is it in Vue.components?`),null):n}}class G extends Te{constructor(t,i){super(),this.parent=t,G.provides||(G.provides=i)}createWrapper(t){const i=this;class s extends He{init(a){super.init(a)}hasMethod(a){return r.getFrameworkComponentInstance()[a]!=null}callMethod(a,o){const u=this.getFrameworkComponentInstance();return r.getFrameworkComponentInstance()[a].apply(u,o)}addMethod(a,o){r[a]=o}overrideProcessing(a){return i.parent.autoParamsRefresh&&a==="refresh"}processMethod(a,o){return a==="refresh"&&(this.getFrameworkComponentInstance().params=o[0]),this.hasMethod(a)?this.callMethod(a,o):a==="refresh"}createComponent(a){return i.createComponent(t,a)}}const r=new s;return r}createComponent(t,i){return B.createAndMountComponent(t,i,this.parent,G.provides)}createMethodProxy(t,i,s){return function(){return t.overrideProcessing(i)?t.processMethod(i,arguments):t.hasMethod(i)?t.callMethod(i,arguments):(s&&console.warn("AG Grid: Framework component is missing the method "+i+"()"),null)}}destroy(){this.parent=null}}class He{getGui(){return this.element}destroy(){this.getFrameworkComponentInstance()&&typeof this.getFrameworkComponentInstance().destroy=="function"&&this.getFrameworkComponentInstance().destroy(),this.unmount()}getFrameworkComponentInstance(){return this.componentInstance}init(t){const{componentInstance:i,element:s,destroy:r}=this.createComponent(t);this.componentInstance=i,this.unmount=r,this.element=s.firstElementChild}}const Ke=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Je=e=>`on${e.charAt(0).toUpperCase()}${e.substring(1,e.length)}`,Ye=()=>{const e={};K.PUBLIC_EVENTS.map(s=>Je(Ke(s))).forEach(s=>e[s]=void 0);const i={};return K.ALL_PROPERTIES.filter(s=>s!="gridOptions").forEach(s=>{e[s]={},i[s]={handler(r,n){this.processChanges(s,r,n)},deep:s!=="popupParent"&&s!=="context"}}),[e,i]};class Ze extends xe{constructor(t){super(),this.parent=t}frameworkComponent(t,i){let s=B.searchForComponentInstance(this.parent,t,10,!0)?t:null;if(!s&&i&&i[t]){const r=i[t];s=B.searchForComponentInstance(this.parent,r,10,!0)?r:null}return s}isFrameworkComponent(t){return typeof t=="object"}}const Qe=["rowDataChanged","rowDataUpdated","cellValueChanged","rowValueChanged"],se="onUpdate:modelValue",Xe="update:modelValue",[et,tt]=Ye(),it=pe({render(){return Le("div")},props:Object.assign({gridOptions:{type:Object,default:()=>({})},autoParamsRefresh:{type:Boolean,default:()=>!1},componentDependencies:{type:Array,default:()=>[]},plugins:[],modules:{type:Array,default:()=>[]},modelValue:{type:Array,default:void 0,required:!1}},et),data(){return{gridCreated:!1,isDestroyed:!1,gridReadyFired:!1,emitRowModel:void 0}},watch:Object.assign({modelValue:{handler(e,t){this.processChanges("rowData",e,t)},deep:!0}},tt),methods:{globalEventListener(e,t){this.isDestroyed||(e==="gridReady"&&(this.gridReadyFired=!0),this.updateModelIfUsed(e))},processChanges(e,t,i){if(this.gridCreated){if(this.skipChange(e,t,i))return;const s={};s[e]={currentValue:e==="rowData"?Object.isFrozen(t)?t:Y(j(t)):t,previousValue:i},K.processOnChange(s,this.gridOptions.api)}},checkForBindingConflicts(){const e=this;(e.rowData||this.gridOptions.rowData)&&e.modelValue&&console.warn("AG Grid: Using both rowData and v-model. rowData will be ignored.")},getRowData(){const e=[];return this.gridOptions.api.forEachNode(t=>{e.push(t.data)}),e},updateModelIfUsed(e){this.gridReadyFired&&this.$attrs[se]&&Qe.indexOf(e)!==-1&&this.emitRowModel&&this.emitRowModel()},getRowDataBasedOnBindings(){const e=this,t=e.modelValue;return t||(e.rowData?e.rowData:e.gridOptions.rowData)},getProvides(){let e=Ve(),t={};for(;e;)e&&e.provides&&(t=Object.assign(Object.assign({},t),e.provides)),e=e.parent;return t},skipChange(e,t,i){if(this.gridReadyFired&&e==="rowData"&&this.$attrs[se]){if(t===i)return!0;if(t&&i){const s=t,r=i;if(s.length===r.length){for(let n=0;n<s.length;n++)if(s[n]!==r[n])return!1;return!0}}}return!1},debounce(e,t){let i;return()=>{const s=function(){e()};window.clearTimeout(i),i=window.setTimeout(s,t)}}},mounted(){this.emitRowModel=this.debounce(()=>{this.$emit(Xe,Object.freeze(this.getRowData()))},20);const e=this.getProvides(),t=new G(this,e),i=Y(K.copyAttributesToGridOptions(j(this.gridOptions),this,!0));this.checkForBindingConflicts();const s=this.getRowDataBasedOnBindings();i.rowData=s&&(Object.isFrozen(s)?s:Y(j(s)));const r={globalEventListener:this.globalEventListener.bind(this),frameworkOverrides:new Ze(this),providedBeanInstances:{frameworkComponentWrapper:t},modules:this.modules};new Me(this.$el,i,r),this.gridCreated=!0},unmounted(){this.gridCreated&&(this.gridOptions.api&&this.gridOptions.api.destroy(),this.isDestroyed=!0)}}),st={page:"Хуудас",more:"Дэлгэрэнгүй",to:"хүртэл",of:"Of",next:"Дараах",last:"Сүүлийн",first:"Эхний",previous:"Өмнөх",loadingOoo:"Ачаалж байна...",selectAll:"Бүгдийг сонгох",searchOoo:"Хайх...",blanks:"Хоосон",filterOoo:"Шүүх...",applyFilter:"Шүүж харах",clearFilter:"Цэвэрлэх",equals:"Тэнцүү",notEqual:"Тэнцүү биш",inRange:"Хооронд",lessThan:"бага",lessThanOrEqual:"тэнцүү эсвэл бага",greaterThan:"их",greaterThanOrEqual:"тэнцүү эсвэл их",contains:"агуулсан",notContains:"агуулаагүй",startsWith:"эхэлсэн",endsWith:"төгссөн",group:"нэгтгэх",columns:" Талбарууд ",rowGroupColumns:"нэгтгэсэн багана",rowGroupColumnsEmptyMessage:"ийш нь багана чирж нэгтгэж харна",valueColumns:"багананы утга",pivotMode:"Пивот горим",groups:"Нэгтгэлүүд",values:"Утгууд",pivots:"пивот",valueColumnsEmptyMessage:"энд багана чирж утгуудыг нэгтгэж харна",pivotColumnsEmptyMessage:"энд багана чирж пивот үүсгэж харна",toolPanelButton:"Багаж",noRowsToShow:"Мэдээлэл олдсонгүй",pinColumn:"багана түгжих",valueAggregation:"нэгтгэл утга",autosizeThiscolumn:"Өргөн авто",autosizeAllColumns:"Бүх багана өргөн авто",groupBy:"нэгтгэх",ungroupBy:"нэгтгэл болиулах",resetColumns:"Багана шинэчлэх",expandAll:"Дэлгэх",collapseAll:"Хаах",toolPanel:"Багаж",export:"экспорт",csvExport:" CSV экспорт",excelExport:"Excel экспорт",pinLeft:"Зүүн талд түгжих <<",pinRight:"Баруун талд түгжих >>",noPin:"Түгжээг авах <>",sum:"Нийлбэр",min:"Хамгийн бага",max:"Хамгийн их",none:"Утгагүй",count:"Тоолох",average:"Дундаж",copy:"Хуулах",copyWithHeaders:"толгойн мэдээлэлтэй хамт хуулах",ctrlC:"ctrl+C",paste:"Буулгах",ctrlV:"ctrl+v"},Z=()=>({showMobileFilter:!1,isLoading:!0,gridTitle:"",identity:"id",overlayLoadingTemplate:'<span class="ag-overlay-loading-center">Түр хүлээнэ үү</span>',init:!1,model:null,template:2,theme:"normal",gridTheme:"material",isClient:!1,isPrint:!1,isNumbered:!1,printSize:"A4",sideBar:!1,header:null,tableWidth:null,fullWidth:!1,fullText:!1,editableAction:null,editType:null,editCellValue:null,editRowValue:null,postModels:[],updateModels:[],cellStatus:"",singleClickEdit:!0,flashChanges:!1,editableShouldSubmit:!1,defaultColDef:{sortable:!0,resizable:!0,filter:!0,floatingFilter:!1},gridOptions:{debug:!1,localeText:st,suppressMultiSort:!0,suppressRowClickSelection:!0,allowContextMenuWithControlKey:!0,animateRows:!1,groupIncludeFooter:!1,groupIncludeTotalFooter:!1,suppressNoRowsOverlay:!0},info:{total:0,totalPage:0},query:{src:"",paginate:50,currentPage:1,sort:"",order:""},gridActions:[],hasContextMenu:!1,actionPosition:0,schema:[],formula:[],aggregations:{columnAggregations:[],columnAggregationsFormula:[],data:[],loading:!0,forumlaResult:""},columns:null,data:[],filterModel:{},searchModel:null,isStatic:!1,selectionMethod:"multiple",selected:[],autoSelect:!1,autoSelectModel:null,deleteModal:!1,delLoading:!1,currentRow:{rowId:null,rowIndex:null},frameworkComponents:null,changedRowsData:[],colMenu:!1,colFilterButton:!0,showGrid:!1,saveFilter:!1,selectInputModels:[],showPrint:!1,showExcelImport:!1,triggers:{namespace:"",beforeFetch:"",afterFetch:"",beforeDelete:"",afterDelete:"",beforePrint:""},baseUrl:""}),rt=function(){var e="data:application/vnd.ms-excel;base64,",t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{header}{rows}</table></body></html>',i=function(r){return window.btoa(unescape(encodeURIComponent(r)))},s=function(r,n){return r.replace(/{(\w+)}/g,function(a,o){return n[o]})};return function(r,n,a){var o={worksheet:a||"Worksheet",header:r,rows:n},u=document.createElement("a");u.download=a+".xls",u.href=e+i(s(t,o)),document.body.appendChild(u),u.click(),document.body.removeChild(u)}}();let ge=/\{ *([\w_-]+) *\}/g;const nt=(e,t)=>e.replace(ge,(i,s)=>{let r=t[s];return r===void 0?0:(typeof r=="function"&&(r=r(t)),r*1)}),H=(e,t)=>e.replace(ge,(i,s)=>{let r=t[s];return r===void 0?"":r}),at=e=>new Function("return "+e)(),k=e=>!(typeof e>"u"||e==null||e===""),ye=(e,t)=>{for(let i in e){if(Object.prototype.hasOwnProperty.call(e,i)!==Object.prototype.hasOwnProperty.call(t,i)||e[i]===null&&t[i]!==null||t[i]===null&&e[i]!==null)return!1;switch(typeof e[i]){case"object":if(!ye(e[i],t[i]))return!1;break;case"function":if(typeof t[i]>"u"||i!="compare"&&e[i].toString()!=t[i].toString())return!1;break;default:if(e[i]===""&&t[i]!==""||t[i]===""&&e[i]!==""||e[i]!=t[i])return!1}}for(let i in t)if(typeof e[i]>"u")return!1;return!0};var lt=/^(((http[s]?)|file):)?(\/\/)+([0-9a-zA-Z-_.=?&].+)$/,ot=/^((\.|\.\.)?\/)([0-9a-zA-Z-_.=?&]+\/)*([0-9a-zA-Z-_.=?&]+)$/,re=function(e){return lt.test(e)||ot.test(e)};function dt(e,t){var i=e.createElement("style");return i.appendChild(e.createTextNode(t)),i}function ut(e,t){var i=e.createElement("link");return i.type="text/css",i.rel="stylesheet",i.href=t,i}function ct(e){var t=window.document.createElement("iframe");return t.setAttribute("src","about:blank"),t.setAttribute("style","visibility:hidden;width:0;height:0;position:absolute;z-index:-9999;bottom:0;"),t.setAttribute("width","0"),t.setAttribute("height","0"),t.setAttribute("wmode","opaque"),e.appendChild(t),t}var ht={parent:window.document.body,headElements:[],bodyElements:[]},pt=function(){function e(t){this.isLoading=!1,this.hasEvents=!1,this.opts=[ht,t||{}].reduce(function(i,s){return Object.keys(s).forEach(function(r){return i[r]=s[r]}),i},{}),this.iframe=ct(this.opts.parent)}return e.prototype.getIFrame=function(){return this.iframe},e.prototype.print=function(t,i,s,r){if(!this.isLoading){var n=this.iframe,a=n.contentDocument,o=n.contentWindow;if(!(!a||!o)&&(this.iframe.src="about:blank",this.elCopy=t.cloneNode(!0),!!this.elCopy)){this.isLoading=!0,this.callback=r;var u=o.document;u.open(),u.write('<!DOCTYPE html><html><head><meta charset="utf-8"></head><body></body></html>'),this.addEvents();var y=this.opts,d=y.headElements,m=y.bodyElements;Array.isArray(d)&&d.forEach(function(P){return u.head.appendChild(P)}),Array.isArray(m)&&m.forEach(function(P){return u.body.appendChild(P)}),Array.isArray(i)&&i.forEach(function(P){P&&u.head.appendChild(re(P)?ut(u,P):dt(u,P))}),u.body.appendChild(this.elCopy),Array.isArray(s)&&s.forEach(function(P){if(P){var U=u.createElement("script");re(P)?U.src=P:U.innerText=P,u.body.appendChild(U)}}),u.close()}}},e.prototype.printURL=function(t,i){this.isLoading||(this.addEvents(),this.isLoading=!0,this.callback=i,this.iframe.src=t)},e.prototype.onBeforePrint=function(t){this.onbeforeprint=t},e.prototype.onAfterPrint=function(t){this.onafterprint=t},e.prototype.launchPrint=function(t){this.isLoading||t.print()},e.prototype.addEvents=function(){var t=this;if(!this.hasEvents){this.hasEvents=!0,this.iframe.addEventListener("load",function(){return t.onLoad()},!1);var i=this.iframe.contentWindow;i&&(this.onbeforeprint&&i.addEventListener("beforeprint",this.onbeforeprint),this.onafterprint&&i.addEventListener("afterprint",this.onafterprint))}},e.prototype.onLoad=function(){var t=this;if(this.iframe){this.isLoading=!1;var i=this.iframe,s=i.contentDocument,r=i.contentWindow;if(!s||!r)return;typeof this.callback=="function"?this.callback({iframe:this.iframe,element:this.elCopy,launchPrint:function(){return t.launchPrint(r)}}):this.launchPrint(r)}},e}();const ft=`

    .no-print {
        display: none
    }
    .A3.landscape {
        width: 420mm;
    }
    .A3, .A4.landscape {
        width: 297mm
    }
    .A4, .A5.landscape {
        width: 210mm
    }
    .A5 {
        width: 148mm !important;
    }
    .print-table {
	 max-width: 100%;
	 width: 100%;
	 border-collapse: collapse;
	 border: 0;
	 border-left: 0;
	 border-right: 0;
	 border-top: 0;
	 margin-top: -1px;
}
 .print-table thead tr {
  background-color: #ffffff;
            border-top: 1px solid #3f3fe7;
            border-bottom: 1px solid #3f3fe7;

            }
 .print-table thead td {
    border-color:#fff !important;
 }
 .print-table tbody {
	 background: #fff;
}
 .print-table tbody td {
    border-color:#fff !important;
 }
 .print-table thead tr td, .print-table tbody tr td {
	 font-size: 10px;
	 color: #545454;
	 text-align: center;
	 vertical-align: middle;

	 padding: 3px 2px;
	 overflow: hidden;
}
 .print-table thead tr td > div, .print-table tbody tr td > div {
	 font-size: 12px;
	 text-align: center;
}
 .print-table tbody {
	 background: #fff;
}
}
.print-table tbody tr:nth-child(odd) {
            background-color: #ffffff;
        }
.print-table tbody tr:nth-child(even) {
            background-color: #f2f2f2 !important;
}
.print-table tbody tr:nth-child(even) td {

            border-color:#f2f2f2 !important;
}
.print-title, .print-table{
    font-family: Arial !important;
}
h2{
   margin-top: 0;
        margin-bottom: 0.5em;
        color: rgba(0, 0, 0, 0.85);
        font-weight: 500;
        font-size: 18px;
    text-align: center;
}
.filter-info {
  list-style: none;
  padding-left: 0;
}

.filter-info li {
  list-style: none;
  display: inline-block;
  padding-right: 10px;
  font-size: 12px;
}

.filter-info .info-label {
  color: #3f3fe7;
}
.align-right{
    text-align: right;
    display:block;
}`;function mt(e){return he(e).format("0,0")}function _e(e){return he(e).format("0,0.00")}const gt={props:["schemaID","pageSize","header","schema","info","query","filter","search","isNumber","gridTitle","aggregations","baseUrl","user_condition"],data(){return{isLoading:!0,isFalse:!1,isTrue:!0,total:0,data:[],scrollOptions:{height:"100%",size:7,railVisible:!0,railOpacity:.2,alwaysVisible:!0,wheelStep:5,color:"#2C3A47"},templatecss:" @media print{@page {size: A4}}",valute:"",selectedPageSize:"",filterInfos:[]}},created(){this.d=new pt,this.templatecss=" @media print{@page {size: "+this.pageSize+"}}",this.selectedPageSize=this.pageSize,this.fetchPrintData(),this.getRelations()},computed:{lang(){const e=["type","selectPaperSize","paperSize","landScape","currencySelection","tugrug","dollar","euro","yen","austDollar","rubli","reboot","print","","","","","",""];return e.reduce((t,i,s)=>(t[i]=this.$t("dataGrid."+e[s]),t),{})},pageClass(){return this.selectedPageSize},computedSchema(){return this.schema.filter(e=>e.printable&&!e.hide)},computedSchemaBody(){return this.schema.filter(e=>e.printable)},printOnly(){return"print-only"},computedHeader(){return this.header!==null?this.header.structure.map(e=>(e.children=e.children.filter(t=>{if(t.label!=="#"){const i=this.schema.findIndex(s=>s.model===t.model);return i>=0?this.schema[i].printable:!0}}),e)):this.header}},methods:{isPrintAble(e){return!0},cssPagedMedia:function(){var e=document.createElement("style");return document.head.appendChild(e),function(t){e.innerHTML=t}}(),changeCss(){this.templatecss=" @media print{@page {size: "+this.pageSize+"}}"},printPage(){this.d.print(document.getElementById("printArea"),[this.templatecss,ft])},fetchPrintData(){this.isLoading=!0;let e=`${this.baseUrl}/lambda/krud/print/${this.schemaID}`,t=Object.keys(this.filter).filter(i=>this.filter[i]!==null).reduce((i,s)=>(i[s]=this.filter[s],i),{});this.user_condition&&(t.user_condition=this.user_condition),F.post(e,t).then(({data:i})=>{this.data=i,this.isLoading=!1,this.aggregations&&this.aggregations.columnAggregations.length>=1&&this.fetchAggregations(t)}).catch(i=>{this.isLoading=!1})},fetchAggregations(e){this.aggregations.loading=!0,this.aggregations.forumlaResult="",this.aggregations.data=[],F.post(`${this.baseUrl}/lambda/puzzle/grid/aggergation/${this.$props.schemaID}`,e).then(({data:t})=>{let i={},s={};this.aggregations.columnAggregations.map(r=>{let n=r.aggregation,a=r.column;if(t.length>=1){let o=this.schema.findIndex(y=>y.model===a),u=n+"_"+a;t[0][u]==null&&(u=u.toLowerCase()),i[r.column]=t[0][u],o>=0&&(s[a]=_e(t[0][u])+" "+r.symbol)}}),this.data.push(s)}).catch(t=>{console.log(t.message)})},printCell(e,t){switch(t.gridType){case"Number":return`<span class="align-right block">${typeof e[t.model]=="number"||!isNaN(e[t.model])?Number(e[t.model]).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):e[t.model]}</span>`;case"Image":return`<img src="${e[t.model]}"/>`;case"Html":return e[t.model];case"Date":return e[t.model]!=null?e[t.model].substr(0,10):"";default:return e[t.model]}},async getRelations(){this.filterInfos=[];let e=[];const t=Object.keys(this.filter).filter(i=>this.filter[i]!==null&&this.filter[i]!=="");if(t&&t.length>=1){this.schema.forEach(s=>{let r=t.findIndex(n=>n===s.model);s.filterable&&r>=0&&e.push({...s,formType:s.filter.type,relation:s.filter.relation})});const i=await ee(e,void 0,"");this.filterInfos=e.map(s=>{if(s.filter.type==="Select")if(i[s.model]){let r=i[s.model].data.findIndex(n=>n.value===this.filter[s.model]);return{label:s.filter.label?s.filter.label:s.label,value:r>=0?i[s.model].data[r].label:this.filter[s.model]}}else{let r=i[s.relation.table].data.findIndex(n=>n.value===this.filter[s.model]);return{label:s.filter.label?s.filter.label:s.label,value:r>=0?i[s.relation.table].data[r].label:this.filter[s.model]}}else return s.filter.type==="DateRange"?{label:s.filter.label?s.filter.label:s.label,value:Array.isArray(this.filter[s.model])?this.filter[s.model].join(" - "):this.filter}:{label:s.filter.label?s.filter.label:s.label,value:this.filter[s.model]}})}}}},yt={class:"print-container"},_t={class:"print-tools no-print"},bt={class:"print-tools-left"},vt={class:"print-tools-right"},Ct={class:"svg-icon"},wt={id:"printArea",class:"sheet padding-5mm print-only"},Dt={class:"print-title"},St={class:"align-center"},kt={class:"filter-info"},At={class:"info-label"},It={border:"1",class:"print-table"},$t={key:0},Et=["colspan","rowspan"],Pt={key:1},Ft=["colspan","rowspan"],Rt=["innerHTML"];function Ot(e,t,i,s,r,n){const a=b("a-select-option"),o=b("a-select"),u=b("inline-svg"),y=b("a-spin");return l(),h("section",yt,[c("div",_t,[c("div",bt,[c("label",null,v(n.lang.paperSize),1),g(o,{value:r.selectedPageSize,"onUpdate:value":t[0]||(t[0]=d=>r.selectedPageSize=d),onChange:n.changeCss,size:"small",style:{"max-width":"160px"}},{default:f(()=>[g(a,{disabled:"",value:null},{default:f(()=>[A(v(n.lang.selectPaperSize),1)]),_:1}),g(a,{value:"A3"},{default:f(()=>[A("A3")]),_:1}),g(a,{value:"A3 landscape"},{default:f(()=>[A("A3 "+v(n.lang.landScape),1)]),_:1}),g(a,{value:"A4"},{default:f(()=>[A("A4")]),_:1}),g(a,{value:"A4 landscape"},{default:f(()=>[A("A4 "+v(n.lang.landScape),1)]),_:1}),g(a,{value:"A5"},{default:f(()=>[A("A5")]),_:1}),g(a,{value:"A5 landscape"},{default:f(()=>[A("A5 "+v(n.lang.landScape),1)]),_:1})]),_:1},8,["value","onChange"])]),c("div",vt,[c("span",{class:"link link-icon",onClick:t[1]||(t[1]=(...d)=>n.printPage&&n.printPage(...d))},[c("span",Ct,[g(u,{src:"/assets/icons/duotone/Devices/Printer.svg"})]),A(" Хэвлэх ")])])]),c("div",{class:M(["print-body",[n.pageClass,n.printOnly]])},[r.isLoading?(l(),I(y,{key:0,size:"large",spinning:!0})):D("",!0),c("section",wt,[c("div",Dt,[c("h2",St,v(i.gridTitle),1),c("ul",kt,[(l(!0),h(E,null,R(r.filterInfos,d=>(l(),h("li",{key:d.index},[c("span",At,v(d.label)+":",1),A(" "+v(d.value),1)]))),128))])]),c("table",It,[i.header!=null?(l(),h("thead",$t,[(l(!0),h(E,null,R(n.computedHeader,d=>(l(),h("tr",{key:d.index},[(l(!0),h(E,null,R(d.children,m=>(l(),h("td",{key:m.index,colspan:m.colspan,rowspan:m.rowspan},[c("div",{class:M(m.rotate?"vertical-column":"")},[c("div",null,v(m.label),1)],2)],8,Et))),128))]))),128))])):(l(),h("thead",Pt,[c("tr",null,[(l(!0),h(E,null,R(n.computedSchema,d=>(l(),h("td",{key:d.index,colspan:d.colspan,rowspan:d.rowspan},v(d.label),9,Ft))),128))])])),c("tbody",null,[(l(!0),h(E,null,R(r.data,d=>(l(),h("tr",{key:d.index},[(l(!0),h(E,null,R(n.computedSchemaBody,m=>(l(),h("td",{key:m.index},[c("span",{innerHTML:n.printCell(d,m)},null,8,Rt)]))),128))]))),128))])])])],2)])}const Tt=$(gt,[["render",Ot]]),xt={components:{LoadingOutlined:qe},props:["schemaID","schema","options","baseUrl"],data(){return{isLoading:!1,excelForm:{excelFile:null,schemaID:this.schemaID},summary:null}},computed:{lang(){const e=["excelImportModalTitle","save"];return e.reduce((t,i,s)=>(t[i]=this.$t("dataGrid."+e[s]),t),{})}},methods:{excelImport(){this.isLoading=!0,F.post(this.baseUrl+"/lambda/krud/import-excel/"+this.schemaID,this.excelForm).then(e=>{console.log("excelImport:"),console.log(e.data),this.isLoading=!1,e.status&&(this.summary=e.data===null?[]:e.data)}).catch(e=>{this.isLoading=!1,L.error({message:"Алдаа",description:e.response.data.error})})},success(e){e.file.status==="done"&&(this.excelForm.excelFile=e.file.response)}}},Mt={class:"excel-import-container"},Lt={class:"excel-import-tools"},Vt={class:"excel-import-tools-left"},Ut={class:"excel-import-tools-right",style:{display:"flex"}},Nt={class:"excel-import-body"},zt={class:"excel-import-btns"},qt={class:"flex"},Gt={key:0,class:"excel_upload_loading notif",style:{padding:"20px"}},Bt={key:1},Wt={key:0,class:"notif",style:{height:"100%",display:"flex","align-items":"center","justify-content":"center","text-transform":"uppercase",padding:"20px",color:"#ccc"}},jt={key:1,class:"notif",style:{height:"100%",display:"flex","align-items":"center","justify-content":"center","text-transform":"uppercase",color:"#149755"}},Ht={key:0,style:{padding:"20px"}},Kt=c("div",null,[c("h3",null," Эксел файл оруулах үеийн лог ")],-1),Jt=c("div",null,"Доорх алдааг засаж дахин оруулна уу, алдаа гараагүй өгөгдлүүд баазад орсон",-1),Yt={style:{"border-top":"1px dotted #eee",padding:"20px","overflow-y":"auto"}},Zt=c("br",null,null,-1),Qt=c("br",null,null,-1);function Xt(e,t,i,s,r,n){const a=b("a-button"),o=b("inline-svg"),u=b("a-upload");return l(),h("section",Mt,[c("div",Lt,[c("div",Vt,[c("label",null,v(n.lang.excelImportModalTitle),1)]),c("div",Ut,[i.options.excelUploadSample?(l(),I(a,{key:0,type:"default",href:i.baseUrl+i.options.excelUploadSample,shape:"round",class:"example-btn"},{default:f(()=>[A(" Жишээ файл татах ")]),_:1},8,["href"])):D("",!0)])]),c("div",Nt,[c("div",zt,[g(u,{action:`${i.baseUrl}/lambda/krud/upload`,modelValue:r.excelForm.excelFile,"onUpdate:modelValue":t[0]||(t[0]=y=>r.excelForm.excelFile=y),onChange:n.success,class:"ant-btn-default",style:{width:"200px"},size:"small"},{default:f(()=>[c("div",qt,[g(o,{class:"svg-icon",src:"/assets/icons/duotone/Files/Upload.svg"}),A(" Файл оруулах ")])]),_:1},8,["action","modelValue","onChange"]),r.excelForm.excelFile?(l(),I(a,{key:0,type:"primary",loading:r.isLoading,onClick:n.excelImport},{default:f(()=>[A(v(n.lang.save),1)]),_:1},8,["loading","onClick"])):D("",!0)]),r.isLoading?(l(),h("div",Gt," Ачаалж байна түр хүлээнэ үү ... ")):(l(),h("div",Bt,[r.summary===null?(l(),h("div",Wt," Эксел файлаа оруулаад өгөгдөл хадгалах товчийг дарна уу ")):r.summary.length===0?(l(),h("div",jt," Амжилттай хадгалагдлаа. Хүснэгтээ дахин ачаалж мэдээллээ шалгана уу ")):(l(),h(E,{key:2},[r.summary.length>=1?(l(),h("div",Ht,[Kt,Jt,c("div",Yt,[c("ul",null,[(l(!0),h(E,null,R(r.summary,y=>(l(),h("li",{key:y},[A(" Мөрийн дугаар: "+v(y.row_index)+" ",1),Zt,A(" "+v(y.row.join(", "))+" - "+v(y.errors.join(", "))+" ",1),Qt,(l(!0),h(E,null,R(y.errors,d=>(l(),h("div",{class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",key:d.index},[c("span",null,v(d),1)]))),128))]))),128))])])])):D("",!0)],64))]))])])}const ei=$(xt,[["render",Xt]]),Q=[{element:"Text",component:w(()=>C(()=>import("./DYMqFcfo.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url))},{element:"Number",component:w(()=>C(()=>import("./BAGCSjPn.js"),__vite__mapDeps([7,1,2,3,4,5,6]),import.meta.url))},{element:"Date",component:w(()=>C(()=>import("./C-pppDRM.js"),__vite__mapDeps([8,1,2,3,4,5,6]),import.meta.url))},{element:"DateRange",component:w(()=>C(()=>import("./DsCDDeZ6.js"),__vite__mapDeps([9,1,2,3,4,5,6]),import.meta.url))},{element:"Select",component:w(()=>C(()=>import("./BcsgYuXl.js"),__vite__mapDeps([10,1,2,3,4,5,6]),import.meta.url))}],ti=(e,t)=>{if(e!==null&&typeof e<"u"){const i=Q.findIndex(s=>s.element===e);if(i>=0)return Q[i].component;if(t&&t.length>=1){const s=t.findIndex(r=>r.element===e);if(s>=0)return t[s].component}return Q[0].component}},ne=[{element:"Text",component:w(()=>C(()=>import("./DYMqFcfo.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url))},{element:"Number",component:w(()=>C(()=>Promise.resolve().then(()=>de),void 0,import.meta.url))},{element:"Date",component:w(()=>C(()=>import("./C-pppDRM.js"),__vite__mapDeps([8,1,2,3,4,5,6]),import.meta.url))},{element:"Image",component:w(()=>C(()=>Promise.resolve().then(()=>le),void 0,import.meta.url))},{element:"File",component:w(()=>C(()=>Promise.resolve().then(()=>oe),void 0,import.meta.url))},{element:"Checkbox",component:w(()=>C(()=>Promise.resolve().then(()=>Bi),void 0,import.meta.url))},{element:"Custom",component:w(()=>C(()=>Promise.resolve().then(()=>ns),void 0,import.meta.url))},{element:"File",component:w(()=>C(()=>Promise.resolve().then(()=>oe),void 0,import.meta.url))},{element:"Html",component:w(()=>C(()=>Promise.resolve().then(()=>ts),void 0,import.meta.url))},{element:"Input",component:w(()=>C(()=>import("./D3IiDQKM.js"),__vite__mapDeps([11,2,3,4,5,6]),import.meta.url))},{element:"InputNumber",component:w(()=>C(()=>Promise.resolve().then(()=>de),void 0,import.meta.url))},{element:"Link",component:w(()=>C(()=>Promise.resolve().then(()=>cs),void 0,import.meta.url))},{element:"Radio",component:w(()=>C(()=>Promise.resolve().then(()=>Yi),void 0,import.meta.url))},{element:"Select",component:w(()=>C(()=>import("./BcsgYuXl.js"),__vite__mapDeps([10,1,2,3,4,5,6]),import.meta.url))},{element:"Set-Filter",component:w(()=>C(()=>Promise.resolve().then(()=>ce),void 0,import.meta.url))},{element:"Selectable-Input",component:w(()=>C(()=>Promise.resolve().then(()=>ce),void 0,import.meta.url))},{element:"Set-Filter-Date",component:w(()=>C(()=>Promise.resolve().then(()=>Os),void 0,import.meta.url))},{element:"Set-Filter-Altered",component:w(()=>C(()=>Promise.resolve().then(()=>Ls),void 0,import.meta.url))},{element:"SVG",component:w(()=>C(()=>Promise.resolve().then(()=>le),void 0,import.meta.url))},{element:"Tag",component:w(()=>C(()=>import("./DPZQ_Rts.js"),__vite__mapDeps([12,2,3,4,5,6]),import.meta.url))},{element:"Textarea",component:w(()=>C(()=>import("./BcbUFkga.js"),__vite__mapDeps([13,2,3,4,5,6]),import.meta.url))}],J=e=>{if(e!==null&&typeof e<"u"){const t=ne.findIndex(i=>i.element===e);if(t>=0)return ne[t].component;{const i=Ue("customDataGridElementList");if(i&&i.length>=1){const s=i.findIndex(r=>r.element===e);if(console.log(s),s>=0)return i[s].component}}}},ii={props:["model","schema","schemaID","permissions","url","inFilter"],name:"GridRowUpdate",computed:{lang(){const e=["infoCourt","filtering","updatedSuccessfully","errorOccurredWhileUpdating","pleaseSelectUpdateLine"];return e.reduce((t,i,s)=>(t[i]=this.$t("dataGrid."+e[s]),t),{})},columns(){return this.schema.filter(e=>e.updateable&&e.update&&e.filter.type&&this.permissions.u===!0&&this.inFilter)},actionColumns(){return this.schema.filter(e=>e.updateable&&e.update&&e.filter.type)}},async mounted(){await this.getRelations()},data(){return{relations:{}}},methods:{element:J,setMeta(e){return e.schemaID=this.$props.schemaID,e.relation=e.filter.relation,e.formType=e.filter.type,e},preUpdate(e,t,i,s){t[i]=e,this.updateRows(t,i,s)},updateRows(e,t,i){let r=(this.inFilter?this.$parent.$parent.gridApi.getSelectedNodes():this.$parent.gridApi.getSelectedNodes()).map(n=>{let a=this.inFilter?this.$parent.$parent.identity:this.$parent.identity;return n.data[a]});if(r.length>=1){let n={ids:r,value:e[t],model:t},a=this.$props.url?this.$props.url:"";F.post(`${a}/lambda/krud/update-row/${this.schemaID}`,n).then(o=>{o.data.status?(i&&(this.refresh?this.refresh():this.inFilter?this.$parent.$parent.refresh():this.$parent.refresh()),L.success({message:this.lang.updatedSuccessfully})):L.error({message:this.lang.errorOccurredWhileUpdating})}).catch(o=>{L.error({message:this.lang.errorOccurredWhileUpdating})})}else L.error({message:this.lang.pleaseSelectUpdateLine})},getRelation(e){let t=this.columns.findIndex(s=>s.model===e.model),i=t>=0?this.columns[t]:e;return me({...i,relation:i.filter.relation},this.relations)},async getRelations(){let e=[];this.schema.forEach(t=>{t.updateable&&e.push({...t,formType:t.filter.type,relation:t.filter.relation})}),this.relations=await ee(e,void 0,"")}}},si={key:0},ri={key:0},ni={class:"row-updater float-left"},ai={class:"row-update-item"},li={class:"dg-filter-widget"},oi={class:"dg-filter-widget-header"},di={class:"dg-filter-widget-body"};function ui(e,t,i,s,r,n){const a=b("a-button"),o=b("portal"),u=b("a-form-item"),y=b("a-form");return i.permissions?(l(),h("div",si,[!i.inFilter&&i.permissions.u===!0?(l(),h("div",ri,[g(o,{to:"grid-left"},{default:f(()=>[c("div",ni,[(l(!0),h(E,null,R(n.actionColumns,d=>(l(),h("div",ai,[g(a,{type:"primary",class:"ml-3",onClick:m=>n.preUpdate(d.update.label,d.update.updateForm,d.model,d.update.refresh)},Ne({default:f(()=>[A(" "+v(d.update.buttonLabel),1)]),_:2},[d.update.buttonIcon?{name:"icon",fn:f(()=>[c("i",{class:M([d.update.buttonIcon,"mr-2"])},null,2)]),key:"0"}:void 0]),1032,["onClick"])]))),256))])]),_:1})])):D("",!0),(l(!0),h(E,null,R(n.columns,d=>(l(),h("div",li,[c("div",oi,[c("h3",null,v(d.update.updateLabel),1)]),c("div",di,[g(y,{model:d.update.updateForm,layout:"vertical"},{default:f(()=>[g(u,null,{default:f(()=>[(l(),I(fe(n.element(d.filter.type)),{model:{form:d.update.updateForm,component:d.model},label:d.update.label?d.update.label:d.label,meta:n.setMeta(d),relation_data:n.getRelation},null,8,["model","label","meta","relation_data"]))]),_:2},1024),g(u,null,{default:f(()=>[g(a,{type:"primary",long:"",onClick:m=>n.updateRows(d.update.updateForm,d.model,d.update.refresh)},{default:f(()=>[A(v(d.update.buttonLabel),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])])]))),256))])):D("",!0)}const be=$(ii,[["render",ui]]),ci={props:["model","schema","schemaID","permissions","url","hideTitle","filterData","refresh"],components:{GridRowUpdate:be,SearchOutlined:Re},data(){return{relations:{}}},computed:{lang(){const e=["infoCourt","filtering","updatedSuccessfully","errorOccurredWhileUpdating","pleaseSelectUpdateLine"];return e.reduce((t,i,s)=>(t[i]=this.$t("dataGrid."+e[s]),t),{})}},methods:{element(e){return ti(e,this.$customDataGridElementList)},setMeta(e){return e.schemaID=this.$props.schemaID,e.relation=e.filter.relation,e.formType=e.filter.type,e},getRelation(e){let t=this.schema.findIndex(s=>s.model==e.model),i=t>=0?this.schema[t]:e;return me({...i,relation:i.filter.relation},this.relations)},async getRelations(){let e=[];this.schema.forEach(t=>{t.filterable&&e.push({...t,formType:t.filter.type,relation:t.filter.relation})}),this.relations=await ee(e,void 0,"")}},async mounted(){await this.getRelations()}},hi={class:"dg-filter"},pi={class:"dg-filter-widget"},fi={key:0,class:"dg-filter-widget-header"},mi={class:"dg-filter-widget-body"},gi=c("br",null,null,-1);function yi(e,t,i,s,r,n){const a=b("a-form-item"),o=b("SearchOutlined"),u=b("a-button"),y=b("a-form"),d=b("GridRowUpdate");return l(),h("div",hi,[c("div",pi,[i.hideTitle?D("",!0):(l(),h("div",fi,[c("h3",null,v(n.lang.infoCourt),1)])),c("div",mi,[g(y,{ref:"filterFrm",model:i.model,layout:"vertical"},{default:f(()=>[(l(!0),h(E,null,R(i.schema,m=>(l(),h(E,null,[m.filterable&&m.filter&&m.filter.type&&m.filter.showSideFilter!==!1?(l(),I(a,{key:m.index},{default:f(()=>[(l(),I(fe(n.element(m.filter.type)),{model:{form:i.model,component:m.model},label:m.filter.label?m.filter.label:m.label,meta:n.setMeta(m),relation_data:n.getRelation,filterData:i.filterData},null,8,["model","label","meta","relation_data","filterData"]))]),_:2},1024)):D("",!0)],64))),256)),g(a,null,{default:f(()=>[g(u,{type:"primary",long:"",onClick:t[0]||(t[0]=m=>i.filterData(1)),block:""},{icon:f(()=>[g(o)]),default:f(()=>[A(" "+v(n.lang.filtering),1)]),_:1})]),_:1}),gi]),_:1},8,["model"])])]),g(d,{permissions:i.permissions,model:i.model,schema:i.schema,url:i.url,inFilter:!0,schemaID:i.schemaID,refresh:i.refresh},null,8,["permissions","model","schema","url","schemaID","refresh"])])}const _i=$(ci,[["render",yi]]);Array.isArray||(Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"});function bi(e){for(var t=[],i=0,s=e.length;i<s;i++)t.indexOf(e[i])===-1&&t.push(e[i]);return t}var p={},N={"==":function(e,t){return e==t},"===":function(e,t){return e===t},"!=":function(e,t){return e!=t},"!==":function(e,t){return e!==t},">":function(e,t){return e>t},">=":function(e,t){return e>=t},"<":function(e,t,i){return i===void 0?e<t:e<t&&t<i},"<=":function(e,t,i){return i===void 0?e<=t:e<=t&&t<=i},"!!":function(e){return p.truthy(e)},"!":function(e){return!p.truthy(e)},"%":function(e,t){return e%t},log:function(e){return console.log(e),e},in:function(e,t){return!t||typeof t.indexOf>"u"?!1:t.indexOf(e)!==-1},cat:function(){return Array.prototype.join.call(arguments,"")},substr:function(e,t,i){if(i<0){var s=String(e).substr(t);return s.substr(0,s.length+i)}return String(e).substr(t,i)},"+":function(){return Array.prototype.reduce.call(arguments,function(e,t){return parseFloat(e,10)+parseFloat(t,10)},0)},"*":function(){return Array.prototype.reduce.call(arguments,function(e,t){return parseFloat(e,10)*parseFloat(t,10)})},"-":function(e,t){return t===void 0?-e:e-t},"/":function(e,t){return e/t},min:function(){return Math.min.apply(this,arguments)},max:function(){return Math.max.apply(this,arguments)},merge:function(){return Array.prototype.reduce.call(arguments,function(e,t){return e.concat(t)},[])},var:function(e,t){var i=t===void 0?null:t,s=this;if(typeof e>"u"||e===""||e===null)return s;for(var r=String(e).split("."),n=0;n<r.length;n++)if(s==null||(s=s[r[n]],s===void 0))return i;return s},missing:function(){for(var e=[],t=Array.isArray(arguments[0])?arguments[0]:arguments,i=0;i<t.length;i++){var s=t[i],r=p.apply({var:s},this);(r===null||r==="")&&e.push(s)}return e},missing_some:function(e,t){var i=p.apply({missing:t},this);return t.length-i.length>=e?[]:i}};p.is_logic=function(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)&&Object.keys(e).length===1};p.truthy=function(e){return Array.isArray(e)&&e.length===0?!1:!!e};p.get_operator=function(e){return Object.keys(e)[0]};p.get_values=function(e){return e[p.get_operator(e)]};p.apply=function(e,t){if(Array.isArray(e))return e.map(function(m){return p.apply(m,t)});if(!p.is_logic(e))return e;var i=p.get_operator(e),s=e[i],r,n,a,o,u;if(Array.isArray(s)||(s=[s]),i==="if"||i=="?:"){for(r=0;r<s.length-1;r+=2)if(p.truthy(p.apply(s[r],t)))return p.apply(s[r+1],t);return s.length===r+1?p.apply(s[r],t):null}else if(i==="and"){for(r=0;r<s.length;r+=1)if(n=p.apply(s[r],t),!p.truthy(n))return n;return n}else if(i==="or"){for(r=0;r<s.length;r+=1)if(n=p.apply(s[r],t),p.truthy(n))return n;return n}else{if(i==="filter")return o=p.apply(s[0],t),a=s[1],Array.isArray(o)?o.filter(function(m){return p.truthy(p.apply(a,m))}):[];if(i==="map")return o=p.apply(s[0],t),a=s[1],Array.isArray(o)?o.map(function(m){return p.apply(a,m)}):[];if(i==="reduce")return o=p.apply(s[0],t),a=s[1],u=typeof s[2]<"u"?s[2]:null,Array.isArray(o)?o.reduce(function(m,P){return p.apply(a,{current:P,accumulator:m})},u):u;if(i==="all"){if(o=p.apply(s[0],t),a=s[1],!Array.isArray(o)||!o.length)return!1;for(r=0;r<o.length;r+=1)if(!p.truthy(p.apply(a,o[r])))return!1;return!0}else if(i==="none"){if(o=p.apply(s[0],t),a=s[1],!Array.isArray(o)||!o.length)return!0;for(r=0;r<o.length;r+=1)if(p.truthy(p.apply(a,o[r])))return!1;return!0}else if(i==="some"){if(o=p.apply(s[0],t),a=s[1],!Array.isArray(o)||!o.length)return!1;for(r=0;r<o.length;r+=1)if(p.truthy(p.apply(a,o[r])))return!0;return!1}}if(s=s.map(function(m){return p.apply(m,t)}),N.hasOwnProperty(i)&&typeof N[i]=="function")return N[i].apply(t,s);if(i.indexOf(".")>0){var y=String(i).split("."),d=N;for(r=0;r<y.length;r++){if(!d.hasOwnProperty(y[r]))throw new Error("Unrecognized operation "+i+" (failed at "+y.slice(0,r+1).join(".")+")");d=d[y[r]]}return d.apply(t,s)}throw new Error("Unrecognized operation "+i)};p.uses_data=function(e){var t=[];if(p.is_logic(e)){var i=p.get_operator(e),s=e[i];Array.isArray(s)||(s=[s]),i==="var"?t.push(s[0]):s.forEach(function(r){t.push.apply(t,p.uses_data(r))})}return bi(t)};p.add_operation=function(e,t){N[e]=t};p.rm_operation=function(e){delete N[e]};p.rule_like=function(e,t){if(t===e||t==="@")return!0;if(t==="number")return typeof e=="number";if(t==="string")return typeof e=="string";if(t==="array")return Array.isArray(e)&&!p.is_logic(e);if(p.is_logic(t)){if(p.is_logic(e)){var i=p.get_operator(t),s=p.get_operator(e);if(i==="@"||i===s)return p.rule_like(p.get_values(e,!1),p.get_values(t,!1))}return!1}if(Array.isArray(t))if(Array.isArray(e)){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r+=1)if(!p.rule_like(e[r],t[r]))return!1;return!0}else return!1;return!1};const ae=(e,t)=>{let i=p.apply(e,t);return Array.isArray(i)?i.length>=1?!i[0]:!0:!i},vi={components:{},computed:{lang(){const e=["easyEdit","view","yes","no","ruSureYouDeleteInfo","edit"];return e.reduce((t,i,s)=>(t[i]=this.$t("dataGrid."+e[s]),t),{})}},methods:{edit(){this.params.methods.edit(this.params.value,this.params.data)},isCanEdit(){return this.params.methods.permissions&&this.params.methods.permissions.gridEditConditionJS!=""&&this.params.methods.permissions.gridEditConditionJS!=null&&this.params.methods.permissions.gridEditConditionJS!=null?ae(this.params.methods.permissions.gridEditConditionJS,this.params.data):!0},isCanDelete(){return this.params.methods.permissions&&this.params.methods.permissions.gridDeleteConditionJS!=""&&this.params.methods.permissions.gridDeleteConditionJS!=null&&this.params.methods.permissions.gridDeleteConditionJS!=null?ae(this.params.methods.permissions.gridDeleteConditionJS,this.params.data):!0}}},Ci={class:"grid-actions"},wi={class:"svg-icon"},Di={class:"svg-icon"},Si={class:"svg-icon"},ki={class:"svg-icon"},Ai={class:"svg-icon"};function Ii(e,t,i,s,r,n){const a=b("inline-svg"),o=b("a-button"),u=b("a-tooltip"),y=b("a-popconfirm");return l(),h("span",Ci,[(l(!0),h(E,null,R(e.params.actions,d=>(l(),h("span",{key:d.index},[d==="qe"?(l(),I(u,{key:0},{title:f(()=>[A(v(n.lang.easyEdit),1)]),default:f(()=>[g(o,{shape:"circle",type:"text",size:"small",onClick:t[0]||(t[0]=m=>e.params.methods.quickEdit(e.params.value))},{icon:f(()=>[c("span",wi,[g(a,{src:"/assets/icons/duotone/Design/Edit.svg"})])]),_:1})]),_:1})):D("",!0),d==="cl"?(l(),I(u,{key:1},{title:f(()=>[A(v(n.lang.copy),1)]),default:f(()=>[g(o,{shape:"circle",type:"text",size:"small",onClick:t[1]||(t[1]=m=>e.params.methods.clone(e.params.value))},{icon:f(()=>[c("span",Di,[g(a,{src:"/assets/icons/duotune/general/gen028.svg"})])]),_:1})]),_:1})):D("",!0),d==="v"?(l(),I(u,{key:2},{title:f(()=>[A(v(n.lang.view),1)]),default:f(()=>[g(o,{shape:"circle",type:"text",size:"small",onClick:t[2]||(t[2]=m=>e.params.methods.view(e.params.value))},{icon:f(()=>[c("span",Si,[g(a,{src:"/assets/icons/duotone/General/Visible.svg"})])]),_:1})]),_:1})):D("",!0),d==="e"&&(e.params.actionsVisibility==null||!("e"in e.params.actionsVisibility)||"e"in e.params.actionsVisibility&&e.params.data[e.params.actionsVisibility.e.field]!==e.params.actionsVisibility.e.value)&&n.isCanEdit()?(l(),I(u,{key:3},{title:f(()=>[A(v(n.lang.edit),1)]),default:f(()=>[g(o,{shape:"circle",type:"text",size:"small",onClick:n.edit},{icon:f(()=>[c("span",ki,[g(a,{src:"/assets/icons/duotone/Design/Edit.svg"})])]),_:1},8,["onClick"])]),_:1})):D("",!0),d==="d"&&(e.params.actionsVisibility==null||!("d"in e.params.actionsVisibility)||"d"in e.params.actionsVisibility&&e.params.data[e.params.actionsVisibility.d.field]!=e.params.actionsVisibility.d.value)&&n.isCanDelete()?(l(),I(y,{key:4,title:n.lang.ruSureYouDeleteInfo,transfer:!0,"ok-text":n.lang.yes,"cancel-text":n.lang.no,onConfirm:t[3]||(t[3]=m=>e.params.methods.remove(e.params.value,e.params.rowIndex))},{default:f(()=>[g(o,{shape:"circle",type:"text",size:"small"},{icon:f(()=>[c("span",Ai,[g(a,{src:"/assets/icons/duotone/General/Trash.svg"})])]),_:1})]),_:1},8,["title","ok-text","cancel-text"])):D("",!0)]))),128)),(l(!0),h(E,null,R(e.params.customActions,d=>(l(),h("span",{key:d.index},[d.tooltip&&(!("condition"in d)||e.params.data[d.condition.field]!==d.condition.value)?(l(),I(u,{key:0,placement:"left"},{title:f(()=>[A(v(d.tooltip),1)]),default:f(()=>[g(o,{shape:"circle",type:"text",size:"small",class:"grid-action-btn",onClick:m=>d.method(e.params.data)},{default:f(()=>[c("i",{class:M(d.icon)},null,2)]),_:2},1032,["onClick"])]),_:2},1024)):!("condition"in d)||e.params.data[d.condition.field]!==d.condition.value?(l(),I(o,{key:1,shape:"circle",type:"text",size:"small",class:"grid-action-btn",onClick:m=>d.method(e.params.data)},{default:f(()=>[c("i",{class:M(d.icon)},null,2)]),_:2},1032,["onClick"])):D("",!0)]))),128))])}const $i=$(vi,[["render",Ii]]),Ei={},Pi=["src"];function Fi(e,t,i,s,r,n){return l(),h("img",{src:e.params.value,class:"ag-grid-image"},null,8,Pi)}const ve=$(Ei,[["render",Fi]]),le=Object.freeze(Object.defineProperty({__proto__:null,default:ve},Symbol.toStringTag,{value:"Module"})),Ri={},Oi={key:0,class:"ag-grid-file"},Ti=["href"],xi=c("i",{class:"ti-eye"},null,-1),Mi=["href"],Li=c("i",{class:"ti-download"},null,-1),Vi={key:1};function Ui(e,t,i,s,r,n){return l(),h("div",null,[e.params.value!=""&&e.params.value!=null?(l(),h("span",Oi,[c("a",{target:"_blank",href:e.params.value,class:"ag-grid-file-link"},[xi,A(" харах ")],8,Ti),c("a",{href:e.params.value,target:"_blank",class:"ag-grid-file-link",download:""},[Li,A(" татах ")],8,Mi)])):(l(),h("span",Vi," ... "))])}const Ce=$(Ri,[["render",Ui]]),oe=Object.freeze(Object.defineProperty({__proto__:null,default:Ce},Symbol.toStringTag,{value:"Module"})),Ni={},zi={class:"svg-icon"},qi=c("span",null,null,-1);function Gi(e,t,i,s,r,n){const a=b("inline-svg");return l(),h(E,null,[c("span",zi,[e.params.value===1?(l(),I(a,{key:0,src:"/assets/icons/duotune/Navigation/Check.svg"})):D("",!0)]),qi],64)}const we=$(Ni,[["render",Gi]]),Bi=Object.freeze(Object.defineProperty({__proto__:null,default:we},Symbol.toStringTag,{value:"Module"})),Wi={},ji={class:"block align-right"};function Hi(e,t,i,s,r,n){return l(),h("span",ji,v(e.params.value!==null?typeof e.params.value=="number"||!isNaN(e.params.value)?Number(e.params.value).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):e.params.value:""),1)}const De=$(Wi,[["render",Hi]]),de=Object.freeze(Object.defineProperty({__proto__:null,default:De},Symbol.toStringTag,{value:"Module"})),Ki={methods:{getRadioValue(){return this.params.valueOptions.filter(t=>t.value==this.params.value)[0].label}}};function Ji(e,t,i,s,r,n){return l(),h("span",null,v(n.getRadioValue()),1)}const Se=$(Ki,[["render",Ji]]),Yi=Object.freeze(Object.defineProperty({__proto__:null,default:Se},Symbol.toStringTag,{value:"Module"}));function Zi(e){return!isNaN(e)&&!isNaN(parseFloat(e))}function ue(e){return Number(e).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}const Qi={computed:{getValue(){if(this.params.type==="Number")if(this.params.value!==null){if(Zi(this.params.value))return ue(this.params.value);{let e=/>(\d+(?:\.\d+)?)</,t=this.params.value.match(e),i=ue(t[1]);return this.params.value.replace(e,`>${i}<`)}}else return"";else return this.params.value}}},Xi=["innerHTML"];function es(e,t,i,s,r,n){return l(),h("div",{class:"dg-html",innerHTML:n.getValue},null,8,Xi)}const X=$(Qi,[["render",es]]),ts=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"})),is={computed:{customEl(){if(this.params.value!==null&&this.params.value!==""){let e=this.params.customOptions.filter(t=>t.compareVal.toString()==this.params.value.toString())[0];if(e){let t=e.label!=null?e.label:"",i=e.icon!=null?`<i class="${e.icon}"></i>`:"",s=e.image!=null?`<img src="${e.image}" />`:"";return`<span style="${e.color!=""?"color: "+e.color:""}">${t} ${i} ${s}</span>`}else return this.params.value}return""}}},ss=["innerHTML"];function rs(e,t,i,s,r,n){return l(),h("span",{innerHTML:n.customEl},null,8,ss)}const ke=$(is,[["render",rs]]),ns=Object.freeze(Object.defineProperty({__proto__:null,default:ke},Symbol.toStringTag,{value:"Module"})),as={computed:{link(){return H(this.params.link,this.params.node.data)}}},ls=["href","target"],os={key:1},ds={key:1};function us(e,t,i,s,r,n){return e.params.value!=""&&e.params.value!=null?(l(),h("a",{key:0,href:n.link,target:this.params.linkTarget},[this.params.icon?(l(),h("i",{key:0,class:M([this.params.icon,"mr-1"])},null,2)):D("",!0),this.params.showOnlyIcon?D("",!0):(l(),h("span",os,v(e.params.value),1))],8,ls)):(l(),h("span",ds," ... "))}const Ae=$(as,[["render",us]]),cs=Object.freeze(Object.defineProperty({__proto__:null,default:Ae},Symbol.toStringTag,{value:"Module"})),hs={data(){return{value:"",cancelBeforeStart:!0}},methods:{getValue(){return this.value},isCancelBeforeStart(){return this.cancelBeforeStart},isCancelAfterEnd(){return this.value>1e6},onKeyDown(e){this.isKeyPressedNumeric(e)||e.preventDefault&&e.preventDefault()},getCharCodeFromEvent(e){return e=e||window.event,typeof e.which>"u"?e.keyCode:e.which},isCharNumeric(e){return/\d/.test(e)},isKeyPressedNumeric(e){const t=this.getCharCodeFromEvent(e),i=String.fromCharCode(t);return this.isCharNumeric(i)}},created(){this.value=this.params.value,this.cancelBeforeStart=this.params.charPress&&"1234567890".indexOf(this.params.charPress)<0},mounted(){}};function ps(e,t,i,s,r,n){return z((l(),h("input",{ref:"input",class:"ag-cell-input",type:"text",onKeydown:t[0]||(t[0]=a=>n.onKeyDown(a)),"onUpdate:modelValue":t[1]||(t[1]=a=>r.value=a)},null,544)),[[q,r.value]])}const fs=$(hs,[["render",ps]]),ms={data(){return{value:"",open:!1,cancelBeforeStart:!0}},methods:{getValue(){return this.value},getCharCodeFromEvent(e){return e=e||window.event,typeof e.which>"u"?e.keyCode:e.which},onKeyDown(e){console.log(e)},isCharNumeric(e){return/\d/.test(e)},isKeyPressedNumeric(e){const t=this.getCharCodeFromEvent(e),i=String.fromCharCode(t);return this.isCharNumeric(i)},openPicker(){console.log("working"),this.open=!this.open},getDate(e){return typeof e=="string"||e instanceof String?e:new Date(e).toString()!=="Invalid Date"?ie(e).format("YYYY-MM-DD"):ie(e*1).format("YYYY-MM-DD")},getDateValue(e){typeof e=="string"||e instanceof String?this.value=e:this.value=this.getDate(e),this.open=!1,this.focus.model=this.item.key,this.focus.val=e,this.$refs.input.value=e,this.$refs.input.focus()}},created(){this.value=this.params.value},mounted(){this.params.editType==null}};function gs(e,t,i,s,r,n){const a=b("Icon"),o=b("DatePicker");return l(),I(o,{value:r.value?r.value:void 0,open:r.open,class:"grid-editor date",type:"date",onOnChange:n.getDateValue,size:"small",placement:"bottom-end"},{default:f(()=>[c("template",null,[z(c("input",{ref:"input",class:"date-editor",mask:"9999-99-99",type:"text","onUpdate:modelValue":t[0]||(t[0]=u=>r.value=u)},null,512),[[q,r.value]])]),c("a",{href:"javascript:void(0)",onClick:t[1]||(t[1]=(...u)=>n.openPicker&&n.openPicker(...u)),class:"date-pick-btn"},[g(a,{type:"ios-calendar-outline"})])]),_:1},8,["value","open","onOnChange"])}const ys=$(ms,[["render",gs]]),_s={data(){return{value:"",cancelBeforeStart:!0}},methods:{getValue(){return this.value},isCancelBeforeStart(){return this.cancelBeforeStart},isCancelAfterEnd(){return this.value>1e6},onKeyDown(e){this.isKeyPressedNumeric(e)||e.preventDefault&&e.preventDefault()},getCharCodeFromEvent(e){return e=e||window.event,typeof e.which>"u"?e.keyCode:e.which},isCharNumeric(e){return/\d/.test(e)},isKeyPressedNumeric(e){const t=this.getCharCodeFromEvent(e),i=String.fromCharCode(t);return this.isCharNumeric(i)}},created(){this.value=this.params.value,this.cancelBeforeStart=this.params.charPress&&"1234567890".indexOf(this.params.charPress)<0},mounted(){}};function bs(e,t,i,s,r,n){return z((l(),h("input",{ref:"input",class:"ag-cell-input",type:"text",onKeydown:t[0]||(t[0]=a=>n.onKeyDown(a)),"onUpdate:modelValue":t[1]||(t[1]=a=>r.value=a)},null,544)),[[q,r.value]])}const vs=$(_s,[["render",bs]]),Cs={data(){return{value:"",cancelBeforeStart:!0}},methods:{getValue(){return this.value},isCancelBeforeStart(){return this.cancelBeforeStart},isCancelAfterEnd(){return this.value>1e6},onKeyDown(e){this.isKeyPressedNumeric(e)||e.preventDefault&&e.preventDefault()},getCharCodeFromEvent(e){return e=e||window.event,typeof e.which>"u"?e.keyCode:e.which},isCharNumeric(e){return/\d/.test(e)},isKeyPressedNumeric(e){const t=this.getCharCodeFromEvent(e),i=String.fromCharCode(t);return this.isCharNumeric(i)}},created(){this.value=this.params.value,this.cancelBeforeStart=this.params.charPress&&"1234567890".indexOf(this.params.charPress)<0},mounted(){}};function ws(e,t,i,s,r,n){return z((l(),h("input",{ref:"input",type:"text",onKeydown:t[0]||(t[0]=a=>n.onKeyDown(a)),"onUpdate:modelValue":t[1]||(t[1]=a=>r.value=a)},null,544)),[[q,r.value]])}const Ds=$(Cs,[["render",ws]]),Ss={components:{},computed:{lang(){const e=["choosevalue"];return e.reduce((t,i,s)=>(t[i]=this.$t("dataGrid."+e[s]),t),{})}},data(){return{loading:!0,options:[],selected:null,currentValue:null}},created(){let e=`/lambda/krud/${this.params.schemaID}/options`;F.post(e,this.params.column.filter.relation).then(({data:t})=>{this.options=t,this.loading=!1})},methods:{setMeta(e){return e.schemaID=this.params.schemaID,e},valueChanged(e){this.params.filterData(this.params.column.model,e)},onParentModelChanged(e){this.currentValue=e?e.filter:null}}};function ks(e,t,i,s,r,n){const a=b("a-select");return l(),I(a,{ref:"select",value:r.selected,"onUpdate:value":t[0]||(t[0]=o=>r.selected=o),allowClear:"",showSearch:"",onChange:n.valueChanged,options:r.options},null,8,["value","onChange","options"])}const As=$(Ss,[["render",ks]]),Is={data(){return{options:[],selected:"",currentValue:null}},created(){if(!this.params.isClient){let e=`/lambda/krud/${this.params.schemaID}/options`;F.post(e,this.params.column.filter.relation).then(({data:t})=>{this.options=t,this.loading=!1})}},methods:{element:J,setMeta(e){return e.schemaID=this.params.schemaID,e},getValues(){console.log("here"),console.log(this.params.api),this.params.api.forEachLeafNode(e=>{this.options.push(e.data[this.params.column.model])}),this.options=[...new Set(this.options)]},setValue(e){this.selected=e,this.params.filterData(this.params.column.model,e,"equals")},valueChanged(e){this.params.isClient?this.params.filterData(this.params.column.model,e.target.value,"contains"):(this.params.filterModel[this.params.column.model]=e.target.value,this.params.filterData(1))},onParentModelChanged(e){this.currentValue=e?e.filter:null}}},$s={class:"selectable-input-filter"},Es=c("div",{class:"selectable-input-filter-arrow"},null,-1);function Ps(e,t,i,s,r,n){return l(),h("div",$s,[z(c("input",{ref:"sinput","onUpdate:modelValue":t[0]||(t[0]=a=>r.selected=a),onInput:t[1]||(t[1]=(...a)=>n.valueChanged&&n.valueChanged(...a))},null,544),[[q,r.selected]]),Es])}const Ie=$(Is,[["render",Ps]]),ce=Object.freeze(Object.defineProperty({__proto__:null,default:Ie},Symbol.toStringTag,{value:"Module"})),Fs={data(){return{options:[],selected:"",currentValue:null}},methods:{element:J,setMeta(e){return e.schemaID=this.params.schemaID,e},getValues(){this.params.api.forEachLeafNode(e=>{this.options.push(e.data[this.params.column.model])}),this.options=[...new Set(this.options)]},setValue(e){this.selected=e,this.params.filterData(this.params.column.model,e,"equals")},valueChanged(e){this.params.isClient?this.params.filterData(this.params.column.model,e,"contains"):this.params.filterData(1)},onParentModelChanged(e){this.currentValue=e?e.filter:null}}};function Rs(e,t,i,s,r,n){const a=b("DatePicker");return l(),I(a,{class:"set-filter-date",size:"small",onOnChange:n.valueChanged},null,8,["onOnChange"])}const $e=$(Fs,[["render",Rs]]),Os=Object.freeze(Object.defineProperty({__proto__:null,default:$e},Symbol.toStringTag,{value:"Module"})),Ts={data(){return{options:[],selected:"",currentValue:null}},methods:{element:J,setMeta(e){return e.schemaID=this.params.schemaID,e},getValues(){this.params.api.forEachLeafNode(e=>{this.options.push(e.data[this.params.column.model])}),this.options=[...new Set(this.options)]},setValue(e){this.selected=e,this.params.filterData(this.params.column.model,e,"equals")},valueChanged(e){this.params.isClient?this.params.filterData(this.params.column.model,e.target.value,"contains"):(this.params.filterModel[this.params.column.model]=e.target.value,this.params.filterData(1))},onParentModelChanged(e){this.currentValue=e?e.filter:null}}},xs={class:"ag-input-wrapper"};function Ms(e,t,i,s,r,n){return l(),h("div",xs,[z(c("input",{ref:"sinput",class:"ag-floating-filter-input","onUpdate:modelValue":t[0]||(t[0]=a=>r.selected=a),onInput:t[1]||(t[1]=(...a)=>n.valueChanged&&n.valueChanged(...a))},null,544),[[q,r.selected]])])}const Ee=$(Ts,[["render",Ms]]),Ls=Object.freeze(Object.defineProperty({__proto__:null,default:Ee},Symbol.toStringTag,{value:"Module"}));Oe.prototype.validateLicense=()=>{};const x="datagrid",Vs={name:"datagrid",props:["schemaID","filterProp","highlights","fnClone","fnEdit","fnView","actions","dblClick","hasSelection","onRowSelect","permissions","user_condition","custom_condition","hasAggregation","page_id","actionvisibility","gridSelector","url","filter","changeKrudTool"],computed:{lang(){const e=["ruSureYouDeleteInfo","yes","no","total","infoDeleted","errorMsg","successfullySaved","noChangesHaveBeenReported","pleaseWaitForLoading","infoCourt","excelImportModalTitle"];return e.reduce((t,i,s)=>(t[i]=this.$t("dataGrid."+e[s]),t),{})},isMobile(){return ze.value},agGridTheme(){return this.gridTheme==="balham"?"ag-theme-balham":"ag-theme-material"}},components:{AgGridVue:it,editableText:fs,editableDate:ys,editableNumber:vs,editableSelect:Ds,selectFloatingFilter:As,SetFilter:Ie,SetFilterAltered:Ee,SetFilterDate:$e,GridActions:$i,datafilter:_i,GridRowUpdate:be,print:Tt,"excel-import":ei},data(){return Z()},watch:{update(e){e!==null&&e.type==="create"&&(this.data=[_.cloneDeep(e.data),...this.data],this.info.total++)},highlights(){this.preselect()}},methods:{onGridReady(e){this.gridApi=e.api,this.gridColumnApi=e.columnApi,this.initGrid(),setTimeout(()=>{this.saveFilter&&(this.restoreFloatFilterValue(),this.onFilterChanged())},150)},async initFromServerData(e){e?this.customShemaId=e:this.customShemaId=null;try{let t=await F.get(this.page_id?`${this.baseUrl}/lambda/puzzle/schema/grid/${this.customShemaId?this.customShemaId:this.$props.schemaID}?page_id=${this.page_id}`:`${this.baseUrl}/lambda/puzzle/schema/grid/${this.customShemaId?this.customShemaId:this.$props.schemaID}`);this.gridTitle=t.data.data.name;let i=t.data.data.schema.replace(/\bTRUE\b/g,"true").replace(/\bFALSE\b/g,"false").replace(/\bNULL\b/g,"null"),s=JSON.parse(i);return s.grid_id=t.data.data.id,s}catch(t){console.log(t);return}},async initGrid(e){this.columns=[],this.data=[],this.formula=[],this.pinnedBottomRowData=null,this.aggregations.columnAggregations=[];let t={};if(this.baseUrl=this.$props.url?this.$props.url:"",t=await this.initFromServerData(e),this.model=t.model,this.template=t.template,this.schema=t.schema,(this._.provides[S]||this.$route).query.sort?this.query.sort=(this._.provides[S]||this.$route).query.sort:this.query.sort=t.sort,(this._.provides[S]||this.$route).query.order?this.query.order=(this._.provides[S]||this.$route).query.order:this.query.order=t.sortOrder,(this._.provides[S]||this.$route).query.paginate?isNaN((this._.provides[S]||this.$route).query.paginate)||(this.query.paginate=(this._.provides[S]||this.$route).query.paginate*1):this.query.paginate=t.paging,(this._.provides[S]||this.$route).query.currentPage?isNaN((this._.provides[S]||this.$route).query.currentPage)?this.query.currentPage=1:this.query.currentPage=(this._.provides[S]||this.$route).query.currentPage*1:this.query.currentPage=1,t.gridTheme&&(this.gridTheme=t.gridTheme),this.hasContextMenu=t.isContextMenu,this.gridActions=t.actions,this.identity=t.identity,this.actionPosition=t.actionPosition?t.actionPosition:0,this.isClient="isClient"in t?t.isClient:!1,this.isStatic="staticWidth"in t?t.staticWidth:!1,this.isNumbered="isNumbered"in t?t.isNumbered:!1,this.formula="formula"in t?t.formula:[],this.fullText="fullText"in t?t.fullText:!1,this.editableAction="editableAction"in t?t.editableAction:null,this.editType="editFullRow"in t&&t.editFullRow?"fullRow":null,this.singleClickEdit="singleClickEdit"in t?t.singleClickEdit:!1,this.flashChanges="flashChanges"in t?t.flashChanges:!1,this.colMenu="colMenu"in t?t.colMenu:!1,this.colFilterButton="colFilterButton"in t?t.colFilterButton:!0,this.showGrid="showGrid"in t?t.showGrid:!1,this.saveFilter="showGrid"in t?t.saveFilter:!1,this.autoSelect="autoSelect"in t?t.autoSelect:!1,this.autoSelectModel="autoSelectModel"in t?t.autoSelectModel:!1,this.isNumbered&&this.columns.push({headerName:"#",valueGetter:"node.rowIndex + 1",width:50,filter:!1}),this.$parent.isSave=this.editableShouldSubmit="editableShouldSubmit"in t?t.editableShouldSubmit:!1,(t.template===2||t.template===3)&&(this.defaultColDef.floatingFilter=!0),this.isClient?(this.gridOptions.enableServerSideFilter=!1,this.gridOptions.enableServerSideSorting=!1,this.gridOptions.enableFilter=!0,this.gridOptions.enableSorting=!0):(t.columnAggregations&&(this.aggregations.columnAggregations=t.columnAggregations),t.excelUploadCustomUrl&&(this.$parent.excelUploadCustomUrl=t.excelUploadCustomUrl),t.excelUploadSample&&(this.$parent.excelUploadSample=t.excelUploadSample),t.excelUploadCustomNamespace&&(this.$parent.excelUploadCustomNamespace=t.excelUploadCustomNamespace),t.excelUploadCustomTrigger&&(this.$parent.excelUploadCustomTrigger=t.excelUploadCustomTrigger),t.columnAggregationsFormula&&(this.aggregations.columnAggregationsFormula=t.columnAggregationsFormula)),t.theme&&(this.theme="theme"in t?t.theme:"normal",this.theme=="mini"?(this.gridApi.setHeaderHeight(22),this.gridApi.setFloatingFiltersHeight(22),this.gridOptions.rowHeight=24):this.gridTheme==="balham"?(this.gridApi.setHeaderHeight(30),this.gridApi.setFloatingFiltersHeight(30)):(this.gridApi.setHeaderHeight(56),this.gridApi.setFloatingFiltersHeight(40))),t.fullWidth&&(this.gridOptions.sizeColumnsToFit=t.fullWidth,this.fullWidth=!0),t.isPrint&&this.changeKrudTool&&(this.isPrint=t.isPrint,this.changeKrudTool("isPrint",t.isPrint),this.printSize=t.printSize),t.isExcel&&this.changeKrudTool&&this.changeKrudTool("isExcel",t.isExcel),t.isExcelUpload&&this.changeKrudTool&&this.changeKrudTool("isExcelUpload",t.isExcelUpload),t.isExcelUploadSample&&this.changeKrudTool&&this.changeKrudTool("isExcelUploadSample",t.isExcelUploadSample),t.isRefresh&&this.changeKrudTool&&this.changeKrudTool("isRefresh",t.isRefresh),t.isPivot&&(this.sideBar={toolPanels:[{id:"columns",labelDefault:"Columns",labelKey:"columns",iconKey:"columns",toolPanel:"agColumnsToolPanel"}],defaultToolPanel:""}),this.$props.hasSelection&&(this.$props.gridSelector?this.selectionMethod="single":this.selectionMethod="multiple"),t.hasCheckbox||this.$props.hasSelection){this.hasCheckbox=!0;let s={headerName:"",width:38,minWidth:38,suppressNavigable:!0,cellClass:"no-border grid-checkbox",checkboxSelection:!0,headerCheckboxSelection:!this.$props.gridSelector,headerCheckboxSelectionFilteredOnly:!0,filter:!1};this.columns.push(s)}(t.hasCheckbox||this.$props.hasSelection)&&(this.hasCheckbox=!0);let i=!0;if(t.header&&t.header.render&&(this.header=t.header,this.gridOptions.headerHeight=0,this.gridOptions.enableColResize=!1,this.gridOptions.toolPanelSuppressSideButtons=!0,this.isStatic=!0,this.tableWidth==null&&(this.tableWidth=0),t.header.structure.forEach(s=>{s.children.forEach(r=>{if(r.model!=null){let n=t.schema.find(a=>a.model===r.model);n&&(n.filterable&&(this.filterModel[n.model]=null,i=!1),n.width=parseInt(r.width)+1,this.tableWidth+=n.width)}})}),this.init=!0,t.hasCheckbox&&(this.tableWidth+=32)),this.schema.forEach(s=>{s.filterable&&(k(s.filter.default)?this.filterModel[s.model]=s.filter.default:this.filterModel[s.model]=null,i=!1),this.setColumn(s)}),this.init=!0,i&&(this.defaultColDef.floatingFilter=!1),!this.hasContextMenu&&!this.$props.hasSelection&&(t.actions.length>0||this.$props.actions&&this.$props.actions.length>0)){let s=t.actions.length*50;this.$props.actions&&(s+=this.$props.actions.length*50),this.header!=null&&(this.tableWidth+=parseInt(s));let r=t.actions;this.permissions&&(this.permissions.u||(r=r.filter(a=>a!="e")),this.permissions.d||(r=r.filter(a=>a!="d")));let n={headerName:"...",width:s,field:this.identity?this.identity:"id",suppressMenu:!0,sortable:!1,filter:!1,cellRenderer:"GridActions",cellRendererParams:{actions:r,width:s,methods:{quickEdit:this.quickEdit,clone:this.fnClone,view:this.fnView,edit:this.fnEdit,remove:this.remove,permissions:this.permissions},customActions:this.$props.actions,actionsVisibility:this.$props.actionvisibility}};this.permissions?(this.permissions.r||this.permissions.u||this.permissions.d)&&(this.actionPosition==0?this.columns.push(n):this.columns.unshift(n)):this.actionPosition==0?this.columns.push(n):this.columns.unshift(n)}this.query.src=this.baseUrl+"/lambda/puzzle/grid/data/"+t.grid_id,this.saveFilter&&this.restoreFilter(),this.fetchData()},setColumn(e){if(k(e.editable)&&k(e.editable)&&e.editable.shouldPost&&this.postModels.push(e.model),!e.hide){let t={headerName:e.label===""?e.model:e.label,field:e.model,enableRowGroup:!0,enableValue:!0,enablePivot:!0,suppressMenu:!this.colMenu};if(e.sortable||(t.sortable=!1),this.fullText&&(t.cellStyle={"white-space":"normal"},t.autoHeight=!0),e.filterable)switch(k(e.filter.param)&&(k((this._.provides[S]||this.$route).query[e.filter.param])&&(this.filterModel[e.model]=(this._.provides[S]||this.$route).query[e.filter.param]),this.$watch("$route.query."+e.filter.param,{handler:()=>{(this._.provides[S]||this.$route).query[e.filter.param]&&(this.filterModel[e.model]={filter:(this._.provides[S]||this.$route).query[e.filter.param]?(this._.provides[S]||this.$route).query[e.filter.param]:"",filterType:"text",type:k(e.filter.paramCompareType)?e.filter.paramCompareType:"contains"},this.fetchData())},deep:!0})),e.filter.type){case"Number":t.filter="agNumberColumnFilter",t.filterParams={newRowsAction:"keep",suppressAndOrCondition:!0};break;case"Date":t.filter="agDateColumnFilter",t.filterParams={newRowsAction:"keep",comparator:(i,s)=>{let r=s.substr(0,10).split("-"),n=parseInt(r[2]),a=parseInt(r[1])-1,o=parseInt(r[0]),u=new Date(o,a,n);return u<i?-1:u>i?1:0},inRangeInclusive:!0,browserDatePicker:!0,suppressAndOrCondition:!0};break;case"DateRange":t.filter="agDateColumnFilter",t.filterParams={newRowsAction:"keep",comparator:(i,s)=>{let r=s.substr(0,10).split("-"),n=parseInt(r[2]),a=parseInt(r[1])-1,o=parseInt(r[0]),u=new Date(o,a,n);return u<i?-1:u>i?1:0},defaultOption:"inRange",inRangeInclusive:!0,browserDatePicker:!0,suppressAndOrCondition:!0};break;case"Select":this.isClient?(t.filter="agTextColumnFilter",t.filterParams={newRowsAction:"keep",suppressAndOrCondition:!0}):(t.floatingFilterComponent="selectFloatingFilter",t.floatingFilterComponentParams={newRowsAction:"keep",suppressAndOrCondition:!0,selectAllOnMiniFilter:!0,suppressFilterButton:!0,schemaID:this.schemaID,column:this.schema.find(i=>i.model===e.model),filterModel:this.filterModel,filterData:this.updateFilterModel});break;case"Tag":this.isClient?(t.filter="agTextColumnFilter",t.filterParams={newRowsAction:"keep",suppressAndOrCondition:!0}):(t.floatingFilterComponent="selectFloatingFilter",t.floatingFilterComponentParams={newRowsAction:"keep",suppressAndOrCondition:!0,selectAllOnMiniFilter:!0,suppressFilterButton:!0,schemaID:this.schemaID,column:this.schema.find(i=>i.model==e.model),filterModel:this.filterModel,filterData:this.updateFilterModel});break;case"Set-Filter":if(this.isClient)t.filter="agSetColumnFilter",t.filterParams={newRowsAction:"keep",selectAllOnMiniFilter:!1,suppressSyncValuesAfterDataChange:!1,suppressRemoveEntries:!1,suppressSelectAll:!0,suppressMiniFilter:!0};else{let i=this.schema.find(r=>r.model==e.model),s=`/lambda/krud/${this.schemaID}/options`;t.filter="agSetColumnFilter",t.filterParams={newRowsAction:"keep",selectAllOnMiniFilter:!0,suppressMiniFilter:!1,cellRenderer:r=>r.value.label,values:r=>{F.post(s,getRelation(i.filter.relation)).then(({data:n})=>{r.success(n)})}}}break;case"Set-Filter-Altered":this.isClient&&(t.filter="agSetColumnFilter",t.floatingFilterComponent="SetFilterAltered",t.filterParams={newRowsAction:"keep",selectAllOnMiniFilter:!1,suppressSyncValuesAfterDataChange:!1,suppressRemoveEntries:!1,suppressSelectAll:!0,suppressMiniFilter:!1,excelMode:"windows"},t.floatingFilterComponentParams={schemaID:this.schemaID,column:this.schema.find(i=>i.model==e.model),width:e.width,isClient:this.isClient,filterModel:this.filterModel,filterType:"text",filterData:this.isClient?this.onClientFilter:this.updateFilterModel},this.selectInputModels.push(e.model));break;case"Set-Filter-Date":this.isClient&&(t.filter="agSetColumnFilter",t.floatingFilterComponent="SetFilterDate",t.filterParams={newRowsAction:"keep",selectAllOnMiniFilter:!1,suppressSyncValuesAfterDataChange:!1,suppressRemoveEntries:!1,suppressSelectAll:!0,suppressMiniFilter:!0},t.floatingFilterComponentParams={schemaID:this.schemaID,column:this.schema.find(i=>i.model==e.model),width:e.width,isClient:this.isClient,filterModel:this.filterModel,filterType:"text",filterData:this.isClient?this.onClientFilter:this.updateFilterModel},this.selectInputModels.push(e.model));break;default:t.filter="agTextColumnFilter",this.isClient?t.filterParams={newRowsAction:"keep",suppressAndOrCondition:!0,textCustomComparator:(i,s,r)=>{let n=!1,a=!1;r.charAt(0)=="*"&&(n=!0),r[r.length-1]=="*"&&(a=!0);let u=r.toLowerCase().replace("*",""),y=s.toString().toLowerCase();if(n==!0&&a==!1){let d=y.lastIndexOf(u);return d>=0&&d===y.length-u.length}if(a==!0&&n==!1)return y.indexOf(u)===0;if(a==!1&&n==!1||a==!0&&n==!0)return y.includes(u)}}:t.filterParams={newRowsAction:"keep",suppressAndOrCondition:!0,textCustomComparator:(i,s,r)=>r.replace("*","")};break}else t.filter=!1;if(this.isStatic&&(this.header!=null?t.width=parseInt(e.width):t.width=this.getColumnWidth(e.width,e.model)),e.pinned&&(t.pinned=e.pinPosition,t.lockPosition=!0,t.width=e.width),k(e.gridType)&&e.gridType==="File"&&(t.cellRenderer=Ce),k(e.gridType)&&e.gridType,k(e.gridType)&&(e.gridType==="Image"||e.gridType==="SVG")&&(t.cellRenderer=ve),k(e.gridType)&&e.gridType==="Date"&&(t.valueFormatter=i=>Ge(i.value)),k(e.gridType)&&e.gridType==="Datetime"&&(t.valueFormatter=i=>Be(i.value)),k(e.gridType)&&e.gridType==="Number"&&(t.cellRenderer=De),k(e.gridType)&&e.gridType==="Radio"&&(t.cellRenderer=Se,t.cellRendererParams={valueOptions:e.options}),k(e.gridType)&&(e.gridType==="Checkbox"||e.gridType==="Switch")&&(t.cellRenderer=we),k(e.gridType)&&e.gridType==="Html"&&(t.cellRenderer=X,t.cellRendererParams={customOptions:e.options,fetchData:this.fetchData}),k(e.gridType)&&e.gridType==="Custom"&&(t.cellRenderer=ke,t.cellRendererParams={customOptions:e.options,fetchData:this.fetchData}),k(e.gridType)&&e.gridType==="Link"&&(t.cellRenderer=Ae,t.cellRendererParams={customOptions:e.options,fetchData:this.fetchData,link:e.link,linkTarget:e.linkTarget,icon:e.icon,showOnlyIcon:e.showOnlyIcon}),k(e.gridType),k(e.editable)&&k(e.editable.shouldUpdate)&&e.editable.shouldUpdate&&this.updateModels.push(e.model),k(e.editable)&&typeof e.editable.status!=null&&e.editable.status==!0)switch(t.cellRenderer=X,t.cellRendererParams={state:"",type:e.gridType},t.editable=!0,e.editable.type){case"date":t.cellEditor="editableDate",t.cellEditorParams={editType:this.editType};break;case"datepicker":t.cellEditor="editableDatePicker";break;case"number":t.cellEditor="agNumberCellEditor";break;case"select":t.cellEditor="editableSelect";break}if(k(e.gridType)&&this.$customDataGridElementList&&this.$customDataGridElementList.length>=1){const i=this.$customDataGridElementList.findIndex(s=>s.element===e.gridType);i>=0&&(t.cellRenderer=this.$customDataGridElementList[i].component,t.cellRendererParams={customOptions:e.options,fetchData:this.fetchData})}this.columns.push(t)}},getColumnWidth(e,t){let i=window.localStorage.getItem(this.$props.schemaID+"_column_width_"+t);return parseInt(i||e)},columnResized(e){e.finished},restoreFilter(){if(!this.isClient){let e=JSON.parse(localStorage.getItem(`grid-${this.schemaID}`));this.filterModel={};for(let t in e)this.filterModel[t]=e[t]}},restoreFloatFilterValue(){let e=JSON.parse(localStorage.getItem(`grid-${this.schemaID}`));for(let t in e)this.gridApi.getFilterInstance(t).setModel(e[t])},saveFilterState(){localStorage.setItem(`grid-${this.schemaID}`,JSON.stringify(this.gridApi.getFilterModel()))},setUserConditionValues(e){return this.user_condition.forEach(t=>{e[t.grid_field]=window.init.user[t.user_field]}),e},fetchData(){this.gridApi.showLoadingOverlay(),this.isLoading=!0;let e=`${this.query.src}?&paginate=${this.query.paginate}&page=${this.query.currentPage}&sort=${this.query.sort}&order=${this.query.order}`,t=Object.keys(this.filterModel).filter(i=>this.filterModel[i]!==null).reduce((i,s)=>(i[s]=this.filterModel[s],i),{});this.filter&&(t={...t,...this.filter}),this.searchModel&&(e=`${e}&search=${this.searchModel}`),this.user_condition&&(t.user_condition=this.user_condition),this.custom_condition&&(t.custom_condition=this.custom_condition),F.post(e,t).then(({data:i})=>{this.isClient?(Array.isArray(i)&&(this.data=i,this.info.total=i.length),typeof i=="object"&&"data"in i&&(this.data=i.data)):(this.info.total=i.total,this.info.totalPage=i.last_page,this.data=i.data??[],this.gridOptions.api.setRowData(i.data),this.aggregations.columnAggregations.length>=1&&this.fetchAggregations(t)),this.gridOptions.sizeColumnsToFit&&this.gridApi.sizeColumnsToFit(),this.data.length<=0?(this.gridOptions.suppressNoRowsOverlay=!1,this.gridApi.showNoRowsOverlay()):this.gridApi.hideOverlay(),setTimeout(()=>{this.preselect(),this.selectInputModels.forEach(s=>{this.gridApi.getFilterInstance(s).selectNothing()})},100),this.isLoading=!1}).catch(i=>{console.log(i.message),this.gridApi.hideOverlay(),this.isLoading=!1})},updateFilterModel(e,t){this.filterModel[e]=t,this.filterData(1)},filterData(e){this.changePage(e),this.showMobileFilter=!1},fetchAggregations(e){this.aggregations.loading=!0,this.aggregations.forumlaResult="",this.aggregations.data=[],F.post(`${this.baseUrl}/lambda/puzzle/grid/aggergation/${this.customShemaId?this.customShemaId:this.$props.schemaID}`,e).then(({data:t})=>{let i={};this.aggregations.columnAggregations.map(r=>{let n=r.aggregation+"_"+r.column;t[0][n]==null&&(n=n.toLowerCase()),i[r.column]=t[0][n]}),this.aggregations.columnAggregationsFormula.map(r=>{let n=nt(r.template,i),a=at(n),o=r.title+": "+mt(a)+r.symbol;this.aggregations.forumlaResult==""?this.aggregations.forumlaResult=o:this.aggregations.forumlaResult=this.aggregations.forumlaResult+", "+o});let s={};this.columns.map(r=>{r.field&&(s[r.field]=null)}),this.aggregations.columnAggregations.map(r=>{let n=r.aggregation,a=r.column;if(t.length>=1){let o=this.schema.findIndex(y=>y.model==a),u=n+"_"+a;t[0][u]==null&&(u=u.toLowerCase()),i[r.column]=t[0][u],o>=0&&(s[a]=_e(t[0][u])+" "+r.symbol)}}),this.gridApi.setPinnedBottomRowData([s]),this.aggregations.data=t,this.aggregations.loading=!1}).catch(t=>{console.log(t.message)})},fetchAggregationsTuushin(e,t){this.aggregations.loading=!0,this.aggregations.forumlaResult="",this.aggregations.data=[];let i={};this.columns.map(r=>{r.field&&(i[r.field]=null)});let s="totalamountfcy saleamountfcy agent1dun agent2dun agent3dun agent4dun agent5dun niitzardal profitamountfcy";this.aggregations.columnAggregations.map(r=>{let n=r.column;Z.length>=1&&(s.includes(n)?i[n]=t[n].MNT+" "+t[n].USD+" "+t[n].EUR+" "+t[n].JPY+" "+t[n].AUD+" "+t[n].RUB:i[n]=t[n])}),this.gridApi.setPinnedBottomRowData([i]),this.aggregations.data=Z,this.aggregations.loading=!1},searchData(e,t){this.searchModel=e,this.changePage(t)},changePage(e,t){this.query.currentPage=e,t&&(this.query.paginate=t),this.$router.push({query:{sort:this.query.sort,order:this.query.order,paginate:this.query.paginate,currentPage:this.query.currentPage}}),this.fetchData()},append(e){this.data=[_.cloneDeep(e),...this.data],this.info.total++},update(e){this.data=this.data.map(t=>(t[this.identity]==e[this.identity]&&(t=e),t))},view(e){console.log("view data",e)},quickEdit(e){console.log("quickedit data",e)},remove(e,t){this.delLoading=!0,F.delete(this.page_id?`${this.baseUrl}/lambda/krud/delete/${this.schemaID}/${e}?page_id=${this.page_id}`:`${this.baseUrl}/lambda/krud/delete/${this.schemaID}/${e}`).then(i=>{i.status?(L.success({message:this.lang.infoDeleted}),this.refresh()):(L.error({message:this.lang.errorOccWhileDeleting+"!"}),setTimeout(()=>{this.delLoading=!1,this.deleteModal=!1},600))}).catch(i=>{L.error({message:this.lang.errorMsg+"!"}),setTimeout(()=>{this.delLoading=!1,this.deleteModal=!1},600)})},refresh(){this.searchModel=null,this.filterModel={},this.gridApi.setFilterModel(null),localStorage.removeItem(`grid-${this.schemaID}`),(this._.provides[S]||this.$route).query.sort&&(this.query.sort=(this._.provides[S]||this.$route).query.sort),(this._.provides[S]||this.$route).query.order&&(this.query.order=(this._.provides[S]||this.$route).query.order),(this._.provides[S]||this.$route).query.paginate&&(isNaN((this._.provides[S]||this.$route).query.paginate)||(this.query.paginate=(this._.provides[S]||this.$route).query.paginate*1)),(this._.provides[S]||this.$route).query.currentPage?isNaN((this._.provides[S]||this.$route).query.currentPage)?this.query.currentPage=1:this.query.currentPage=(this._.provides[S]||this.$route).query.currentPage*1:this.query.currentPage=1,this.fetchData()},exportExcel(e){if(this.isClient)this.gridApi.exportDataAsExcel();else{let t=`${this.baseUrl}/lambda/krud/excel/${this.schemaID}?sort=${this.query.sort}&order=${this.query.order}`,i=Object.keys(this.filterModel).filter(s=>this.filterModel[s]!==null).reduce((s,r)=>(s[r]=this.filterModel[r],s),{});this.user_condition&&(i.user_condition=this.user_condition),this.custom_condition&&(i.custom_condition=this.custom_condition),this.header&&(i.customHeader=JSON.stringify(this.header)),this.header&&(i.customHeader="customHeader"),F.post(t,i).then(({data:s})=>{if(s.tableRows){let r=document.getElementById("custom-header");rt(r?r.innerHTML:"",s.tableRows,s.name),e&&e(!0)}else{let r=document.createElement("a");const n=this.b64toBlob(decodeURIComponent(s.file),"data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");r.href=URL.createObjectURL(n),r.download=s.name,r.click(),e&&e(!0)}}).catch(s=>{console.log(s.message),e&&e(!1)})}},b64toBlob(e,t="",i=512){const s=atob(e),r=[];for(let a=0;a<s.length;a+=i){const o=s.slice(a,a+i),u=new Array(o.length);for(let d=0;d<o.length;d++)u[d]=o.charCodeAt(d);const y=new Uint8Array(u);r.push(y)}return new Blob(r,{type:t})},print(){this.showPrint=!0},importExcel(){this.showExcelImport=!0},onRowDblClick(e){this.$props.dblClick?this.permissions?this.permissions.u&&this.$props.dblClick(e.data):this.$props.dblClick(e.data):this.permissions&&this.permissions.u&&(this.gridActions.find(t=>t=="dbl")||this.gridActions.find(t=>t=="obl"))&&e.data[this.identity]&&this.fnEdit(e.data[this.identity])},onRowClick(e){this.permissions&&this.permissions.u&&this.gridActions.find(t=>t=="obl")&&e.data[this.identity]&&this.fnEdit(e.data[this.identity],e.data)},getContextMenuItems(e){if(!this.hasContextMenu||e.node==null)return null;let t=e.node.data.id,i=[];return this.$props.actions&&this.$props.actions.forEach(s=>{let r={name:s.label?s.label:"",icon:"<span class='"+s.icon+"'></span>",action:()=>{s.method(e.node.data)},disabled:s.disabled?s.disabled:!1};i.push(r)}),this.gridActions.forEach(s=>{if(s=="qe"&&console.log("qe"),s=="cl"){let r={name:"Хувилах",icon:"<span class='ivu-icon ivu-icon-ios-copy-outline'></span>",action:()=>{this.fnClone(t)}};i.push(r)}if(s=="v"&&console.log("v action"),s=="e"){let r={name:"Засах",icon:"<span class='ivu-icon ivu-icon-ios-color-wand-outline'></span>",action:()=>{this.fnEdit(t)}};i.push(r)}if(s=="d"){let r={name:"Устгах",icon:"<span class='ivu-icon ivu-icon-ios-trash-outline'></span>",action:()=>{this.deleteModal=!0,this.currentRow.rowId=t,this.currentRow.rowIndex=e.node.rowIndex}};i.push(r)}}),i},onSortChanged(){if(!this.isClient){let e=this.gridColumnApi.getColumnState().filter(t=>t.sort!=null);typeof e<"u"&&e.length>0&&(this.query.sort=e[0].colId,this.query.order=e[0].sort,this.fetchData())}},getColumnValues(e){let t=[];return this.gridApi.forEachNode(i=>{!t.includes(i.data[e])&&i.data[e]!=null&&t.push(i.data[e])}),t},manualAliasFilter(e,t){return e.filter(i=>{let s=!1,r=!1;i.charAt(0)=="*"&&(s=!0),i[i.length-1]=="*"&&(r=!0);let a=i.toLowerCase().replace("*",""),o=t.toString().toLowerCase();if(s==!0&&r==!1){let u=o.lastIndexOf(a);return u>=0&&u===o.length-a.length}return r==!0&&s==!1?o.indexOf(a)===0:r==!1&&s==!1||r==!0&&s==!0?a.includes(o):!1})},onClientFilter(e,t,i){console.log("working here",i);let s=this.gridApi.getFilterInstance(e),r=this.getColumnValues(e);this.manualAliasFilter(r,t).forEach(a=>{s.selectValue(a)}),s.applyModel(),this.gridApi.onFilterChanged(),s.selectNothing()},onFilterModified(e){this.isClient||console.log(e)},onFilterChanged(e){if(this.saveFilter&&this.saveFilterState(e),this.isClient){let t=e.api.getFilterModel();for(let i in t)Object.prototype.hasOwnProperty.call(t,i)&&(console.log(t[i]),t[i].filterType=="set"&&this.selectInputModels.includes(i)&&this.gridApi.getFilterInstance(i).selectNothing());this.info.total=this.gridApi.getModel().rootNode.childrenAfterFilter.length}else{this.filterModel={};let t=e.api.getFilterModel();for(let i in t)this.filterModel[i]=t[i];this.filterData(1)}},onCellEditingStarted(e){this.editType==null&&(this.editCellValue=e.value)},onCellEditingStopped(e){if(this.editType==null&&this.editableAction!=null&&this.editCellValue!==e.value){let t={};if(t[e.colDef.field]=e.value,this.postModels.forEach(r=>{t[r]=e.data[r]}),this.editableShouldSubmit){this.setChangedData(e,t);return}let i=`<span class='loading-cell'><span>${e.value}</span><i class='ti-reload'></i></span>`;e.node.setDataValue(e.colDef.field,i);let s=H(this.editableAction,e.data);F.post(s,t).then(({data:r})=>{if(r.status){let n=`<span class='success-cell'><span>${e.value}</span><i class='ti-check'></i></span>`;e.node.setDataValue(e.colDef.field,n),k(r.data)&&this.updateModels.forEach(a=>{e.node.setDataValue(a,r.data[a])}),setTimeout(()=>{e.node.setDataValue(e.colDef.field,e.value)},1100)}else setTimeout(()=>{let n=`<span class='error-cell'><span>${e.value}</span><i class='ti-check'></i></span>`;e.node.setDataValue(e.colDef.field,n),setTimeout(()=>{e.node.setDataValue(e.colDef.field,this.editCellValue)},1500)},1e3)}).catch(r=>{console.log(r),setTimeout(()=>{let n=`<span class='error-cell'><span>${e.value}</span><i class='ti-close'></i></span>`;e.node.setDataValue(e.colDef.field,n),setTimeout(()=>{e.node.setDataValue(e.colDef.field,this.editCellValue)},1500)},1e3)})}},onRowEditingStarted(e){this.editRowValue=_.clone(e.data),this.gridApi.setFocusedCell(e.rowIndex,e.node.Column)},onRowEditingStopped(e){if(ye(this.editRowValue,e.data))return;if(this.editableShouldSubmit){let i={rowIndex:e.rowIndex,data:e.data};this.changedRowsData.push(i);return}T.destroy(x),T.loading({content:this.lang.pleaseWaitForLoading,key:x,duration:0});let t=H(this.editableAction,e.data);F.post(t,e.data).then(({data:i})=>{i.status?(T.success({content:this.lang.successfullySaved,key:x,duration:2}),k(i.data)&&this.updateModels.forEach(s=>{e.node.setDataValue(s,i.data[s])})):T.error({content:"msg"in i?i.msg:this.lang.anErrorOccurredWhileSaving,key:x,duration:2})}).catch(i=>{console.log(i),T.error({content:this.lang.anErrorOccurredWhileSaving,key:x,duration:2})})},setChangedData(e,t){let i=this.changedRowsData.find(s=>s.rowIndex===e.rowIndex);if(i)i.data=t;else{let s={rowIndex:e.rowIndex,data:t};this.changedRowsData.push(s)}},saveGridData(){if(this.changedRowsData.length===0){T.info({content:this.lang.noChangesHaveBeenReported,key:x});return}T.destroy(x),T.loading({content:this.lang.pleaseWaitForLoading,key:x,duration:0}),console.log(this.editableAction);let e=H(this.editableAction,{});F.post(e,this.changedRowsData).then(({data:t})=>{t.status?(T.success({content:this.lang.successfullySaved,key:x,duration:2}),k(t.data)&&t.data.forEach(i=>{this.updateModels.forEach(s=>{this.gridApi.getRowNode(i.rowIndex).setDataValue(s,i[s])})}),this.changedRowsData=[]):T.error({content:"msg"in t?t.msg:this.lang.anErrorOccurredWhileSaving,key:x,duration:2})}).catch(t=>{console.log(t),T.error({content:this.lang.anErrorOccurredWhileSaving,key:x,duration:2})})},preselect(){this.gridApi.deselectAll(),this.highlights&&this.highlights.length>0&&this.gridApi.forEachNode(e=>{this.highlights.forEach(t=>{e.data.id==t.id&&e.setSelected(!0)})})},autoSelectRows(e){this.gridApi.getSelectedNodes().forEach(i=>{e.isSelected()?this.gridApi.forEachNode(s=>{s.data[this.autoSelectModel]==i.data[this.autoSelectModel]&&s.setSelected(!0)}):e.data[this.autoSelectModel]==i.data[this.autoSelectModel]&&i.setSelected(!1)})},onRowSelected(e){if(this.$props.onRowSelect){let t=this.gridApi.getSelectedNodes(),i=t.map(s=>s.data);this.autoSelect&&this.autoSelectModel!=null&&this.autoSelectRows(e.node),this.$props.onRowSelect(i,t)}}}},Us={class:"dg"},Ns=["colspan","rowspan"],zs={class:"dg-footer"},qs={class:"dg-info text-gray-700 dark:text-gray-200"},Gs={key:0},Bs={key:0,class:"fixed top-20 right-2"},Ws={class:"settings-btn ant-btn-svg-icon"};function js(e,t,i,s,r,n){const a=b("ag-grid-vue"),o=b("a-pagination"),u=b("inline-svg"),y=b("a-button"),d=b("datafilter"),m=b("a-drawer"),P=b("print"),U=b("a-modal"),Pe=b("excel-import"),Fe=b("GridRowUpdate");return l(),h("div",Us,[c("div",{class:"dg-body bg-white dark:bg-slate-900 rounded-md",style:W(e.fullWidth?"flex: 1":""),ref:"dgBody"},[c("div",{class:M(`dg-table ${e.header!=null?"custom-table":""} ${"template-"+e.template}`)},[e.header!=null?(l(),h("table",{key:0,ref:"customTableHeader",border:"1",style:W(`width: ${e.tableWidth!=null?e.tableWidth+"px":"auto"}`),class:"custom-header",id:"custom-header"},[(l(!0),h(E,null,R(e.header.structure,O=>(l(),h("tr",{key:O.index},[(l(!0),h(E,null,R(O.children,V=>(l(),h("td",{key:V.index,colspan:V.colspan,rowspan:V.rowspan},[c("div",{style:W(`width: ${V.width}; height: ${V.height}`),class:M(V.rotate?"vertical-column":"")},[c("div",null,v(V.label),1)],6)],8,Ns))),128))]))),128))],4)):D("",!0),g(a,{ref:"agGrid",class:M(`${e.$appState.colorScheme==="dark",n.agGridTheme} ag-data-grid ag-table ${e.header!=null?"custom-header-table custom-table-template"+e.template:"template-"+e.template} ${e.sideBar?"":"no-sidebar"} ${e.fullText?"full-text":""} ${e.colFilterButton?"":"no-filter-btn"} ${e.showGrid?"has-grid":""} ${e.theme?e.theme:"normal"}`),style:W(`width: ${e.tableWidth!=null?e.tableWidth+"px":"auto"}`),gridOptions:e.gridOptions,columnDefs:e.columns,rowData:e.data,sideBar:e.sideBar,getContextMenuItems:n.getContextMenuItems,overlayLoadingTemplate:e.overlayLoadingTemplate,rowSelection:e.selectionMethod,defaultColDef:e.defaultColDef,enableRangeSelection:!0,singleClickEdit:e.singleClickEdit,editType:e.editType,stopEditingWhenCellsLoseFocus:!0,enableCellChangeFlash:e.flashChanges,onGridReady:n.onGridReady,onSortChanged:n.onSortChanged,onFilterChanged:n.onFilterChanged,onFilterModified:n.onFilterModified,onRowDoubleClicked:n.onRowDblClick,onRowClicked:n.onRowClick,onRowSelected:n.onRowSelected,onRowEditingStarted:n.onRowEditingStarted,onRowEditingStopped:n.onRowEditingStopped,onCellEditingStarted:n.onCellEditingStarted,onCellEditingStopped:n.onCellEditingStopped,onColumnResized:n.columnResized},null,8,["class","style","gridOptions","columnDefs","rowData","sideBar","getContextMenuItems","overlayLoadingTemplate","rowSelection","defaultColDef","singleClickEdit","editType","enableCellChangeFlash","onGridReady","onSortChanged","onFilterChanged","onFilterModified","onRowDoubleClicked","onRowClicked","onRowSelected","onRowEditingStarted","onRowEditingStopped","onCellEditingStarted","onCellEditingStopped","onColumnResized"])],2),c("div",zs,[c("div",qs,[A(v(n.lang.total)+" : "+v(e.info.total)+" ",1),e.aggregations.forumlaResult!=""?(l(),h("span",Gs,"| "+v(e.aggregations.forumlaResult),1)):D("",!0)]),this.isClient?D("",!0):(l(),I(o,{key:0,rows:e.query.paginate,current:e.query.currentPage,"onUpdate:current":t[0]||(t[0]=O=>e.query.currentPage=O),pageSize:e.query.paginate,"onUpdate:pageSize":t[1]||(t[1]=O=>e.query.paginate=O),"show-size-changer":"",total:e.info.total,size:"small",onChange:n.changePage,pageSizeOptions:["10","20","30","50","100","500"]},null,8,["rows","current","pageSize","total","onChange"]))])],4),n.isMobile&&e.template==1||n.isMobile&&e.template==3?(l(),h("div",Bs,[g(y,{type:"outline",onClick:t[2]||(t[2]=O=>e.showMobileFilter=!0),shape:"circle",size:"large"},{icon:f(()=>[c("span",Ws,[g(u,{src:"/assets/icons/duotune/general/gen021.svg"})])]),_:1})])):D("",!0),n.isMobile&&e.template==1||n.isMobile&&e.template==3?(l(),I(m,{key:1,open:e.showMobileFilter,"onUpdate:open":t[3]||(t[3]=O=>e.showMobileFilter=O),class:"custom-class",style:{color:"red"},title:n.lang.infoCourt,placement:"right"},{default:f(()=>[n.isMobile&&e.template==1||n.isMobile&&e.template==3?(l(),I(d,{key:0,class:"bg-white dark:bg-slate-900 rounded-md",schemaID:i.schemaID,schema:e.schema,permissions:i.permissions,url:i.url,hideTitle:!0,filterData:n.filterData,model:e.filterModel},null,8,["schemaID","schema","permissions","url","filterData","model"])):D("",!0)]),_:1},8,["open","title"])):D("",!0),!n.isMobile&&e.template==1||!n.isMobile&&e.template==3?(l(),I(d,{key:2,class:"bg-white dark:bg-slate-900 rounded-md",schemaID:i.schemaID,schema:e.schema,permissions:i.permissions,url:i.url,filterData:n.filterData,refresh:n.refresh,model:e.filterModel},null,8,["schemaID","schema","permissions","url","filterData","refresh","model"])):D("",!0),g(U,{"min-width":200,"min-height":200,class:"print-modal",footer:null,width:"78%",height:"90%",open:e.showPrint,"onUpdate:open":t[4]||(t[4]=O=>e.showPrint=O)},{default:f(()=>[e.showPrint?(l(),I(P,{key:0,schemaID:e.$props.schemaID,user_condition:i.user_condition,gridTitle:e.gridTitle,pageSize:e.printSize,header:e.header,schema:e.schema,info:e.info,query:e.query,baseUrl:e.baseUrl,search:e.searchModel,filter:e.filterModel,aggregations:e.aggregations,isNumber:e.isNumbered},null,8,["schemaID","user_condition","gridTitle","pageSize","header","schema","info","query","baseUrl","search","filter","aggregations","isNumber"])):D("",!0)]),_:1},8,["open"]),g(U,{"min-width":200,"min-height":200,class:"import-excel-modal",footer:null,width:"78%",height:"90%",title:n.lang.excelImportModalTitle,open:e.showExcelImport,"onUpdate:open":t[5]||(t[5]=O=>e.showExcelImport=O)},{default:f(()=>[g(Pe,{schemaID:e.$props.schemaID,schema:e.schema,baseUrl:e.baseUrl,options:e.$parent},null,8,["schemaID","schema","baseUrl","options"])]),_:1},8,["title","open"]),e.template==0||e.template==2?(l(),I(Fe,{key:3,permissions:i.permissions,model:e.filterModel,schema:e.schema,url:i.url,inFilter:!1,schemaID:i.schemaID},null,8,["permissions","model","schema","url","schemaID"])):D("",!0)])}const sr=$(Vs,[["render",js]]);export{sr as default};
