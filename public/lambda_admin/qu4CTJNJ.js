import{b7 as x,b8 as U,_ as ct}from"./3ncfVO38.js";import{m as yt}from"./DugTeqwv.js";import{D as H,J as P,F as T,I as dt,G as b,L as Y}from"./DXHvmmg6.js";import"./BYTvHWBW.js";import"./CYxtEuKL.js";import"./2tDPZFmp.js";var S={},Z,$;function M(){return $||($=1,Z={wkt:{Point:"POINT",LineString:"LINESTRING",Polygon:"POLYGON",MultiPoint:"MULTIPOINT",MultiLineString:"MULTILINESTRING",MultiPolygon:"MULTIPOLYGON",GeometryCollection:"GEOMETRYCOLLECTION"},wkb:{Point:1,LineString:2,Polygon:3,MultiPoint:4,MultiLineString:5,MultiPolygon:6,GeometryCollection:7},geoJSON:{Point:"Point",LineString:"LineString",Polygon:"Polygon",MultiPoint:"MultiPoint",MultiLineString:"MultiLineString",MultiPolygon:"MultiPolygon",GeometryCollection:"GeometryCollection"}}),Z}var W,K;function v(){if(K)return W;K=1,W=s;function s(h,l){this.buffer=new Buffer(h),this.position=0,this.allowResize=l}function a(h,l){return function(o,i){this.ensureSize(l),h.call(this.buffer,o,this.position,i),this.position+=l}}return s.prototype.writeUInt8=a(Buffer.prototype.writeUInt8,1),s.prototype.writeUInt16LE=a(Buffer.prototype.writeUInt16LE,2),s.prototype.writeUInt16BE=a(Buffer.prototype.writeUInt16BE,2),s.prototype.writeUInt32LE=a(Buffer.prototype.writeUInt32LE,4),s.prototype.writeUInt32BE=a(Buffer.prototype.writeUInt32BE,4),s.prototype.writeInt8=a(Buffer.prototype.writeInt8,1),s.prototype.writeInt16LE=a(Buffer.prototype.writeInt16LE,2),s.prototype.writeInt16BE=a(Buffer.prototype.writeInt16BE,2),s.prototype.writeInt32LE=a(Buffer.prototype.writeInt32LE,4),s.prototype.writeInt32BE=a(Buffer.prototype.writeInt32BE,4),s.prototype.writeFloatLE=a(Buffer.prototype.writeFloatLE,4),s.prototype.writeFloatBE=a(Buffer.prototype.writeFloatBE,4),s.prototype.writeDoubleLE=a(Buffer.prototype.writeDoubleLE,8),s.prototype.writeDoubleBE=a(Buffer.prototype.writeDoubleBE,8),s.prototype.writeBuffer=function(h){this.ensureSize(h.length),h.copy(this.buffer,this.position,0,h.length),this.position+=h.length},s.prototype.writeVarInt=function(h){for(var l=1;(h&4294967168)!==0;)this.writeUInt8(h&127|128),h>>>=7,l++;return this.writeUInt8(h&127),l},s.prototype.ensureSize=function(h){if(this.buffer.length<this.position+h)if(this.allowResize){var l=new Buffer(this.position+h);this.buffer.copy(l,0,0,this.buffer.length),this.buffer=l}else throw new RangeError("index out of range")},W}var E,Q;function lt(){return Q||(Q=1,E={encode:function(s){return s<<1^s>>31},decode:function(s){return s>>1^-(s&1)}}),E}var G,X;function _(){if(X)return G;X=1,G=i;var s=x,a=L(),h=M(),l=v(),o=lt();function i(r,t,e,n,g){a.call(this),this.x=r,this.y=t,this.z=e,this.m=n,this.srid=g,this.hasZ=typeof this.z<"u",this.hasM=typeof this.m<"u"}return s.inherits(i,a),i.Z=function(r,t,e,n){var g=new i(r,t,e,void 0,n);return g.hasZ=!0,g},i.M=function(r,t,e,n){var g=new i(r,t,void 0,e,n);return g.hasM=!0,g},i.ZM=function(r,t,e,n,g){var c=new i(r,t,e,n,g);return c.hasZ=!0,c.hasM=!0,c},i._parseWkt=function(r,t){var e=new i;if(e.srid=t.srid,e.hasZ=t.hasZ,e.hasM=t.hasM,r.isMatch(["EMPTY"]))return e;r.expectGroupStart();var n=r.matchCoordinate(t);return e.x=n.x,e.y=n.y,e.z=n.z,e.m=n.m,r.expectGroupEnd(),e},i._parseWkb=function(r,t){var e=i._readWkbPoint(r,t);return e.srid=t.srid,e},i._readWkbPoint=function(r,t){return new i(r.readDouble(),r.readDouble(),t.hasZ?r.readDouble():void 0,t.hasM?r.readDouble():void 0)},i._parseTwkb=function(r,t){var e=new i;return e.hasZ=t.hasZ,e.hasM=t.hasM,t.isEmpty||(e.x=o.decode(r.readVarInt())/t.precisionFactor,e.y=o.decode(r.readVarInt())/t.precisionFactor,e.z=t.hasZ?o.decode(r.readVarInt())/t.zPrecisionFactor:void 0,e.m=t.hasM?o.decode(r.readVarInt())/t.mPrecisionFactor:void 0),e},i._readTwkbPoint=function(r,t,e){return e.x+=o.decode(r.readVarInt())/t.precisionFactor,e.y+=o.decode(r.readVarInt())/t.precisionFactor,t.hasZ&&(e.z+=o.decode(r.readVarInt())/t.zPrecisionFactor),t.hasM&&(e.m+=o.decode(r.readVarInt())/t.mPrecisionFactor),new i(e.x,e.y,e.z,e.m)},i._parseGeoJSON=function(r){return i._readGeoJSONPoint(r.coordinates)},i._readGeoJSONPoint=function(r){return r.length===0?new i:r.length>2?new i(r[0],r[1],r[2]):new i(r[0],r[1])},i.prototype.toWkt=function(){return typeof this.x>"u"&&typeof this.y>"u"&&typeof this.z>"u"&&typeof this.m>"u"?this._getWktType(h.wkt.Point,!0):this._getWktType(h.wkt.Point,!1)+"("+this._getWktCoordinate(this)+")"},i.prototype.toWkb=function(r){var t=new l(this._getWkbSize());return t.writeInt8(1),this._writeWkbType(t,h.wkb.Point,r),typeof this.x>"u"&&typeof this.y>"u"?(t.writeDoubleLE(NaN),t.writeDoubleLE(NaN),this.hasZ&&t.writeDoubleLE(NaN),this.hasM&&t.writeDoubleLE(NaN)):this._writeWkbPoint(t),t.buffer},i.prototype._writeWkbPoint=function(r){r.writeDoubleLE(this.x),r.writeDoubleLE(this.y),this.hasZ&&r.writeDoubleLE(this.z),this.hasM&&r.writeDoubleLE(this.m)},i.prototype.toTwkb=function(){var r=new l(0,!0),t=a.getTwkbPrecision(5,0,0),e=typeof this.x>"u"&&typeof this.y>"u";return this._writeTwkbHeader(r,h.wkb.Point,t,e),e||this._writeTwkbPoint(r,t,new i(0,0,0,0)),r.buffer},i.prototype._writeTwkbPoint=function(r,t,e){var n=this.x*t.xyFactor,g=this.y*t.xyFactor,c=this.z*t.zFactor,y=this.m*t.mFactor;r.writeVarInt(o.encode(n-e.x)),r.writeVarInt(o.encode(g-e.y)),this.hasZ&&r.writeVarInt(o.encode(c-e.z)),this.hasM&&r.writeVarInt(o.encode(y-e.m)),e.x=n,e.y=g,e.z=c,e.m=y},i.prototype._getWkbSize=function(){var r=21;return this.hasZ&&(r+=8),this.hasM&&(r+=8),r},i.prototype.toGeoJSON=function(r){var t=a.prototype.toGeoJSON.call(this,r);return t.type=h.geoJSON.Point,typeof this.x>"u"&&typeof this.y>"u"?t.coordinates=[]:typeof this.z<"u"?t.coordinates=[this.x,this.y,this.z]:t.coordinates=[this.x,this.y],t},G}var R,j;function q(){if(j)return R;j=1,R=i;var s=x,a=L(),h=M(),l=_(),o=v();function i(r,t){a.call(this),this.points=r||[],this.srid=t,this.points.length>0&&(this.hasZ=this.points[0].hasZ,this.hasM=this.points[0].hasM)}return s.inherits(i,a),i.Z=function(r,t){var e=new i(r,t);return e.hasZ=!0,e},i.M=function(r,t){var e=new i(r,t);return e.hasM=!0,e},i.ZM=function(r,t){var e=new i(r,t);return e.hasZ=!0,e.hasM=!0,e},i._parseWkt=function(r,t){var e=new i;return e.srid=t.srid,e.hasZ=t.hasZ,e.hasM=t.hasM,r.isMatch(["EMPTY"])||(r.expectGroupStart(),e.points.push.apply(e.points,r.matchCoordinates(t)),r.expectGroupEnd()),e},i._parseWkb=function(r,t){var e=new i;e.srid=t.srid,e.hasZ=t.hasZ,e.hasM=t.hasM;for(var n=r.readUInt32(),g=0;g<n;g++)e.points.push(l._readWkbPoint(r,t));return e},i._parseTwkb=function(r,t){var e=new i;if(e.hasZ=t.hasZ,e.hasM=t.hasM,t.isEmpty)return e;for(var n=new l(0,0,t.hasZ?0:void 0,t.hasM?0:void 0),g=r.readVarInt(),c=0;c<g;c++)e.points.push(l._readTwkbPoint(r,t,n));return e},i._parseGeoJSON=function(r){var t=new i;r.coordinates.length>0&&(t.hasZ=r.coordinates[0].length>2);for(var e=0;e<r.coordinates.length;e++)t.points.push(l._readGeoJSONPoint(r.coordinates[e]));return t},i.prototype.toWkt=function(){return this.points.length===0?this._getWktType(h.wkt.LineString,!0):this._getWktType(h.wkt.LineString,!1)+this._toInnerWkt()},i.prototype._toInnerWkt=function(){for(var r="(",t=0;t<this.points.length;t++)r+=this._getWktCoordinate(this.points[t])+",";return r=r.slice(0,-1),r+=")",r},i.prototype.toWkb=function(r){var t=new o(this._getWkbSize());t.writeInt8(1),this._writeWkbType(t,h.wkb.LineString,r),t.writeUInt32LE(this.points.length);for(var e=0;e<this.points.length;e++)this.points[e]._writeWkbPoint(t);return t.buffer},i.prototype.toTwkb=function(){var r=new o(0,!0),t=a.getTwkbPrecision(5,0,0),e=this.points.length===0;if(this._writeTwkbHeader(r,h.wkb.LineString,t,e),this.points.length>0){r.writeVarInt(this.points.length);for(var n=new l(0,0,0,0),g=0;g<this.points.length;g++)this.points[g]._writeTwkbPoint(r,t,n)}return r.buffer},i.prototype._getWkbSize=function(){var r=16;return this.hasZ&&(r+=8),this.hasM&&(r+=8),9+this.points.length*r},i.prototype.toGeoJSON=function(r){var t=a.prototype.toGeoJSON.call(this,r);t.type=h.geoJSON.LineString,t.coordinates=[];for(var e=0;e<this.points.length;e++)this.hasZ?t.coordinates.push([this.points[e].x,this.points[e].y,this.points[e].z]):t.coordinates.push([this.points[e].x,this.points[e].y]);return t},R}var O,tt;function D(){if(tt)return O;tt=1,O=i;var s=x,a=L(),h=M(),l=_(),o=v();function i(r,t,e){a.call(this),this.exteriorRing=r||[],this.interiorRings=t||[],this.srid=e,this.exteriorRing.length>0&&(this.hasZ=this.exteriorRing[0].hasZ,this.hasM=this.exteriorRing[0].hasM)}return s.inherits(i,a),i.Z=function(r,t,e){var n=new i(r,t,e);return n.hasZ=!0,n},i.M=function(r,t,e){var n=new i(r,t,e);return n.hasM=!0,n},i.ZM=function(r,t,e){var n=new i(r,t,e);return n.hasZ=!0,n.hasM=!0,n},i._parseWkt=function(r,t){var e=new i;if(e.srid=t.srid,e.hasZ=t.hasZ,e.hasM=t.hasM,r.isMatch(["EMPTY"]))return e;for(r.expectGroupStart(),r.expectGroupStart(),e.exteriorRing.push.apply(e.exteriorRing,r.matchCoordinates(t)),r.expectGroupEnd();r.isMatch([","]);)r.expectGroupStart(),e.interiorRings.push(r.matchCoordinates(t)),r.expectGroupEnd();return r.expectGroupEnd(),e},i._parseWkb=function(r,t){var e=new i;e.srid=t.srid,e.hasZ=t.hasZ,e.hasM=t.hasM;var n=r.readUInt32();if(n>0){for(var g=r.readUInt32(),c=0;c<g;c++)e.exteriorRing.push(l._readWkbPoint(r,t));for(c=1;c<n;c++){for(var y=[],u=r.readUInt32(),f=0;f<u;f++)y.push(l._readWkbPoint(r,t));e.interiorRings.push(y)}}return e},i._parseTwkb=function(r,t){var e=new i;if(e.hasZ=t.hasZ,e.hasM=t.hasM,t.isEmpty)return e;for(var n=new l(0,0,t.hasZ?0:void 0,t.hasM?0:void 0),g=r.readVarInt(),c=r.readVarInt(),y=0;y<c;y++)e.exteriorRing.push(l._readTwkbPoint(r,t,n));for(y=1;y<g;y++){for(var u=[],f=r.readVarInt(),p=0;p<f;p++)u.push(l._readTwkbPoint(r,t,n));e.interiorRings.push(u)}return e},i._parseGeoJSON=function(r){var t=new i;r.coordinates.length>0&&r.coordinates[0].length>0&&(t.hasZ=r.coordinates[0][0].length>2);for(var e=0;e<r.coordinates.length;e++){e>0&&t.interiorRings.push([]);for(var n=0;n<r.coordinates[e].length;n++)e===0?t.exteriorRing.push(l._readGeoJSONPoint(r.coordinates[e][n])):t.interiorRings[e-1].push(l._readGeoJSONPoint(r.coordinates[e][n]))}return t},i.prototype.toWkt=function(){return this.exteriorRing.length===0?this._getWktType(h.wkt.Polygon,!0):this._getWktType(h.wkt.Polygon,!1)+this._toInnerWkt()},i.prototype._toInnerWkt=function(){for(var r="((",t=0;t<this.exteriorRing.length;t++)r+=this._getWktCoordinate(this.exteriorRing[t])+",";for(r=r.slice(0,-1),r+=")",t=0;t<this.interiorRings.length;t++){r+=",(";for(var e=0;e<this.interiorRings[t].length;e++)r+=this._getWktCoordinate(this.interiorRings[t][e])+",";r=r.slice(0,-1),r+=")"}return r+=")",r},i.prototype.toWkb=function(r){var t=new o(this._getWkbSize());t.writeInt8(1),this._writeWkbType(t,h.wkb.Polygon,r),this.exteriorRing.length>0?(t.writeUInt32LE(1+this.interiorRings.length),t.writeUInt32LE(this.exteriorRing.length)):t.writeUInt32LE(0);for(var e=0;e<this.exteriorRing.length;e++)this.exteriorRing[e]._writeWkbPoint(t);for(e=0;e<this.interiorRings.length;e++){t.writeUInt32LE(this.interiorRings[e].length);for(var n=0;n<this.interiorRings[e].length;n++)this.interiorRings[e][n]._writeWkbPoint(t)}return t.buffer},i.prototype.toTwkb=function(){var r=new o(0,!0),t=a.getTwkbPrecision(5,0,0),e=this.exteriorRing.length===0;if(this._writeTwkbHeader(r,h.wkb.Polygon,t,e),this.exteriorRing.length>0){r.writeVarInt(1+this.interiorRings.length),r.writeVarInt(this.exteriorRing.length);for(var n=new l(0,0,0,0),g=0;g<this.exteriorRing.length;g++)this.exteriorRing[g]._writeTwkbPoint(r,t,n);for(g=0;g<this.interiorRings.length;g++){r.writeVarInt(this.interiorRings[g].length);for(var c=0;c<this.interiorRings[g].length;c++)this.interiorRings[g][c]._writeTwkbPoint(r,t,n)}}return r.buffer},i.prototype._getWkbSize=function(){var r=16;this.hasZ&&(r+=8),this.hasM&&(r+=8);var t=9;this.exteriorRing.length>0&&(t+=4+this.exteriorRing.length*r);for(var e=0;e<this.interiorRings.length;e++)t+=4+this.interiorRings[e].length*r;return t},i.prototype.toGeoJSON=function(r){var t=a.prototype.toGeoJSON.call(this,r);if(t.type=h.geoJSON.Polygon,t.coordinates=[],this.exteriorRing.length>0){for(var e=[],n=0;n<this.exteriorRing.length;n++)this.hasZ?e.push([this.exteriorRing[n].x,this.exteriorRing[n].y,this.exteriorRing[n].z]):e.push([this.exteriorRing[n].x,this.exteriorRing[n].y]);t.coordinates.push(e)}for(var g=0;g<this.interiorRings.length;g++){for(var c=[],y=0;y<this.interiorRings[g].length;y++)this.hasZ?c.push([this.interiorRings[g][y].x,this.interiorRings[g][y].y,this.interiorRings[g][y].z]):c.push([this.interiorRings[g][y].x,this.interiorRings[g][y].y]);t.coordinates.push(c)}return t},O}var N,et;function pt(){if(et)return N;et=1,N=i;var s=x,a=M(),h=L(),l=_(),o=v();function i(r,t){h.call(this),this.points=r||[],this.srid=t,this.points.length>0&&(this.hasZ=this.points[0].hasZ,this.hasM=this.points[0].hasM)}return s.inherits(i,h),i.Z=function(r,t){var e=new i(r,t);return e.hasZ=!0,e},i.M=function(r,t){var e=new i(r,t);return e.hasM=!0,e},i.ZM=function(r,t){var e=new i(r,t);return e.hasZ=!0,e.hasM=!0,e},i._parseWkt=function(r,t){var e=new i;return e.srid=t.srid,e.hasZ=t.hasZ,e.hasM=t.hasM,r.isMatch(["EMPTY"])||(r.expectGroupStart(),e.points.push.apply(e.points,r.matchCoordinates(t)),r.expectGroupEnd()),e},i._parseWkb=function(r,t){var e=new i;e.srid=t.srid,e.hasZ=t.hasZ,e.hasM=t.hasM;for(var n=r.readUInt32(),g=0;g<n;g++)e.points.push(h.parse(r,t));return e},i._parseTwkb=function(r,t){var e=new i;if(e.hasZ=t.hasZ,e.hasM=t.hasM,t.isEmpty)return e;for(var n=new l(0,0,t.hasZ?0:void 0,t.hasM?0:void 0),g=r.readVarInt(),c=0;c<g;c++)e.points.push(l._readTwkbPoint(r,t,n));return e},i._parseGeoJSON=function(r){var t=new i;r.coordinates.length>0&&(t.hasZ=r.coordinates[0].length>2);for(var e=0;e<r.coordinates.length;e++)t.points.push(l._parseGeoJSON({coordinates:r.coordinates[e]}));return t},i.prototype.toWkt=function(){if(this.points.length===0)return this._getWktType(a.wkt.MultiPoint,!0);for(var r=this._getWktType(a.wkt.MultiPoint,!1)+"(",t=0;t<this.points.length;t++)r+=this._getWktCoordinate(this.points[t])+",";return r=r.slice(0,-1),r+=")",r},i.prototype.toWkb=function(){var r=new o(this._getWkbSize());r.writeInt8(1),this._writeWkbType(r,a.wkb.MultiPoint),r.writeUInt32LE(this.points.length);for(var t=0;t<this.points.length;t++)r.writeBuffer(this.points[t].toWkb({srid:this.srid}));return r.buffer},i.prototype.toTwkb=function(){var r=new o(0,!0),t=h.getTwkbPrecision(5,0,0),e=this.points.length===0;if(this._writeTwkbHeader(r,a.wkb.MultiPoint,t,e),this.points.length>0){r.writeVarInt(this.points.length);for(var n=new l(0,0,0,0),g=0;g<this.points.length;g++)this.points[g]._writeTwkbPoint(r,t,n)}return r.buffer},i.prototype._getWkbSize=function(){var r=16;return this.hasZ&&(r+=8),this.hasM&&(r+=8),r+=5,9+this.points.length*r},i.prototype.toGeoJSON=function(r){var t=h.prototype.toGeoJSON.call(this,r);t.type=a.geoJSON.MultiPoint,t.coordinates=[];for(var e=0;e<this.points.length;e++)t.coordinates.push(this.points[e].toGeoJSON().coordinates);return t},N}var B,rt;function ut(){if(rt)return B;rt=1,B=r;var s=x,a=M(),h=L(),l=_(),o=q(),i=v();function r(t,e){h.call(this),this.lineStrings=t||[],this.srid=e,this.lineStrings.length>0&&(this.hasZ=this.lineStrings[0].hasZ,this.hasM=this.lineStrings[0].hasM)}return s.inherits(r,h),r.Z=function(t,e){var n=new r(t,e);return n.hasZ=!0,n},r.M=function(t,e){var n=new r(t,e);return n.hasM=!0,n},r.ZM=function(t,e){var n=new r(t,e);return n.hasZ=!0,n.hasM=!0,n},r._parseWkt=function(t,e){var n=new r;if(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.isMatch(["EMPTY"]))return n;t.expectGroupStart();do t.expectGroupStart(),n.lineStrings.push(new o(t.matchCoordinates(e))),t.expectGroupEnd();while(t.isMatch([","]));return t.expectGroupEnd(),n},r._parseWkb=function(t,e){var n=new r;n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM;for(var g=t.readUInt32(),c=0;c<g;c++)n.lineStrings.push(h.parse(t,e));return n},r._parseTwkb=function(t,e){var n=new r;if(n.hasZ=e.hasZ,n.hasM=e.hasM,e.isEmpty)return n;for(var g=new l(0,0,e.hasZ?0:void 0,e.hasM?0:void 0),c=t.readVarInt(),y=0;y<c;y++){var u=new o;u.hasZ=e.hasZ,u.hasM=e.hasM;for(var f=t.readVarInt(),p=0;p<f;p++)u.points.push(l._readTwkbPoint(t,e,g));n.lineStrings.push(u)}return n},r._parseGeoJSON=function(t){var e=new r;t.coordinates.length>0&&t.coordinates[0].length>0&&(e.hasZ=t.coordinates[0][0].length>2);for(var n=0;n<t.coordinates.length;n++)e.lineStrings.push(o._parseGeoJSON({coordinates:t.coordinates[n]}));return e},r.prototype.toWkt=function(){if(this.lineStrings.length===0)return this._getWktType(a.wkt.MultiLineString,!0);for(var t=this._getWktType(a.wkt.MultiLineString,!1)+"(",e=0;e<this.lineStrings.length;e++)t+=this.lineStrings[e]._toInnerWkt()+",";return t=t.slice(0,-1),t+=")",t},r.prototype.toWkb=function(){var t=new i(this._getWkbSize());t.writeInt8(1),this._writeWkbType(t,a.wkb.MultiLineString),t.writeUInt32LE(this.lineStrings.length);for(var e=0;e<this.lineStrings.length;e++)t.writeBuffer(this.lineStrings[e].toWkb({srid:this.srid}));return t.buffer},r.prototype.toTwkb=function(){var t=new i(0,!0),e=h.getTwkbPrecision(5,0,0),n=this.lineStrings.length===0;if(this._writeTwkbHeader(t,a.wkb.MultiLineString,e,n),this.lineStrings.length>0){t.writeVarInt(this.lineStrings.length);for(var g=new l(0,0,0,0),c=0;c<this.lineStrings.length;c++){t.writeVarInt(this.lineStrings[c].points.length);for(var y=0;y<this.lineStrings[c].points.length;y++)this.lineStrings[c].points[y]._writeTwkbPoint(t,e,g)}}return t.buffer},r.prototype._getWkbSize=function(){for(var t=9,e=0;e<this.lineStrings.length;e++)t+=this.lineStrings[e]._getWkbSize();return t},r.prototype.toGeoJSON=function(t){var e=h.prototype.toGeoJSON.call(this,t);e.type=a.geoJSON.MultiLineString,e.coordinates=[];for(var n=0;n<this.lineStrings.length;n++)e.coordinates.push(this.lineStrings[n].toGeoJSON().coordinates);return e},B}var z,it;function gt(){if(it)return z;it=1,z=r;var s=x,a=M(),h=L(),l=_(),o=D(),i=v();function r(t,e){h.call(this),this.polygons=t||[],this.srid=e,this.polygons.length>0&&(this.hasZ=this.polygons[0].hasZ,this.hasM=this.polygons[0].hasM)}return s.inherits(r,h),r.Z=function(t,e){var n=new r(t,e);return n.hasZ=!0,n},r.M=function(t,e){var n=new r(t,e);return n.hasM=!0,n},r.ZM=function(t,e){var n=new r(t,e);return n.hasZ=!0,n.hasM=!0,n},r._parseWkt=function(t,e){var n=new r;if(n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM,t.isMatch(["EMPTY"]))return n;t.expectGroupStart();do{t.expectGroupStart();var g=[],c=[];for(t.expectGroupStart(),g.push.apply(g,t.matchCoordinates(e)),t.expectGroupEnd();t.isMatch([","]);)t.expectGroupStart(),c.push(t.matchCoordinates(e)),t.expectGroupEnd();n.polygons.push(new o(g,c)),t.expectGroupEnd()}while(t.isMatch([","]));return t.expectGroupEnd(),n},r._parseWkb=function(t,e){var n=new r;n.srid=e.srid,n.hasZ=e.hasZ,n.hasM=e.hasM;for(var g=t.readUInt32(),c=0;c<g;c++)n.polygons.push(h.parse(t,e));return n},r._parseTwkb=function(t,e){var n=new r;if(n.hasZ=e.hasZ,n.hasM=e.hasM,e.isEmpty)return n;for(var g=new l(0,0,e.hasZ?0:void 0,e.hasM?0:void 0),c=t.readVarInt(),y=0;y<c;y++){var u=new o;u.hasZ=e.hasZ,u.hasM=e.hasM;for(var f=t.readVarInt(),p=t.readVarInt(),d=0;d<p;d++)u.exteriorRing.push(l._readTwkbPoint(t,e,g));for(d=1;d<f;d++){for(var m=[],w=t.readVarInt(),k=0;k<w;k++)m.push(l._readTwkbPoint(t,e,g));u.interiorRings.push(m)}n.polygons.push(u)}return n},r._parseGeoJSON=function(t){var e=new r;t.coordinates.length>0&&t.coordinates[0].length>0&&t.coordinates[0][0].length>0&&(e.hasZ=t.coordinates[0][0][0].length>2);for(var n=0;n<t.coordinates.length;n++)e.polygons.push(o._parseGeoJSON({coordinates:t.coordinates[n]}));return e},r.prototype.toWkt=function(){if(this.polygons.length===0)return this._getWktType(a.wkt.MultiPolygon,!0);for(var t=this._getWktType(a.wkt.MultiPolygon,!1)+"(",e=0;e<this.polygons.length;e++)t+=this.polygons[e]._toInnerWkt()+",";return t=t.slice(0,-1),t+=")",t},r.prototype.toWkb=function(){var t=new i(this._getWkbSize());t.writeInt8(1),this._writeWkbType(t,a.wkb.MultiPolygon),t.writeUInt32LE(this.polygons.length);for(var e=0;e<this.polygons.length;e++)t.writeBuffer(this.polygons[e].toWkb({srid:this.srid}));return t.buffer},r.prototype.toTwkb=function(){var t=new i(0,!0),e=h.getTwkbPrecision(5,0,0),n=this.polygons.length===0;if(this._writeTwkbHeader(t,a.wkb.MultiPolygon,e,n),this.polygons.length>0){t.writeVarInt(this.polygons.length);for(var g=new l(0,0,0,0),c=0;c<this.polygons.length;c++){t.writeVarInt(1+this.polygons[c].interiorRings.length),t.writeVarInt(this.polygons[c].exteriorRing.length);for(var y=0;y<this.polygons[c].exteriorRing.length;y++)this.polygons[c].exteriorRing[y]._writeTwkbPoint(t,e,g);for(y=0;y<this.polygons[c].interiorRings.length;y++){t.writeVarInt(this.polygons[c].interiorRings[y].length);for(var u=0;u<this.polygons[c].interiorRings[y].length;u++)this.polygons[c].interiorRings[y][u]._writeTwkbPoint(t,e,g)}}}return t.buffer},r.prototype._getWkbSize=function(){for(var t=9,e=0;e<this.polygons.length;e++)t+=this.polygons[e]._getWkbSize();return t},r.prototype.toGeoJSON=function(t){var e=h.prototype.toGeoJSON.call(this,t);e.type=a.geoJSON.MultiPolygon,e.coordinates=[];for(var n=0;n<this.polygons.length;n++)e.coordinates.push(this.polygons[n].toGeoJSON().coordinates);return e},z}var C,nt;function ft(){if(nt)return C;nt=1,C=o;var s=x,a=M(),h=L(),l=v();function o(i,r){h.call(this),this.geometries=i||[],this.srid=r,this.geometries.length>0&&(this.hasZ=this.geometries[0].hasZ,this.hasM=this.geometries[0].hasM)}return s.inherits(o,h),o.Z=function(i,r){var t=new o(i,r);return t.hasZ=!0,t},o.M=function(i,r){var t=new o(i,r);return t.hasM=!0,t},o.ZM=function(i,r){var t=new o(i,r);return t.hasZ=!0,t.hasM=!0,t},o._parseWkt=function(i,r){var t=new o;if(t.srid=r.srid,t.hasZ=r.hasZ,t.hasM=r.hasM,i.isMatch(["EMPTY"]))return t;i.expectGroupStart();do t.geometries.push(h.parse(i));while(i.isMatch([","]));return i.expectGroupEnd(),t},o._parseWkb=function(i,r){var t=new o;t.srid=r.srid,t.hasZ=r.hasZ,t.hasM=r.hasM;for(var e=i.readUInt32(),n=0;n<e;n++)t.geometries.push(h.parse(i,r));return t},o._parseTwkb=function(i,r){var t=new o;if(t.hasZ=r.hasZ,t.hasM=r.hasM,r.isEmpty)return t;for(var e=i.readVarInt(),n=0;n<e;n++)t.geometries.push(h.parseTwkb(i));return t},o._parseGeoJSON=function(i){for(var r=new o,t=0;t<i.geometries.length;t++)r.geometries.push(h._parseGeoJSON(i.geometries[t],!0));return r.geometries.length>0&&(r.hasZ=r.geometries[0].hasZ),r},o.prototype.toWkt=function(){if(this.geometries.length===0)return this._getWktType(a.wkt.GeometryCollection,!0);for(var i=this._getWktType(a.wkt.GeometryCollection,!1)+"(",r=0;r<this.geometries.length;r++)i+=this.geometries[r].toWkt()+",";return i=i.slice(0,-1),i+=")",i},o.prototype.toWkb=function(){var i=new l(this._getWkbSize());i.writeInt8(1),this._writeWkbType(i,a.wkb.GeometryCollection),i.writeUInt32LE(this.geometries.length);for(var r=0;r<this.geometries.length;r++)i.writeBuffer(this.geometries[r].toWkb({srid:this.srid}));return i.buffer},o.prototype.toTwkb=function(){var i=new l(0,!0),r=h.getTwkbPrecision(5,0,0),t=this.geometries.length===0;if(this._writeTwkbHeader(i,a.wkb.GeometryCollection,r,t),this.geometries.length>0){i.writeVarInt(this.geometries.length);for(var e=0;e<this.geometries.length;e++)i.writeBuffer(this.geometries[e].toTwkb())}return i.buffer},o.prototype._getWkbSize=function(){for(var i=9,r=0;r<this.geometries.length;r++)i+=this.geometries[r]._getWkbSize();return i},o.prototype.toGeoJSON=function(i){var r=h.prototype.toGeoJSON.call(this,i);r.type=a.geoJSON.GeometryCollection,r.geometries=[];for(var t=0;t<this.geometries.length;t++)r.geometries.push(this.geometries[t].toGeoJSON());return r},C}var F,st;function wt(){if(st)return F;st=1,F=s;function s(h,l){this.buffer=h,this.position=0,this.isBigEndian=l||!1}function a(h,l,o){return function(){var i;return this.isBigEndian?i=l.call(this.buffer,this.position):i=h.call(this.buffer,this.position),this.position+=o,i}}return s.prototype.readUInt8=a(Buffer.prototype.readUInt8,Buffer.prototype.readUInt8,1),s.prototype.readUInt16=a(Buffer.prototype.readUInt16LE,Buffer.prototype.readUInt16BE,2),s.prototype.readUInt32=a(Buffer.prototype.readUInt32LE,Buffer.prototype.readUInt32BE,4),s.prototype.readInt8=a(Buffer.prototype.readInt8,Buffer.prototype.readInt8,1),s.prototype.readInt16=a(Buffer.prototype.readInt16LE,Buffer.prototype.readInt16BE,2),s.prototype.readInt32=a(Buffer.prototype.readInt32LE,Buffer.prototype.readInt32BE,4),s.prototype.readFloat=a(Buffer.prototype.readFloatLE,Buffer.prototype.readFloatBE,4),s.prototype.readDouble=a(Buffer.prototype.readDoubleLE,Buffer.prototype.readDoubleBE,8),s.prototype.readVarInt=function(){var h,l=0,o=0;do h=this.buffer[this.position+o],l+=(h&127)<<7*o,o++;while(h>=128);return this.position+=o,l},F}var J,ot;function mt(){if(ot)return J;ot=1,J=h;var s=M(),a=_();function h(l){this.value=l,this.position=0}return h.prototype.match=function(l){this.skipWhitespaces();for(var o=0;o<l.length;o++)if(this.value.substring(this.position).indexOf(l[o])===0)return this.position+=l[o].length,l[o];return null},h.prototype.matchRegex=function(l){this.skipWhitespaces();for(var o=0;o<l.length;o++){var i=this.value.substring(this.position).match(l[o]);if(i)return this.position+=i[0].length,i}return null},h.prototype.isMatch=function(l){this.skipWhitespaces();for(var o=0;o<l.length;o++)if(this.value.substring(this.position).indexOf(l[o])===0)return this.position+=l[o].length,!0;return!1},h.prototype.matchType=function(){var l=this.match([s.wkt.Point,s.wkt.LineString,s.wkt.Polygon,s.wkt.MultiPoint,s.wkt.MultiLineString,s.wkt.MultiPolygon,s.wkt.GeometryCollection]);if(!l)throw new Error("Expected geometry type");return l},h.prototype.matchDimension=function(){var l=this.match(["ZM","Z","M"]);switch(l){case"ZM":return{hasZ:!0,hasM:!0};case"Z":return{hasZ:!0,hasM:!1};case"M":return{hasZ:!1,hasM:!0};default:return{hasZ:!1,hasM:!1}}},h.prototype.expectGroupStart=function(){if(!this.isMatch(["("]))throw new Error("Expected group start")},h.prototype.expectGroupEnd=function(){if(!this.isMatch([")"]))throw new Error("Expected group end")},h.prototype.matchCoordinate=function(l){var o;if(l.hasZ&&l.hasM?o=this.matchRegex([/^(\S*)\s+(\S*)\s+(\S*)\s+([^\s,)]*)/]):l.hasZ||l.hasM?o=this.matchRegex([/^(\S*)\s+(\S*)\s+([^\s,)]*)/]):o=this.matchRegex([/^(\S*)\s+([^\s,)]*)/]),!o)throw new Error("Expected coordinates");return l.hasZ&&l.hasM?new a(parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3]),parseFloat(o[4])):l.hasZ?new a(parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3])):l.hasM?new a(parseFloat(o[1]),parseFloat(o[2]),void 0,parseFloat(o[3])):new a(parseFloat(o[1]),parseFloat(o[2]))},h.prototype.matchCoordinates=function(l){var o=[];do{var i=this.isMatch(["("]);o.push(this.matchCoordinate(l)),i&&this.expectGroupEnd()}while(this.isMatch([","]));return o},h.prototype.skipWhitespaces=function(){for(;this.position<this.value.length&&this.value[this.position]===" ";)this.position++},J}var V,at;function L(){if(at)return V;at=1,V=y;var s=M(),a=_(),h=q(),l=D(),o=pt(),i=ut(),r=gt(),t=ft(),e=wt(),n=v(),g=mt(),c=lt();function y(){this.srid=void 0,this.hasZ=!1,this.hasM=!1}return y.parse=function(u,f){var p=typeof u;if(p==="string"||u instanceof g)return y._parseWkt(u);if(Buffer.isBuffer(u)||u instanceof e)return y._parseWkb(u,f);throw new Error("first argument must be a string or Buffer")},y._parseWkt=function(u){var f,p;u instanceof g?f=u:f=new g(u);var d=f.matchRegex([/^SRID=(\d+);/]);d&&(p=parseInt(d[1],10));var m=f.matchType(),w=f.matchDimension(),k={srid:p,hasZ:w.hasZ,hasM:w.hasM};switch(m){case s.wkt.Point:return a._parseWkt(f,k);case s.wkt.LineString:return h._parseWkt(f,k);case s.wkt.Polygon:return l._parseWkt(f,k);case s.wkt.MultiPoint:return o._parseWkt(f,k);case s.wkt.MultiLineString:return i._parseWkt(f,k);case s.wkt.MultiPolygon:return r._parseWkt(f,k);case s.wkt.GeometryCollection:return t._parseWkt(f,k)}},y._parseWkb=function(u,f){var p,d,m,w={};switch(u instanceof e?p=u:p=new e(u),p.isBigEndian=!p.readInt8(),d=p.readUInt32(),w.hasSrid=(d&536870912)===536870912,w.isEwkb=d&536870912||d&1073741824||d&2147483648,w.hasSrid&&(w.srid=p.readUInt32()),w.hasZ=!1,w.hasM=!1,!w.isEwkb&&(!f||!f.isEwkb)?d>=1e3&&d<2e3?(w.hasZ=!0,m=d-1e3):d>=2e3&&d<3e3?(w.hasM=!0,m=d-2e3):d>=3e3&&d<4e3?(w.hasZ=!0,w.hasM=!0,m=d-3e3):m=d:(d&2147483648&&(w.hasZ=!0),d&1073741824&&(w.hasM=!0),m=d&15),m){case s.wkb.Point:return a._parseWkb(p,w);case s.wkb.LineString:return h._parseWkb(p,w);case s.wkb.Polygon:return l._parseWkb(p,w);case s.wkb.MultiPoint:return o._parseWkb(p,w);case s.wkb.MultiLineString:return i._parseWkb(p,w);case s.wkb.MultiPolygon:return r._parseWkb(p,w);case s.wkb.GeometryCollection:return t._parseWkb(p,w);default:throw new Error("GeometryType "+m+" not supported")}},y.parseTwkb=function(u){var f,p={};u instanceof e?f=u:f=new e(u);var d=f.readUInt8(),m=f.readUInt8(),w=d&15;if(p.precision=c.decode(d>>4),p.precisionFactor=Math.pow(10,p.precision),p.hasBoundingBox=m>>0&1,p.hasSizeAttribute=m>>1&1,p.hasIdList=m>>2&1,p.hasExtendedPrecision=m>>3&1,p.isEmpty=m>>4&1,p.hasExtendedPrecision){var k=f.readUInt8();p.hasZ=(k&1)===1,p.hasM=(k&2)===2,p.zPrecision=c.decode((k&28)>>2),p.zPrecisionFactor=Math.pow(10,p.zPrecision),p.mPrecision=c.decode((k&224)>>5),p.mPrecisionFactor=Math.pow(10,p.mPrecision)}else p.hasZ=!1,p.hasM=!1;if(p.hasSizeAttribute&&f.readVarInt(),p.hasBoundingBox){var I=2;p.hasZ&&I++,p.hasM&&I++;for(var A=0;A<I;A++)f.readVarInt(),f.readVarInt()}switch(w){case s.wkb.Point:return a._parseTwkb(f,p);case s.wkb.LineString:return h._parseTwkb(f,p);case s.wkb.Polygon:return l._parseTwkb(f,p);case s.wkb.MultiPoint:return o._parseTwkb(f,p);case s.wkb.MultiLineString:return i._parseTwkb(f,p);case s.wkb.MultiPolygon:return r._parseTwkb(f,p);case s.wkb.GeometryCollection:return t._parseTwkb(f,p);default:throw new Error("GeometryType "+w+" not supported")}},y.parseGeoJSON=function(u){return y._parseGeoJSON(u)},y._parseGeoJSON=function(u,f){var p;switch(u.type){case s.geoJSON.Point:p=a._parseGeoJSON(u);break;case s.geoJSON.LineString:p=h._parseGeoJSON(u);break;case s.geoJSON.Polygon:p=l._parseGeoJSON(u);break;case s.geoJSON.MultiPoint:p=o._parseGeoJSON(u);break;case s.geoJSON.MultiLineString:p=i._parseGeoJSON(u);break;case s.geoJSON.MultiPolygon:p=r._parseGeoJSON(u);break;case s.geoJSON.GeometryCollection:p=t._parseGeoJSON(u);break;default:throw new Error("GeometryType "+u.type+" not supported")}if(u.crs&&u.crs.type&&u.crs.type==="name"&&u.crs.properties&&u.crs.properties.name){var d=u.crs.properties.name;if(d.indexOf("EPSG:")===0)p.srid=parseInt(d.substring(5));else if(d.indexOf("urn:ogc:def:crs:EPSG::")===0)p.srid=parseInt(d.substring(22));else throw new Error("Unsupported crs: "+d)}else f||(p.srid=4326);return p},y.prototype.toEwkt=function(){return"SRID="+this.srid+";"+this.toWkt()},y.prototype.toEwkb=function(){var u=new n(this._getWkbSize()+4),f=this.toWkb();return u.writeInt8(1),u.writeUInt32LE((f.slice(1,5).readUInt32LE(0)|536870912)>>>0,!0),u.writeUInt32LE(this.srid),u.writeBuffer(f.slice(5)),u.buffer},y.prototype._getWktType=function(u,f){var p=u;return this.hasZ&&this.hasM?p+=" ZM ":this.hasZ?p+=" Z ":this.hasM&&(p+=" M "),f&&!this.hasZ&&!this.hasM&&(p+=" "),f&&(p+="EMPTY"),p},y.prototype._getWktCoordinate=function(u){var f=u.x+" "+u.y;return this.hasZ&&(f+=" "+u.z),this.hasM&&(f+=" "+u.m),f},y.prototype._writeWkbType=function(u,f,p){var d=0;typeof this.srid>"u"&&(!p||typeof p.srid>"u")?this.hasZ&&this.hasM?d+=3e3:this.hasZ?d+=1e3:this.hasM&&(d+=2e3):(this.hasZ&&(d|=2147483648),this.hasM&&(d|=1073741824)),u.writeUInt32LE(d+f>>>0,!0)},y.getTwkbPrecision=function(u,f,p){return{xy:u,z:f,m:p,xyFactor:Math.pow(10,u),zFactor:Math.pow(10,f),mFactor:Math.pow(10,p)}},y.prototype._writeTwkbHeader=function(u,f,p,d){var m=(c.encode(p.xy)<<4)+f,w=(this.hasZ||this.hasM)<<3;if(w+=d<<4,u.writeUInt8(m),u.writeUInt8(w),this.hasZ||this.hasM){var k=0;this.hasZ&&(k|=1),this.hasM&&(k|=2),u.writeUInt8(k)}},y.prototype.toGeoJSON=function(u){var f={};return this.srid&&u&&(u.shortCrs?f.crs={type:"name",properties:{name:"EPSG:"+this.srid}}:u.longCrs&&(f.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+this.srid}})),f},V}var ht;function kt(){return ht||(ht=1,S.Types=M(),S.Geometry=L(),S.Point=_(),S.LineString=q(),S.Polygon=D(),S.MultiPoint=pt(),S.MultiLineString=ut(),S.MultiPolygon=gt(),S.GeometryCollection=ft()),S}kt();const bt=U("/assets/images/baseMaps/googleStreets.jpg"),St=U("/assets/images/baseMaps/googleSatellite.jpg"),Mt=U("/assets/images/baseMaps/openstreet.jpg"),vt={mixins:[yt],components:{},mounted(){this.do_render&&this.initMap()},computed:{geoVal(){return this.model.form[this.model.component]}},watch:{do_render(s,a){s?this.editMode?!this.geoVal&&!this.map&&this.initMap():this.initMap():this.destroy()},geoVal(s,a){s&&a===null&&this.getGisData()}},data(){return{map:null,parcelLayer:null,currentLayer:null,vector:null,source:null,isLoading:!1,isLoadingLayer:!1,q:"",selectedLayer:null,layers:{otm:new ol.source.TileImage({url:"https://{a-c}.tile.opentopomap.org/{z}/{x}/{y}.png"}),osm:new ol.source.TileImage({url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),osmBW:new ol.source.TileImage({url:"https://tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png"}),osmCycle:new ol.source.TileImage({url:"https://tile.thunderforest.com/cycle/{z}/{x}/{y}.png"}),googleLayerRoadNames:new ol.source.TileImage({url:"https://mt1.google.com/vt/lyrs=h&x={x}&y={y}&z={z}"}),googleLayerRoadmap:new ol.source.TileImage({url:"https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}"}),googleLayerSatellite:new ol.source.TileImage({url:"https://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}"}),esriLayerStreet:new ol.source.TileImage({url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}"}),esriLayerTopo:new ol.source.TileImage({url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}"}),cartoPositron:new ol.source.TileImage({url:"https://cartodb-basemaps-a.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"}),stamenTerrain:new ol.source.TileImage({url:"https://a.tile.stamen.com/terrain/{z}/{x}/{y}.png"}),alagacSpecial:new ol.source.TileImage({url:"https://geoportal.nsdi.gov.mn/alagac/rest/services/ALAGAC/11THG/MapServer/tile/{z}/{y}/{x}"}),alagacForest:new ol.source.TileImage({url:"https://geoportal.nsdi.gov.mn/alagac/rest/services/ALAGAC/CTM_map/MapServer/tile/{z}/{y}/{x}"}),nsdi:new ol.source.TileImage({url:"https://gisserver01.nsdi.gov.mn/gzbgzzg/rest/services/EngineerHM/Ulaanbaatar_Gazar_Hudlul_Bichil_Mujlal_Hursnii_Orgil_Hurdatgal_UTM48N/MapServer/export?bbox=606139.8364730093,5264976.112310054,765882.3714873542,5333060.391939491"})}}},methods:{initMap(){this.source=new ol.source.Vector,this.vector=new ol.layer.Vector({source:this.source,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})})}),this.currentLayer=new ol.layer.Tile({source:new ol.source.TileImage({url:"https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",crossOrigin:"Anonymous"})}),this.map=new ol.Map({target:"qgis",layers:[this.currentLayer,this.vector],view:new ol.View({center:ol.proj.fromLonLat([106.831832,47.8916288]),zoom:12}),controls:ol.control.defaults().extend([new ol.control.FullScreen])}),this.drawLayer(),this.map.on("click",s=>{let a=ol.proj.transform(s.coordinate,"EPSG:3857","EPSG:4326"),h=parseFloat(a[1]).toFixed(6),l=parseFloat(a[0]).toFixed(6);if(this.map.getView().setCenter(ol.proj.fromLonLat([parseFloat(l),parseFloat(h)])),this.map.getView().setZoom(14),this.parcelLayer!=null){let o=this.map.getView(),i=o.getResolution(),t=this.parcelLayer.getSource().getGetFeatureInfoUrl(s.coordinate,i,o.getProjection(),{INFO_FORMAT:"application/json",FEATURE_COUNT:50});t&&fetch(t).then(e=>e.json()).then(e=>{e!=null&&e.features.length>0&&e.features.forEach(n=>{n.properties&&(this.setFormField(n.properties),this.model.form[this.model.component]=n.properties[this.meta.qgisOptions.cAttr],this.geoVal=n.properties[this.meta.qgisOptions.cAttr],this.getGisData(n.geometry.type))})})}}),this.map.removeLayer(this.selectedLayer),this.map.removeLayer(this.markerLayer)},switchLayer(s){switch(s){case"otm":this.currentLayer.setSource(this.layers.otm);break;case"googleRoad":this.currentLayer.setSource(this.layers.googleLayerRoadmap);break;case"googleSatellite":this.currentLayer.setSource(this.layers.googleLayerSatellite);break;case"esriTopo":this.currentLayer.setSource(this.layers.esriLayerTopo);break;case"esriStreet":this.currentLayer.setSource(this.layers.esriLayerStreet);break;case"cartoPositron":this.currentLayer.setSource(this.layers.cartoPositron);break;case"stamenTerrain":this.currentLayer.setSource(this.layers.stamenTerrain);break;case"osm":this.currentLayer.setSource(this.layers.osm);break;case"osmBW":this.currentLayer.setSource(this.layers.osmBW);break;case"osmCycle":this.currentLayer.setSource(this.layers.osmCycle);break;case"alagacSpecial":this.currentLayer.setSource(this.layers.alagacSpecial);break;case"alagacForest":this.currentLayer.setSource(this.layers.alagacForest);break;case"nsdi":this.currentLayer.setSource(this.layers.nsdi);break}},setFormField(s){this.meta.qgisOptions.attrList.forEach(a=>{this.model.form[a.label]=s[a.value]})},drawLayer(){this.isLoadingLayer=!0,this.parcelLayer=new ol.layer.Tile({name:"wms",source:new ol.source.TileWMS({ratio:1,url:this.meta.qgisOptions.service,params:{FORMAT:"image/png",VERSION:"1.1.1",tiled:!0,STYLES:"",LAYERS:this.meta.qgisOptions.link,exceptions:"application/vnd.ogc.se_inimage",tilesOrigin:619573.6875+","+52965535e-1}})}),this.map.addLayer(this.parcelLayer),this.isLoadingLayer=!1},getGisData(){this.isLoading=!0,axios.get(`https://urban.gov.mn/urban/gis/${this.meta.qgisOptions.cTable}/${this.meta.qgisOptions.cShapeField}/${this.meta.qgisOptions.cAttr}/${this.geoVal}`).then(({data:s})=>{if(s.status){if(this.map.removeLayer(this.selectedLayer),s.point){let h=JSON.parse(s.geo_shape);this.drawSelectedPoint(h.coordinates)}else this.drawSelected(s.shape);let a=JSON.parse(s.center);this.map.getView().setCenter(ol.proj.fromLonLat(a.coordinates)),this.map.getView().setZoom(15)}this.isLoading=!1}).catch(()=>{this.isLoading=!1})},drawSelectedPoint(s){this.map.removeLayer(this.markerLayer);let a=new ol.geom.Point(ol.proj.transform(s,"EPSG:4326","EPSG:3857")),h=new ol.Feature({geometry:a}),l=new ol.style.Icon({src:"/images/markers/default.png"});h.setStyle(new ol.style.Style({image:l}));let o=new ol.source.Vector({features:[h]});this.markerLayer=new ol.layer.Vector({title:"Selected Point",visible:!0,source:o}),this.map.addLayer(this.markerLayer)},drawSelected(s){this.map.removeLayer(this.selectedLayer);let h=new ol.format.WKT().readFeature(s);h.getGeometry().transform("EPSG:4326","EPSG:3857");let l=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,0,0, .5)"}),stroke:new ol.style.Stroke({color:"rgba(255,0,0, 1)",width:2,lineDash:[.1,5]})});this.selectedLayer=new ol.layer.Vector({source:new ol.source.Vector({features:[h]}),style:l}),this.map.addLayer(this.selectedLayer)},destroy(){this.map.removeLayer(this.selectedLayer),this.map.getView().setCenter(ol.proj.fromLonLat([106.831832,47.8916288])),this.map.getView().setZoom(12)}}},_t={class:"qgis-map"},Lt={class:"map-layer-switcher"};function xt(s,a,h,l,o,i){const r=H("Spin"),t=H("lambda-form-item");return T(),P(t,{label:s.label,name:s.model.component,meta:s.meta},{default:dt(()=>[b("div",_t,[o.isLoading?(T(),P(r,{key:0,fix:""})):Y("",!0),o.isLoadingLayer?(T(),P(r,{key:1,fix:""})):Y("",!0),a[6]||(a[6]=b("div",{id:"qgis",style:{height:"350px","border-radius":"10px"}},null,-1)),b("div",Lt,[b("a",{href:"javascript:void(0)",onClick:a[0]||(a[0]=e=>i.switchLayer("googleRoad"))},a[3]||(a[3]=[b("img",{src:bt,alt:""},null,-1),b("span",null,"Google road",-1)])),b("a",{href:"javascript:void(0)",onClick:a[1]||(a[1]=e=>i.switchLayer("googleSatellite"))},a[4]||(a[4]=[b("img",{src:St,alt:""},null,-1),b("span",null,"Google satellite",-1)])),b("a",{href:"javascript:void(0)",onClick:a[2]||(a[2]=e=>i.switchLayer("osm"))},a[5]||(a[5]=[b("img",{src:Mt,alt:""},null,-1),b("span",null,"Open Street Map",-1)]))])])]),_:1},8,["label","name","meta"])}const Gt=ct(vt,[["render",xt]]);export{Gt as default};
